function N0(h,y){for(var w=0;w<y.length;w++){const S=y[w];if(typeof S!="string"&&!Array.isArray(S)){for(const P in S)if(P!=="default"&&!(P in h)){const G=Object.getOwnPropertyDescriptor(S,P);G&&Object.defineProperty(h,P,G.get?G:{enumerable:!0,get:()=>S[P]})}}}return Object.freeze(Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}))}(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))S(P);new MutationObserver(P=>{for(const G of P)if(G.type==="childList")for(const z of G.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&S(z)}).observe(document,{childList:!0,subtree:!0});function w(P){const G={};return P.integrity&&(G.integrity=P.integrity),P.referrerPolicy&&(G.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?G.credentials="include":P.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function S(P){if(P.ep)return;P.ep=!0;const G=w(P);fetch(P.href,G)}})();function tg(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function Z0(h){if(Object.prototype.hasOwnProperty.call(h,"__esModule"))return h;var y=h.default;if(typeof y=="function"){var w=function S(){var P=!1;try{P=this instanceof S}catch{}return P?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};w.prototype=y.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(h).forEach(function(S){var P=Object.getOwnPropertyDescriptor(h,S);Object.defineProperty(w,S,P.get?P:{enumerable:!0,get:function(){return h[S]}})}),w}var bg={exports:{}},Dp={};var w_;function V0(){if(w_)return Dp;w_=1;var h=Symbol.for("react.transitional.element"),y=Symbol.for("react.fragment");function w(S,P,G){var z=null;if(G!==void 0&&(z=""+G),P.key!==void 0&&(z=""+P.key),"key"in P){G={};for(var c in P)c!=="key"&&(G[c]=P[c])}else G=P;return P=G.ref,{$$typeof:h,type:S,key:z,ref:P!==void 0?P:null,props:G}}return Dp.Fragment=y,Dp.jsx=w,Dp.jsxs=w,Dp}var S_;function G0(){return S_||(S_=1,bg.exports=V0()),bg.exports}var Ct=G0(),xg={exports:{}},Ai={};var T_;function q0(){if(T_)return Ai;T_=1;var h=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),z=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),$=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),ce=Symbol.for("react.activity"),ge=Symbol.iterator;function Me(fe){return fe===null||typeof fe!="object"?null:(fe=ge&&fe[ge]||fe["@@iterator"],typeof fe=="function"?fe:null)}var Ae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ie=Object.assign,Ve={};function ot(fe,Re,Ze){this.props=fe,this.context=Re,this.refs=Ve,this.updater=Ze||Ae}ot.prototype.isReactComponent={},ot.prototype.setState=function(fe,Re){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,Re,"setState")},ot.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function Ye(){}Ye.prototype=ot.prototype;function Le(fe,Re,Ze){this.props=fe,this.context=Re,this.refs=Ve,this.updater=Ze||Ae}var Ke=Le.prototype=new Ye;Ke.constructor=Le,ie(Ke,ot.prototype),Ke.isPureReactComponent=!0;var _t=Array.isArray;function ht(){}var St={H:null,A:null,T:null,S:null},be=Object.prototype.hasOwnProperty;function Ie(fe,Re,Ze){var mt=Ze.ref;return{$$typeof:h,type:fe,key:Re,ref:mt!==void 0?mt:null,props:Ze}}function tt(fe,Re){return Ie(fe.type,Re,fe.props)}function bt(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===h}function wt(fe){var Re={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(Ze){return Re[Ze]})}var Wt=/\/+/g;function vi(fe,Re){return typeof fe=="object"&&fe!==null&&fe.key!=null?wt(""+fe.key):Re.toString(36)}function Si(fe){switch(fe.status){case"fulfilled":return fe.value;case"rejected":throw fe.reason;default:switch(typeof fe.status=="string"?fe.then(ht,ht):(fe.status="pending",fe.then(function(Re){fe.status==="pending"&&(fe.status="fulfilled",fe.value=Re)},function(Re){fe.status==="pending"&&(fe.status="rejected",fe.reason=Re)})),fe.status){case"fulfilled":return fe.value;case"rejected":throw fe.reason}}throw fe}function Ue(fe,Re,Ze,mt,It){var Pt=typeof fe;(Pt==="undefined"||Pt==="boolean")&&(fe=null);var Rt=!1;if(fe===null)Rt=!0;else switch(Pt){case"bigint":case"string":case"number":Rt=!0;break;case"object":switch(fe.$$typeof){case h:case y:Rt=!0;break;case oe:return Rt=fe._init,Ue(Rt(fe._payload),Re,Ze,mt,It)}}if(Rt)return It=It(fe),Rt=mt===""?"."+vi(fe,0):mt,_t(It)?(Ze="",Rt!=null&&(Ze=Rt.replace(Wt,"$&/")+"/"),Ue(It,Re,Ze,"",function(bi){return bi})):It!=null&&(bt(It)&&(It=tt(It,Ze+(It.key==null||fe&&fe.key===It.key?"":(""+It.key).replace(Wt,"$&/")+"/")+Rt)),Re.push(It)),1;Rt=0;var Dt=mt===""?".":mt+":";if(_t(fe))for(var Bt=0;Bt<fe.length;Bt++)mt=fe[Bt],Pt=Dt+vi(mt,Bt),Rt+=Ue(mt,Re,Ze,Pt,It);else if(Bt=Me(fe),typeof Bt=="function")for(fe=Bt.call(fe),Bt=0;!(mt=fe.next()).done;)mt=mt.value,Pt=Dt+vi(mt,Bt++),Rt+=Ue(mt,Re,Ze,Pt,It);else if(Pt==="object"){if(typeof fe.then=="function")return Ue(Si(fe),Re,Ze,mt,It);throw Re=String(fe),Error("Objects are not valid as a React child (found: "+(Re==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":Re)+"). If you meant to render a collection of children, use an array instead.")}return Rt}function et(fe,Re,Ze){if(fe==null)return fe;var mt=[],It=0;return Ue(fe,mt,"","",function(Pt){return Re.call(Ze,Pt,It++)}),mt}function it(fe){if(fe._status===-1){var Re=fe._result;Re=Re(),Re.then(function(Ze){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=Ze)},function(Ze){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=Ze)}),fe._status===-1&&(fe._status=0,fe._result=Re)}if(fe._status===1)return fe._result.default;throw fe._result}var dt=typeof reportError=="function"?reportError:function(fe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof fe=="object"&&fe!==null&&typeof fe.message=="string"?String(fe.message):String(fe),error:fe});if(!window.dispatchEvent(Re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",fe);return}console.error(fe)},Kt={map:et,forEach:function(fe,Re,Ze){et(fe,function(){Re.apply(this,arguments)},Ze)},count:function(fe){var Re=0;return et(fe,function(){Re++}),Re},toArray:function(fe){return et(fe,function(Re){return Re})||[]},only:function(fe){if(!bt(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}};return Ai.Activity=ce,Ai.Children=Kt,Ai.Component=ot,Ai.Fragment=w,Ai.Profiler=P,Ai.PureComponent=Le,Ai.StrictMode=S,Ai.Suspense=K,Ai.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=St,Ai.__COMPILER_RUNTIME={__proto__:null,c:function(fe){return St.H.useMemoCache(fe)}},Ai.cache=function(fe){return function(){return fe.apply(null,arguments)}},Ai.cacheSignal=function(){return null},Ai.cloneElement=function(fe,Re,Ze){if(fe==null)throw Error("The argument must be a React element, but you passed "+fe+".");var mt=ie({},fe.props),It=fe.key;if(Re!=null)for(Pt in Re.key!==void 0&&(It=""+Re.key),Re)!be.call(Re,Pt)||Pt==="key"||Pt==="__self"||Pt==="__source"||Pt==="ref"&&Re.ref===void 0||(mt[Pt]=Re[Pt]);var Pt=arguments.length-2;if(Pt===1)mt.children=Ze;else if(1<Pt){for(var Rt=Array(Pt),Dt=0;Dt<Pt;Dt++)Rt[Dt]=arguments[Dt+2];mt.children=Rt}return Ie(fe.type,It,mt)},Ai.createContext=function(fe){return fe={$$typeof:z,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null},fe.Provider=fe,fe.Consumer={$$typeof:G,_context:fe},fe},Ai.createElement=function(fe,Re,Ze){var mt,It={},Pt=null;if(Re!=null)for(mt in Re.key!==void 0&&(Pt=""+Re.key),Re)be.call(Re,mt)&&mt!=="key"&&mt!=="__self"&&mt!=="__source"&&(It[mt]=Re[mt]);var Rt=arguments.length-2;if(Rt===1)It.children=Ze;else if(1<Rt){for(var Dt=Array(Rt),Bt=0;Bt<Rt;Bt++)Dt[Bt]=arguments[Bt+2];It.children=Dt}if(fe&&fe.defaultProps)for(mt in Rt=fe.defaultProps,Rt)It[mt]===void 0&&(It[mt]=Rt[mt]);return Ie(fe,Pt,It)},Ai.createRef=function(){return{current:null}},Ai.forwardRef=function(fe){return{$$typeof:c,render:fe}},Ai.isValidElement=bt,Ai.lazy=function(fe){return{$$typeof:oe,_payload:{_status:-1,_result:fe},_init:it}},Ai.memo=function(fe,Re){return{$$typeof:$,type:fe,compare:Re===void 0?null:Re}},Ai.startTransition=function(fe){var Re=St.T,Ze={};St.T=Ze;try{var mt=fe(),It=St.S;It!==null&&It(Ze,mt),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"&&mt.then(ht,dt)}catch(Pt){dt(Pt)}finally{Re!==null&&Ze.types!==null&&(Re.types=Ze.types),St.T=Re}},Ai.unstable_useCacheRefresh=function(){return St.H.useCacheRefresh()},Ai.use=function(fe){return St.H.use(fe)},Ai.useActionState=function(fe,Re,Ze){return St.H.useActionState(fe,Re,Ze)},Ai.useCallback=function(fe,Re){return St.H.useCallback(fe,Re)},Ai.useContext=function(fe){return St.H.useContext(fe)},Ai.useDebugValue=function(){},Ai.useDeferredValue=function(fe,Re){return St.H.useDeferredValue(fe,Re)},Ai.useEffect=function(fe,Re){return St.H.useEffect(fe,Re)},Ai.useEffectEvent=function(fe){return St.H.useEffectEvent(fe)},Ai.useId=function(){return St.H.useId()},Ai.useImperativeHandle=function(fe,Re,Ze){return St.H.useImperativeHandle(fe,Re,Ze)},Ai.useInsertionEffect=function(fe,Re){return St.H.useInsertionEffect(fe,Re)},Ai.useLayoutEffect=function(fe,Re){return St.H.useLayoutEffect(fe,Re)},Ai.useMemo=function(fe,Re){return St.H.useMemo(fe,Re)},Ai.useOptimistic=function(fe,Re){return St.H.useOptimistic(fe,Re)},Ai.useReducer=function(fe,Re,Ze){return St.H.useReducer(fe,Re,Ze)},Ai.useRef=function(fe){return St.H.useRef(fe)},Ai.useState=function(fe){return St.H.useState(fe)},Ai.useSyncExternalStore=function(fe,Re,Ze){return St.H.useSyncExternalStore(fe,Re,Ze)},Ai.useTransition=function(){return St.H.useTransition()},Ai.version="19.2.0",Ai}var E_;function o_(){return E_||(E_=1,xg.exports=q0()),xg.exports}var Hi=o_();const Op=tg(Hi),$0=N0({__proto__:null,default:Op},[Hi]);var wg={exports:{}},kp={},Sg={exports:{}},Tg={};var M_;function H0(){return M_||(M_=1,(function(h){function y(Ue,et){var it=Ue.length;Ue.push(et);e:for(;0<it;){var dt=it-1>>>1,Kt=Ue[dt];if(0<P(Kt,et))Ue[dt]=et,Ue[it]=Kt,it=dt;else break e}}function w(Ue){return Ue.length===0?null:Ue[0]}function S(Ue){if(Ue.length===0)return null;var et=Ue[0],it=Ue.pop();if(it!==et){Ue[0]=it;e:for(var dt=0,Kt=Ue.length,fe=Kt>>>1;dt<fe;){var Re=2*(dt+1)-1,Ze=Ue[Re],mt=Re+1,It=Ue[mt];if(0>P(Ze,it))mt<Kt&&0>P(It,Ze)?(Ue[dt]=It,Ue[mt]=it,dt=mt):(Ue[dt]=Ze,Ue[Re]=it,dt=Re);else if(mt<Kt&&0>P(It,it))Ue[dt]=It,Ue[mt]=it,dt=mt;else break e}}return et}function P(Ue,et){var it=Ue.sortIndex-et.sortIndex;return it!==0?it:Ue.id-et.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var G=performance;h.unstable_now=function(){return G.now()}}else{var z=Date,c=z.now();h.unstable_now=function(){return z.now()-c}}var K=[],$=[],oe=1,ce=null,ge=3,Me=!1,Ae=!1,ie=!1,Ve=!1,ot=typeof setTimeout=="function"?setTimeout:null,Ye=typeof clearTimeout=="function"?clearTimeout:null,Le=typeof setImmediate<"u"?setImmediate:null;function Ke(Ue){for(var et=w($);et!==null;){if(et.callback===null)S($);else if(et.startTime<=Ue)S($),et.sortIndex=et.expirationTime,y(K,et);else break;et=w($)}}function _t(Ue){if(ie=!1,Ke(Ue),!Ae)if(w(K)!==null)Ae=!0,ht||(ht=!0,wt());else{var et=w($);et!==null&&Si(_t,et.startTime-Ue)}}var ht=!1,St=-1,be=5,Ie=-1;function tt(){return Ve?!0:!(h.unstable_now()-Ie<be)}function bt(){if(Ve=!1,ht){var Ue=h.unstable_now();Ie=Ue;var et=!0;try{e:{Ae=!1,ie&&(ie=!1,Ye(St),St=-1),Me=!0;var it=ge;try{t:{for(Ke(Ue),ce=w(K);ce!==null&&!(ce.expirationTime>Ue&&tt());){var dt=ce.callback;if(typeof dt=="function"){ce.callback=null,ge=ce.priorityLevel;var Kt=dt(ce.expirationTime<=Ue);if(Ue=h.unstable_now(),typeof Kt=="function"){ce.callback=Kt,Ke(Ue),et=!0;break t}ce===w(K)&&S(K),Ke(Ue)}else S(K);ce=w(K)}if(ce!==null)et=!0;else{var fe=w($);fe!==null&&Si(_t,fe.startTime-Ue),et=!1}}break e}finally{ce=null,ge=it,Me=!1}et=void 0}}finally{et?wt():ht=!1}}}var wt;if(typeof Le=="function")wt=function(){Le(bt)};else if(typeof MessageChannel<"u"){var Wt=new MessageChannel,vi=Wt.port2;Wt.port1.onmessage=bt,wt=function(){vi.postMessage(null)}}else wt=function(){ot(bt,0)};function Si(Ue,et){St=ot(function(){Ue(h.unstable_now())},et)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(Ue){Ue.callback=null},h.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):be=0<Ue?Math.floor(1e3/Ue):5},h.unstable_getCurrentPriorityLevel=function(){return ge},h.unstable_next=function(Ue){switch(ge){case 1:case 2:case 3:var et=3;break;default:et=ge}var it=ge;ge=et;try{return Ue()}finally{ge=it}},h.unstable_requestPaint=function(){Ve=!0},h.unstable_runWithPriority=function(Ue,et){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var it=ge;ge=Ue;try{return et()}finally{ge=it}},h.unstable_scheduleCallback=function(Ue,et,it){var dt=h.unstable_now();switch(typeof it=="object"&&it!==null?(it=it.delay,it=typeof it=="number"&&0<it?dt+it:dt):it=dt,Ue){case 1:var Kt=-1;break;case 2:Kt=250;break;case 5:Kt=1073741823;break;case 4:Kt=1e4;break;default:Kt=5e3}return Kt=it+Kt,Ue={id:oe++,callback:et,priorityLevel:Ue,startTime:it,expirationTime:Kt,sortIndex:-1},it>dt?(Ue.sortIndex=it,y($,Ue),w(K)===null&&Ue===w($)&&(ie?(Ye(St),St=-1):ie=!0,Si(_t,it-dt))):(Ue.sortIndex=Kt,y(K,Ue),Ae||Me||(Ae=!0,ht||(ht=!0,wt()))),Ue},h.unstable_shouldYield=tt,h.unstable_wrapCallback=function(Ue){var et=ge;return function(){var it=ge;ge=et;try{return Ue.apply(this,arguments)}finally{ge=it}}}})(Tg)),Tg}var A_;function X0(){return A_||(A_=1,Sg.exports=H0()),Sg.exports}var Eg={exports:{}},qa={};var z_;function Y0(){if(z_)return qa;z_=1;var h=o_();function y(K){var $="https://react.dev/errors/"+K;if(1<arguments.length){$+="?args[]="+encodeURIComponent(arguments[1]);for(var oe=2;oe<arguments.length;oe++)$+="&args[]="+encodeURIComponent(arguments[oe])}return"Minified React error #"+K+"; visit "+$+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function w(){}var S={d:{f:w,r:function(){throw Error(y(522))},D:w,C:w,L:w,m:w,X:w,S:w,M:w},p:0,findDOMNode:null},P=Symbol.for("react.portal");function G(K,$,oe){var ce=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:ce==null?null:""+ce,children:K,containerInfo:$,implementation:oe}}var z=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(K,$){if(K==="font")return"";if(typeof $=="string")return $==="use-credentials"?$:""}return qa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,qa.createPortal=function(K,$){var oe=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$||$.nodeType!==1&&$.nodeType!==9&&$.nodeType!==11)throw Error(y(299));return G(K,$,null,oe)},qa.flushSync=function(K){var $=z.T,oe=S.p;try{if(z.T=null,S.p=2,K)return K()}finally{z.T=$,S.p=oe,S.d.f()}},qa.preconnect=function(K,$){typeof K=="string"&&($?($=$.crossOrigin,$=typeof $=="string"?$==="use-credentials"?$:"":void 0):$=null,S.d.C(K,$))},qa.prefetchDNS=function(K){typeof K=="string"&&S.d.D(K)},qa.preinit=function(K,$){if(typeof K=="string"&&$&&typeof $.as=="string"){var oe=$.as,ce=c(oe,$.crossOrigin),ge=typeof $.integrity=="string"?$.integrity:void 0,Me=typeof $.fetchPriority=="string"?$.fetchPriority:void 0;oe==="style"?S.d.S(K,typeof $.precedence=="string"?$.precedence:void 0,{crossOrigin:ce,integrity:ge,fetchPriority:Me}):oe==="script"&&S.d.X(K,{crossOrigin:ce,integrity:ge,fetchPriority:Me,nonce:typeof $.nonce=="string"?$.nonce:void 0})}},qa.preinitModule=function(K,$){if(typeof K=="string")if(typeof $=="object"&&$!==null){if($.as==null||$.as==="script"){var oe=c($.as,$.crossOrigin);S.d.M(K,{crossOrigin:oe,integrity:typeof $.integrity=="string"?$.integrity:void 0,nonce:typeof $.nonce=="string"?$.nonce:void 0})}}else $==null&&S.d.M(K)},qa.preload=function(K,$){if(typeof K=="string"&&typeof $=="object"&&$!==null&&typeof $.as=="string"){var oe=$.as,ce=c(oe,$.crossOrigin);S.d.L(K,oe,{crossOrigin:ce,integrity:typeof $.integrity=="string"?$.integrity:void 0,nonce:typeof $.nonce=="string"?$.nonce:void 0,type:typeof $.type=="string"?$.type:void 0,fetchPriority:typeof $.fetchPriority=="string"?$.fetchPriority:void 0,referrerPolicy:typeof $.referrerPolicy=="string"?$.referrerPolicy:void 0,imageSrcSet:typeof $.imageSrcSet=="string"?$.imageSrcSet:void 0,imageSizes:typeof $.imageSizes=="string"?$.imageSizes:void 0,media:typeof $.media=="string"?$.media:void 0})}},qa.preloadModule=function(K,$){if(typeof K=="string")if($){var oe=c($.as,$.crossOrigin);S.d.m(K,{as:typeof $.as=="string"&&$.as!=="script"?$.as:void 0,crossOrigin:oe,integrity:typeof $.integrity=="string"?$.integrity:void 0})}else S.d.m(K)},qa.requestFormReset=function(K){S.d.r(K)},qa.unstable_batchedUpdates=function(K,$){return K($)},qa.useFormState=function(K,$,oe){return z.H.useFormState(K,$,oe)},qa.useFormStatus=function(){return z.H.useHostTransitionStatus()},qa.version="19.2.0",qa}var C_;function W0(){if(C_)return Eg.exports;C_=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(y){console.error(y)}}return h(),Eg.exports=Y0(),Eg.exports}var I_;function K0(){if(I_)return kp;I_=1;var h=X0(),y=o_(),w=W0();function S(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function G(i){var s=i,u=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(u=s.return),i=s.return;while(i)}return s.tag===3?u:null}function z(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function c(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function K(i){if(G(i)!==i)throw Error(S(188))}function $(i){var s=i.alternate;if(!s){if(s=G(i),s===null)throw Error(S(188));return s!==i?null:i}for(var u=i,m=s;;){var E=u.return;if(E===null)break;var C=E.alternate;if(C===null){if(m=E.return,m!==null){u=m;continue}break}if(E.child===C.child){for(C=E.child;C;){if(C===u)return K(E),i;if(C===m)return K(E),s;C=C.sibling}throw Error(S(188))}if(u.return!==m.return)u=E,m=C;else{for(var Z=!1,te=E.child;te;){if(te===u){Z=!0,u=E,m=C;break}if(te===m){Z=!0,m=E,u=C;break}te=te.sibling}if(!Z){for(te=C.child;te;){if(te===u){Z=!0,u=C,m=E;break}if(te===m){Z=!0,m=C,u=E;break}te=te.sibling}if(!Z)throw Error(S(189))}}if(u.alternate!==m)throw Error(S(190))}if(u.tag!==3)throw Error(S(188));return u.stateNode.current===u?i:s}function oe(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=oe(i),s!==null)return s;i=i.sibling}return null}var ce=Object.assign,ge=Symbol.for("react.element"),Me=Symbol.for("react.transitional.element"),Ae=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),Ve=Symbol.for("react.strict_mode"),ot=Symbol.for("react.profiler"),Ye=Symbol.for("react.consumer"),Le=Symbol.for("react.context"),Ke=Symbol.for("react.forward_ref"),_t=Symbol.for("react.suspense"),ht=Symbol.for("react.suspense_list"),St=Symbol.for("react.memo"),be=Symbol.for("react.lazy"),Ie=Symbol.for("react.activity"),tt=Symbol.for("react.memo_cache_sentinel"),bt=Symbol.iterator;function wt(i){return i===null||typeof i!="object"?null:(i=bt&&i[bt]||i["@@iterator"],typeof i=="function"?i:null)}var Wt=Symbol.for("react.client.reference");function vi(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Wt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ie:return"Fragment";case ot:return"Profiler";case Ve:return"StrictMode";case _t:return"Suspense";case ht:return"SuspenseList";case Ie:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case Ae:return"Portal";case Le:return i.displayName||"Context";case Ye:return(i._context.displayName||"Context")+".Consumer";case Ke:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case St:return s=i.displayName||null,s!==null?s:vi(i.type)||"Memo";case be:s=i._payload,i=i._init;try{return vi(i(s))}catch{}}return null}var Si=Array.isArray,Ue=y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,et=w.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,it={pending:!1,data:null,method:null,action:null},dt=[],Kt=-1;function fe(i){return{current:i}}function Re(i){0>Kt||(i.current=dt[Kt],dt[Kt]=null,Kt--)}function Ze(i,s){Kt++,dt[Kt]=i.current,i.current=s}var mt=fe(null),It=fe(null),Pt=fe(null),Rt=fe(null);function Dt(i,s){switch(Ze(Pt,s),Ze(It,i),Ze(mt,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?yp(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=yp(s),i=Mm(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Re(mt),Ze(mt,i)}function Bt(){Re(mt),Re(It),Re(Pt)}function bi(i){i.memoizedState!==null&&Ze(Rt,i);var s=mt.current,u=Mm(s,i.type);s!==u&&(Ze(It,i),Ze(mt,u))}function Qt(i){It.current===i&&(Re(mt),Re(It)),Rt.current===i&&(Re(Rt),xe._currentValue=it)}var ri,Pi;function Yt(i){if(ri===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);ri=s&&s[1]||"",Pi=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ri+i+Pi}var gi=!1;function jt(i,s){if(!i||gi)return"";gi=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var ft=function(){throw Error()};if(Object.defineProperty(ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ft,[])}catch(Qe){var Xe=Qe}Reflect.construct(i,[],ft)}else{try{ft.call()}catch(Qe){Xe=Qe}i.call(ft.prototype)}}else{try{throw Error()}catch(Qe){Xe=Qe}(ft=i())&&typeof ft.catch=="function"&&ft.catch(function(){})}}catch(Qe){if(Qe&&Xe&&typeof Qe.stack=="string")return[Qe.stack,Xe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=m.DetermineComponentFrameRoot(),Z=C[0],te=C[1];if(Z&&te){var Se=Z.split(`
`),He=te.split(`
`);for(E=m=0;m<Se.length&&!Se[m].includes("DetermineComponentFrameRoot");)m++;for(;E<He.length&&!He[E].includes("DetermineComponentFrameRoot");)E++;if(m===Se.length||E===He.length)for(m=Se.length-1,E=He.length-1;1<=m&&0<=E&&Se[m]!==He[E];)E--;for(;1<=m&&0<=E;m--,E--)if(Se[m]!==He[E]){if(m!==1||E!==1)do if(m--,E--,0>E||Se[m]!==He[E]){var st=`
`+Se[m].replace(" at new "," at ");return i.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",i.displayName)),st}while(1<=m&&0<=E);break}}}finally{gi=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?Yt(u):""}function nn(i,s){switch(i.tag){case 26:case 27:case 5:return Yt(i.type);case 16:return Yt("Lazy");case 13:return i.child!==s&&s!==null?Yt("Suspense Fallback"):Yt("Suspense");case 19:return Yt("SuspenseList");case 0:case 15:return jt(i.type,!1);case 11:return jt(i.type.render,!1);case 1:return jt(i.type,!0);case 31:return Yt("Activity");default:return""}}function Ti(i){try{var s="",u=null;do s+=nn(i,u),u=i,i=i.return;while(i);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var zi=Object.prototype.hasOwnProperty,Gi=h.unstable_scheduleCallback,er=h.unstable_cancelCallback,Xi=h.unstable_shouldYield,tr=h.unstable_requestPaint,Ei=h.unstable_now,mn=h.unstable_getCurrentPriorityLevel,Ui=h.unstable_ImmediatePriority,ee=h.unstable_UserBlockingPriority,O=h.unstable_NormalPriority,U=h.unstable_LowPriority,q=h.unstable_IdlePriority,L=h.log,F=h.unstable_setDisableYieldValue,H=null,ae=null;function pe(i){if(typeof L=="function"&&F(i),ae&&typeof ae.setStrictMode=="function")try{ae.setStrictMode(H,i)}catch{}}var we=Math.clz32?Math.clz32:qe,ke=Math.log,Te=Math.LN2;function qe(i){return i>>>=0,i===0?32:31-(ke(i)/Te|0)|0}var ct=256,Je=262144,Ft=4194304;function De(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function _i(i,s,u){var m=i.pendingLanes;if(m===0)return 0;var E=0,C=i.suspendedLanes,Z=i.pingedLanes;i=i.warmLanes;var te=m&134217727;return te!==0?(m=te&~C,m!==0?E=De(m):(Z&=te,Z!==0?E=De(Z):u||(u=te&~i,u!==0&&(E=De(u))))):(te=m&~C,te!==0?E=De(te):Z!==0?E=De(Z):u||(u=m&~i,u!==0&&(E=De(u)))),E===0?0:s!==0&&s!==E&&(s&C)===0&&(C=E&-E,u=s&-s,C>=u||C===32&&(u&4194048)!==0)?s:E}function rn(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Gt(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xi(){var i=Ft;return Ft<<=1,(Ft&62914560)===0&&(Ft=4194304),i}function Yi(i){for(var s=[],u=0;31>u;u++)s.push(i);return s}function gn(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function _r(i,s,u,m,E,C){var Z=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var te=i.entanglements,Se=i.expirationTimes,He=i.hiddenUpdates;for(u=Z&~u;0<u;){var st=31-we(u),ft=1<<st;te[st]=0,Se[st]=-1;var Xe=He[st];if(Xe!==null)for(He[st]=null,st=0;st<Xe.length;st++){var Qe=Xe[st];Qe!==null&&(Qe.lane&=-536870913)}u&=~ft}m!==0&&Sn(i,m,0),C!==0&&E===0&&i.tag!==0&&(i.suspendedLanes|=C&~(Z&~s))}function Sn(i,s,u){i.pendingLanes|=s,i.suspendedLanes&=~s;var m=31-we(s);i.entangledLanes|=s,i.entanglements[m]=i.entanglements[m]|1073741824|u&261930}function Zn(i,s){var u=i.entangledLanes|=s;for(i=i.entanglements;u;){var m=31-we(u),E=1<<m;E&s|i[m]&s&&(i[m]|=s),u&=~E}}function _n(i,s){var u=s&-s;return u=(u&42)!==0?1:Vn(u),(u&(i.suspendedLanes|s))!==0?0:u}function Vn(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function at(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Rn(){var i=et.p;return i!==0?i:(i=window.event,i===void 0?32:kn(i.type))}function jr(i,s){var u=et.p;try{return et.p=i,s()}finally{et.p=u}}var ga=Math.random().toString(36).slice(2),Ni="__reactFiber$"+ga,gt="__reactProps$"+ga,ai="__reactContainer$"+ga,yi="__reactEvents$"+ga,$a="__reactListeners$"+ga,tc="__reactHandles$"+ga,As="__reactResources$"+ga,ci="__reactMarker$"+ga;function Fo(i){delete i[Ni],delete i[gt],delete i[yi],delete i[$a],delete i[tc]}function za(i){var s=i[Ni];if(s)return s;for(var u=i.parentNode;u;){if(s=u[ai]||u[Ni]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(i=Tp(i);i!==null;){if(u=i[Ni])return u;i=Tp(i)}return s}i=u,u=i.parentNode}return null}function Xr(i){if(i=i[Ni]||i[ai]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Ca(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(S(33))}function os(i){var s=i[As];return s||(s=i[As]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Cn(i){i[ci]=!0}var ic=new Set,Ir={};function Wi(i,s){Ha(i,s),Ha(i+"Capture",s)}function Ha(i,s){for(Ir[i]=s,i=0;i<s.length;i++)ic.add(s[i])}var jo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gn={},co={};function zs(i){return zi.call(co,i)?!0:zi.call(Gn,i)?!1:jo.test(i)?co[i]=!0:(Gn[i]=!0,!1)}function Cs(i,s,u){if(zs(s))if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+u)}}function El(i,s,u){if(u===null)i.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+u)}}function ls(i,s,u,m){if(m===null)i.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(s,u,""+m)}}function Pr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function nu(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ef(i,s,u){var m=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var E=m.get,C=m.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return E.call(this)},set:function(Z){u=""+Z,C.call(this,Z)}}),Object.defineProperty(i,s,{enumerable:m.enumerable}),{getValue:function(){return u},setValue:function(Z){u=""+Z},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ru(i){if(!i._valueTracker){var s=nu(i)?"checked":"value";i._valueTracker=Ef(i,s,""+i[s])}}function pd(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var u=s.getValue(),m="";return i&&(m=nu(i)?i.checked?"true":"false":i.value),i=m,i!==u?(s.setValue(i),!0):!1}function nc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var md=/[\n"\\]/g;function la(i){return i.replace(md,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function rc(i,s,u,m,E,C,Z,te){i.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?i.type=Z:i.removeAttribute("type"),s!=null?Z==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Pr(s)):i.value!==""+Pr(s)&&(i.value=""+Pr(s)):Z!=="submit"&&Z!=="reset"||i.removeAttribute("value"),s!=null?ac(i,Z,Pr(s)):u!=null?ac(i,Z,Pr(u)):m!=null&&i.removeAttribute("value"),E==null&&C!=null&&(i.defaultChecked=!!C),E!=null&&(i.checked=E&&typeof E!="function"&&typeof E!="symbol"),te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?i.name=""+Pr(te):i.removeAttribute("name")}function oh(i,s,u,m,E,C,Z,te){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),s!=null||u!=null){if(!(C!=="submit"&&C!=="reset"||s!=null)){ru(i);return}u=u!=null?""+Pr(u):"",s=s!=null?""+Pr(s):u,te||s===i.value||(i.value=s),i.defaultValue=s}m=m??E,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=te?i.checked:!!m,i.defaultChecked=!!m,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(i.name=Z),ru(i)}function ac(i,s,u){s==="number"&&nc(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function Is(i,s,u,m){if(i=i.options,s){s={};for(var E=0;E<u.length;E++)s["$"+u[E]]=!0;for(u=0;u<i.length;u++)E=s.hasOwnProperty("$"+i[u].value),i[u].selected!==E&&(i[u].selected=E),E&&m&&(i[u].defaultSelected=!0)}else{for(u=""+Pr(u),s=null,E=0;E<i.length;E++){if(i[E].value===u){i[E].selected=!0,m&&(i[E].defaultSelected=!0);return}s!==null||i[E].disabled||(s=i[E])}s!==null&&(s.selected=!0)}}function Ml(i,s,u){if(s!=null&&(s=""+Pr(s),s!==i.value&&(i.value=s),u==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=u!=null?""+Pr(u):""}function Al(i,s,u,m){if(s==null){if(m!=null){if(u!=null)throw Error(S(92));if(Si(m)){if(1<m.length)throw Error(S(93));m=m[0]}u=m}u==null&&(u=""),s=u}u=Pr(s),i.defaultValue=u,m=i.textContent,m===u&&m!==""&&m!==null&&(i.value=m),ru(i)}function Ps(i,s){if(s){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=s;return}}i.textContent=s}var zl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Uo(i,s,u){var m=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?m?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":m?i.setProperty(s,u):typeof u!="number"||u===0||zl.has(s)?s==="float"?i.cssFloat=u:i[s]=(""+u).trim():i[s]=u+"px"}function lh(i,s,u){if(s!=null&&typeof s!="object")throw Error(S(62));if(i=i.style,u!=null){for(var m in u)!u.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var E in s)m=s[E],s.hasOwnProperty(E)&&u[E]!==m&&Uo(i,E,m)}else for(var C in s)s.hasOwnProperty(C)&&Uo(i,C,s[C])}function ch(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ds=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),No=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ni(i){return No.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function di(){}var uo=null;function Ia(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var dr=null,qn=null;function yr(i){var s=Xr(i);if(s&&(i=s.stateNode)){var u=i[gt]||null;e:switch(i=s.stateNode,s.type){case"input":if(rc(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+la(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var m=u[s];if(m!==i&&m.form===i.form){var E=m[gt]||null;if(!E)throw Error(S(90));rc(m,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(s=0;s<u.length;s++)m=u[s],m.form===i.form&&pd(m)}break e;case"textarea":Ml(i,u.value,u.defaultValue);break e;case"select":s=u.value,s!=null&&Is(i,!!u.multiple,s,!1)}}}var Bn=!1;function un(i,s,u){if(Bn)return i(s,u);Bn=!0;try{var m=i(s);return m}finally{if(Bn=!1,(dr!==null||qn!==null)&&(qd(),dr&&(s=dr,i=qn,qn=dr=null,yr(s),i)))for(s=0;s<i.length;s++)yr(i[s])}}function Cl(i,s){var u=i.stateNode;if(u===null)return null;var m=u[gt]||null;if(m===null)return null;u=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(S(231,s,typeof u));return u}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dr=!1;if(In)try{var kr={};Object.defineProperty(kr,"passive",{get:function(){Dr=!0}}),window.addEventListener("test",kr,kr),window.removeEventListener("test",kr,kr)}catch{Dr=!1}var Pa=null,Da=null,Tn=null;function Zo(){if(Tn)return Tn;var i,s=Da,u=s.length,m,E="value"in Pa?Pa.value:Pa.textContent,C=E.length;for(i=0;i<u&&s[i]===E[i];i++);var Z=u-i;for(m=1;m<=Z&&s[u-m]===E[C-m];m++);return Tn=E.slice(i,1<m?1-m:void 0)}function Xa(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function cs(){return!0}function Ri(){return!1}function Rr(i){function s(u,m,E,C,Z){this._reactName=u,this._targetInst=E,this.type=m,this.nativeEvent=C,this.target=Z,this.currentTarget=null;for(var te in i)i.hasOwnProperty(te)&&(u=i[te],this[te]=u?u(C):C[te]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?cs:Ri,this.isPropagationStopped=Ri,this}return ce(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),s}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fi=Rr(ui),ho=ce({},ui,{view:0,detail:0}),Di=Rr(ho),fo,ca,ks,Rs=ce({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ks&&(ks&&i.type==="mousemove"?(fo=i.screenX-ks.screenX,ca=i.screenY-ks.screenY):ca=fo=0,ks=i),fo)},movementY:function(i){return"movementY"in i?i.movementY:ca}}),Il=Rr(Rs),sc=ce({},Rs,{dataTransfer:0}),au=Rr(sc),su=ce({},ho,{relatedTarget:0}),Vo=Rr(su),Pl=ce({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),po=Rr(Pl),vr=ce({},ui,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),oc=Rr(vr),gd=ce({},ui,{data:0}),lc=Rr(gd),qi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ou={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ka={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cc(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=ka[i])?!!s[i]:!1}function lu(){return cc}var Go=ce({},ho,{key:function(i){if(i.key){var s=qi[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Xa(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ou[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lu,charCode:function(i){return i.type==="keypress"?Xa(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Xa(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Bs=Rr(Go),uh=ce({},Rs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_d=Rr(uh),yd=ce({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lu}),cu=Rr(yd),uu=ce({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ya=Rr(uu),uc=ce({},Rs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Dl=Rr(uc),hu=ce({},ui,{newState:0,oldState:0}),hc=Rr(hu),hh=[9,13,27,32],Ra=In&&"CompositionEvent"in window,dc=null;In&&"documentMode"in document&&(dc=document.documentMode);var dh=In&&"TextEvent"in window&&!dc,Ls=In&&(!Ra||dc&&8<dc&&11>=dc),kl=" ",fh=!1;function Rl(i,s){switch(i){case"keyup":return hh.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vd(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ba=!1;function Mf(i,s){switch(i){case"compositionend":return vd(s);case"keypress":return s.which!==32?null:(fh=!0,kl);case"textInput":return i=s.data,i===kl&&fh?null:i;default:return null}}function bd(i,s){if(Ba)return i==="compositionend"||!Ra&&Rl(i,s)?(i=Zo(),Tn=Da=Pa=null,Ba=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ls&&s.locale!=="ko"?null:s.data;default:return null}}var Af={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ph(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Af[i.type]:s==="textarea"}function du(i,s,u,m){dr?qn?qn.push(m):qn=[m]:dr=m,s=Kh(s,"onChange"),0<s.length&&(u=new fi("onChange","change",null,u,m),i.push({event:u,listeners:s}))}var qo=null,$o=null;function mh(i){Sm(i,0)}function fc(i){var s=Ca(i);if(pd(s))return i}function mo(i,s){if(i==="change")return s}var gh=!1;if(In){var fu;if(In){var us="oninput"in document;if(!us){var xd=document.createElement("div");xd.setAttribute("oninput","return;"),us=typeof xd.oninput=="function"}fu=us}else fu=!1;gh=fu&&(!document.documentMode||9<document.documentMode)}function pc(){qo&&(qo.detachEvent("onpropertychange",wd),$o=qo=null)}function wd(i){if(i.propertyName==="value"&&fc($o)){var s=[];du(s,$o,i,Ia(i)),un(mh,s)}}function zf(i,s,u){i==="focusin"?(pc(),qo=s,$o=u,qo.attachEvent("onpropertychange",wd)):i==="focusout"&&pc()}function pu(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return fc($o)}function _h(i,s){if(i==="click")return fc(s)}function Sd(i,s){if(i==="input"||i==="change")return fc(s)}function yh(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Yr=typeof Object.is=="function"?Object.is:yh;function Os(i,s){if(Yr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var u=Object.keys(i),m=Object.keys(s);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var E=u[m];if(!zi.call(s,E)||!Yr(i[E],s[E]))return!1}return!0}function hs(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function mu(i,s){var u=hs(i);i=0;for(var m;u;){if(u.nodeType===3){if(m=i+u.textContent.length,i<=s&&m>=s)return{node:u,offset:s-i};i=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=hs(u)}}function gu(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?gu(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function mc(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=nc(i.document);s instanceof i.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)i=s.contentWindow;else break;s=nc(i.document)}return s}function _u(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var vh=In&&"documentMode"in document&&11>=document.documentMode,La=null,gc=null,Bi=null,bh=!1;function Td(i,s,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;bh||La==null||La!==nc(m)||(m=La,"selectionStart"in m&&_u(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Bi&&Os(Bi,m)||(Bi=m,m=Kh(gc,"onSelect"),0<m.length&&(s=new fi("onSelect","select",null,s,u),i.push({event:s,listeners:m}),s.target=La)))}function Ho(i,s){var u={};return u[i.toLowerCase()]=s.toLowerCase(),u["Webkit"+i]="webkit"+s,u["Moz"+i]="moz"+s,u}var Xo={animationend:Ho("Animation","AnimationEnd"),animationiteration:Ho("Animation","AnimationIteration"),animationstart:Ho("Animation","AnimationStart"),transitionrun:Ho("Transition","TransitionRun"),transitionstart:Ho("Transition","TransitionStart"),transitioncancel:Ho("Transition","TransitionCancel"),transitionend:Ho("Transition","TransitionEnd")},xh={},wh={};In&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function ds(i){if(xh[i])return xh[i];if(!Xo[i])return i;var s=Xo[i],u;for(u in s)if(s.hasOwnProperty(u)&&u in wh)return xh[i]=s[u];return i}var _c=ds("animationend"),yc=ds("animationiteration"),yu=ds("animationstart"),Yo=ds("transitionrun"),vc=ds("transitionstart"),Bl=ds("transitioncancel"),_a=ds("transitionend"),Sh=new Map,vu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vu.push("scrollEnd");function ya(i,s){Sh.set(i,s),Wi(s,[i])}var fs=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Wr=[],Fs=0,Wo=0;function Ko(){for(var i=Fs,s=Wo=Fs=0;s<i;){var u=Wr[s];Wr[s++]=null;var m=Wr[s];Wr[s++]=null;var E=Wr[s];Wr[s++]=null;var C=Wr[s];if(Wr[s++]=null,m!==null&&E!==null){var Z=m.pending;Z===null?E.next=E:(E.next=Z.next,Z.next=E),m.pending=E}C!==0&&Th(u,E,C)}}function bc(i,s,u,m){Wr[Fs++]=i,Wr[Fs++]=s,Wr[Fs++]=u,Wr[Fs++]=m,Wo|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function go(i,s,u,m){return bc(i,s,u,m),Ll(i)}function Oa(i,s){return bc(i,null,null,s),Ll(i)}function Th(i,s,u){i.lanes|=u;var m=i.alternate;m!==null&&(m.lanes|=u);for(var E=!1,C=i.return;C!==null;)C.childLanes|=u,m=C.alternate,m!==null&&(m.childLanes|=u),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(E=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,E&&s!==null&&(E=31-we(u),i=C.hiddenUpdates,m=i[E],m===null?i[E]=[s]:m.push(s),s.lane=u|536870912),C):null}function Ll(i){if(50<yl)throw yl=0,or=null,Error(S(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var pi={};function bu(i,s,u,m){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(i,s,u,m){return new bu(i,s,u,m)}function xu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Kr(i,s){var u=i.alternate;return u===null?(u=va(i.tag,s,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=s,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,s=i.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Ed(i,s){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,s=u.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function wu(i,s,u,m,E,C){var Z=0;if(m=i,typeof i=="function")xu(i)&&(Z=1);else if(typeof i=="string")Z=B(i,u,mt.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Ie:return i=va(31,u,s,E),i.elementType=Ie,i.lanes=C,i;case ie:return _o(u.children,E,C,s);case Ve:Z=8,E|=24;break;case ot:return i=va(12,u,s,E|2),i.elementType=ot,i.lanes=C,i;case _t:return i=va(13,u,s,E),i.elementType=_t,i.lanes=C,i;case ht:return i=va(19,u,s,E),i.elementType=ht,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Le:Z=10;break e;case Ye:Z=9;break e;case Ke:Z=11;break e;case St:Z=14;break e;case be:Z=16,m=null;break e}Z=29,u=Error(S(130,i===null?"null":typeof i,"")),m=null}return s=va(Z,u,s,E),s.elementType=i,s.type=m,s.lanes=C,s}function _o(i,s,u,m){return i=va(7,i,m,s),i.lanes=u,i}function Su(i,s,u){return i=va(6,i,null,s),i.lanes=u,i}function Tu(i){var s=va(18,null,null,0);return s.stateNode=i,s}function Ol(i,s,u){return s=va(4,i.children!==null?i.children:[],i.key,s),s.lanes=u,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var yo=new WeakMap;function Ur(i,s){if(typeof i=="object"&&i!==null){var u=yo.get(i);return u!==void 0?u:(s={value:i,source:s,stack:Ti(s)},yo.set(i,s),s)}return{value:i,source:s,stack:Ti(s)}}var vo=[],Qo=0,Jo=null,bo=0,Qr=[],br=0,Wa=null,ps=1,ua="";function ms(i,s){vo[Qo++]=bo,vo[Qo++]=Jo,Jo=i,bo=s}function Eu(i,s,u){Qr[br++]=ps,Qr[br++]=ua,Qr[br++]=Wa,Wa=i;var m=ps;i=ua;var E=32-we(m)-1;m&=~(1<<E),u+=1;var C=32-we(s)+E;if(30<C){var Z=E-E%5;C=(m&(1<<Z)-1).toString(32),m>>=Z,E-=Z,ps=1<<32-we(s)+E|u<<E|m,ua=C+i}else ps=1<<C|u<<E|m,ua=i}function el(i){i.return!==null&&(ms(i,1),Eu(i,1,0))}function xc(i){for(;i===Jo;)Jo=vo[--Qo],vo[Qo]=null,bo=vo[--Qo],vo[Qo]=null;for(;i===Wa;)Wa=Qr[--br],Qr[br]=null,ua=Qr[--br],Qr[br]=null,ps=Qr[--br],Qr[br]=null}function Eh(i,s){Qr[br++]=ps,Qr[br++]=ua,Qr[br++]=Wa,ps=s.id,ua=s.overflow,Wa=i}var xr=null,an=null,Ii=!1,js=null,Jr=!1,yn=Error(S(519));function Nr(i){var s=Error(S(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw il(Ur(s,i)),yn}function ea(i){var s=i.stateNode,u=i.type,m=i.memoizedProps;switch(s[Ni]=i,s[gt]=m,u){case"dialog":Oi("cancel",s),Oi("close",s);break;case"iframe":case"object":case"embed":Oi("load",s);break;case"video":case"audio":for(u=0;u<Wh.length;u++)Oi(Wh[u],s);break;case"source":Oi("error",s);break;case"img":case"image":case"link":Oi("error",s),Oi("load",s);break;case"details":Oi("toggle",s);break;case"input":Oi("invalid",s),oh(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Oi("invalid",s);break;case"textarea":Oi("invalid",s),Al(s,m.value,m.defaultValue,m.children)}u=m.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||m.suppressHydrationWarning===!0||_p(s.textContent,u)?(m.popover!=null&&(Oi("beforetoggle",s),Oi("toggle",s)),m.onScroll!=null&&Oi("scroll",s),m.onScrollEnd!=null&&Oi("scrollend",s),m.onClick!=null&&(s.onclick=di),s=!0):s=!1,s||Nr(i,!0)}function tl(i){for(xr=i.return;xr;)switch(xr.tag){case 5:case 31:case 13:Jr=!1;return;case 27:case 3:Jr=!0;return;default:xr=xr.return}}function Us(i){if(i!==xr)return!1;if(!Ii)return tl(i),Ii=!0,!1;var s=i.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||af(i.type,i.memoizedProps)),u=!u),u&&an&&Nr(i),tl(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(S(317));an=cf(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(S(317));an=cf(i)}else s===27?(s=an,vl(i.type)?(i=Tr,Tr=null,an=i):an=s):an=xr?sa(i.stateNode.nextSibling):null;return!0}function xo(){an=xr=null,Ii=!1}function wo(){var i=js;return i!==null&&(fa===null?fa=i:fa.push.apply(fa,i),js=null),i}function il(i){js===null?js=[i]:js.push(i)}var nl=fe(null),Ns=null,Ka=null;function gs(i,s,u){Ze(nl,s._currentValue),s._currentValue=u}function ba(i){i._currentValue=nl.current,Re(nl)}function Mu(i,s,u){for(;i!==null;){var m=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),i===u)break;i=i.return}}function wc(i,s,u,m){var E=i.child;for(E!==null&&(E.return=i);E!==null;){var C=E.dependencies;if(C!==null){var Z=E.child;C=C.firstContext;e:for(;C!==null;){var te=C;C=E;for(var Se=0;Se<s.length;Se++)if(te.context===s[Se]){C.lanes|=u,te=C.alternate,te!==null&&(te.lanes|=u),Mu(C.return,u,i),m||(Z=null);break e}C=te.next}}else if(E.tag===18){if(Z=E.return,Z===null)throw Error(S(341));Z.lanes|=u,C=Z.alternate,C!==null&&(C.lanes|=u),Mu(Z,u,i),Z=null}else Z=E.child;if(Z!==null)Z.return=E;else for(Z=E;Z!==null;){if(Z===i){Z=null;break}if(E=Z.sibling,E!==null){E.return=Z.return,Z=E;break}Z=Z.return}E=Z}}function xa(i,s,u,m){i=null;for(var E=s,C=!1;E!==null;){if(!C){if((E.flags&524288)!==0)C=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var Z=E.alternate;if(Z===null)throw Error(S(387));if(Z=Z.memoizedProps,Z!==null){var te=E.type;Yr(E.pendingProps.value,Z.value)||(i!==null?i.push(te):i=[te])}}else if(E===Rt.current){if(Z=E.alternate,Z===null)throw Error(S(387));Z.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(i!==null?i.push(xe):i=[xe])}E=E.return}i!==null&&wc(s,i,u,m),s.flags|=262144}function Sc(i){for(i=i.firstContext;i!==null;){if(!Yr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Zs(i){Ns=i,Ka=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fr(i){return Mh(Ns,i)}function Vs(i,s){return Ns===null&&Zs(i),Mh(i,s)}function Mh(i,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},Ka===null){if(i===null)throw Error(S(308));Ka=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ka=Ka.next=s;return u}var Md=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(u,m){i.push(m)}};this.abort=function(){s.aborted=!0,i.forEach(function(u){return u()})}},Ad=h.unstable_scheduleCallback,zd=h.unstable_NormalPriority,Ln={$$typeof:Le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Au(){return{controller:new Md,data:new Map,refCount:0}}function ir(i){i.refCount--,i.refCount===0&&Ad(zd,function(){i.controller.abort()})}var pr=null,Zr=0,nr=0,rl=null;function Fl(i,s){if(pr===null){var u=pr=[];Zr=0,nr=Xh(),rl={status:"pending",value:void 0,then:function(m){u.push(m)}}}return Zr++,s.then(Cd,Cd),s}function Cd(){if(--Zr===0&&pr!==null){rl!==null&&(rl.status="fulfilled");var i=pr;pr=null,nr=0,rl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function Tc(i,s){var u=[],m={status:"pending",value:null,reason:null,then:function(E){u.push(E)}};return i.then(function(){m.status="fulfilled",m.value=s;for(var E=0;E<u.length;E++)(0,u[E])(s)},function(E){for(m.status="rejected",m.reason=E,E=0;E<u.length;E++)(0,u[E])(void 0)}),m}var Ah=Ue.S;Ue.S=function(i,s){tp=Ei(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Fl(i,s),Ah!==null&&Ah(i,s)};var Gs=fe(null);function zu(){var i=Gs.current;return i!==null?i:tn.pooledCache}function _s(i,s){s===null?Ze(Gs,Gs.current):Ze(Gs,s.pool)}function ys(){var i=zu();return i===null?null:{parent:Ln._currentValue,pool:i}}var zt=Error(S(460)),Cu=Error(S(474)),jl=Error(S(542)),Ec={then:function(){}};function vs(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ul(i,s,u){switch(u=i[u],u===void 0?i.push(s):u!==s&&(s.then(di,di),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Pu(i),i;default:if(typeof s.status=="string")s.then(di,di);else{if(i=tn,i!==null&&100<i.shellSuspendCounter)throw Error(S(482));i=s,i.status="pending",i.then(function(m){if(s.status==="pending"){var E=s;E.status="fulfilled",E.value=m}},function(m){if(s.status==="pending"){var E=s;E.status="rejected",E.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Pu(i),i}throw hi=s,zt}}function qs(i){try{var s=i._init;return s(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(hi=u,zt):u}}var hi=null;function Iu(){if(hi===null)throw Error(S(459));var i=hi;return hi=null,i}function Pu(i){if(i===zt||i===jl)throw Error(S(483))}var Qa=null,Nl=0;function Mc(i){var s=Nl;return Nl+=1,Qa===null&&(Qa=[]),Ul(Qa,i,s)}function al(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function sl(i,s){throw s.$$typeof===ge?Error(S(525)):(i=Object.prototype.toString.call(s),Error(S(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Ac(i){function s(Be,Pe){if(i){var je=Be.deletions;je===null?(Be.deletions=[Pe],Be.flags|=16):je.push(Pe)}}function u(Be,Pe){if(!i)return null;for(;Pe!==null;)s(Be,Pe),Pe=Pe.sibling;return null}function m(Be){for(var Pe=new Map;Be!==null;)Be.key!==null?Pe.set(Be.key,Be):Pe.set(Be.index,Be),Be=Be.sibling;return Pe}function E(Be,Pe){return Be=Kr(Be,Pe),Be.index=0,Be.sibling=null,Be}function C(Be,Pe,je){return Be.index=je,i?(je=Be.alternate,je!==null?(je=je.index,je<Pe?(Be.flags|=67108866,Pe):je):(Be.flags|=67108866,Pe)):(Be.flags|=1048576,Pe)}function Z(Be){return i&&Be.alternate===null&&(Be.flags|=67108866),Be}function te(Be,Pe,je,lt){return Pe===null||Pe.tag!==6?(Pe=Su(je,Be.mode,lt),Pe.return=Be,Pe):(Pe=E(Pe,je),Pe.return=Be,Pe)}function Se(Be,Pe,je,lt){var ei=je.type;return ei===ie?st(Be,Pe,je.props.children,lt,je.key):Pe!==null&&(Pe.elementType===ei||typeof ei=="object"&&ei!==null&&ei.$$typeof===be&&qs(ei)===Pe.type)?(Pe=E(Pe,je.props),al(Pe,je),Pe.return=Be,Pe):(Pe=wu(je.type,je.key,je.props,null,Be.mode,lt),al(Pe,je),Pe.return=Be,Pe)}function He(Be,Pe,je,lt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==je.containerInfo||Pe.stateNode.implementation!==je.implementation?(Pe=Ol(je,Be.mode,lt),Pe.return=Be,Pe):(Pe=E(Pe,je.children||[]),Pe.return=Be,Pe)}function st(Be,Pe,je,lt,ei){return Pe===null||Pe.tag!==7?(Pe=_o(je,Be.mode,lt,ei),Pe.return=Be,Pe):(Pe=E(Pe,je),Pe.return=Be,Pe)}function ft(Be,Pe,je){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return Pe=Su(""+Pe,Be.mode,je),Pe.return=Be,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case Me:return je=wu(Pe.type,Pe.key,Pe.props,null,Be.mode,je),al(je,Pe),je.return=Be,je;case Ae:return Pe=Ol(Pe,Be.mode,je),Pe.return=Be,Pe;case be:return Pe=qs(Pe),ft(Be,Pe,je)}if(Si(Pe)||wt(Pe))return Pe=_o(Pe,Be.mode,je,null),Pe.return=Be,Pe;if(typeof Pe.then=="function")return ft(Be,Mc(Pe),je);if(Pe.$$typeof===Le)return ft(Be,Vs(Be,Pe),je);sl(Be,Pe)}return null}function Xe(Be,Pe,je,lt){var ei=Pe!==null?Pe.key:null;if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return ei!==null?null:te(Be,Pe,""+je,lt);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case Me:return je.key===ei?Se(Be,Pe,je,lt):null;case Ae:return je.key===ei?He(Be,Pe,je,lt):null;case be:return je=qs(je),Xe(Be,Pe,je,lt)}if(Si(je)||wt(je))return ei!==null?null:st(Be,Pe,je,lt,null);if(typeof je.then=="function")return Xe(Be,Pe,Mc(je),lt);if(je.$$typeof===Le)return Xe(Be,Pe,Vs(Be,je),lt);sl(Be,je)}return null}function Qe(Be,Pe,je,lt,ei){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Be=Be.get(je)||null,te(Pe,Be,""+lt,ei);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case Me:return Be=Be.get(lt.key===null?je:lt.key)||null,Se(Pe,Be,lt,ei);case Ae:return Be=Be.get(lt.key===null?je:lt.key)||null,He(Pe,Be,lt,ei);case be:return lt=qs(lt),Qe(Be,Pe,je,lt,ei)}if(Si(lt)||wt(lt))return Be=Be.get(je)||null,st(Pe,Be,lt,ei,null);if(typeof lt.then=="function")return Qe(Be,Pe,je,Mc(lt),ei);if(lt.$$typeof===Le)return Qe(Be,Pe,je,Vs(Pe,lt),ei);sl(Pe,lt)}return null}function Vt(Be,Pe,je,lt){for(var ei=null,Ki=null,Xt=Pe,Ci=Pe=0,si=null;Xt!==null&&Ci<je.length;Ci++){Xt.index>Ci?(si=Xt,Xt=null):si=Xt.sibling;var wi=Xe(Be,Xt,je[Ci],lt);if(wi===null){Xt===null&&(Xt=si);break}i&&Xt&&wi.alternate===null&&s(Be,Xt),Pe=C(wi,Pe,Ci),Ki===null?ei=wi:Ki.sibling=wi,Ki=wi,Xt=si}if(Ci===je.length)return u(Be,Xt),Ii&&ms(Be,Ci),ei;if(Xt===null){for(;Ci<je.length;Ci++)Xt=ft(Be,je[Ci],lt),Xt!==null&&(Pe=C(Xt,Pe,Ci),Ki===null?ei=Xt:Ki.sibling=Xt,Ki=Xt);return Ii&&ms(Be,Ci),ei}for(Xt=m(Xt);Ci<je.length;Ci++)si=Qe(Xt,Be,Ci,je[Ci],lt),si!==null&&(i&&si.alternate!==null&&Xt.delete(si.key===null?Ci:si.key),Pe=C(si,Pe,Ci),Ki===null?ei=si:Ki.sibling=si,Ki=si);return i&&Xt.forEach(function(Ga){return s(Be,Ga)}),Ii&&ms(Be,Ci),ei}function li(Be,Pe,je,lt){if(je==null)throw Error(S(151));for(var ei=null,Ki=null,Xt=Pe,Ci=Pe=0,si=null,wi=je.next();Xt!==null&&!wi.done;Ci++,wi=je.next()){Xt.index>Ci?(si=Xt,Xt=null):si=Xt.sibling;var Ga=Xe(Be,Xt,wi.value,lt);if(Ga===null){Xt===null&&(Xt=si);break}i&&Xt&&Ga.alternate===null&&s(Be,Xt),Pe=C(Ga,Pe,Ci),Ki===null?ei=Ga:Ki.sibling=Ga,Ki=Ga,Xt=si}if(wi.done)return u(Be,Xt),Ii&&ms(Be,Ci),ei;if(Xt===null){for(;!wi.done;Ci++,wi=je.next())wi=ft(Be,wi.value,lt),wi!==null&&(Pe=C(wi,Pe,Ci),Ki===null?ei=wi:Ki.sibling=wi,Ki=wi);return Ii&&ms(Be,Ci),ei}for(Xt=m(Xt);!wi.done;Ci++,wi=je.next())wi=Qe(Xt,Be,Ci,wi.value,lt),wi!==null&&(i&&wi.alternate!==null&&Xt.delete(wi.key===null?Ci:wi.key),Pe=C(wi,Pe,Ci),Ki===null?ei=wi:Ki.sibling=wi,Ki=wi);return i&&Xt.forEach(function(ro){return s(Be,ro)}),Ii&&ms(Be,Ci),ei}function wn(Be,Pe,je,lt){if(typeof je=="object"&&je!==null&&je.type===ie&&je.key===null&&(je=je.props.children),typeof je=="object"&&je!==null){switch(je.$$typeof){case Me:e:{for(var ei=je.key;Pe!==null;){if(Pe.key===ei){if(ei=je.type,ei===ie){if(Pe.tag===7){u(Be,Pe.sibling),lt=E(Pe,je.props.children),lt.return=Be,Be=lt;break e}}else if(Pe.elementType===ei||typeof ei=="object"&&ei!==null&&ei.$$typeof===be&&qs(ei)===Pe.type){u(Be,Pe.sibling),lt=E(Pe,je.props),al(lt,je),lt.return=Be,Be=lt;break e}u(Be,Pe);break}else s(Be,Pe);Pe=Pe.sibling}je.type===ie?(lt=_o(je.props.children,Be.mode,lt,je.key),lt.return=Be,Be=lt):(lt=wu(je.type,je.key,je.props,null,Be.mode,lt),al(lt,je),lt.return=Be,Be=lt)}return Z(Be);case Ae:e:{for(ei=je.key;Pe!==null;){if(Pe.key===ei)if(Pe.tag===4&&Pe.stateNode.containerInfo===je.containerInfo&&Pe.stateNode.implementation===je.implementation){u(Be,Pe.sibling),lt=E(Pe,je.children||[]),lt.return=Be,Be=lt;break e}else{u(Be,Pe);break}else s(Be,Pe);Pe=Pe.sibling}lt=Ol(je,Be.mode,lt),lt.return=Be,Be=lt}return Z(Be);case be:return je=qs(je),wn(Be,Pe,je,lt)}if(Si(je))return Vt(Be,Pe,je,lt);if(wt(je)){if(ei=wt(je),typeof ei!="function")throw Error(S(150));return je=ei.call(je),li(Be,Pe,je,lt)}if(typeof je.then=="function")return wn(Be,Pe,Mc(je),lt);if(je.$$typeof===Le)return wn(Be,Pe,Vs(Be,je),lt);sl(Be,je)}return typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint"?(je=""+je,Pe!==null&&Pe.tag===6?(u(Be,Pe.sibling),lt=E(Pe,je),lt.return=Be,Be=lt):(u(Be,Pe),lt=Su(je,Be.mode,lt),lt.return=Be,Be=lt),Z(Be)):u(Be,Pe)}return function(Be,Pe,je,lt){try{Nl=0;var ei=wn(Be,Pe,je,lt);return Qa=null,ei}catch(Xt){if(Xt===zt||Xt===jl)throw Xt;var Ki=va(29,Xt,null,Be.mode);return Ki.lanes=lt,Ki.return=Be,Ki}finally{}}}var So=Ac(!0),zh=Ac(!1),$s=!1;function Ch(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ja(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Li(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Hs(i,s,u){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,($i&2)!==0){var E=m.pending;return E===null?s.next=s:(s.next=E.next,E.next=s),m.pending=s,s=Ll(i),Th(i,null,u),s}return bc(i,m,s,u),Ll(i)}function Xs(i,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var m=s.lanes;m&=i.pendingLanes,u|=m,s.lanes=u,Zn(i,u)}}function zc(i,s){var u=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var E=null,C=null;if(u=u.firstBaseUpdate,u!==null){do{var Z={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};C===null?E=C=Z:C=C.next=Z,u=u.next}while(u!==null);C===null?E=C=s:C=C.next=s}else E=C=s;u={baseState:m.baseState,firstBaseUpdate:E,lastBaseUpdate:C,shared:m.shared,callbacks:m.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=s:i.next=s,u.lastBaseUpdate=s}var Du=!1;function ol(){if(Du){var i=rl;if(i!==null)throw i}}function ll(i,s,u,m){Du=!1;var E=i.updateQueue;$s=!1;var C=E.firstBaseUpdate,Z=E.lastBaseUpdate,te=E.shared.pending;if(te!==null){E.shared.pending=null;var Se=te,He=Se.next;Se.next=null,Z===null?C=He:Z.next=He,Z=Se;var st=i.alternate;st!==null&&(st=st.updateQueue,te=st.lastBaseUpdate,te!==Z&&(te===null?st.firstBaseUpdate=He:te.next=He,st.lastBaseUpdate=Se))}if(C!==null){var ft=E.baseState;Z=0,st=He=Se=null,te=C;do{var Xe=te.lane&-536870913,Qe=Xe!==te.lane;if(Qe?(ji&Xe)===Xe:(m&Xe)===Xe){Xe!==0&&Xe===nr&&(Du=!0),st!==null&&(st=st.next={lane:0,tag:te.tag,payload:te.payload,callback:null,next:null});e:{var Vt=i,li=te;Xe=s;var wn=u;switch(li.tag){case 1:if(Vt=li.payload,typeof Vt=="function"){ft=Vt.call(wn,ft,Xe);break e}ft=Vt;break e;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=li.payload,Xe=typeof Vt=="function"?Vt.call(wn,ft,Xe):Vt,Xe==null)break e;ft=ce({},ft,Xe);break e;case 2:$s=!0}}Xe=te.callback,Xe!==null&&(i.flags|=64,Qe&&(i.flags|=8192),Qe=E.callbacks,Qe===null?E.callbacks=[Xe]:Qe.push(Xe))}else Qe={lane:Xe,tag:te.tag,payload:te.payload,callback:te.callback,next:null},st===null?(He=st=Qe,Se=ft):st=st.next=Qe,Z|=Xe;if(te=te.next,te===null){if(te=E.shared.pending,te===null)break;Qe=te,te=Qe.next,Qe.next=null,E.lastBaseUpdate=Qe,E.shared.pending=null}}while(!0);st===null&&(Se=ft),E.baseState=Se,E.firstBaseUpdate=He,E.lastBaseUpdate=st,C===null&&(E.shared.lanes=0),$l|=Z,i.lanes=Z,i.memoizedState=ft}}function Ih(i,s){if(typeof i!="function")throw Error(S(191,i));i.call(s)}function Fa(i,s){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Ih(u[i],s)}var ja=fe(null),Ot=fe(0);function qt(i,s){i=is,Ze(Ot,i),Ze(ja,s),is=i|s.baseLanes}function cl(){Ze(Ot,is),Ze(ja,ja.current)}function ku(){is=Ot.current,Re(ja),Re(Ot)}var Br=fe(null),hn=null;function bs(i){var s=i.alternate;Ze($n,$n.current&1),Ze(Br,i),hn===null&&(s===null||ja.current!==null||s.memoizedState!==null)&&(hn=i)}function wa(i){Ze($n,$n.current),Ze(Br,i),hn===null&&(hn=i)}function Ph(i){i.tag===22?(Ze($n,$n.current),Ze(Br,i),hn===null&&(hn=i)):To()}function To(){Ze($n,$n.current),Ze(Br,Br.current)}function Sa(i){Re(Br),hn===i&&(hn=null),Re($n)}var $n=fe(0);function Ta(i){for(var s=i;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||wp(u)||Sp(u)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Vi=0,Nt=null,Qi=null,En=null,ul=!1,Eo=!1,ta=!1,hl=0,es=0,Ys=null,Cc=0;function Pn(){throw Error(S(321))}function Mo(i,s){if(s===null)return!1;for(var u=0;u<s.length&&u<i.length;u++)if(!Yr(i[u],s[u]))return!1;return!0}function Ws(i,s,u,m,E,C){return Vi=C,Nt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Ue.H=i===null||i.memoizedState===null?Dh:Bu,ta=!1,C=u(m,E),ta=!1,Eo&&(C=Ic(s,u,m,E)),Ru(i),C}function Ru(i){Ue.H=Gl;var s=Qi!==null&&Qi.next!==null;if(Vi=0,En=Qi=Nt=null,ul=!1,es=0,Ys=null,s)throw Error(S(300));i===null||sr||(i=i.dependencies,i!==null&&Sc(i)&&(sr=!0))}function Ic(i,s,u,m){Nt=i;var E=0;do{if(Eo&&(Ys=null),es=0,Eo=!1,25<=E)throw Error(S(301));if(E+=1,En=Qi=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Ue.H=Io,C=s(u,m)}while(Eo);return C}function dl(){var i=Ue.H,s=i.useState()[0];return s=typeof s.then=="function"?a(s):s,i=i.useState()[0],(Qi!==null?Qi.memoizedState:null)!==i&&(Nt.flags|=1024),s}function Pc(){var i=hl!==0;return hl=0,i}function Zl(i,s,u){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~u}function Vl(i){if(ul){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}ul=!1}Vi=0,En=Qi=Nt=null,Eo=!1,es=hl=0,Ys=null}function Lr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Nt.memoizedState=En=i:En=En.next=i,En}function p(){if(Qi===null){var i=Nt.alternate;i=i!==null?i.memoizedState:null}else i=Qi.next;var s=En===null?Nt.memoizedState:En.next;if(s!==null)En=s,Qi=i;else{if(i===null)throw Nt.alternate===null?Error(S(467)):Error(S(310));Qi=i,i={memoizedState:Qi.memoizedState,baseState:Qi.baseState,baseQueue:Qi.baseQueue,queue:Qi.queue,next:null},En===null?Nt.memoizedState=En=i:En=En.next=i}return En}function e(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function a(i){var s=es;return es+=1,Ys===null&&(Ys=[]),i=Ul(Ys,i,s),s=Nt,(En===null?s.memoizedState:En.next)===null&&(s=s.alternate,Ue.H=s===null||s.memoizedState===null?Dh:Bu),i}function l(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return a(i);if(i.$$typeof===Le)return fr(i)}throw Error(S(438,String(i)))}function f(i){var s=null,u=Nt.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var m=Nt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(E){return E.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=e(),Nt.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(i),m=0;m<i;m++)u[m]=tt;return s.index++,u}function g(i,s){return typeof s=="function"?s(i):s}function b(i){var s=p();return M(s,Qi,i)}function M(i,s,u){var m=i.queue;if(m===null)throw Error(S(311));m.lastRenderedReducer=u;var E=i.baseQueue,C=m.pending;if(C!==null){if(E!==null){var Z=E.next;E.next=C.next,C.next=Z}s.baseQueue=E=C,m.pending=null}if(C=i.baseState,E===null)i.memoizedState=C;else{s=E.next;var te=Z=null,Se=null,He=s,st=!1;do{var ft=He.lane&-536870913;if(ft!==He.lane?(ji&ft)===ft:(Vi&ft)===ft){var Xe=He.revertLane;if(Xe===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,gesture:null,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),ft===nr&&(st=!0);else if((Vi&Xe)===Xe){He=He.next,Xe===nr&&(st=!0);continue}else ft={lane:0,revertLane:He.revertLane,gesture:null,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null},Se===null?(te=Se=ft,Z=C):Se=Se.next=ft,Nt.lanes|=Xe,$l|=Xe;ft=He.action,ta&&u(C,ft),C=He.hasEagerState?He.eagerState:u(C,ft)}else Xe={lane:ft,revertLane:He.revertLane,gesture:He.gesture,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null},Se===null?(te=Se=Xe,Z=C):Se=Se.next=Xe,Nt.lanes|=ft,$l|=ft;He=He.next}while(He!==null&&He!==s);if(Se===null?Z=C:Se.next=te,!Yr(C,i.memoizedState)&&(sr=!0,st&&(u=rl,u!==null)))throw u;i.memoizedState=C,i.baseState=Z,i.baseQueue=Se,m.lastRenderedState=C}return E===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function A(i){var s=p(),u=s.queue;if(u===null)throw Error(S(311));u.lastRenderedReducer=i;var m=u.dispatch,E=u.pending,C=s.memoizedState;if(E!==null){u.pending=null;var Z=E=E.next;do C=i(C,Z.action),Z=Z.next;while(Z!==E);Yr(C,s.memoizedState)||(sr=!0),s.memoizedState=C,s.baseQueue===null&&(s.baseState=C),u.lastRenderedState=C}return[C,m]}function k(i,s,u){var m=Nt,E=p(),C=Ii;if(C){if(u===void 0)throw Error(S(407));u=u()}else u=s();var Z=!Yr((Qi||E).memoizedState,u);if(Z&&(E.memoizedState=u,sr=!0),E=E.queue,Zi(j.bind(null,m,E,i),[i]),E.getSnapshot!==s||Z||En!==null&&En.memoizedState.tag&1){if(m.flags|=2048,yt(9,{destroy:void 0},N.bind(null,m,E,u,s),null),tn===null)throw Error(S(349));C||(Vi&127)!==0||R(m,s,u)}return u}function R(i,s,u){i.flags|=16384,i={getSnapshot:s,value:u},s=Nt.updateQueue,s===null?(s=e(),Nt.updateQueue=s,s.stores=[i]):(u=s.stores,u===null?s.stores=[i]:u.push(i))}function N(i,s,u,m){s.value=u,s.getSnapshot=m,Y(s)&&Q(i)}function j(i,s,u){return u(function(){Y(s)&&Q(i)})}function Y(i){var s=i.getSnapshot;i=i.value;try{var u=s();return!Yr(i,u)}catch{return!0}}function Q(i){var s=Oa(i,2);s!==null&&Aa(s,i,2)}function re(i){var s=Lr();if(typeof i=="function"){var u=i;if(i=u(),ta){pe(!0);try{u()}finally{pe(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:i},s}function se(i,s,u,m){return i.baseState=u,M(i,Qi,typeof m=="function"?m:g)}function le(i,s,u,m,E){if(en(i))throw Error(S(485));if(i=s.action,i!==null){var C={payload:E,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){C.listeners.push(Z)}};Ue.T!==null?u(!0):C.isTransition=!1,m(C),u=s.pending,u===null?(C.next=s.pending=C,de(s,C)):(C.next=u.next,s.pending=u.next=C)}}function de(i,s){var u=s.action,m=s.payload,E=i.state;if(s.isTransition){var C=Ue.T,Z={};Ue.T=Z;try{var te=u(E,m),Se=Ue.S;Se!==null&&Se(Z,te),ye(i,s,te)}catch(He){ve(i,s,He)}finally{C!==null&&Z.types!==null&&(C.types=Z.types),Ue.T=C}}else try{C=u(E,m),ye(i,s,C)}catch(He){ve(i,s,He)}}function ye(i,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(m){he(i,s,m)},function(m){return ve(i,s,m)}):he(i,s,u)}function he(i,s,u){s.status="fulfilled",s.value=u,Ee(s),i.state=u,s=i.pending,s!==null&&(u=s.next,u===s?i.pending=null:(u=u.next,s.next=u,de(i,u)))}function ve(i,s,u){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=u,Ee(s),s=s.next;while(s!==m)}i.action=null}function Ee(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function me(i,s){return s}function ze(i,s){if(Ii){var u=tn.formState;if(u!==null){e:{var m=Nt;if(Ii){if(an){t:{for(var E=an,C=Jr;E.nodeType!==8;){if(!C){E=null;break t}if(E=sa(E.nextSibling),E===null){E=null;break t}}C=E.data,E=C==="F!"||C==="F"?E:null}if(E){an=sa(E.nextSibling),m=E.data==="F!";break e}}Nr(m)}m=!1}m&&(s=u[0])}}return u=Lr(),u.memoizedState=u.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:me,lastRenderedState:s},u.queue=m,u=Un.bind(null,Nt,m),m.dispatch=u,m=re(!1),C=ar.bind(null,Nt,!1,m.queue),m=Lr(),E={state:s,dispatch:null,action:i,pending:null},m.queue=E,u=le.bind(null,Nt,E,C,u),E.dispatch=u,m.memoizedState=i,[s,u,!1]}function Ge(i){var s=p();return Oe(s,Qi,i)}function Oe(i,s,u){if(s=M(i,s,me)[0],i=b(g)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=a(s)}catch(Z){throw Z===zt?jl:Z}else m=s;s=p();var E=s.queue,C=E.dispatch;return u!==s.memoizedState&&(Nt.flags|=2048,yt(9,{destroy:void 0},Ne.bind(null,E,u),null)),[m,C,i]}function Ne(i,s){i.action=s}function $e(i){var s=p(),u=Qi;if(u!==null)return Oe(s,u,i);p(),s=s.memoizedState,u=p();var m=u.queue.dispatch;return u.memoizedState=i,[s,m,!1]}function yt(i,s,u,m){return i={tag:i,create:u,deps:m,inst:s,next:null},s=Nt.updateQueue,s===null&&(s=e(),Nt.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=i.next=i:(m=u.next,u.next=i,i.next=m,s.lastEffect=i),i}function vt(){return p().memoizedState}function nt(i,s,u,m){var E=Lr();Nt.flags|=i,E.memoizedState=yt(1|s,{destroy:void 0},u,m===void 0?null:m)}function kt(i,s,u,m){var E=p();m=m===void 0?null:m;var C=E.memoizedState.inst;Qi!==null&&m!==null&&Mo(m,Qi.memoizedState.deps)?E.memoizedState=yt(s,C,u,m):(Nt.flags|=i,E.memoizedState=yt(1|s,C,u,m))}function oi(i,s){nt(8390656,8,i,s)}function Zi(i,s){kt(2048,8,i,s)}function mi(i){Nt.flags|=4;var s=Nt.updateQueue;if(s===null)s=e(),Nt.updateQueue=s,s.events=[i];else{var u=s.events;u===null?s.events=[i]:u.push(i)}}function Ji(i){var s=p().memoizedState;return mi({ref:s,nextImpl:i}),function(){if(($i&2)!==0)throw Error(S(440));return s.impl.apply(void 0,arguments)}}function Mn(i,s){return kt(4,2,i,s)}function sn(i,s){return kt(4,4,i,s)}function Hn(i,s){if(typeof s=="function"){i=i();var u=s(i);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function vn(i,s,u){u=u!=null?u.concat([i]):null,kt(4,4,Hn.bind(null,s,i),u)}function rr(){}function bn(i,s){var u=p();s=s===void 0?null:s;var m=u.memoizedState;return s!==null&&Mo(s,m[1])?m[0]:(u.memoizedState=[i,s],i)}function jn(i,s){var u=p();s=s===void 0?null:s;var m=u.memoizedState;if(s!==null&&Mo(s,m[1]))return m[0];if(m=i(),ta){pe(!0);try{i()}finally{pe(!1)}}return u.memoizedState=[m,s],m}function Or(i,s,u){return u===void 0||(Vi&1073741824)!==0&&(ji&261930)===0?i.memoizedState=s:(i.memoizedState=u,i=np(),Nt.lanes|=i,$l|=i,u)}function Ao(i,s,u,m){return Yr(u,s)?u:ja.current!==null?(i=Or(i,u,m),Yr(i,s)||(sr=!0),i):(Vi&42)===0||(Vi&1073741824)!==0&&(ji&261930)===0?(sr=!0,i.memoizedState=u):(i=np(),Nt.lanes|=i,$l|=i,s)}function xs(i,s,u,m,E){var C=et.p;et.p=C!==0&&8>C?C:8;var Z=Ue.T,te={};Ue.T=te,ar(i,!1,s,u);try{var Se=E(),He=Ue.S;if(He!==null&&He(te,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var st=Tc(Se,m);xn(i,s,st,Ma(i))}else xn(i,s,m,Ma(i))}catch(ft){xn(i,s,{then:function(){},status:"rejected",reason:ft},Ma())}finally{et.p=C,Z!==null&&te.types!==null&&(Z.types=te.types),Ue.T=Z}}function ws(){}function Ks(i,s,u,m){if(i.tag!==5)throw Error(S(476));var E=fl(i).queue;xs(i,E,s,it,u===null?ws:function(){return zo(i),u(m)})}function fl(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:it,baseState:it,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:it},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:u},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function zo(i){var s=fl(i);s.next===null&&(s=i.alternate.memoizedState),xn(i,s.next.queue,{},Ma())}function Vr(){return fr(xe)}function Gr(){return p().memoizedState}function Ss(){return p().memoizedState}function Co(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var u=Ma();i=Li(u);var m=Hs(s,i,u);m!==null&&(Aa(m,s,u),Xs(m,s,u)),s={cache:Au()},i.payload=s;return}s=s.return}}function Dc(i,s,u){var m=Ma();u={lane:m,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},en(i)?Ua(s,u):(u=go(i,s,u,m),u!==null&&(Aa(u,i,m),Qs(u,s,m)))}function Un(i,s,u){var m=Ma();xn(i,s,u,m)}function xn(i,s,u,m){var E={lane:m,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(en(i))Ua(s,E);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=s.lastRenderedReducer,C!==null))try{var Z=s.lastRenderedState,te=C(Z,u);if(E.hasEagerState=!0,E.eagerState=te,Yr(te,Z))return bc(i,s,E,0),tn===null&&Ko(),!1}catch{}finally{}if(u=go(i,s,E,m),u!==null)return Aa(u,i,m),Qs(u,s,m),!0}return!1}function ar(i,s,u,m){if(m={lane:2,revertLane:Xh(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},en(i)){if(s)throw Error(S(479))}else s=go(i,u,m,2),s!==null&&Aa(s,i,2)}function en(i){var s=i.alternate;return i===Nt||s!==null&&s===Nt}function Ua(i,s){Eo=ul=!0;var u=i.pending;u===null?s.next=s:(s.next=u.next,u.next=s),i.pending=s}function Qs(i,s,u){if((u&4194048)!==0){var m=s.lanes;m&=i.pendingLanes,u|=m,s.lanes=u,Zn(i,u)}}var Gl={readContext:fr,use:l,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useLayoutEffect:Pn,useInsertionEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useSyncExternalStore:Pn,useId:Pn,useHostTransitionStatus:Pn,useFormState:Pn,useActionState:Pn,useOptimistic:Pn,useMemoCache:Pn,useCacheRefresh:Pn};Gl.useEffectEvent=Pn;var Dh={readContext:fr,use:l,useCallback:function(i,s){return Lr().memoizedState=[i,s===void 0?null:s],i},useContext:fr,useEffect:oi,useImperativeHandle:function(i,s,u){u=u!=null?u.concat([i]):null,nt(4194308,4,Hn.bind(null,s,i),u)},useLayoutEffect:function(i,s){return nt(4194308,4,i,s)},useInsertionEffect:function(i,s){nt(4,2,i,s)},useMemo:function(i,s){var u=Lr();s=s===void 0?null:s;var m=i();if(ta){pe(!0);try{i()}finally{pe(!1)}}return u.memoizedState=[m,s],m},useReducer:function(i,s,u){var m=Lr();if(u!==void 0){var E=u(s);if(ta){pe(!0);try{u(s)}finally{pe(!1)}}}else E=s;return m.memoizedState=m.baseState=E,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:E},m.queue=i,i=i.dispatch=Dc.bind(null,Nt,i),[m.memoizedState,i]},useRef:function(i){var s=Lr();return i={current:i},s.memoizedState=i},useState:function(i){i=re(i);var s=i.queue,u=Un.bind(null,Nt,s);return s.dispatch=u,[i.memoizedState,u]},useDebugValue:rr,useDeferredValue:function(i,s){var u=Lr();return Or(u,i,s)},useTransition:function(){var i=re(!1);return i=xs.bind(null,Nt,i.queue,!0,!1),Lr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,u){var m=Nt,E=Lr();if(Ii){if(u===void 0)throw Error(S(407));u=u()}else{if(u=s(),tn===null)throw Error(S(349));(ji&127)!==0||R(m,s,u)}E.memoizedState=u;var C={value:u,getSnapshot:s};return E.queue=C,oi(j.bind(null,m,C,i),[i]),m.flags|=2048,yt(9,{destroy:void 0},N.bind(null,m,C,u,s),null),u},useId:function(){var i=Lr(),s=tn.identifierPrefix;if(Ii){var u=ua,m=ps;u=(m&~(1<<32-we(m)-1)).toString(32)+u,s="_"+s+"R_"+u,u=hl++,0<u&&(s+="H"+u.toString(32)),s+="_"}else u=Cc++,s="_"+s+"r_"+u.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:Vr,useFormState:ze,useActionState:ze,useOptimistic:function(i){var s=Lr();s.memoizedState=s.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=ar.bind(null,Nt,!0,u),u.dispatch=s,[i,s]},useMemoCache:f,useCacheRefresh:function(){return Lr().memoizedState=Co.bind(null,Nt)},useEffectEvent:function(i){var s=Lr(),u={impl:i};return s.memoizedState=u,function(){if(($i&2)!==0)throw Error(S(440));return u.impl.apply(void 0,arguments)}}},Bu={readContext:fr,use:l,useCallback:bn,useContext:fr,useEffect:Zi,useImperativeHandle:vn,useInsertionEffect:Mn,useLayoutEffect:sn,useMemo:jn,useReducer:b,useRef:vt,useState:function(){return b(g)},useDebugValue:rr,useDeferredValue:function(i,s){var u=p();return Ao(u,Qi.memoizedState,i,s)},useTransition:function(){var i=b(g)[0],s=p().memoizedState;return[typeof i=="boolean"?i:a(i),s]},useSyncExternalStore:k,useId:Gr,useHostTransitionStatus:Vr,useFormState:Ge,useActionState:Ge,useOptimistic:function(i,s){var u=p();return se(u,Qi,i,s)},useMemoCache:f,useCacheRefresh:Ss};Bu.useEffectEvent=Ji;var Io={readContext:fr,use:l,useCallback:bn,useContext:fr,useEffect:Zi,useImperativeHandle:vn,useInsertionEffect:Mn,useLayoutEffect:sn,useMemo:jn,useReducer:A,useRef:vt,useState:function(){return A(g)},useDebugValue:rr,useDeferredValue:function(i,s){var u=p();return Qi===null?Or(u,i,s):Ao(u,Qi.memoizedState,i,s)},useTransition:function(){var i=A(g)[0],s=p().memoizedState;return[typeof i=="boolean"?i:a(i),s]},useSyncExternalStore:k,useId:Gr,useHostTransitionStatus:Vr,useFormState:$e,useActionState:$e,useOptimistic:function(i,s){var u=p();return Qi!==null?se(u,Qi,i,s):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:f,useCacheRefresh:Ss};Io.useEffectEvent=Ji;function Js(i,s,u,m){s=i.memoizedState,u=u(m,s),u=u==null?s:ce({},s,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var kc={enqueueSetState:function(i,s,u){i=i._reactInternals;var m=Ma(),E=Li(m);E.payload=s,u!=null&&(E.callback=u),s=Hs(i,E,m),s!==null&&(Aa(s,i,m),Xs(s,i,m))},enqueueReplaceState:function(i,s,u){i=i._reactInternals;var m=Ma(),E=Li(m);E.tag=1,E.payload=s,u!=null&&(E.callback=u),s=Hs(i,E,m),s!==null&&(Aa(s,i,m),Xs(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var u=Ma(),m=Li(u);m.tag=2,s!=null&&(m.callback=s),s=Hs(i,m,u),s!==null&&(Aa(s,i,u),Xs(s,i,u))}};function Rc(i,s,u,m,E,C,Z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,C,Z):s.prototype&&s.prototype.isPureReactComponent?!Os(u,m)||!Os(E,C):!0}function Lu(i,s,u,m){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,m),s.state!==i&&kc.enqueueReplaceState(s,s.state,null)}function ia(i,s){var u=s;if("ref"in s){u={};for(var m in s)m!=="ref"&&(u[m]=s[m])}if(i=i.defaultProps){u===s&&(u=ce({},u));for(var E in i)u[E]===void 0&&(u[E]=i[E])}return u}function eo(i){fs(i)}function Bc(i){console.error(i)}function Xp(i){fs(i)}function Ou(i,s){try{var u=i.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function Cf(i,s,u){try{var m=i.onCaughtError;m(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function Fu(i,s,u){return u=Li(u),u.tag=3,u.payload={element:null},u.callback=function(){Ou(i,s)},u}function If(i){return i=Li(i),i.tag=3,i}function Yp(i,s,u,m){var E=u.type.getDerivedStateFromError;if(typeof E=="function"){var C=m.value;i.payload=function(){return E(C)},i.callback=function(){Cf(s,u,m)}}var Z=u.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(i.callback=function(){Cf(s,u,m),typeof E!="function"&&(Hl===null?Hl=new Set([this]):Hl.add(this));var te=m.stack;this.componentDidCatch(m.value,{componentStack:te!==null?te:""})})}function Pf(i,s,u,m,E){if(u.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=u.alternate,s!==null&&xa(s,u,E,!0),u=Br.current,u!==null){switch(u.tag){case 31:case 13:return hn===null?$d():u.alternate===null&&Yn===0&&(Yn=3),u.flags&=-257,u.flags|=65536,u.lanes=E,m===Ec?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([m]):s.add(m),qh(i,m,E)),!1;case 22:return u.flags|=65536,m===Ec?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([m]):u.add(m)),qh(i,m,E)),!1}throw Error(S(435,u.tag))}return qh(i,m,E),$d(),!1}if(Ii)return s=Br.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=E,m!==yn&&(i=Error(S(422),{cause:m}),il(Ur(i,u)))):(m!==yn&&(s=Error(S(423),{cause:m}),il(Ur(s,u))),i=i.current.alternate,i.flags|=65536,E&=-E,i.lanes|=E,m=Ur(m,u),E=Fu(i.stateNode,m,E),zc(i,E),Yn!==4&&(Yn=2)),!1;var C=Error(S(520),{cause:m});if(C=Ur(C,u),Hu===null?Hu=[C]:Hu.push(C),Yn!==4&&(Yn=2),s===null)return!0;m=Ur(m,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,i=E&-E,u.lanes|=i,i=Fu(u.stateNode,m,i),zc(u,i),!1;case 1:if(s=u.type,C=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Hl===null||!Hl.has(C))))return u.flags|=65536,E&=-E,u.lanes|=E,E=If(E),Yp(E,i,u,m),zc(u,E),!1}u=u.return}while(u!==null);return!1}var Df=Error(S(461)),sr=!1;function qr(i,s,u,m){s.child=i===null?zh(s,null,u,m):So(s,i.child,u,m)}function kf(i,s,u,m,E){u=u.render;var C=s.ref;if("ref"in m){var Z={};for(var te in m)te!=="ref"&&(Z[te]=m[te])}else Z=m;return Zs(s),m=Ws(i,s,u,Z,C,E),te=Pc(),i!==null&&!sr?(Zl(i,s,E),Po(i,s,E)):(Ii&&te&&el(s),s.flags|=1,qr(i,s,m,E),s.child)}function Lc(i,s,u,m,E){if(i===null){var C=u.type;return typeof C=="function"&&!xu(C)&&C.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=C,Wp(i,s,C,m,E)):(i=wu(u.type,null,m,s,s.mode,E),i.ref=s.ref,i.return=s,s.child=i)}if(C=i.child,!Rh(i,E)){var Z=C.memoizedProps;if(u=u.compare,u=u!==null?u:Os,u(Z,m)&&i.ref===s.ref)return Po(i,s,E)}return s.flags|=1,i=Kr(C,m),i.ref=s.ref,i.return=s,s.child=i}function Wp(i,s,u,m,E){if(i!==null){var C=i.memoizedProps;if(Os(C,m)&&i.ref===s.ref)if(sr=!1,s.pendingProps=m=C,Rh(i,E))(i.flags&131072)!==0&&(sr=!0);else return s.lanes=i.lanes,Po(i,s,E)}return Dd(i,s,u,m,E)}function Oc(i,s,u,m){var E=m.children,C=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(C=C!==null?C.baseLanes|u:u,i!==null){for(m=s.child=i.child,E=0;m!==null;)E=E|m.lanes|m.childLanes,m=m.sibling;m=E&~C}else m=0,s.child=null;return kh(i,s,C,u,m)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&_s(s,C!==null?C.cachePool:null),C!==null?qt(s,C):cl(),Ph(s);else return m=s.lanes=536870912,kh(i,s,C!==null?C.baseLanes|u:u,u,m)}else C!==null?(_s(s,C.cachePool),qt(s,C),To(),s.memoizedState=null):(i!==null&&_s(s,null),cl(),To());return qr(i,s,E,u),s.child}function ql(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function kh(i,s,u,m,E){var C=zu();return C=C===null?null:{parent:Ln._currentValue,pool:C},s.memoizedState={baseLanes:u,cachePool:C},i!==null&&_s(s,null),cl(),Ph(s),i!==null&&xa(i,s,m,!0),s.childLanes=E,null}function Id(i,s){return s=ju({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function Kp(i,s,u){return So(s,i.child,null,u),i=Id(s,s.pendingProps),i.flags|=2,Sa(s),s.memoizedState=null,i}function lg(i,s,u){var m=s.pendingProps,E=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(Ii){if(m.mode==="hidden")return i=Id(s,m),s.lanes=536870912,ql(null,i);if(wa(s),(i=an)?(i=ed(i,Jr),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Wa!==null?{id:ps,overflow:ua}:null,retryLane:536870912,hydrationErrors:null},u=Tu(i),u.return=s,s.child=u,xr=s,an=null)):i=null,i===null)throw Nr(s);return s.lanes=536870912,null}return Id(s,m)}var C=i.memoizedState;if(C!==null){var Z=C.dehydrated;if(wa(s),E)if(s.flags&256)s.flags&=-257,s=Kp(i,s,u);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(S(558));else if(sr||xa(i,s,u,!1),E=(u&i.childLanes)!==0,sr||E){if(m=tn,m!==null&&(Z=_n(m,u),Z!==0&&Z!==C.retryLane))throw C.retryLane=Z,Oa(i,Z),Aa(m,i,Z),Df;$d(),s=Kp(i,s,u)}else i=C.treeContext,an=sa(Z.nextSibling),xr=s,Ii=!0,js=null,Jr=!1,i!==null&&Eh(s,i),s=Id(s,m),s.flags|=4096;return s}return i=Kr(i.child,{mode:m.mode,children:m.children}),i.ref=s.ref,s.child=i,i.return=s,i}function Pd(i,s){var u=s.ref;if(u===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(S(284));(i===null||i.ref!==u)&&(s.flags|=4194816)}}function Dd(i,s,u,m,E){return Zs(s),u=Ws(i,s,u,m,void 0,E),m=Pc(),i!==null&&!sr?(Zl(i,s,E),Po(i,s,E)):(Ii&&m&&el(s),s.flags|=1,qr(i,s,u,E),s.child)}function kd(i,s,u,m,E,C){return Zs(s),s.updateQueue=null,u=Ic(s,m,u,E),Ru(i),m=Pc(),i!==null&&!sr?(Zl(i,s,C),Po(i,s,C)):(Ii&&m&&el(s),s.flags|=1,qr(i,s,u,C),s.child)}function Rf(i,s,u,m,E){if(Zs(s),s.stateNode===null){var C=pi,Z=u.contextType;typeof Z=="object"&&Z!==null&&(C=fr(Z)),C=new u(m,C),s.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=kc,s.stateNode=C,C._reactInternals=s,C=s.stateNode,C.props=m,C.state=s.memoizedState,C.refs={},Ch(s),Z=u.contextType,C.context=typeof Z=="object"&&Z!==null?fr(Z):pi,C.state=s.memoizedState,Z=u.getDerivedStateFromProps,typeof Z=="function"&&(Js(s,u,Z,m),C.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(Z=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),Z!==C.state&&kc.enqueueReplaceState(C,C.state,null),ll(s,m,C,E),ol(),C.state=s.memoizedState),typeof C.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(i===null){C=s.stateNode;var te=s.memoizedProps,Se=ia(u,te);C.props=Se;var He=C.context,st=u.contextType;Z=pi,typeof st=="object"&&st!==null&&(Z=fr(st));var ft=u.getDerivedStateFromProps;st=typeof ft=="function"||typeof C.getSnapshotBeforeUpdate=="function",te=s.pendingProps!==te,st||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(te||He!==Z)&&Lu(s,C,m,Z),$s=!1;var Xe=s.memoizedState;C.state=Xe,ll(s,m,C,E),ol(),He=s.memoizedState,te||Xe!==He||$s?(typeof ft=="function"&&(Js(s,u,ft,m),He=s.memoizedState),(Se=$s||Rc(s,u,Se,m,Xe,He,Z))?(st||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(s.flags|=4194308)):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=He),C.props=m,C.state=He,C.context=Z,m=Se):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{C=s.stateNode,Ja(i,s),Z=s.memoizedProps,st=ia(u,Z),C.props=st,ft=s.pendingProps,Xe=C.context,He=u.contextType,Se=pi,typeof He=="object"&&He!==null&&(Se=fr(He)),te=u.getDerivedStateFromProps,(He=typeof te=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(Z!==ft||Xe!==Se)&&Lu(s,C,m,Se),$s=!1,Xe=s.memoizedState,C.state=Xe,ll(s,m,C,E),ol();var Qe=s.memoizedState;Z!==ft||Xe!==Qe||$s||i!==null&&i.dependencies!==null&&Sc(i.dependencies)?(typeof te=="function"&&(Js(s,u,te,m),Qe=s.memoizedState),(st=$s||Rc(s,u,st,m,Xe,Qe,Se)||i!==null&&i.dependencies!==null&&Sc(i.dependencies))?(He||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(m,Qe,Se),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(m,Qe,Se)),typeof C.componentDidUpdate=="function"&&(s.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof C.componentDidUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=Qe),C.props=m,C.state=Qe,C.context=Se,m=st):(typeof C.componentDidUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(s.flags|=1024),m=!1)}return C=m,Pd(i,s),m=(s.flags&128)!==0,C||m?(C=s.stateNode,u=m&&typeof u.getDerivedStateFromError!="function"?null:C.render(),s.flags|=1,i!==null&&m?(s.child=So(s,i.child,null,E),s.child=So(s,null,u,E)):qr(i,s,u,E),s.memoizedState=C.state,i=s.child):i=Po(i,s,E),i}function Bf(i,s,u,m){return xo(),s.flags|=256,qr(i,s,u,m),s.child}var Lf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Of(i){return{baseLanes:i,cachePool:ys()}}function Rd(i,s,u){return i=i!==null?i.childLanes&~u:0,s&&(i|=ns),i}function Ff(i,s,u){var m=s.pendingProps,E=!1,C=(s.flags&128)!==0,Z;if((Z=C)||(Z=i!==null&&i.memoizedState===null?!1:($n.current&2)!==0),Z&&(E=!0,s.flags&=-129),Z=(s.flags&32)!==0,s.flags&=-33,i===null){if(Ii){if(E?bs(s):To(),(i=an)?(i=ed(i,Jr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:Wa!==null?{id:ps,overflow:ua}:null,retryLane:536870912,hydrationErrors:null},u=Tu(i),u.return=s,s.child=u,xr=s,an=null)):i=null,i===null)throw Nr(s);return Sp(i)?s.lanes=32:s.lanes=536870912,null}var te=m.children;return m=m.fallback,E?(To(),E=s.mode,te=ju({mode:"hidden",children:te},E),m=_o(m,E,u,null),te.return=s,m.return=s,te.sibling=m,s.child=te,m=s.child,m.memoizedState=Of(u),m.childLanes=Rd(i,Z,u),s.memoizedState=Lf,ql(null,m)):(bs(s),jf(s,te))}var Se=i.memoizedState;if(Se!==null&&(te=Se.dehydrated,te!==null)){if(C)s.flags&256?(bs(s),s.flags&=-257,s=Bd(i,s,u)):s.memoizedState!==null?(To(),s.child=i.child,s.flags|=128,s=null):(To(),te=m.fallback,E=s.mode,m=ju({mode:"visible",children:m.children},E),te=_o(te,E,u,null),te.flags|=2,m.return=s,te.return=s,m.sibling=te,s.child=m,So(s,i.child,null,u),m=s.child,m.memoizedState=Of(u),m.childLanes=Rd(i,Z,u),s.memoizedState=Lf,s=ql(null,m));else if(bs(s),Sp(te)){if(Z=te.nextSibling&&te.nextSibling.dataset,Z)var He=Z.dgst;Z=He,m=Error(S(419)),m.stack="",m.digest=Z,il({value:m,source:null,stack:null}),s=Bd(i,s,u)}else if(sr||xa(i,s,u,!1),Z=(u&i.childLanes)!==0,sr||Z){if(Z=tn,Z!==null&&(m=_n(Z,u),m!==0&&m!==Se.retryLane))throw Se.retryLane=m,Oa(i,m),Aa(Z,i,m),Df;wp(te)||$d(),s=Bd(i,s,u)}else wp(te)?(s.flags|=192,s.child=i.child,s=null):(i=Se.treeContext,an=sa(te.nextSibling),xr=s,Ii=!0,js=null,Jr=!1,i!==null&&Eh(s,i),s=jf(s,m.children),s.flags|=4096);return s}return E?(To(),te=m.fallback,E=s.mode,Se=i.child,He=Se.sibling,m=Kr(Se,{mode:"hidden",children:m.children}),m.subtreeFlags=Se.subtreeFlags&65011712,He!==null?te=Kr(He,te):(te=_o(te,E,u,null),te.flags|=2),te.return=s,m.return=s,m.sibling=te,s.child=m,ql(null,m),m=s.child,te=i.child.memoizedState,te===null?te=Of(u):(E=te.cachePool,E!==null?(Se=Ln._currentValue,E=E.parent!==Se?{parent:Se,pool:Se}:E):E=ys(),te={baseLanes:te.baseLanes|u,cachePool:E}),m.memoizedState=te,m.childLanes=Rd(i,Z,u),s.memoizedState=Lf,ql(i.child,m)):(bs(s),u=i.child,i=u.sibling,u=Kr(u,{mode:"visible",children:m.children}),u.return=s,u.sibling=null,i!==null&&(Z=s.deletions,Z===null?(s.deletions=[i],s.flags|=16):Z.push(i)),s.child=u,s.memoizedState=null,u)}function jf(i,s){return s=ju({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function ju(i,s){return i=va(22,i,null,s),i.lanes=0,i}function Bd(i,s,u){return So(s,i.child,null,u),i=jf(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Ld(i,s,u){i.lanes|=s;var m=i.alternate;m!==null&&(m.lanes|=s),Mu(i.return,s,u)}function Fc(i,s,u,m,E,C){var Z=i.memoizedState;Z===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:E,treeForkCount:C}:(Z.isBackwards=s,Z.rendering=null,Z.renderingStartTime=0,Z.last=m,Z.tail=u,Z.tailMode=E,Z.treeForkCount=C)}function ha(i,s,u){var m=s.pendingProps,E=m.revealOrder,C=m.tail;m=m.children;var Z=$n.current,te=(Z&2)!==0;if(te?(Z=Z&1|2,s.flags|=128):Z&=1,Ze($n,Z),qr(i,s,m,u),m=Ii?bo:0,!te&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ld(i,u,s);else if(i.tag===19)Ld(i,u,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(E){case"forwards":for(u=s.child,E=null;u!==null;)i=u.alternate,i!==null&&Ta(i)===null&&(E=u),u=u.sibling;u=E,u===null?(E=s.child,s.child=null):(E=u.sibling,u.sibling=null),Fc(s,!1,E,u,C,m);break;case"backwards":case"unstable_legacy-backwards":for(u=null,E=s.child,s.child=null;E!==null;){if(i=E.alternate,i!==null&&Ta(i)===null){s.child=E;break}i=E.sibling,E.sibling=u,u=E,E=i}Fc(s,!0,u,null,C,m);break;case"together":Fc(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function Po(i,s,u){if(i!==null&&(s.dependencies=i.dependencies),$l|=s.lanes,(u&s.childLanes)===0)if(i!==null){if(xa(i,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(S(153));if(s.child!==null){for(i=s.child,u=Kr(i,i.pendingProps),s.child=u,u.return=s;i.sibling!==null;)i=i.sibling,u=u.sibling=Kr(i,i.pendingProps),u.return=s;u.sibling=null}return s.child}function Rh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Sc(i)))}function cg(i,s,u){switch(s.tag){case 3:Dt(s,s.stateNode.containerInfo),gs(s,Ln,i.memoizedState.cache),xo();break;case 27:case 5:bi(s);break;case 4:Dt(s,s.stateNode.containerInfo);break;case 10:gs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,wa(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(bs(s),s.flags|=128,null):(u&s.child.childLanes)!==0?Ff(i,s,u):(bs(s),i=Po(i,s,u),i!==null?i.sibling:null);bs(s);break;case 19:var E=(i.flags&128)!==0;if(m=(u&s.childLanes)!==0,m||(xa(i,s,u,!1),m=(u&s.childLanes)!==0),E){if(m)return ha(i,s,u);s.flags|=128}if(E=s.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Ze($n,$n.current),m)break;return null;case 22:return s.lanes=0,Oc(i,s,u,s.pendingProps);case 24:gs(s,Ln,i.memoizedState.cache)}return Po(i,s,u)}function Uf(i,s,u){if(i!==null)if(i.memoizedProps!==s.pendingProps)sr=!0;else{if(!Rh(i,u)&&(s.flags&128)===0)return sr=!1,cg(i,s,u);sr=(i.flags&131072)!==0}else sr=!1,Ii&&(s.flags&1048576)!==0&&Eu(s,bo,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(i=qs(s.elementType),s.type=i,typeof i=="function")xu(i)?(m=ia(i,m),s.tag=1,s=Rf(null,s,i,m,u)):(s.tag=0,s=Dd(null,s,i,m,u));else{if(i!=null){var E=i.$$typeof;if(E===Ke){s.tag=11,s=kf(null,s,i,m,u);break e}else if(E===St){s.tag=14,s=Lc(null,s,i,m,u);break e}}throw s=vi(i)||i,Error(S(306,s,""))}}return s;case 0:return Dd(i,s,s.type,s.pendingProps,u);case 1:return m=s.type,E=ia(m,s.pendingProps),Rf(i,s,m,E,u);case 3:e:{if(Dt(s,s.stateNode.containerInfo),i===null)throw Error(S(387));m=s.pendingProps;var C=s.memoizedState;E=C.element,Ja(i,s),ll(s,m,null,u);var Z=s.memoizedState;if(m=Z.cache,gs(s,Ln,m),m!==C.cache&&wc(s,[Ln],u,!0),ol(),m=Z.element,C.isDehydrated)if(C={element:m,isDehydrated:!1,cache:Z.cache},s.updateQueue.baseState=C,s.memoizedState=C,s.flags&256){s=Bf(i,s,m,u);break e}else if(m!==E){E=Ur(Error(S(424)),s),il(E),s=Bf(i,s,m,u);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(an=sa(i.firstChild),xr=s,Ii=!0,js=null,Jr=!0,u=zh(s,null,m,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(xo(),m===E){s=Po(i,s,u);break e}qr(i,s,m,u)}s=s.child}return s;case 26:return Pd(i,s),i===null?(u=hf(s.type,null,s.pendingProps,null))?s.memoizedState=u:Ii||(u=s.type,i=s.pendingProps,m=Qh(Pt.current).createElement(u),m[Ni]=s,m[gt]=i,fn(m,u,i),Cn(m),s.stateNode=m):s.memoizedState=hf(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return bi(s),i===null&&Ii&&(m=s.stateNode=Ep(s.type,s.pendingProps,Pt.current),xr=s,Jr=!0,E=an,vl(s.type)?(Tr=E,an=sa(m.firstChild)):an=E),qr(i,s,s.pendingProps.children,u),Pd(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Ii&&((E=m=an)&&(m=of(m,s.type,s.pendingProps,Jr),m!==null?(s.stateNode=m,xr=s,an=sa(m.firstChild),Jr=!1,E=!0):E=!1),E||Nr(s)),bi(s),E=s.type,C=s.pendingProps,Z=i!==null?i.memoizedProps:null,m=C.children,af(E,C)?m=null:Z!==null&&af(E,Z)&&(s.flags|=32),s.memoizedState!==null&&(E=Ws(i,s,dl,null,null,u),xe._currentValue=E),Pd(i,s),qr(i,s,m,u),s.child;case 6:return i===null&&Ii&&((i=u=an)&&(u=lf(u,s.pendingProps,Jr),u!==null?(s.stateNode=u,xr=s,an=null,i=!0):i=!1),i||Nr(s)),null;case 13:return Ff(i,s,u);case 4:return Dt(s,s.stateNode.containerInfo),m=s.pendingProps,i===null?s.child=So(s,null,m,u):qr(i,s,m,u),s.child;case 11:return kf(i,s,s.type,s.pendingProps,u);case 7:return qr(i,s,s.pendingProps,u),s.child;case 8:return qr(i,s,s.pendingProps.children,u),s.child;case 12:return qr(i,s,s.pendingProps.children,u),s.child;case 10:return m=s.pendingProps,gs(s,s.type,m.value),qr(i,s,m.children,u),s.child;case 9:return E=s.type._context,m=s.pendingProps.children,Zs(s),E=fr(E),m=m(E),s.flags|=1,qr(i,s,m,u),s.child;case 14:return Lc(i,s,s.type,s.pendingProps,u);case 15:return Wp(i,s,s.type,s.pendingProps,u);case 19:return ha(i,s,u);case 31:return lg(i,s,u);case 22:return Oc(i,s,u,s.pendingProps);case 24:return Zs(s),m=fr(Ln),i===null?(E=zu(),E===null&&(E=tn,C=Au(),E.pooledCache=C,C.refCount++,C!==null&&(E.pooledCacheLanes|=u),E=C),s.memoizedState={parent:m,cache:E},Ch(s),gs(s,Ln,E)):((i.lanes&u)!==0&&(Ja(i,s),ll(s,null,null,u),ol()),E=i.memoizedState,C=s.memoizedState,E.parent!==m?(E={parent:m,cache:m},s.memoizedState=E,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=E),gs(s,Ln,m)):(m=C.cache,gs(s,Ln,m),m!==E.cache&&wc(s,[Ln],u,!0))),qr(i,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(S(156,s.tag))}function pl(i){i.flags|=4}function Nf(i,s,u,m,E){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(E&335544128)===E)if(i.stateNode.complete)i.flags|=8192;else if(um())i.flags|=8192;else throw hi=Ec,Cu}else i.flags&=-16777217}function Zf(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!V(s))if(um())i.flags|=8192;else throw hi=Ec,Cu}function Od(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?xi():536870912,i.lanes|=s,$u|=s)}function jc(i,s){if(!Ii)switch(i.tailMode){case"hidden":s=i.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function Dn(i){var s=i.alternate!==null&&i.alternate.child===i.child,u=0,m=0;if(s)for(var E=i.child;E!==null;)u|=E.lanes|E.childLanes,m|=E.subtreeFlags&65011712,m|=E.flags&65011712,E.return=i,E=E.sibling;else for(E=i.child;E!==null;)u|=E.lanes|E.childLanes,m|=E.subtreeFlags,m|=E.flags,E.return=i,E=E.sibling;return i.subtreeFlags|=m,i.childLanes=u,s}function Qp(i,s,u){var m=s.pendingProps;switch(xc(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(s),null;case 1:return Dn(s),null;case 3:return u=s.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),ba(Ln),Bt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(Us(s)?pl(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,wo())),Dn(s),null;case 26:var E=s.type,C=s.memoizedState;return i===null?(pl(s),C!==null?(Dn(s),Zf(s,C)):(Dn(s),Nf(s,E,null,m,u))):C?C!==i.memoizedState?(pl(s),Dn(s),Zf(s,C)):(Dn(s),s.flags&=-16777217):(i=i.memoizedProps,i!==m&&pl(s),Dn(s),Nf(s,E,i,m,u)),null;case 27:if(Qt(s),u=Pt.current,E=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&pl(s);else{if(!m){if(s.stateNode===null)throw Error(S(166));return Dn(s),null}i=mt.current,Us(s)?ea(s):(i=Ep(E,m,u),s.stateNode=i,pl(s))}return Dn(s),null;case 5:if(Qt(s),E=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&pl(s);else{if(!m){if(s.stateNode===null)throw Error(S(166));return Dn(s),null}if(C=mt.current,Us(s))ea(s);else{var Z=Qh(Pt.current);switch(C){case 1:C=Z.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:C=Z.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":C=Z.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":C=Z.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":C=Z.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof m.is=="string"?Z.createElement("select",{is:m.is}):Z.createElement("select"),m.multiple?C.multiple=!0:m.size&&(C.size=m.size);break;default:C=typeof m.is=="string"?Z.createElement(E,{is:m.is}):Z.createElement(E)}}C[Ni]=s,C[gt]=m;e:for(Z=s.child;Z!==null;){if(Z.tag===5||Z.tag===6)C.appendChild(Z.stateNode);else if(Z.tag!==4&&Z.tag!==27&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===s)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===s)break e;Z=Z.return}Z.sibling.return=Z.return,Z=Z.sibling}s.stateNode=C;e:switch(fn(C,E,m),E){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&pl(s)}}return Dn(s),Nf(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,u),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==m&&pl(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(S(166));if(i=Pt.current,Us(s)){if(i=s.stateNode,u=s.memoizedProps,m=null,E=xr,E!==null)switch(E.tag){case 27:case 5:m=E.memoizedProps}i[Ni]=s,i=!!(i.nodeValue===u||m!==null&&m.suppressHydrationWarning===!0||_p(i.nodeValue,u)),i||Nr(s,!0)}else i=Qh(i).createTextNode(m),i[Ni]=s,s.stateNode=i}return Dn(s),null;case 31:if(u=s.memoizedState,i===null||i.memoizedState!==null){if(m=Us(s),u!==null){if(i===null){if(!m)throw Error(S(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(S(557));i[Ni]=s}else xo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Dn(s),i=!1}else u=wo(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return s.flags&256?(Sa(s),s):(Sa(s),null);if((s.flags&128)!==0)throw Error(S(558))}return Dn(s),null;case 13:if(m=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(E=Us(s),m!==null&&m.dehydrated!==null){if(i===null){if(!E)throw Error(S(318));if(E=s.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(S(317));E[Ni]=s}else xo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Dn(s),E=!1}else E=wo(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=E),E=!0;if(!E)return s.flags&256?(Sa(s),s):(Sa(s),null)}return Sa(s),(s.flags&128)!==0?(s.lanes=u,s):(u=m!==null,i=i!==null&&i.memoizedState!==null,u&&(m=s.child,E=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(E=m.alternate.memoizedState.cachePool.pool),C=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),C!==E&&(m.flags|=2048)),u!==i&&u&&(s.child.flags|=8192),Od(s,s.updateQueue),Dn(s),null);case 4:return Bt(),i===null&&ko(s.stateNode.containerInfo),Dn(s),null;case 10:return ba(s.type),Dn(s),null;case 19:if(Re($n),m=s.memoizedState,m===null)return Dn(s),null;if(E=(s.flags&128)!==0,C=m.rendering,C===null)if(E)jc(m,!1);else{if(Yn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(C=Ta(i),C!==null){for(s.flags|=128,jc(m,!1),i=C.updateQueue,s.updateQueue=i,Od(s,i),s.subtreeFlags=0,i=u,u=s.child;u!==null;)Ed(u,i),u=u.sibling;return Ze($n,$n.current&1|2),Ii&&ms(s,m.treeForkCount),s.child}i=i.sibling}m.tail!==null&&Ei()>Zd&&(s.flags|=128,E=!0,jc(m,!1),s.lanes=4194304)}else{if(!E)if(i=Ta(C),i!==null){if(s.flags|=128,E=!0,i=i.updateQueue,s.updateQueue=i,Od(s,i),jc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!C.alternate&&!Ii)return Dn(s),null}else 2*Ei()-m.renderingStartTime>Zd&&u!==536870912&&(s.flags|=128,E=!0,jc(m,!1),s.lanes=4194304);m.isBackwards?(C.sibling=s.child,s.child=C):(i=m.last,i!==null?i.sibling=C:s.child=C,m.last=C)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Ei(),i.sibling=null,u=$n.current,Ze($n,E?u&1|2:u&1),Ii&&ms(s,m.treeForkCount),i):(Dn(s),null);case 22:case 23:return Sa(s),ku(),m=s.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(u&536870912)!==0&&(s.flags&128)===0&&(Dn(s),s.subtreeFlags&6&&(s.flags|=8192)):Dn(s),u=s.updateQueue,u!==null&&Od(s,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==u&&(s.flags|=2048),i!==null&&Re(Gs),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),ba(Ln),Dn(s),null;case 25:return null;case 30:return null}throw Error(S(156,s.tag))}function ug(i,s){switch(xc(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return ba(Ln),Bt(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Qt(s),null;case 31:if(s.memoizedState!==null){if(Sa(s),s.alternate===null)throw Error(S(340));xo()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(Sa(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(S(340));xo()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return Re($n),null;case 4:return Bt(),null;case 10:return ba(s.type),null;case 22:case 23:return Sa(s),ku(),i!==null&&Re(Gs),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return ba(Ln),null;case 25:return null;default:return null}}function Jp(i,s){switch(xc(s),s.tag){case 3:ba(Ln),Bt();break;case 26:case 27:case 5:Qt(s);break;case 4:Bt();break;case 31:s.memoizedState!==null&&Sa(s);break;case 13:Sa(s);break;case 19:Re($n);break;case 10:ba(s.type);break;case 22:case 23:Sa(s),ku(),i!==null&&Re(Gs);break;case 24:ba(Ln)}}function Bh(i,s){try{var u=s.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var E=m.next;u=E;do{if((u.tag&i)===i){m=void 0;var C=u.create,Z=u.inst;m=C(),Z.destroy=m}u=u.next}while(u!==E)}}catch(te){on(s,s.return,te)}}function to(i,s,u){try{var m=s.updateQueue,E=m!==null?m.lastEffect:null;if(E!==null){var C=E.next;m=C;do{if((m.tag&i)===i){var Z=m.inst,te=Z.destroy;if(te!==void 0){Z.destroy=void 0,E=s;var Se=u,He=te;try{He()}catch(st){on(E,Se,st)}}}m=m.next}while(m!==C)}}catch(st){on(s,s.return,st)}}function Fd(i){var s=i.updateQueue;if(s!==null){var u=i.stateNode;try{Fa(s,u)}catch(m){on(i,i.return,m)}}}function Vf(i,s,u){u.props=ia(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(m){on(i,s,m)}}function io(i,s){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var m=i.stateNode;break;case 30:m=i.stateNode;break;default:m=i.stateNode}typeof u=="function"?i.refCleanup=u(m):u.current=m}}catch(E){on(i,s,E)}}function Na(i,s){var u=i.ref,m=i.refCleanup;if(u!==null)if(typeof m=="function")try{m()}catch(E){on(i,s,E)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(E){on(i,s,E)}else u.current=null}function em(i){var s=i.type,u=i.memoizedProps,m=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&m.focus();break e;case"img":u.src?m.src=u.src:u.srcSet&&(m.srcset=u.srcSet)}}catch(E){on(i,i.return,E)}}function Gf(i,s,u){try{var m=i.stateNode;th(m,i.type,u,s),m[gt]=s}catch(E){on(i,i.return,E)}}function tm(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&vl(i.type)||i.tag===4}function qf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||tm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&vl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function $f(i,s,u){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(i),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=di));else if(m!==4&&(m===27&&vl(i.type)&&(u=i.stateNode,s=null),i=i.child,i!==null))for($f(i,s,u),i=i.sibling;i!==null;)$f(i,s,u),i=i.sibling}function jd(i,s,u){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?u.insertBefore(i,s):u.appendChild(i);else if(m!==4&&(m===27&&vl(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(jd(i,s,u),i=i.sibling;i!==null;)jd(i,s,u),i=i.sibling}function im(i){var s=i.stateNode,u=i.memoizedProps;try{for(var m=i.type,E=s.attributes;E.length;)s.removeAttributeNode(E[0]);fn(s,m,u),s[Ni]=i,s[gt]=u}catch(C){on(i,i.return,C)}}var no=!1,wr=!1,Ud=!1,Uu=typeof WeakSet=="function"?WeakSet:Set,$r=null;function Xn(i,s){if(i=i.containerInfo,nf=Tt,i=mc(i),_u(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var E=m.anchorOffset,C=m.focusNode;m=m.focusOffset;try{u.nodeType,C.nodeType}catch{u=null;break e}var Z=0,te=-1,Se=-1,He=0,st=0,ft=i,Xe=null;t:for(;;){for(var Qe;ft!==u||E!==0&&ft.nodeType!==3||(te=Z+E),ft!==C||m!==0&&ft.nodeType!==3||(Se=Z+m),ft.nodeType===3&&(Z+=ft.nodeValue.length),(Qe=ft.firstChild)!==null;)Xe=ft,ft=Qe;for(;;){if(ft===i)break t;if(Xe===u&&++He===E&&(te=Z),Xe===C&&++st===m&&(Se=Z),(Qe=ft.nextSibling)!==null)break;ft=Xe,Xe=ft.parentNode}ft=Qe}u=te===-1||Se===-1?null:{start:te,end:Se}}else u=null}u=u||{start:0,end:0}}else u=null;for(rf={focusedElem:i,selectionRange:u},Tt=!1,$r=s;$r!==null;)if(s=$r,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,$r=i;else for(;$r!==null;){switch(s=$r,C=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)E=i[u],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,u=s,E=C.memoizedProps,C=C.memoizedState,m=u.stateNode;try{var Vt=ia(u.type,E);i=m.getSnapshotBeforeUpdate(Vt,C),m.__reactInternalSnapshotBeforeUpdate=i}catch(li){on(u,u.return,li)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,u=i.nodeType,u===9)sf(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":sf(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(S(163))}if(i=s.sibling,i!==null){i.return=s.return,$r=i;break}$r=s.return}}function Uc(i,s,u){var m=u.flags;switch(u.tag){case 0:case 11:case 15:Ea(i,u),m&4&&Bh(5,u);break;case 1:if(Ea(i,u),m&4)if(i=u.stateNode,s===null)try{i.componentDidMount()}catch(Z){on(u,u.return,Z)}else{var E=ia(u.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(E,s,i.__reactInternalSnapshotBeforeUpdate)}catch(Z){on(u,u.return,Z)}}m&64&&Fd(u),m&512&&io(u,u.return);break;case 3:if(Ea(i,u),m&64&&(i=u.updateQueue,i!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{Fa(i,s)}catch(Z){on(u,u.return,Z)}}break;case 27:s===null&&m&4&&im(u);case 26:case 5:Ea(i,u),s===null&&m&4&&em(u),m&512&&io(u,u.return);break;case 12:Ea(i,u);break;case 31:Ea(i,u),m&4&&Yf(i,u);break;case 13:Ea(i,u),m&4&&Nu(i,u),m&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=ym.bind(null,u),vg(i,u))));break;case 22:if(m=u.memoizedState!==null||no,!m){s=s!==null&&s.memoizedState!==null||wr,E=no;var C=wr;no=m,(wr=s)&&!C?Do(i,u,(u.subtreeFlags&8772)!==0):Ea(i,u),no=E,wr=C}break;case 30:break;default:Ea(i,u)}}function Hf(i){var s=i.alternate;s!==null&&(i.alternate=null,Hf(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Fo(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var An=null,na=!1;function ts(i,s,u){for(u=u.child;u!==null;)Xf(i,s,u),u=u.sibling}function Xf(i,s,u){if(ae&&typeof ae.onCommitFiberUnmount=="function")try{ae.onCommitFiberUnmount(H,u)}catch{}switch(u.tag){case 26:wr||Na(u,s),ts(i,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:wr||Na(u,s);var m=An,E=na;vl(u.type)&&(An=u.stateNode,na=!1),ts(i,s,u),Wc(u.stateNode),An=m,na=E;break;case 5:wr||Na(u,s);case 6:if(m=An,E=na,An=null,ts(i,s,u),An=m,na=E,An!==null)if(na)try{(An.nodeType===9?An.body:An.nodeName==="HTML"?An.ownerDocument.body:An).removeChild(u.stateNode)}catch(C){on(u,s,C)}else try{An.removeChild(u.stateNode)}catch(C){on(u,s,C)}break;case 18:An!==null&&(na?(i=An,xp(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),ma(i)):xp(An,u.stateNode));break;case 4:m=An,E=na,An=u.stateNode.containerInfo,na=!0,ts(i,s,u),An=m,na=E;break;case 0:case 11:case 14:case 15:to(2,u,s),wr||to(4,u,s),ts(i,s,u);break;case 1:wr||(Na(u,s),m=u.stateNode,typeof m.componentWillUnmount=="function"&&Vf(u,s,m)),ts(i,s,u);break;case 21:ts(i,s,u);break;case 22:wr=(m=wr)||u.memoizedState!==null,ts(i,s,u),wr=m;break;default:ts(i,s,u)}}function Yf(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ma(i)}catch(u){on(s,s.return,u)}}}function Nu(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ma(i)}catch(u){on(s,s.return,u)}}function Wf(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Uu),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Uu),s;default:throw Error(S(435,i.tag))}}function ml(i,s){var u=Wf(i);s.forEach(function(m){if(!u.has(m)){u.add(m);var E=pg.bind(null,i,m);m.then(E,E)}})}function ra(i,s){var u=s.deletions;if(u!==null)for(var m=0;m<u.length;m++){var E=u[m],C=i,Z=s,te=Z;e:for(;te!==null;){switch(te.tag){case 27:if(vl(te.type)){An=te.stateNode,na=!1;break e}break;case 5:An=te.stateNode,na=!1;break e;case 3:case 4:An=te.stateNode.containerInfo,na=!0;break e}te=te.return}if(An===null)throw Error(S(160));Xf(C,Z,E),An=null,na=!1,C=E.alternate,C!==null&&(C.return=null),E.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Zu(s,i),s=s.sibling}var da=null;function Zu(i,s){var u=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ra(s,i),Za(i),m&4&&(to(3,i,i.return),Bh(3,i),to(5,i,i.return));break;case 1:ra(s,i),Za(i),m&512&&(wr||u===null||Na(u,u.return)),m&64&&no&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?m:u.concat(m))));break;case 26:var E=da;if(ra(s,i),Za(i),m&512&&(wr||u===null||Na(u,u.return)),m&4){var C=u!==null?u.memoizedState:null;if(m=i.memoizedState,u===null)if(m===null)if(i.stateNode===null){e:{m=i.type,u=i.memoizedProps,E=E.ownerDocument||E;t:switch(m){case"title":C=E.getElementsByTagName("title")[0],(!C||C[ci]||C[Ni]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=E.createElement(m),E.head.insertBefore(C,E.querySelector("head > title"))),fn(C,m,u),C[Ni]=i,Cn(C),m=C;break e;case"link":var Z=I("link","href",E).get(m+(u.href||""));if(Z){for(var te=0;te<Z.length;te++)if(C=Z[te],C.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&C.getAttribute("rel")===(u.rel==null?null:u.rel)&&C.getAttribute("title")===(u.title==null?null:u.title)&&C.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){Z.splice(te,1);break t}}C=E.createElement(m),fn(C,m,u),E.head.appendChild(C);break;case"meta":if(Z=I("meta","content",E).get(m+(u.content||""))){for(te=0;te<Z.length;te++)if(C=Z[te],C.getAttribute("content")===(u.content==null?null:""+u.content)&&C.getAttribute("name")===(u.name==null?null:u.name)&&C.getAttribute("property")===(u.property==null?null:u.property)&&C.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&C.getAttribute("charset")===(u.charSet==null?null:u.charSet)){Z.splice(te,1);break t}}C=E.createElement(m),fn(C,m,u),E.head.appendChild(C);break;default:throw Error(S(468,m))}C[Ni]=i,Cn(C),m=C}i.stateNode=m}else D(E,i.type,i.stateNode);else i.stateNode=d(E,m,i.memoizedProps);else C!==m?(C===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):C.count--,m===null?D(E,i.type,i.stateNode):d(E,m,i.memoizedProps)):m===null&&i.stateNode!==null&&Gf(i,i.memoizedProps,u.memoizedProps)}break;case 27:ra(s,i),Za(i),m&512&&(wr||u===null||Na(u,u.return)),u!==null&&m&4&&Gf(i,i.memoizedProps,u.memoizedProps);break;case 5:if(ra(s,i),Za(i),m&512&&(wr||u===null||Na(u,u.return)),i.flags&32){E=i.stateNode;try{Ps(E,"")}catch(Vt){on(i,i.return,Vt)}}m&4&&i.stateNode!=null&&(E=i.memoizedProps,Gf(i,E,u!==null?u.memoizedProps:E)),m&1024&&(Ud=!0);break;case 6:if(ra(s,i),Za(i),m&4){if(i.stateNode===null)throw Error(S(162));m=i.memoizedProps,u=i.stateNode;try{u.nodeValue=m}catch(Vt){on(i,i.return,Vt)}}break;case 3:if(T=null,E=da,da=td(s.containerInfo),ra(s,i),da=E,Za(i),m&4&&u!==null&&u.memoizedState.isDehydrated)try{ma(s.containerInfo)}catch(Vt){on(i,i.return,Vt)}Ud&&(Ud=!1,Kf(i));break;case 4:m=da,da=td(i.stateNode.containerInfo),ra(s,i),Za(i),da=m;break;case 12:ra(s,i),Za(i);break;case 31:ra(s,i),Za(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ml(i,m)));break;case 13:ra(s,i),Za(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Nh=Ei()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ml(i,m)));break;case 22:E=i.memoizedState!==null;var Se=u!==null&&u.memoizedState!==null,He=no,st=wr;if(no=He||E,wr=st||Se,ra(s,i),wr=st,no=He,Za(i),m&8192)e:for(s=i.stateNode,s._visibility=E?s._visibility&-2:s._visibility|1,E&&(u===null||Se||no||wr||Nc(i)),u=null,s=i;;){if(s.tag===5||s.tag===26){if(u===null){Se=u=s;try{if(C=Se.stateNode,E)Z=C.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{te=Se.stateNode;var ft=Se.memoizedProps.style,Xe=ft!=null&&ft.hasOwnProperty("display")?ft.display:null;te.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Vt){on(Se,Se.return,Vt)}}}else if(s.tag===6){if(u===null){Se=s;try{Se.stateNode.nodeValue=E?"":Se.memoizedProps}catch(Vt){on(Se,Se.return,Vt)}}}else if(s.tag===18){if(u===null){Se=s;try{var Qe=Se.stateNode;E?Jh(Qe,!0):Jh(Se.stateNode,!1)}catch(Vt){on(Se,Se.return,Vt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=i.updateQueue,m!==null&&(u=m.retryQueue,u!==null&&(m.retryQueue=null,ml(i,u))));break;case 19:ra(s,i),Za(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ml(i,m)));break;case 30:break;case 21:break;default:ra(s,i),Za(i)}}function Za(i){var s=i.flags;if(s&2){try{for(var u,m=i.return;m!==null;){if(tm(m)){u=m;break}m=m.return}if(u==null)throw Error(S(160));switch(u.tag){case 27:var E=u.stateNode,C=qf(i);jd(i,C,E);break;case 5:var Z=u.stateNode;u.flags&32&&(Ps(Z,""),u.flags&=-33);var te=qf(i);jd(i,te,Z);break;case 3:case 4:var Se=u.stateNode.containerInfo,He=qf(i);$f(i,He,Se);break;default:throw Error(S(161))}}catch(st){on(i,i.return,st)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Kf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Kf(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ea(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Uc(i,s.alternate,s),s=s.sibling}function Nc(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:to(4,s,s.return),Nc(s);break;case 1:Na(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&Vf(s,s.return,u),Nc(s);break;case 27:Wc(s.stateNode);case 26:case 5:Na(s,s.return),Nc(s);break;case 22:s.memoizedState===null&&Nc(s);break;case 30:Nc(s);break;default:Nc(s)}i=i.sibling}}function Do(i,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,E=i,C=s,Z=C.flags;switch(C.tag){case 0:case 11:case 15:Do(E,C,u),Bh(4,C);break;case 1:if(Do(E,C,u),m=C,E=m.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(He){on(m,m.return,He)}if(m=C,E=m.updateQueue,E!==null){var te=m.stateNode;try{var Se=E.shared.hiddenCallbacks;if(Se!==null)for(E.shared.hiddenCallbacks=null,E=0;E<Se.length;E++)Ih(Se[E],te)}catch(He){on(m,m.return,He)}}u&&Z&64&&Fd(C),io(C,C.return);break;case 27:im(C);case 26:case 5:Do(E,C,u),u&&m===null&&Z&4&&em(C),io(C,C.return);break;case 12:Do(E,C,u);break;case 31:Do(E,C,u),u&&Z&4&&Yf(E,C);break;case 13:Do(E,C,u),u&&Z&4&&Nu(E,C);break;case 22:C.memoizedState===null&&Do(E,C,u),io(C,C.return);break;case 30:break;default:Do(E,C,u)}s=s.sibling}}function Zc(i,s){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&ir(u))}function Lh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ir(i))}function Ts(i,s,u,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Qf(i,s,u,m),s=s.sibling}function Qf(i,s,u,m){var E=s.flags;switch(s.tag){case 0:case 11:case 15:Ts(i,s,u,m),E&2048&&Bh(9,s);break;case 1:Ts(i,s,u,m);break;case 3:Ts(i,s,u,m),E&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ir(i)));break;case 12:if(E&2048){Ts(i,s,u,m),i=s.stateNode;try{var C=s.memoizedProps,Z=C.id,te=C.onPostCommit;typeof te=="function"&&te(Z,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Se){on(s,s.return,Se)}}else Ts(i,s,u,m);break;case 31:Ts(i,s,u,m);break;case 13:Ts(i,s,u,m);break;case 23:break;case 22:C=s.stateNode,Z=s.alternate,s.memoizedState!==null?C._visibility&2?Ts(i,s,u,m):Oh(i,s):C._visibility&2?Ts(i,s,u,m):(C._visibility|=2,Vu(i,s,u,m,(s.subtreeFlags&10256)!==0||!1)),E&2048&&Zc(Z,s);break;case 24:Ts(i,s,u,m),E&2048&&Lh(s.alternate,s);break;default:Ts(i,s,u,m)}}function Vu(i,s,u,m,E){for(E=E&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var C=i,Z=s,te=u,Se=m,He=Z.flags;switch(Z.tag){case 0:case 11:case 15:Vu(C,Z,te,Se,E),Bh(8,Z);break;case 23:break;case 22:var st=Z.stateNode;Z.memoizedState!==null?st._visibility&2?Vu(C,Z,te,Se,E):Oh(C,Z):(st._visibility|=2,Vu(C,Z,te,Se,E)),E&&He&2048&&Zc(Z.alternate,Z);break;case 24:Vu(C,Z,te,Se,E),E&&He&2048&&Lh(Z.alternate,Z);break;default:Vu(C,Z,te,Se,E)}s=s.sibling}}function Oh(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=i,m=s,E=m.flags;switch(m.tag){case 22:Oh(u,m),E&2048&&Zc(m.alternate,m);break;case 24:Oh(u,m),E&2048&&Lh(m.alternate,m);break;default:Oh(u,m)}s=s.sibling}}var Fh=8192;function Gu(i,s,u){if(i.subtreeFlags&Fh)for(i=i.child;i!==null;)nm(i,s,u),i=i.sibling}function nm(i,s,u){switch(i.tag){case 26:Gu(i,s,u),i.flags&Fh&&i.memoizedState!==null&&X(u,da,i.memoizedState,i.memoizedProps);break;case 5:Gu(i,s,u);break;case 3:case 4:var m=da;da=td(i.stateNode.containerInfo),Gu(i,s,u),da=m;break;case 22:i.memoizedState===null&&(m=i.alternate,m!==null&&m.memoizedState!==null?(m=Fh,Fh=16777216,Gu(i,s,u),Fh=m):Gu(i,s,u));break;default:Gu(i,s,u)}}function Vc(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function jh(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var m=s[u];$r=m,am(m,i)}Vc(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)rm(i),i=i.sibling}function rm(i){switch(i.tag){case 0:case 11:case 15:jh(i),i.flags&2048&&to(9,i,i.return);break;case 3:jh(i);break;case 12:jh(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Uh(i)):jh(i);break;default:jh(i)}}function Uh(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var m=s[u];$r=m,am(m,i)}Vc(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:to(8,s,s.return),Uh(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,Uh(s));break;default:Uh(s)}i=i.sibling}}function am(i,s){for(;$r!==null;){var u=$r;switch(u.tag){case 0:case 11:case 15:to(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var m=u.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:ir(u.memoizedState.cache)}if(m=u.child,m!==null)m.return=u,$r=m;else e:for(u=i;$r!==null;){m=$r;var E=m.sibling,C=m.return;if(Hf(m),m===u){$r=null;break e}if(E!==null){E.return=C,$r=E;break e}$r=C}}}var sm={getCacheForType:function(i){var s=fr(Ln),u=s.data.get(i);return u===void 0&&(u=i(),s.data.set(i,u)),u},cacheSignal:function(){return fr(Ln).controller.signal}},hg=typeof WeakMap=="function"?WeakMap:Map,$i=0,tn=null,ki=null,ji=0,dn=0,Va=null,gl=!1,qu=!1,Jf=!1,is=0,Yn=0,$l=0,Gc=0,ep=0,ns=0,$u=0,Hu=null,fa=null,Nd=!1,Nh=0,tp=0,Zd=1/0,qc=null,Hl=null,Sr=0,Xl=null,Xu=null,_l=0,Vd=0,ip=null,om=null,yl=0,or=null;function Ma(){return($i&2)!==0&&ji!==0?ji&-ji:Ue.T!==null?Xh():Rn()}function np(){if(ns===0)if((ji&536870912)===0||Ii){var i=Je;Je<<=1,(Je&3932160)===0&&(Je=262144),ns=i}else ns=536870912;return i=Br.current,i!==null&&(i.flags|=32),ns}function Aa(i,s,u){(i===tn&&(dn===2||dn===9)||i.cancelPendingCommit!==null)&&(Yu(i,0),Yl(i,ji,ns,!1)),gn(i,u),(($i&2)===0||i!==tn)&&(i===tn&&(($i&2)===0&&(Gc|=u),Yn===4&&Yl(i,ji,ns,!1)),aa(i))}function Gd(i,s,u){if(($i&6)!==0)throw Error(S(327));var m=!u&&(s&127)===0&&(s&i.expiredLanes)===0||rn(i,s),E=m?fg(i,s):ap(i,s,!0),C=m;do{if(E===0){qu&&!m&&Yl(i,s,0,!1);break}else{if(u=i.current.alternate,C&&!lm(u)){E=ap(i,s,!1),C=!1;continue}if(E===2){if(C=s,i.errorRecoveryDisabledLanes&C)var Z=0;else Z=i.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){s=Z;e:{var te=i;E=Hu;var Se=te.current.memoizedState.isDehydrated;if(Se&&(Yu(te,Z).flags|=256),Z=ap(te,Z,!1),Z!==2){if(Jf&&!Se){te.errorRecoveryDisabledLanes|=C,Gc|=C,E=4;break e}C=fa,fa=E,C!==null&&(fa===null?fa=C:fa.push.apply(fa,C))}E=Z}if(C=!1,E!==2)continue}}if(E===1){Yu(i,0),Yl(i,s,0,!0);break}e:{switch(m=i,C=E,C){case 0:case 1:throw Error(S(345));case 4:if((s&4194048)!==s)break;case 6:Yl(m,s,ns,!gl);break e;case 2:fa=null;break;case 3:case 5:break;default:throw Error(S(329))}if((s&62914560)===s&&(E=Nh+300-Ei(),10<E)){if(Yl(m,s,ns,!gl),_i(m,0,!0)!==0)break e;_l=s,m.timeoutHandle=vp($c.bind(null,m,u,fa,qc,Nd,s,ns,Gc,$u,gl,C,"Throttled",-0,0),E);break e}$c(m,u,fa,qc,Nd,s,ns,Gc,$u,gl,C,null,-0,0)}}break}while(!0);aa(i)}function $c(i,s,u,m,E,C,Z,te,Se,He,st,ft,Xe,Qe){if(i.timeoutHandle=-1,ft=s.subtreeFlags,ft&8192||(ft&16785408)===16785408){ft={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:di},nm(s,C,ft);var Vt=(C&62914560)===C?Nh-Ei():(C&4194048)===C?tp-Ei():0;if(Vt=J(ft,Vt),Vt!==null){_l=C,i.cancelPendingCommit=Vt(Zh.bind(null,i,s,C,u,m,E,Z,te,Se,st,ft,null,Xe,Qe)),Yl(i,C,Z,!He);return}}Zh(i,s,C,u,m,E,Z,te,Se)}function lm(i){for(var s=i;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var m=0;m<u.length;m++){var E=u[m],C=E.getSnapshot;E=E.value;try{if(!Yr(C(),E))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Yl(i,s,u,m){s&=~ep,s&=~Gc,i.suspendedLanes|=s,i.pingedLanes&=~s,m&&(i.warmLanes|=s),m=i.expirationTimes;for(var E=s;0<E;){var C=31-we(E),Z=1<<C;m[C]=-1,E&=~Z}u!==0&&Sn(i,u,s)}function qd(){return($i&6)===0?(Ku(0),!1):!0}function rp(){if(ki!==null){if(dn===0)var i=ki.return;else i=ki,Ka=Ns=null,Vl(i),Qa=null,Nl=0,i=ki;for(;i!==null;)Jp(i.alternate,i),i=i.return;ki=null}}function Yu(i,s){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,zm(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),_l=0,rp(),tn=i,ki=u=Kr(i.current,null),ji=s,dn=0,Va=null,gl=!1,qu=rn(i,s),Jf=!1,$u=ns=ep=Gc=$l=Yn=0,fa=Hu=null,Nd=!1,(s&8)!==0&&(s|=s&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=s;0<m;){var E=31-we(m),C=1<<E;s|=i[E],m&=~C}return is=s,Ko(),u}function cm(i,s){Nt=null,Ue.H=Gl,s===zt||s===jl?(s=Iu(),dn=3):s===Cu?(s=Iu(),dn=4):dn=s===Df?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Va=s,ki===null&&(Yn=1,Ou(i,Ur(s,i.current)))}function um(){var i=Br.current;return i===null?!0:(ji&4194048)===ji?hn===null:(ji&62914560)===ji||(ji&536870912)!==0?i===hn:!1}function hm(){var i=Ue.H;return Ue.H=Gl,i===null?Gl:i}function dm(){var i=Ue.A;return Ue.A=sm,i}function $d(){Yn=4,gl||(ji&4194048)!==ji&&Br.current!==null||(qu=!0),($l&134217727)===0&&(Gc&134217727)===0||tn===null||Yl(tn,ji,ns,!1)}function ap(i,s,u){var m=$i;$i|=2;var E=hm(),C=dm();(tn!==i||ji!==s)&&(qc=null,Yu(i,s)),s=!1;var Z=Yn;e:do try{if(dn!==0&&ki!==null){var te=ki,Se=Va;switch(dn){case 8:rp(),Z=6;break e;case 3:case 2:case 9:case 6:Br.current===null&&(s=!0);var He=dn;if(dn=0,Va=null,rs(i,te,Se,He),u&&qu){Z=0;break e}break;default:He=dn,dn=0,Va=null,rs(i,te,Se,He)}}dg(),Z=Yn;break}catch(st){cm(i,st)}while(!0);return s&&i.shellSuspendCounter++,Ka=Ns=null,$i=m,Ue.H=E,Ue.A=C,ki===null&&(tn=null,ji=0,Ko()),Z}function dg(){for(;ki!==null;)Hd(ki)}function fg(i,s){var u=$i;$i|=2;var m=hm(),E=dm();tn!==i||ji!==s?(qc=null,Zd=Ei()+500,Yu(i,s)):qu=rn(i,s);e:do try{if(dn!==0&&ki!==null){s=ki;var C=Va;t:switch(dn){case 1:dn=0,Va=null,rs(i,s,C,1);break;case 2:case 9:if(vs(C)){dn=0,Va=null,sp(s);break}s=function(){dn!==2&&dn!==9||tn!==i||(dn=7),aa(i)},C.then(s,s);break e;case 3:dn=7;break e;case 4:dn=5;break e;case 7:vs(C)?(dn=0,Va=null,sp(s)):(dn=0,Va=null,rs(i,s,C,7));break;case 5:var Z=null;switch(ki.tag){case 26:Z=ki.memoizedState;case 5:case 27:var te=ki;if(Z?V(Z):te.stateNode.complete){dn=0,Va=null;var Se=te.sibling;if(Se!==null)ki=Se;else{var He=te.return;He!==null?(ki=He,Wl(He)):ki=null}break t}}dn=0,Va=null,rs(i,s,C,5);break;case 6:dn=0,Va=null,rs(i,s,C,6);break;case 8:rp(),Yn=6;break e;default:throw Error(S(462))}}fm();break}catch(st){cm(i,st)}while(!0);return Ka=Ns=null,Ue.H=m,Ue.A=E,$i=u,ki!==null?0:(tn=null,ji=0,Ko(),Yn)}function fm(){for(;ki!==null&&!Xi();)Hd(ki)}function Hd(i){var s=Uf(i.alternate,i,is);i.memoizedProps=i.pendingProps,s===null?Wl(i):ki=s}function sp(i){var s=i,u=s.alternate;switch(s.tag){case 15:case 0:s=kd(u,s,s.pendingProps,s.type,void 0,ji);break;case 11:s=kd(u,s,s.pendingProps,s.type.render,s.ref,ji);break;case 5:Vl(s);default:Jp(u,s),s=ki=Ed(s,is),s=Uf(u,s,is)}i.memoizedProps=i.pendingProps,s===null?Wl(i):ki=s}function rs(i,s,u,m){Ka=Ns=null,Vl(s),Qa=null,Nl=0;var E=s.return;try{if(Pf(i,E,s,u,ji)){Yn=1,Ou(i,Ur(u,i.current)),ki=null;return}}catch(C){if(E!==null)throw ki=E,C;Yn=1,Ou(i,Ur(u,i.current)),ki=null;return}s.flags&32768?(Ii||m===1?i=!0:qu||(ji&536870912)!==0?i=!1:(gl=i=!0,(m===2||m===9||m===3||m===6)&&(m=Br.current,m!==null&&m.tag===13&&(m.flags|=16384))),Hc(s,i)):Wl(s)}function Wl(i){var s=i;do{if((s.flags&32768)!==0){Hc(s,gl);return}i=s.return;var u=Qp(s.alternate,s,is);if(u!==null){ki=u;return}if(s=s.sibling,s!==null){ki=s;return}ki=s=i}while(s!==null);Yn===0&&(Yn=5)}function Hc(i,s){do{var u=ug(i.alternate,i);if(u!==null){u.flags&=32767,ki=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(i=i.sibling,i!==null)){ki=i;return}ki=i=u}while(i!==null);Yn=6,ki=null}function Zh(i,s,u,m,E,C,Z,te,Se){i.cancelPendingCommit=null;do Gh();while(Sr!==0);if(($i&6)!==0)throw Error(S(327));if(s!==null){if(s===i.current)throw Error(S(177));if(C=s.lanes|s.childLanes,C|=Wo,_r(i,u,C,Z,te,Se),i===tn&&(ki=tn=null,ji=0),Xu=s,Xl=i,_l=u,Vd=C,ip=E,om=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,mg(O,function(){return gm(),null})):(i.callbackNode=null,i.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=Ue.T,Ue.T=null,E=et.p,et.p=2,Z=$i,$i|=4;try{Xn(i,s,u)}finally{$i=Z,et.p=E,Ue.T=m}}Sr=1,Vh(),pm(),mm()}}function Vh(){if(Sr===1){Sr=0;var i=Xl,s=Xu,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=Ue.T,Ue.T=null;var m=et.p;et.p=2;var E=$i;$i|=4;try{Zu(s,i);var C=rf,Z=mc(i.containerInfo),te=C.focusedElem,Se=C.selectionRange;if(Z!==te&&te&&te.ownerDocument&&gu(te.ownerDocument.documentElement,te)){if(Se!==null&&_u(te)){var He=Se.start,st=Se.end;if(st===void 0&&(st=He),"selectionStart"in te)te.selectionStart=He,te.selectionEnd=Math.min(st,te.value.length);else{var ft=te.ownerDocument||document,Xe=ft&&ft.defaultView||window;if(Xe.getSelection){var Qe=Xe.getSelection(),Vt=te.textContent.length,li=Math.min(Se.start,Vt),wn=Se.end===void 0?li:Math.min(Se.end,Vt);!Qe.extend&&li>wn&&(Z=wn,wn=li,li=Z);var Be=mu(te,li),Pe=mu(te,wn);if(Be&&Pe&&(Qe.rangeCount!==1||Qe.anchorNode!==Be.node||Qe.anchorOffset!==Be.offset||Qe.focusNode!==Pe.node||Qe.focusOffset!==Pe.offset)){var je=ft.createRange();je.setStart(Be.node,Be.offset),Qe.removeAllRanges(),li>wn?(Qe.addRange(je),Qe.extend(Pe.node,Pe.offset)):(je.setEnd(Pe.node,Pe.offset),Qe.addRange(je))}}}}for(ft=[],Qe=te;Qe=Qe.parentNode;)Qe.nodeType===1&&ft.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof te.focus=="function"&&te.focus(),te=0;te<ft.length;te++){var lt=ft[te];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}Tt=!!nf,rf=nf=null}finally{$i=E,et.p=m,Ue.T=u}}i.current=s,Sr=2}}function pm(){if(Sr===2){Sr=0;var i=Xl,s=Xu,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=Ue.T,Ue.T=null;var m=et.p;et.p=2;var E=$i;$i|=4;try{Uc(i,s.alternate,s)}finally{$i=E,et.p=m,Ue.T=u}}Sr=3}}function mm(){if(Sr===4||Sr===3){Sr=0,tr();var i=Xl,s=Xu,u=_l,m=om;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Sr=5:(Sr=0,Xu=Xl=null,op(i,i.pendingLanes));var E=i.pendingLanes;if(E===0&&(Hl=null),at(u),s=s.stateNode,ae&&typeof ae.onCommitFiberRoot=="function")try{ae.onCommitFiberRoot(H,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=Ue.T,E=et.p,et.p=2,Ue.T=null;try{for(var C=i.onRecoverableError,Z=0;Z<m.length;Z++){var te=m[Z];C(te.value,{componentStack:te.stack})}}finally{Ue.T=s,et.p=E}}(_l&3)!==0&&Gh(),aa(i),E=i.pendingLanes,(u&261930)!==0&&(E&42)!==0?i===or?yl++:(yl=0,or=i):yl=0,Ku(0)}}function op(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,ir(s)))}function Gh(){return Vh(),pm(),mm(),gm()}function gm(){if(Sr!==5)return!1;var i=Xl,s=Vd;Vd=0;var u=at(_l),m=Ue.T,E=et.p;try{et.p=32>u?32:u,Ue.T=null,u=ip,ip=null;var C=Xl,Z=_l;if(Sr=0,Xu=Xl=null,_l=0,($i&6)!==0)throw Error(S(331));var te=$i;if($i|=4,rm(C.current),Qf(C,C.current,Z,u),$i=te,Ku(0,!1),ae&&typeof ae.onPostCommitFiberRoot=="function")try{ae.onPostCommitFiberRoot(H,C)}catch{}return!0}finally{et.p=E,Ue.T=m,op(i,s)}}function lp(i,s,u){s=Ur(u,s),s=Fu(i.stateNode,s,2),i=Hs(i,s,2),i!==null&&(gn(i,2),aa(i))}function on(i,s,u){if(i.tag===3)lp(i,i,u);else for(;s!==null;){if(s.tag===3){lp(s,i,u);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Hl===null||!Hl.has(m))){i=Ur(u,i),u=If(2),m=Hs(s,u,2),m!==null&&(Yp(u,m,s,i),gn(m,2),aa(m));break}}s=s.return}}function qh(i,s,u){var m=i.pingCache;if(m===null){m=i.pingCache=new hg;var E=new Set;m.set(s,E)}else E=m.get(s),E===void 0&&(E=new Set,m.set(s,E));E.has(u)||(Jf=!0,E.add(u),i=cp.bind(null,i,s,u),s.then(i,i))}function cp(i,s,u){var m=i.pingCache;m!==null&&m.delete(s),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,tn===i&&(ji&u)===u&&(Yn===4||Yn===3&&(ji&62914560)===ji&&300>Ei()-Nh?($i&2)===0&&Yu(i,0):ep|=u,$u===ji&&($u=0)),aa(i)}function _m(i,s){s===0&&(s=xi()),i=Oa(i,s),i!==null&&(gn(i,s),aa(i))}function ym(i){var s=i.memoizedState,u=0;s!==null&&(u=s.retryLane),_m(i,u)}function pg(i,s){var u=0;switch(i.tag){case 31:case 13:var m=i.stateNode,E=i.memoizedState;E!==null&&(u=E.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(S(314))}m!==null&&m.delete(s),_m(i,u)}function mg(i,s){return Gi(i,s)}var Xd=null,Wu=null,up=!1,$h=!1,Yd=!1,pa=0;function aa(i){i!==Wu&&i.next===null&&(Wu===null?Xd=Wu=i:Wu=Wu.next=i),$h=!0,up||(up=!0,dp())}function Ku(i,s){if(!Yd&&$h){Yd=!0;do for(var u=!1,m=Xd;m!==null;){if(i!==0){var E=m.pendingLanes;if(E===0)var C=0;else{var Z=m.suspendedLanes,te=m.pingedLanes;C=(1<<31-we(42|i)+1)-1,C&=E&~(Z&~te),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(u=!0,bm(m,C))}else C=ji,C=_i(m,m===tn?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(C&3)===0||rn(m,C)||(u=!0,bm(m,C));m=m.next}while(u);Yd=!1}}function hp(){vm()}function vm(){$h=up=!1;var i=0;pa!==0&&Am()&&(i=pa);for(var s=Ei(),u=null,m=Xd;m!==null;){var E=m.next,C=Hh(m,s);C===0?(m.next=null,u===null?Xd=E:u.next=E,E===null&&(Wu=u)):(u=m,(i!==0||(C&3)!==0)&&($h=!0)),m=E}Sr!==0&&Sr!==5||Ku(i),pa!==0&&(pa=0)}function Hh(i,s){for(var u=i.suspendedLanes,m=i.pingedLanes,E=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var Z=31-we(C),te=1<<Z,Se=E[Z];Se===-1?((te&u)===0||(te&m)!==0)&&(E[Z]=Gt(te,s)):Se<=s&&(i.expiredLanes|=te),C&=~te}if(s=tn,u=ji,u=_i(i,i===s?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m=i.callbackNode,u===0||i===s&&(dn===2||dn===9)||i.cancelPendingCommit!==null)return m!==null&&m!==null&&er(m),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||rn(i,u)){if(s=u&-u,s===i.callbackPriority)return s;switch(m!==null&&er(m),at(u)){case 2:case 8:u=ee;break;case 32:u=O;break;case 268435456:u=q;break;default:u=O}return m=Wd.bind(null,i),u=Gi(u,m),i.callbackPriority=s,i.callbackNode=u,s}return m!==null&&m!==null&&er(m),i.callbackPriority=2,i.callbackNode=null,2}function Wd(i,s){if(Sr!==0&&Sr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Gh()&&i.callbackNode!==u)return null;var m=ji;return m=_i(i,i===tn?m:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m===0?null:(Gd(i,m,s),Hh(i,Ei()),i.callbackNode!=null&&i.callbackNode===u?Wd.bind(null,i):null)}function bm(i,s){if(Gh())return null;Gd(i,s,!0)}function dp(){_g(function(){($i&6)!==0?Gi(Ui,hp):vm()})}function Xh(){if(pa===0){var i=nr;i===0&&(i=ct,ct<<=1,(ct&261888)===0&&(ct=256)),pa=i}return pa}function Xc(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ni(""+i)}function fp(i,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,i.id&&u.setAttribute("form",i.id),s.parentNode.insertBefore(u,s),i=new FormData(i),u.parentNode.removeChild(u),i}function xm(i,s,u,m,E){if(s==="submit"&&u&&u.stateNode===E){var C=Xc((E[gt]||null).action),Z=m.submitter;Z&&(s=(s=Z[gt]||null)?Xc(s.formAction):Z.getAttribute("formAction"),s!==null&&(C=s,Z=null));var te=new fi("action","action",null,m,E);i.push({event:te,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(pa!==0){var Se=Z?fp(E,Z):new FormData(E);Ks(u,{pending:!0,data:Se,method:E.method,action:C},null,Se)}}else typeof C=="function"&&(te.preventDefault(),Se=Z?fp(E,Z):new FormData(E),Ks(u,{pending:!0,data:Se,method:E.method,action:C},C,Se))},currentTarget:E}]})}}for(var Yh=0;Yh<vu.length;Yh++){var Kd=vu[Yh],Qd=Kd.toLowerCase(),wm=Kd[0].toUpperCase()+Kd.slice(1);ya(Qd,"on"+wm)}ya(_c,"onAnimationEnd"),ya(yc,"onAnimationIteration"),ya(yu,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(Yo,"onTransitionRun"),ya(vc,"onTransitionStart"),ya(Bl,"onTransitionCancel"),ya(_a,"onTransitionEnd"),Ha("onMouseEnter",["mouseout","mouseover"]),Ha("onMouseLeave",["mouseout","mouseover"]),Ha("onPointerEnter",["pointerout","pointerover"]),Ha("onPointerLeave",["pointerout","pointerover"]),Wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wh));function Sm(i,s){s=(s&4)!==0;for(var u=0;u<i.length;u++){var m=i[u],E=m.event;m=m.listeners;e:{var C=void 0;if(s)for(var Z=m.length-1;0<=Z;Z--){var te=m[Z],Se=te.instance,He=te.currentTarget;if(te=te.listener,Se!==C&&E.isPropagationStopped())break e;C=te,E.currentTarget=He;try{C(E)}catch(st){fs(st)}E.currentTarget=null,C=Se}else for(Z=0;Z<m.length;Z++){if(te=m[Z],Se=te.instance,He=te.currentTarget,te=te.listener,Se!==C&&E.isPropagationStopped())break e;C=te,E.currentTarget=He;try{C(E)}catch(st){fs(st)}E.currentTarget=null,C=Se}}}}function Oi(i,s){var u=s[yi];u===void 0&&(u=s[yi]=new Set);var m=i+"__bubble";u.has(m)||(mp(s,i,2,!1),u.add(m))}function pp(i,s,u){var m=0;s&&(m|=4),mp(u,i,m,s)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function ko(i){if(!i[Qu]){i[Qu]=!0,ic.forEach(function(u){u!=="selectionchange"&&(gg.has(u)||pp(u,!1,i),pp(u,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Qu]||(s[Qu]=!0,pp("selectionchange",!1,s))}}function mp(i,s,u,m){switch(kn(s)){case 2:var E=rt;break;case 8:E=Jt;break;default:E=ti}u=E.bind(null,s,u,i),E=void 0,!Dr||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(E=!0),m?E!==void 0?i.addEventListener(s,u,{capture:!0,passive:E}):i.addEventListener(s,u,!0):E!==void 0?i.addEventListener(s,u,{passive:E}):i.addEventListener(s,u,!1)}function Jd(i,s,u,m,E){var C=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var Z=m.tag;if(Z===3||Z===4){var te=m.stateNode.containerInfo;if(te===E)break;if(Z===4)for(Z=m.return;Z!==null;){var Se=Z.tag;if((Se===3||Se===4)&&Z.stateNode.containerInfo===E)return;Z=Z.return}for(;te!==null;){if(Z=za(te),Z===null)return;if(Se=Z.tag,Se===5||Se===6||Se===26||Se===27){m=C=Z;continue e}te=te.parentNode}}m=m.return}un(function(){var He=C,st=Ia(u),ft=[];e:{var Xe=Sh.get(i);if(Xe!==void 0){var Qe=fi,Vt=i;switch(i){case"keypress":if(Xa(u)===0)break e;case"keydown":case"keyup":Qe=Bs;break;case"focusin":Vt="focus",Qe=Vo;break;case"focusout":Vt="blur",Qe=Vo;break;case"beforeblur":case"afterblur":Qe=Vo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Il;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=cu;break;case _c:case yc:case yu:Qe=po;break;case _a:Qe=Ya;break;case"scroll":case"scrollend":Qe=Di;break;case"wheel":Qe=Dl;break;case"copy":case"cut":case"paste":Qe=oc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=_d;break;case"toggle":case"beforetoggle":Qe=hc}var li=(s&4)!==0,wn=!li&&(i==="scroll"||i==="scrollend"),Be=li?Xe!==null?Xe+"Capture":null:Xe;li=[];for(var Pe=He,je;Pe!==null;){var lt=Pe;if(je=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||je===null||Be===null||(lt=Cl(Pe,Be),lt!=null&&li.push(Ju(Pe,lt,je))),wn)break;Pe=Pe.return}0<li.length&&(Xe=new Qe(Xe,Vt,null,u,st),ft.push({event:Xe,listeners:li}))}}if((s&7)===0){e:{if(Xe=i==="mouseover"||i==="pointerover",Qe=i==="mouseout"||i==="pointerout",Xe&&u!==uo&&(Vt=u.relatedTarget||u.fromElement)&&(za(Vt)||Vt[ai]))break e;if((Qe||Xe)&&(Xe=st.window===st?st:(Xe=st.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Qe?(Vt=u.relatedTarget||u.toElement,Qe=He,Vt=Vt?za(Vt):null,Vt!==null&&(wn=G(Vt),li=Vt.tag,Vt!==wn||li!==5&&li!==27&&li!==6)&&(Vt=null)):(Qe=null,Vt=He),Qe!==Vt)){if(li=Il,lt="onMouseLeave",Be="onMouseEnter",Pe="mouse",(i==="pointerout"||i==="pointerover")&&(li=_d,lt="onPointerLeave",Be="onPointerEnter",Pe="pointer"),wn=Qe==null?Xe:Ca(Qe),je=Vt==null?Xe:Ca(Vt),Xe=new li(lt,Pe+"leave",Qe,u,st),Xe.target=wn,Xe.relatedTarget=je,lt=null,za(st)===He&&(li=new li(Be,Pe+"enter",Vt,u,st),li.target=je,li.relatedTarget=wn,lt=li),wn=lt,Qe&&Vt)t:{for(li=Tm,Be=Qe,Pe=Vt,je=0,lt=Be;lt;lt=li(lt))je++;lt=0;for(var ei=Pe;ei;ei=li(ei))lt++;for(;0<je-lt;)Be=li(Be),je--;for(;0<lt-je;)Pe=li(Pe),lt--;for(;je--;){if(Be===Pe||Pe!==null&&Be===Pe.alternate){li=Be;break t}Be=li(Be),Pe=li(Pe)}li=null}else li=null;Qe!==null&&gp(ft,Xe,Qe,li,!1),Vt!==null&&wn!==null&&gp(ft,wn,Vt,li,!0)}}e:{if(Xe=He?Ca(He):window,Qe=Xe.nodeName&&Xe.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Xe.type==="file")var Ki=mo;else if(ph(Xe))if(gh)Ki=Sd;else{Ki=pu;var Xt=zf}else Qe=Xe.nodeName,!Qe||Qe.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?He&&ch(He.elementType)&&(Ki=mo):Ki=_h;if(Ki&&(Ki=Ki(i,He))){du(ft,Ki,u,st);break e}Xt&&Xt(i,Xe,He),i==="focusout"&&He&&Xe.type==="number"&&He.memoizedProps.value!=null&&ac(Xe,"number",Xe.value)}switch(Xt=He?Ca(He):window,i){case"focusin":(ph(Xt)||Xt.contentEditable==="true")&&(La=Xt,gc=He,Bi=null);break;case"focusout":Bi=gc=La=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,Td(ft,u,st);break;case"selectionchange":if(vh)break;case"keydown":case"keyup":Td(ft,u,st)}var Ci;if(Ra)e:{switch(i){case"compositionstart":var si="onCompositionStart";break e;case"compositionend":si="onCompositionEnd";break e;case"compositionupdate":si="onCompositionUpdate";break e}si=void 0}else Ba?Rl(i,u)&&(si="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(si="onCompositionStart");si&&(Ls&&u.locale!=="ko"&&(Ba||si!=="onCompositionStart"?si==="onCompositionEnd"&&Ba&&(Ci=Zo()):(Pa=st,Da="value"in Pa?Pa.value:Pa.textContent,Ba=!0)),Xt=Kh(He,si),0<Xt.length&&(si=new lc(si,i,null,u,st),ft.push({event:si,listeners:Xt}),Ci?si.data=Ci:(Ci=vd(u),Ci!==null&&(si.data=Ci)))),(Ci=dh?Mf(i,u):bd(i,u))&&(si=Kh(He,"onBeforeInput"),0<si.length&&(Xt=new lc("onBeforeInput","beforeinput",null,u,st),ft.push({event:Xt,listeners:si}),Xt.data=Ci)),xm(ft,i,He,u,st)}Sm(ft,s)})}function Ju(i,s,u){return{instance:i,listener:s,currentTarget:u}}function Kh(i,s){for(var u=s+"Capture",m=[];i!==null;){var E=i,C=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||C===null||(E=Cl(i,u),E!=null&&m.unshift(Ju(i,E,C)),E=Cl(i,s),E!=null&&m.push(Ju(i,E,C))),i.tag===3)return m;i=i.return}return[]}function Tm(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function gp(i,s,u,m,E){for(var C=s._reactName,Z=[];u!==null&&u!==m;){var te=u,Se=te.alternate,He=te.stateNode;if(te=te.tag,Se!==null&&Se===m)break;te!==5&&te!==26&&te!==27||He===null||(Se=He,E?(He=Cl(u,C),He!=null&&Z.unshift(Ju(u,He,Se))):E||(He=Cl(u,C),He!=null&&Z.push(Ju(u,He,Se)))),u=u.return}Z.length!==0&&i.push({event:s,listeners:Z})}var ef=/\r\n?/g,Em=/\u0000|\uFFFD/g;function eh(i){return(typeof i=="string"?i:""+i).replace(ef,`
`).replace(Em,"")}function _p(i,s){return s=eh(s),eh(i)===s}function ln(i,s,u,m,E,C){switch(u){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||Ps(i,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&Ps(i,""+m);break;case"className":El(i,"class",m);break;case"tabIndex":El(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":El(i,u,m);break;case"style":lh(i,m,C);break;case"data":if(s!=="object"){El(i,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||u!=="href")){i.removeAttribute(u);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(u);break}m=ni(""+m),i.setAttribute(u,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(u==="formAction"?(s!=="input"&&ln(i,s,"name",E.name,E,null),ln(i,s,"formEncType",E.formEncType,E,null),ln(i,s,"formMethod",E.formMethod,E,null),ln(i,s,"formTarget",E.formTarget,E,null)):(ln(i,s,"encType",E.encType,E,null),ln(i,s,"method",E.method,E,null),ln(i,s,"target",E.target,E,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(u);break}m=ni(""+m),i.setAttribute(u,m);break;case"onClick":m!=null&&(i.onclick=di);break;case"onScroll":m!=null&&Oi("scroll",i);break;case"onScrollEnd":m!=null&&Oi("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(S(61));if(u=m.__html,u!=null){if(E.children!=null)throw Error(S(60));i.innerHTML=u}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}u=ni(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(u,""+m):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":m===!0?i.setAttribute(u,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(u,m):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(u,m):i.removeAttribute(u);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(u):i.setAttribute(u,m);break;case"popover":Oi("beforetoggle",i),Oi("toggle",i),Cs(i,"popover",m);break;case"xlinkActuate":ls(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ls(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ls(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ls(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ls(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ls(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ls(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ls(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ls(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Cs(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Ds.get(u)||u,Cs(i,u,m))}}function tf(i,s,u,m,E,C){switch(u){case"style":lh(i,m,C);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(S(61));if(u=m.__html,u!=null){if(E.children!=null)throw Error(S(60));i.innerHTML=u}}break;case"children":typeof m=="string"?Ps(i,m):(typeof m=="number"||typeof m=="bigint")&&Ps(i,""+m);break;case"onScroll":m!=null&&Oi("scroll",i);break;case"onScrollEnd":m!=null&&Oi("scrollend",i);break;case"onClick":m!=null&&(i.onclick=di);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ir.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(E=u.endsWith("Capture"),s=u.slice(2,E?u.length-7:void 0),C=i[gt]||null,C=C!=null?C[u]:null,typeof C=="function"&&i.removeEventListener(s,C,E),typeof m=="function")){typeof C!="function"&&C!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(s,m,E);break e}u in i?i[u]=m:m===!0?i.setAttribute(u,""):Cs(i,u,m)}}}function fn(i,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Oi("error",i),Oi("load",i);var m=!1,E=!1,C;for(C in u)if(u.hasOwnProperty(C)){var Z=u[C];if(Z!=null)switch(C){case"src":m=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(S(137,s));default:ln(i,s,C,Z,u,null)}}E&&ln(i,s,"srcSet",u.srcSet,u,null),m&&ln(i,s,"src",u.src,u,null);return;case"input":Oi("invalid",i);var te=C=Z=E=null,Se=null,He=null;for(m in u)if(u.hasOwnProperty(m)){var st=u[m];if(st!=null)switch(m){case"name":E=st;break;case"type":Z=st;break;case"checked":Se=st;break;case"defaultChecked":He=st;break;case"value":C=st;break;case"defaultValue":te=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(S(137,s));break;default:ln(i,s,m,st,u,null)}}oh(i,C,te,Se,He,Z,E,!1);return;case"select":Oi("invalid",i),m=Z=C=null;for(E in u)if(u.hasOwnProperty(E)&&(te=u[E],te!=null))switch(E){case"value":C=te;break;case"defaultValue":Z=te;break;case"multiple":m=te;default:ln(i,s,E,te,u,null)}s=C,u=Z,i.multiple=!!m,s!=null?Is(i,!!m,s,!1):u!=null&&Is(i,!!m,u,!0);return;case"textarea":Oi("invalid",i),C=E=m=null;for(Z in u)if(u.hasOwnProperty(Z)&&(te=u[Z],te!=null))switch(Z){case"value":m=te;break;case"defaultValue":E=te;break;case"children":C=te;break;case"dangerouslySetInnerHTML":if(te!=null)throw Error(S(91));break;default:ln(i,s,Z,te,u,null)}Al(i,m,E,C);return;case"option":for(Se in u)if(u.hasOwnProperty(Se)&&(m=u[Se],m!=null))switch(Se){case"selected":i.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ln(i,s,Se,m,u,null)}return;case"dialog":Oi("beforetoggle",i),Oi("toggle",i),Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":Oi("load",i);break;case"video":case"audio":for(m=0;m<Wh.length;m++)Oi(Wh[m],i);break;case"image":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"embed":case"source":case"link":Oi("error",i),Oi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(He in u)if(u.hasOwnProperty(He)&&(m=u[He],m!=null))switch(He){case"children":case"dangerouslySetInnerHTML":throw Error(S(137,s));default:ln(i,s,He,m,u,null)}return;default:if(ch(s)){for(st in u)u.hasOwnProperty(st)&&(m=u[st],m!==void 0&&tf(i,s,st,m,u,void 0));return}}for(te in u)u.hasOwnProperty(te)&&(m=u[te],m!=null&&ln(i,s,te,m,u,null))}function th(i,s,u,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,C=null,Z=null,te=null,Se=null,He=null,st=null;for(Qe in u){var ft=u[Qe];if(u.hasOwnProperty(Qe)&&ft!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":Se=ft;default:m.hasOwnProperty(Qe)||ln(i,s,Qe,null,m,ft)}}for(var Xe in m){var Qe=m[Xe];if(ft=u[Xe],m.hasOwnProperty(Xe)&&(Qe!=null||ft!=null))switch(Xe){case"type":C=Qe;break;case"name":E=Qe;break;case"checked":He=Qe;break;case"defaultChecked":st=Qe;break;case"value":Z=Qe;break;case"defaultValue":te=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(S(137,s));break;default:Qe!==ft&&ln(i,s,Xe,Qe,m,ft)}}rc(i,Z,te,Se,He,st,C,E);return;case"select":Qe=Z=te=Xe=null;for(C in u)if(Se=u[C],u.hasOwnProperty(C)&&Se!=null)switch(C){case"value":break;case"multiple":Qe=Se;default:m.hasOwnProperty(C)||ln(i,s,C,null,m,Se)}for(E in m)if(C=m[E],Se=u[E],m.hasOwnProperty(E)&&(C!=null||Se!=null))switch(E){case"value":Xe=C;break;case"defaultValue":te=C;break;case"multiple":Z=C;default:C!==Se&&ln(i,s,E,C,m,Se)}s=te,u=Z,m=Qe,Xe!=null?Is(i,!!u,Xe,!1):!!m!=!!u&&(s!=null?Is(i,!!u,s,!0):Is(i,!!u,u?[]:"",!1));return;case"textarea":Qe=Xe=null;for(te in u)if(E=u[te],u.hasOwnProperty(te)&&E!=null&&!m.hasOwnProperty(te))switch(te){case"value":break;case"children":break;default:ln(i,s,te,null,m,E)}for(Z in m)if(E=m[Z],C=u[Z],m.hasOwnProperty(Z)&&(E!=null||C!=null))switch(Z){case"value":Xe=E;break;case"defaultValue":Qe=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(S(91));break;default:E!==C&&ln(i,s,Z,E,m,C)}Ml(i,Xe,Qe);return;case"option":for(var Vt in u)if(Xe=u[Vt],u.hasOwnProperty(Vt)&&Xe!=null&&!m.hasOwnProperty(Vt))switch(Vt){case"selected":i.selected=!1;break;default:ln(i,s,Vt,null,m,Xe)}for(Se in m)if(Xe=m[Se],Qe=u[Se],m.hasOwnProperty(Se)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(Se){case"selected":i.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:ln(i,s,Se,Xe,m,Qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var li in u)Xe=u[li],u.hasOwnProperty(li)&&Xe!=null&&!m.hasOwnProperty(li)&&ln(i,s,li,null,m,Xe);for(He in m)if(Xe=m[He],Qe=u[He],m.hasOwnProperty(He)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(He){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(S(137,s));break;default:ln(i,s,He,Xe,m,Qe)}return;default:if(ch(s)){for(var wn in u)Xe=u[wn],u.hasOwnProperty(wn)&&Xe!==void 0&&!m.hasOwnProperty(wn)&&tf(i,s,wn,void 0,m,Xe);for(st in m)Xe=m[st],Qe=u[st],!m.hasOwnProperty(st)||Xe===Qe||Xe===void 0&&Qe===void 0||tf(i,s,st,Xe,m,Qe);return}}for(var Be in u)Xe=u[Be],u.hasOwnProperty(Be)&&Xe!=null&&!m.hasOwnProperty(Be)&&ln(i,s,Be,null,m,Xe);for(ft in m)Xe=m[ft],Qe=u[ft],!m.hasOwnProperty(ft)||Xe===Qe||Xe==null&&Qe==null||ln(i,s,ft,Xe,m,Qe)}function ih(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Yc(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,u=performance.getEntriesByType("resource"),m=0;m<u.length;m++){var E=u[m],C=E.transferSize,Z=E.initiatorType,te=E.duration;if(C&&te&&ih(Z)){for(Z=0,te=E.responseEnd,m+=1;m<u.length;m++){var Se=u[m],He=Se.startTime;if(He>te)break;var st=Se.transferSize,ft=Se.initiatorType;st&&ih(ft)&&(Se=Se.responseEnd,Z+=st*(Se<te?1:(te-He)/(Se-He)))}if(--m,s+=8*(C+Z)/(E.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var nf=null,rf=null;function Qh(i){return i.nodeType===9?i:i.ownerDocument}function yp(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mm(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function af(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ro=null;function Am(){var i=window.event;return i&&i.type==="popstate"?i===Ro?!1:(Ro=i,!0):(Ro=null,!1)}var vp=typeof setTimeout=="function"?setTimeout:void 0,zm=typeof clearTimeout=="function"?clearTimeout:void 0,bp=typeof Promise=="function"?Promise:void 0,_g=typeof queueMicrotask=="function"?queueMicrotask:typeof bp<"u"?function(i){return bp.resolve(null).then(i).catch(yg)}:vp;function yg(i){setTimeout(function(){throw i})}function vl(i){return i==="head"}function xp(i,s){var u=s,m=0;do{var E=u.nextSibling;if(i.removeChild(u),E&&E.nodeType===8)if(u=E.data,u==="/$"||u==="/&"){if(m===0){i.removeChild(E),ma(s);return}m--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")m++;else if(u==="html")Wc(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Wc(u);for(var C=u.firstChild;C;){var Z=C.nextSibling,te=C.nodeName;C[ci]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&C.rel.toLowerCase()==="stylesheet"||u.removeChild(C),C=Z}}else u==="body"&&Wc(i.ownerDocument.body);u=E}while(u);ma(s)}function Jh(i,s){var u=i;i=0;do{var m=u.nextSibling;if(u.nodeType===1?s?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(s?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=m}while(u)}function sf(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":sf(u),Fo(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function of(i,s,u,m){for(;i.nodeType===1;){var E=u;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[ci])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==E.rel||i.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||i.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||i.getAttribute("title")!==(E.title==null?null:E.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(E.src==null?null:E.src)||i.getAttribute("type")!==(E.type==null?null:E.type)||i.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var C=E.name==null?null:""+E.name;if(E.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=sa(i.nextSibling),i===null)break}return null}function lf(i,s,u){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=sa(i.nextSibling),i===null))return null;return i}function ed(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=sa(i.nextSibling),i===null))return null;return i}function wp(i){return i.data==="$?"||i.data==="$~"}function Sp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function vg(i,s){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||u.readyState!=="loading")s();else{var m=function(){s(),u.removeEventListener("DOMContentLoaded",m)};u.addEventListener("DOMContentLoaded",m),i._reactRetry=m}}function sa(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var Tr=null;function cf(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(s===0)return sa(i.nextSibling);s--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||s++}i=i.nextSibling}return null}function Tp(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(s===0)return i;s--}else u!=="/$"&&u!=="/&"||s++}i=i.previousSibling}return null}function Ep(i,s,u){switch(s=Qh(u),i){case"html":if(i=s.documentElement,!i)throw Error(S(452));return i;case"head":if(i=s.head,!i)throw Error(S(453));return i;case"body":if(i=s.body,!i)throw Error(S(454));return i;default:throw Error(S(451))}}function Wc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Fo(i)}var Es=new Map,Mp=new Set;function td(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var bl=et.d;et.d={f:Cm,r:Ap,D:id,C:Cp,L:Im,m:Ip,X:nd,S:uf,M:Pp};function Cm(){var i=bl.f(),s=qd();return i||s}function Ap(i){var s=Xr(i);s!==null&&s.tag===5&&s.type==="form"?zo(s):bl.r(i)}var Kl=typeof document>"u"?null:document;function zp(i,s,u){var m=Kl;if(m&&typeof s=="string"&&s){var E=la(s);E='link[rel="'+i+'"][href="'+E+'"]',typeof u=="string"&&(E+='[crossorigin="'+u+'"]'),Mp.has(E)||(Mp.add(E),i={rel:i,crossOrigin:u,href:s},m.querySelector(E)===null&&(s=m.createElement("link"),fn(s,"link",i),Cn(s),m.head.appendChild(s)))}}function id(i){bl.D(i),zp("dns-prefetch",i,null)}function Cp(i,s){bl.C(i,s),zp("preconnect",i,s)}function Im(i,s,u){bl.L(i,s,u);var m=Kl;if(m&&i&&s){var E='link[rel="preload"][as="'+la(s)+'"]';s==="image"&&u&&u.imageSrcSet?(E+='[imagesrcset="'+la(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(E+='[imagesizes="'+la(u.imageSizes)+'"]')):E+='[href="'+la(i)+'"]';var C=E;switch(s){case"style":C=Ql(i);break;case"script":C=n(i)}Es.has(C)||(i=ce({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:i,as:s},u),Es.set(C,i),m.querySelector(E)!==null||s==="style"&&m.querySelector(rd(C))||s==="script"&&m.querySelector(o(C))||(s=m.createElement("link"),fn(s,"link",i),Cn(s),m.head.appendChild(s)))}}function Ip(i,s){bl.m(i,s);var u=Kl;if(u&&i){var m=s&&typeof s.as=="string"?s.as:"script",E='link[rel="modulepreload"][as="'+la(m)+'"][href="'+la(i)+'"]',C=E;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=n(i)}if(!Es.has(C)&&(i=ce({rel:"modulepreload",href:i},s),Es.set(C,i),u.querySelector(E)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(o(C)))return}m=u.createElement("link"),fn(m,"link",i),Cn(m),u.head.appendChild(m)}}}function uf(i,s,u){bl.S(i,s,u);var m=Kl;if(m&&i){var E=os(m).hoistableStyles,C=Ql(i);s=s||"default";var Z=E.get(C);if(!Z){var te={loading:0,preload:null};if(Z=m.querySelector(rd(C)))te.loading=5;else{i=ce({rel:"stylesheet",href:i,"data-precedence":s},u),(u=Es.get(C))&&v(i,u);var Se=Z=m.createElement("link");Cn(Se),fn(Se,"link",i),Se._p=new Promise(function(He,st){Se.onload=He,Se.onerror=st}),Se.addEventListener("load",function(){te.loading|=1}),Se.addEventListener("error",function(){te.loading|=2}),te.loading|=4,_(Z,s,m)}Z={type:"stylesheet",instance:Z,count:1,state:te},E.set(C,Z)}}}function nd(i,s){bl.X(i,s);var u=Kl;if(u&&i){var m=os(u).hoistableScripts,E=n(i),C=m.get(E);C||(C=u.querySelector(o(E)),C||(i=ce({src:i,async:!0},s),(s=Es.get(E))&&x(i,s),C=u.createElement("script"),Cn(C),fn(C,"link",i),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},m.set(E,C))}}function Pp(i,s){bl.M(i,s);var u=Kl;if(u&&i){var m=os(u).hoistableScripts,E=n(i),C=m.get(E);C||(C=u.querySelector(o(E)),C||(i=ce({src:i,async:!0,type:"module"},s),(s=Es.get(E))&&x(i,s),C=u.createElement("script"),Cn(C),fn(C,"link",i),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},m.set(E,C))}}function hf(i,s,u,m){var E=(E=Pt.current)?td(E):null;if(!E)throw Error(S(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=Ql(u.href),u=os(E).hoistableStyles,m=u.get(s),m||(m={type:"style",instance:null,count:0,state:null},u.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Ql(u.href);var C=os(E).hoistableStyles,Z=C.get(i);if(Z||(E=E.ownerDocument||E,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,Z),(C=E.querySelector(rd(i)))&&!C._p&&(Z.instance=C,Z.state.loading=5),Es.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Es.set(i,u),C||t(E,i,u,Z.state))),s&&m===null)throw Error(S(528,""));return Z}if(s&&m!==null)throw Error(S(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=n(u),u=os(E).hoistableScripts,m=u.get(s),m||(m={type:"script",instance:null,count:0,state:null},u.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(S(444,i))}}function Ql(i){return'href="'+la(i)+'"'}function rd(i){return'link[rel="stylesheet"]['+i+"]"}function r(i){return ce({},i,{"data-precedence":i.precedence,precedence:null})}function t(i,s,u,m){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=i.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),fn(s,"link",u),Cn(s),i.head.appendChild(s))}function n(i){return'[src="'+la(i)+'"]'}function o(i){return"script[async]"+i}function d(i,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var m=i.querySelector('style[data-href~="'+la(u.href)+'"]');if(m)return s.instance=m,Cn(m),m;var E=ce({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),Cn(m),fn(m,"style",E),_(m,u.precedence,i),s.instance=m;case"stylesheet":E=Ql(u.href);var C=i.querySelector(rd(E));if(C)return s.state.loading|=4,s.instance=C,Cn(C),C;m=r(u),(E=Es.get(E))&&v(m,E),C=(i.ownerDocument||i).createElement("link"),Cn(C);var Z=C;return Z._p=new Promise(function(te,Se){Z.onload=te,Z.onerror=Se}),fn(C,"link",m),s.state.loading|=4,_(C,u.precedence,i),s.instance=C;case"script":return C=n(u.src),(E=i.querySelector(o(C)))?(s.instance=E,Cn(E),E):(m=u,(E=Es.get(C))&&(m=ce({},u),x(m,E)),i=i.ownerDocument||i,E=i.createElement("script"),Cn(E),fn(E,"link",m),i.head.appendChild(E),s.instance=E);case"void":return null;default:throw Error(S(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,_(m,u.precedence,i));return s.instance}function _(i,s,u){for(var m=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=m.length?m[m.length-1]:null,C=E,Z=0;Z<m.length;Z++){var te=m[Z];if(te.dataset.precedence===s)C=te;else if(C!==E)break}C?C.parentNode.insertBefore(i,C.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(i,s.firstChild))}function v(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function x(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var T=null;function I(i,s,u){if(T===null){var m=new Map,E=T=new Map;E.set(u,m)}else E=T,m=E.get(u),m||(m=new Map,E.set(u,m));if(m.has(i))return m;for(m.set(i,null),u=u.getElementsByTagName(i),E=0;E<u.length;E++){var C=u[E];if(!(C[ci]||C[Ni]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=C.getAttribute(s)||"";Z=i+Z;var te=m.get(Z);te?te.push(C):m.set(Z,[C])}}return m}function D(i,s,u){i=i.ownerDocument||i,i.head.insertBefore(u,s==="title"?i.querySelector("head > title"):null)}function B(i,s,u){if(u===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function V(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function X(i,s,u,m){if(u.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var E=Ql(m.href),C=s.querySelector(rd(E));if(C){s=C._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=ne.bind(i),s.then(i,i)),u.state.loading|=4,u.instance=C,Cn(C);return}C=s.ownerDocument||s,m=r(m),(E=Es.get(E))&&v(m,E),C=C.createElement("link"),Cn(C);var Z=C;Z._p=new Promise(function(te,Se){Z.onload=te,Z.onerror=Se}),fn(C,"link",m),u.instance=C}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,s),(s=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=ne.bind(i),s.addEventListener("load",u),s.addEventListener("error",u))}}var W=0;function J(i,s){return i.stylesheets&&i.count===0&&Ce(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var m=setTimeout(function(){if(i.stylesheets&&Ce(i,i.stylesheets),i.unsuspend){var C=i.unsuspend;i.unsuspend=null,C()}},6e4+s);0<i.imgBytes&&W===0&&(W=62500*Yc());var E=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Ce(i,i.stylesheets),i.unsuspend)){var C=i.unsuspend;i.unsuspend=null,C()}},(i.imgBytes>W?50:800)+s);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(m),clearTimeout(E)}}:null}function ne(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ce(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ue=null;function Ce(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ue=new Map,s.forEach(_e,i),ue=null,ne.call(i))}function _e(i,s){if(!(s.state.loading&4)){var u=ue.get(i);if(u)var m=u.get(null);else{u=new Map,ue.set(i,u);for(var E=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<E.length;C++){var Z=E[C];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(u.set(Z.dataset.precedence,Z),m=Z)}m&&u.set(null,m)}E=s.instance,Z=E.getAttribute("data-precedence"),C=u.get(Z)||m,C===m&&u.set(null,E),u.set(Z,E),this.count++,m=ne.bind(this),E.addEventListener("load",m),E.addEventListener("error",m),C?C.parentNode.insertBefore(E,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(E,i.firstChild)),s.state.loading|=4}}var xe={$$typeof:Le,Provider:null,Consumer:null,_currentValue:it,_currentValue2:it,_threadCount:0};function Fe(i,s,u,m,E,C,Z,te,Se){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yi(0),this.hiddenUpdates=Yi(null),this.identifierPrefix=m,this.onUncaughtError=E,this.onCaughtError=C,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Se,this.incompleteTransitions=new Map}function We(i,s,u,m,E,C,Z,te,Se,He,st,ft){return i=new Fe(i,s,u,Z,Se,He,st,ft,te),s=1,C===!0&&(s|=24),C=va(3,null,null,s),i.current=C,C.stateNode=i,s=Au(),s.refCount++,i.pooledCache=s,s.refCount++,C.memoizedState={element:m,isDehydrated:u,cache:s},Ch(C),i}function ut(i){return i?(i=pi,i):pi}function At(i,s,u,m,E,C){E=ut(E),m.context===null?m.context=E:m.pendingContext=E,m=Li(s),m.payload={element:u},C=C===void 0?null:C,C!==null&&(m.callback=C),u=Hs(i,m,s),u!==null&&(Aa(u,i,s),Xs(u,i,s))}function xt(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<s?u:s}}function Et(i,s){xt(i,s),(i=i.alternate)&&xt(i,s)}function Ut(i){if(i.tag===13||i.tag===31){var s=Oa(i,67108864);s!==null&&Aa(s,i,67108864),Et(i,67108864)}}function Mt(i){if(i.tag===13||i.tag===31){var s=Ma();s=Vn(s);var u=Oa(i,s);u!==null&&Aa(u,i,s),Et(i,s)}}var Tt=!0;function rt(i,s,u,m){var E=Ue.T;Ue.T=null;var C=et.p;try{et.p=2,ti(i,s,u,m)}finally{et.p=C,Ue.T=E}}function Jt(i,s,u,m){var E=Ue.T;Ue.T=null;var C=et.p;try{et.p=8,ti(i,s,u,m)}finally{et.p=C,Ue.T=E}}function ti(i,s,u,m){if(Tt){var E=Zt(m);if(E===null)Jd(i,s,m,Lt,u),Mr(i,m);else if(as(E,i,s,u,m))m.stopPropagation();else if(Mr(i,m),s&4&&-1<Fr.indexOf(i)){for(;E!==null;){var C=Xr(E);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var Z=De(C.pendingLanes);if(Z!==0){var te=C;for(te.pendingLanes|=2,te.entangledLanes|=2;Z;){var Se=1<<31-we(Z);te.entanglements[1]|=Se,Z&=~Se}aa(C),($i&6)===0&&(Zd=Ei()+500,Ku(0))}}break;case 31:case 13:te=Oa(C,2),te!==null&&Aa(te,C,2),qd(),Et(C,2)}if(C=Zt(m),C===null&&Jd(i,s,m,Lt,u),C===E)break;E=C}E!==null&&m.stopPropagation()}else Jd(i,s,m,null,u)}}function Zt(i){return i=Ia(i),Mi(i)}var Lt=null;function Mi(i){if(Lt=null,i=za(i),i!==null){var s=G(i);if(s===null)i=null;else{var u=s.tag;if(u===13){if(i=z(s),i!==null)return i;i=null}else if(u===31){if(i=c(s),i!==null)return i;i=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Lt=i,null}function kn(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(mn()){case Ui:return 2;case ee:return 8;case O:case U:return 32;case q:return 268435456;default:return 32}default:return 32}}var Wn=!1,On=null,Er=null,lr=null,Kn=new Map,cn=new Map,zn=[],Fr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mr(i,s){switch(i){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":lr=null;break;case"pointerover":case"pointerout":Kn.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":cn.delete(s.pointerId)}}function Ar(i,s,u,m,E,C){return i===null||i.nativeEvent!==C?(i={blockedOn:s,domEventName:u,eventSystemFlags:m,nativeEvent:C,targetContainers:[E]},s!==null&&(s=Xr(s),s!==null&&Ut(s)),i):(i.eventSystemFlags|=m,s=i.targetContainers,E!==null&&s.indexOf(E)===-1&&s.push(E),i)}function as(i,s,u,m,E){switch(s){case"focusin":return On=Ar(On,i,s,u,m,E),!0;case"dragenter":return Er=Ar(Er,i,s,u,m,E),!0;case"mouseover":return lr=Ar(lr,i,s,u,m,E),!0;case"pointerover":var C=E.pointerId;return Kn.set(C,Ar(Kn.get(C)||null,i,s,u,m,E)),!0;case"gotpointercapture":return C=E.pointerId,cn.set(C,Ar(cn.get(C)||null,i,s,u,m,E)),!0}return!1}function mr(i){var s=za(i.target);if(s!==null){var u=G(s);if(u!==null){if(s=u.tag,s===13){if(s=z(u),s!==null){i.blockedOn=s,jr(i.priority,function(){Mt(u)});return}}else if(s===31){if(s=c(u),s!==null){i.blockedOn=s,jr(i.priority,function(){Mt(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Hr(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var u=Zt(i.nativeEvent);if(u===null){u=i.nativeEvent;var m=new u.constructor(u.type,u);uo=m,u.target.dispatchEvent(m),uo=null}else return s=Xr(u),s!==null&&Ut(s),i.blockedOn=u,!1;s.shift()}return!0}function cr(i,s,u){Hr(i)&&u.delete(s)}function zr(){Wn=!1,On!==null&&Hr(On)&&(On=null),Er!==null&&Hr(Er)&&(Er=null),lr!==null&&Hr(lr)&&(lr=null),Kn.forEach(cr),cn.forEach(cr)}function Qn(i,s){i.blockedOn===s&&(i.blockedOn=null,Wn||(Wn=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,zr)))}var Fn=null;function pn(i){Fn!==i&&(Fn=i,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){Fn===i&&(Fn=null);for(var s=0;s<i.length;s+=3){var u=i[s],m=i[s+1],E=i[s+2];if(typeof m!="function"){if(Mi(m||u)===null)continue;break}var C=Xr(u);C!==null&&(i.splice(s,3),s-=3,Ks(C,{pending:!0,data:E,method:u.method,action:m},m,E))}}))}function ma(i){function s(Se){return Qn(Se,i)}On!==null&&Qn(On,i),Er!==null&&Qn(Er,i),lr!==null&&Qn(lr,i),Kn.forEach(s),cn.forEach(s);for(var u=0;u<zn.length;u++){var m=zn[u];m.blockedOn===i&&(m.blockedOn=null)}for(;0<zn.length&&(u=zn[0],u.blockedOn===null);)mr(u),u.blockedOn===null&&zn.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(m=0;m<u.length;m+=3){var E=u[m],C=u[m+1],Z=E[gt]||null;if(typeof C=="function")Z||pn(u);else if(Z){var te=null;if(C&&C.hasAttribute("formAction")){if(E=C,Z=C[gt]||null)te=Z.formAction;else if(Mi(E)!==null)continue}else te=Z.action;typeof te=="function"?u[m+1]=te:(u.splice(m,3),m-=3),pn(u)}}}function Kc(){function i(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(Z){return E=Z})},focusReset:"manual",scroll:"manual"})}function s(){E!==null&&(E(),E=null),m||setTimeout(u,20)}function u(){if(!m&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,E=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(u,100),function(){m=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),E!==null&&(E(),E=null)}}}function ss(i){this._internalRoot=i}df.prototype.render=ss.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(S(409));var u=s.current,m=Ma();At(u,m,i,s,null,null)},df.prototype.unmount=ss.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;At(i.current,2,null,i,null,null),qd(),s[ai]=null}};function df(i){this._internalRoot=i}df.prototype.unstable_scheduleHydration=function(i){if(i){var s=Rn();i={blockedOn:null,target:i,priority:s};for(var u=0;u<zn.length&&s!==0&&s<zn[u].priority;u++);zn.splice(u,0,i),u===0&&mr(i)}};var Qc=y.version;if(Qc!=="19.2.0")throw Error(S(527,Qc,"19.2.0"));et.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(S(188)):(i=Object.keys(i).join(","),Error(S(268,i)));return i=$(s),i=i!==null?oe(i):null,i=i===null?null:i.stateNode,i};var Jc={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Ue,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{H=xl.inject(Jc),ae=xl}catch{}}return kp.createRoot=function(i,s){if(!P(i))throw Error(S(299));var u=!1,m="",E=eo,C=Bc,Z=Xp;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(E=s.onUncaughtError),s.onCaughtError!==void 0&&(C=s.onCaughtError),s.onRecoverableError!==void 0&&(Z=s.onRecoverableError)),s=We(i,1,!1,null,null,u,m,null,E,C,Z,Kc),i[ai]=s.current,ko(i),new ss(s)},kp.hydrateRoot=function(i,s,u){if(!P(i))throw Error(S(299));var m=!1,E="",C=eo,Z=Bc,te=Xp,Se=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(E=u.identifierPrefix),u.onUncaughtError!==void 0&&(C=u.onUncaughtError),u.onCaughtError!==void 0&&(Z=u.onCaughtError),u.onRecoverableError!==void 0&&(te=u.onRecoverableError),u.formState!==void 0&&(Se=u.formState)),s=We(i,1,!0,s,u??null,m,E,Se,C,Z,te,Kc),s.context=ut(null),u=s.current,m=Ma(),m=Vn(m),E=Li(m),E.callback=null,Hs(u,E,m),u=m,s.current.lanes=u,gn(s,u),aa(s),i[ai]=s.current,ko(i),new df(s)},kp.version="19.2.0",kp}var P_;function Q0(){if(P_)return wg.exports;P_=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(y){console.error(y)}}return h(),wg.exports=K0(),wg.exports}var J0=Q0();function D_(h,y){if(typeof h=="function")return h(y);h!=null&&(h.current=y)}function ev(...h){return y=>{let w=!1;const S=h.map(P=>{const G=D_(P,y);return!w&&typeof G=="function"&&(w=!0),G});if(w)return()=>{for(let P=0;P<S.length;P++){const G=S[P];typeof G=="function"?G():D_(h[P],null)}}}}var tv=Symbol.for("react.lazy"),Hm=$0[" use ".trim().toString()];function iv(h){return typeof h=="object"&&h!==null&&"then"in h}function Fy(h){return h!=null&&typeof h=="object"&&"$$typeof"in h&&h.$$typeof===tv&&"_payload"in h&&iv(h._payload)}function nv(h){const y=av(h),w=Hi.forwardRef((S,P)=>{let{children:G,...z}=S;Fy(G)&&typeof Hm=="function"&&(G=Hm(G._payload));const c=Hi.Children.toArray(G),K=c.find(ov);if(K){const $=K.props.children,oe=c.map(ce=>ce===K?Hi.Children.count($)>1?Hi.Children.only(null):Hi.isValidElement($)?$.props.children:null:ce);return Ct.jsx(y,{...z,ref:P,children:Hi.isValidElement($)?Hi.cloneElement($,void 0,oe):null})}return Ct.jsx(y,{...z,ref:P,children:G})});return w.displayName=`${h}.Slot`,w}var rv=nv("Slot");function av(h){const y=Hi.forwardRef((w,S)=>{let{children:P,...G}=w;if(Fy(P)&&typeof Hm=="function"&&(P=Hm(P._payload)),Hi.isValidElement(P)){const z=cv(P),c=lv(G,P.props);return P.type!==Hi.Fragment&&(c.ref=S?ev(S,z):z),Hi.cloneElement(P,c)}return Hi.Children.count(P)>1?Hi.Children.only(null):null});return y.displayName=`${h}.SlotClone`,y}var sv=Symbol("radix.slottable");function ov(h){return Hi.isValidElement(h)&&typeof h.type=="function"&&"__radixId"in h.type&&h.type.__radixId===sv}function lv(h,y){const w={...y};for(const S in y){const P=h[S],G=y[S];/^on[A-Z]/.test(S)?P&&G?w[S]=(...c)=>{const K=G(...c);return P(...c),K}:P&&(w[S]=P):S==="style"?w[S]={...P,...G}:S==="className"&&(w[S]=[P,G].filter(Boolean).join(" "))}return{...h,...w}}function cv(h){let y=Object.getOwnPropertyDescriptor(h.props,"ref")?.get,w=y&&"isReactWarning"in y&&y.isReactWarning;return w?h.ref:(y=Object.getOwnPropertyDescriptor(h,"ref")?.get,w=y&&"isReactWarning"in y&&y.isReactWarning,w?h.props.ref:h.props.ref||h.ref)}function jy(h){var y,w,S="";if(typeof h=="string"||typeof h=="number")S+=h;else if(typeof h=="object")if(Array.isArray(h)){var P=h.length;for(y=0;y<P;y++)h[y]&&(w=jy(h[y]))&&(S&&(S+=" "),S+=w)}else for(w in h)h[w]&&(S&&(S+=" "),S+=w);return S}function Uy(){for(var h,y,w=0,S="",P=arguments.length;w<P;w++)(h=arguments[w])&&(y=jy(h))&&(S&&(S+=" "),S+=y);return S}const k_=h=>typeof h=="boolean"?`${h}`:h===0?"0":h,R_=Uy,Ny=(h,y)=>w=>{var S;if(y?.variants==null)return R_(h,w?.class,w?.className);const{variants:P,defaultVariants:G}=y,z=Object.keys(P).map($=>{const oe=w?.[$],ce=G?.[$];if(oe===null)return null;const ge=k_(oe)||k_(ce);return P[$][ge]}),c=w&&Object.entries(w).reduce(($,oe)=>{let[ce,ge]=oe;return ge===void 0||($[ce]=ge),$},{}),K=y==null||(S=y.compoundVariants)===null||S===void 0?void 0:S.reduce(($,oe)=>{let{class:ce,className:ge,...Me}=oe;return Object.entries(Me).every(Ae=>{let[ie,Ve]=Ae;return Array.isArray(Ve)?Ve.includes({...G,...c}[ie]):{...G,...c}[ie]===Ve})?[...$,ce,ge]:$},[]);return R_(h,z,K,w?.class,w?.className)},l_="-",uv=h=>{const y=dv(h),{conflictingClassGroups:w,conflictingClassGroupModifiers:S}=h;return{getClassGroupId:z=>{const c=z.split(l_);return c[0]===""&&c.length!==1&&c.shift(),Zy(c,y)||hv(z)},getConflictingClassGroupIds:(z,c)=>{const K=w[z]||[];return c&&S[z]?[...K,...S[z]]:K}}},Zy=(h,y)=>{if(h.length===0)return y.classGroupId;const w=h[0],S=y.nextPart.get(w),P=S?Zy(h.slice(1),S):void 0;if(P)return P;if(y.validators.length===0)return;const G=h.join(l_);return y.validators.find(({validator:z})=>z(G))?.classGroupId},B_=/^\[(.+)\]$/,hv=h=>{if(B_.test(h)){const y=B_.exec(h)[1],w=y?.substring(0,y.indexOf(":"));if(w)return"arbitrary.."+w}},dv=h=>{const{theme:y,classGroups:w}=h,S={nextPart:new Map,validators:[]};for(const P in w)Hg(w[P],S,P,y);return S},Hg=(h,y,w,S)=>{h.forEach(P=>{if(typeof P=="string"){const G=P===""?y:L_(y,P);G.classGroupId=w;return}if(typeof P=="function"){if(fv(P)){Hg(P(S),y,w,S);return}y.validators.push({validator:P,classGroupId:w});return}Object.entries(P).forEach(([G,z])=>{Hg(z,L_(y,G),w,S)})})},L_=(h,y)=>{let w=h;return y.split(l_).forEach(S=>{w.nextPart.has(S)||w.nextPart.set(S,{nextPart:new Map,validators:[]}),w=w.nextPart.get(S)}),w},fv=h=>h.isThemeGetter,pv=h=>{if(h<1)return{get:()=>{},set:()=>{}};let y=0,w=new Map,S=new Map;const P=(G,z)=>{w.set(G,z),y++,y>h&&(y=0,S=w,w=new Map)};return{get(G){let z=w.get(G);if(z!==void 0)return z;if((z=S.get(G))!==void 0)return P(G,z),z},set(G,z){w.has(G)?w.set(G,z):P(G,z)}}},Xg="!",Yg=":",mv=Yg.length,gv=h=>{const{prefix:y,experimentalParseClassName:w}=h;let S=P=>{const G=[];let z=0,c=0,K=0,$;for(let Ae=0;Ae<P.length;Ae++){let ie=P[Ae];if(z===0&&c===0){if(ie===Yg){G.push(P.slice(K,Ae)),K=Ae+mv;continue}if(ie==="/"){$=Ae;continue}}ie==="["?z++:ie==="]"?z--:ie==="("?c++:ie===")"&&c--}const oe=G.length===0?P:P.substring(K),ce=_v(oe),ge=ce!==oe,Me=$&&$>K?$-K:void 0;return{modifiers:G,hasImportantModifier:ge,baseClassName:ce,maybePostfixModifierPosition:Me}};if(y){const P=y+Yg,G=S;S=z=>z.startsWith(P)?G(z.substring(P.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:z,maybePostfixModifierPosition:void 0}}if(w){const P=S;S=G=>w({className:G,parseClassName:P})}return S},_v=h=>h.endsWith(Xg)?h.substring(0,h.length-1):h.startsWith(Xg)?h.substring(1):h,yv=h=>{const y=Object.fromEntries(h.orderSensitiveModifiers.map(S=>[S,!0]));return S=>{if(S.length<=1)return S;const P=[];let G=[];return S.forEach(z=>{z[0]==="["||y[z]?(P.push(...G.sort(),z),G=[]):G.push(z)}),P.push(...G.sort()),P}},vv=h=>({cache:pv(h.cacheSize),parseClassName:gv(h),sortModifiers:yv(h),...uv(h)}),bv=/\s+/,xv=(h,y)=>{const{parseClassName:w,getClassGroupId:S,getConflictingClassGroupIds:P,sortModifiers:G}=y,z=[],c=h.trim().split(bv);let K="";for(let $=c.length-1;$>=0;$-=1){const oe=c[$],{isExternal:ce,modifiers:ge,hasImportantModifier:Me,baseClassName:Ae,maybePostfixModifierPosition:ie}=w(oe);if(ce){K=oe+(K.length>0?" "+K:K);continue}let Ve=!!ie,ot=S(Ve?Ae.substring(0,ie):Ae);if(!ot){if(!Ve){K=oe+(K.length>0?" "+K:K);continue}if(ot=S(Ae),!ot){K=oe+(K.length>0?" "+K:K);continue}Ve=!1}const Ye=G(ge).join(":"),Le=Me?Ye+Xg:Ye,Ke=Le+ot;if(z.includes(Ke))continue;z.push(Ke);const _t=P(ot,Ve);for(let ht=0;ht<_t.length;++ht){const St=_t[ht];z.push(Le+St)}K=oe+(K.length>0?" "+K:K)}return K};function wv(){let h=0,y,w,S="";for(;h<arguments.length;)(y=arguments[h++])&&(w=Vy(y))&&(S&&(S+=" "),S+=w);return S}const Vy=h=>{if(typeof h=="string")return h;let y,w="";for(let S=0;S<h.length;S++)h[S]&&(y=Vy(h[S]))&&(w&&(w+=" "),w+=y);return w};function Sv(h,...y){let w,S,P,G=z;function z(K){const $=y.reduce((oe,ce)=>ce(oe),h());return w=vv($),S=w.cache.get,P=w.cache.set,G=c,c(K)}function c(K){const $=S(K);if($)return $;const oe=xv(K,w);return P(K,oe),oe}return function(){return G(wv.apply(null,arguments))}}const oa=h=>{const y=w=>w[h]||[];return y.isThemeGetter=!0,y},Gy=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,qy=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Tv=/^\d+\/\d+$/,Ev=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Mv=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Av=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,zv=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Cv=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ff=h=>Tv.test(h),Fi=h=>!!h&&!Number.isNaN(Number(h)),nh=h=>!!h&&Number.isInteger(Number(h)),Mg=h=>h.endsWith("%")&&Fi(h.slice(0,-1)),eu=h=>Ev.test(h),Iv=()=>!0,Pv=h=>Mv.test(h)&&!Av.test(h),$y=()=>!1,Dv=h=>zv.test(h),kv=h=>Cv.test(h),Rv=h=>!$t(h)&&!Ht(h),Bv=h=>Sf(h,Yy,$y),$t=h=>Gy.test(h),sd=h=>Sf(h,Wy,Pv),Ag=h=>Sf(h,Uv,Fi),O_=h=>Sf(h,Hy,$y),Lv=h=>Sf(h,Xy,kv),Pm=h=>Sf(h,Ky,Dv),Ht=h=>qy.test(h),Rp=h=>Tf(h,Wy),Ov=h=>Tf(h,Nv),F_=h=>Tf(h,Hy),Fv=h=>Tf(h,Yy),jv=h=>Tf(h,Xy),Dm=h=>Tf(h,Ky,!0),Sf=(h,y,w)=>{const S=Gy.exec(h);return S?S[1]?y(S[1]):w(S[2]):!1},Tf=(h,y,w=!1)=>{const S=qy.exec(h);return S?S[1]?y(S[1]):w:!1},Hy=h=>h==="position"||h==="percentage",Xy=h=>h==="image"||h==="url",Yy=h=>h==="length"||h==="size"||h==="bg-size",Wy=h=>h==="length",Uv=h=>h==="number",Nv=h=>h==="family-name",Ky=h=>h==="shadow",Zv=()=>{const h=oa("color"),y=oa("font"),w=oa("text"),S=oa("font-weight"),P=oa("tracking"),G=oa("leading"),z=oa("breakpoint"),c=oa("container"),K=oa("spacing"),$=oa("radius"),oe=oa("shadow"),ce=oa("inset-shadow"),ge=oa("text-shadow"),Me=oa("drop-shadow"),Ae=oa("blur"),ie=oa("perspective"),Ve=oa("aspect"),ot=oa("ease"),Ye=oa("animate"),Le=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ke=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],_t=()=>[...Ke(),Ht,$t],ht=()=>["auto","hidden","clip","visible","scroll"],St=()=>["auto","contain","none"],be=()=>[Ht,$t,K],Ie=()=>[ff,"full","auto",...be()],tt=()=>[nh,"none","subgrid",Ht,$t],bt=()=>["auto",{span:["full",nh,Ht,$t]},nh,Ht,$t],wt=()=>[nh,"auto",Ht,$t],Wt=()=>["auto","min","max","fr",Ht,$t],vi=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Si=()=>["start","end","center","stretch","center-safe","end-safe"],Ue=()=>["auto",...be()],et=()=>[ff,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...be()],it=()=>[h,Ht,$t],dt=()=>[...Ke(),F_,O_,{position:[Ht,$t]}],Kt=()=>["no-repeat",{repeat:["","x","y","space","round"]}],fe=()=>["auto","cover","contain",Fv,Bv,{size:[Ht,$t]}],Re=()=>[Mg,Rp,sd],Ze=()=>["","none","full",$,Ht,$t],mt=()=>["",Fi,Rp,sd],It=()=>["solid","dashed","dotted","double"],Pt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Rt=()=>[Fi,Mg,F_,O_],Dt=()=>["","none",Ae,Ht,$t],Bt=()=>["none",Fi,Ht,$t],bi=()=>["none",Fi,Ht,$t],Qt=()=>[Fi,Ht,$t],ri=()=>[ff,"full",...be()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[eu],breakpoint:[eu],color:[Iv],container:[eu],"drop-shadow":[eu],ease:["in","out","in-out"],font:[Rv],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[eu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[eu],shadow:[eu],spacing:["px",Fi],text:[eu],"text-shadow":[eu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ff,$t,Ht,Ve]}],container:["container"],columns:[{columns:[Fi,$t,Ht,c]}],"break-after":[{"break-after":Le()}],"break-before":[{"break-before":Le()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:_t()}],overflow:[{overflow:ht()}],"overflow-x":[{"overflow-x":ht()}],"overflow-y":[{"overflow-y":ht()}],overscroll:[{overscroll:St()}],"overscroll-x":[{"overscroll-x":St()}],"overscroll-y":[{"overscroll-y":St()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Ie()}],"inset-x":[{"inset-x":Ie()}],"inset-y":[{"inset-y":Ie()}],start:[{start:Ie()}],end:[{end:Ie()}],top:[{top:Ie()}],right:[{right:Ie()}],bottom:[{bottom:Ie()}],left:[{left:Ie()}],visibility:["visible","invisible","collapse"],z:[{z:[nh,"auto",Ht,$t]}],basis:[{basis:[ff,"full","auto",c,...be()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fi,ff,"auto","initial","none",$t]}],grow:[{grow:["",Fi,Ht,$t]}],shrink:[{shrink:["",Fi,Ht,$t]}],order:[{order:[nh,"first","last","none",Ht,$t]}],"grid-cols":[{"grid-cols":tt()}],"col-start-end":[{col:bt()}],"col-start":[{"col-start":wt()}],"col-end":[{"col-end":wt()}],"grid-rows":[{"grid-rows":tt()}],"row-start-end":[{row:bt()}],"row-start":[{"row-start":wt()}],"row-end":[{"row-end":wt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Wt()}],"auto-rows":[{"auto-rows":Wt()}],gap:[{gap:be()}],"gap-x":[{"gap-x":be()}],"gap-y":[{"gap-y":be()}],"justify-content":[{justify:[...vi(),"normal"]}],"justify-items":[{"justify-items":[...Si(),"normal"]}],"justify-self":[{"justify-self":["auto",...Si()]}],"align-content":[{content:["normal",...vi()]}],"align-items":[{items:[...Si(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Si(),{baseline:["","last"]}]}],"place-content":[{"place-content":vi()}],"place-items":[{"place-items":[...Si(),"baseline"]}],"place-self":[{"place-self":["auto",...Si()]}],p:[{p:be()}],px:[{px:be()}],py:[{py:be()}],ps:[{ps:be()}],pe:[{pe:be()}],pt:[{pt:be()}],pr:[{pr:be()}],pb:[{pb:be()}],pl:[{pl:be()}],m:[{m:Ue()}],mx:[{mx:Ue()}],my:[{my:Ue()}],ms:[{ms:Ue()}],me:[{me:Ue()}],mt:[{mt:Ue()}],mr:[{mr:Ue()}],mb:[{mb:Ue()}],ml:[{ml:Ue()}],"space-x":[{"space-x":be()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":be()}],"space-y-reverse":["space-y-reverse"],size:[{size:et()}],w:[{w:[c,"screen",...et()]}],"min-w":[{"min-w":[c,"screen","none",...et()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[z]},...et()]}],h:[{h:["screen","lh",...et()]}],"min-h":[{"min-h":["screen","lh","none",...et()]}],"max-h":[{"max-h":["screen","lh",...et()]}],"font-size":[{text:["base",w,Rp,sd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[S,Ht,Ag]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Mg,$t]}],"font-family":[{font:[Ov,$t,y]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[P,Ht,$t]}],"line-clamp":[{"line-clamp":[Fi,"none",Ht,Ag]}],leading:[{leading:[G,...be()]}],"list-image":[{"list-image":["none",Ht,$t]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ht,$t]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:it()}],"text-color":[{text:it()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...It(),"wavy"]}],"text-decoration-thickness":[{decoration:[Fi,"from-font","auto",Ht,sd]}],"text-decoration-color":[{decoration:it()}],"underline-offset":[{"underline-offset":[Fi,"auto",Ht,$t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:be()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ht,$t]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ht,$t]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:dt()}],"bg-repeat":[{bg:Kt()}],"bg-size":[{bg:fe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},nh,Ht,$t],radial:["",Ht,$t],conic:[nh,Ht,$t]},jv,Lv]}],"bg-color":[{bg:it()}],"gradient-from-pos":[{from:Re()}],"gradient-via-pos":[{via:Re()}],"gradient-to-pos":[{to:Re()}],"gradient-from":[{from:it()}],"gradient-via":[{via:it()}],"gradient-to":[{to:it()}],rounded:[{rounded:Ze()}],"rounded-s":[{"rounded-s":Ze()}],"rounded-e":[{"rounded-e":Ze()}],"rounded-t":[{"rounded-t":Ze()}],"rounded-r":[{"rounded-r":Ze()}],"rounded-b":[{"rounded-b":Ze()}],"rounded-l":[{"rounded-l":Ze()}],"rounded-ss":[{"rounded-ss":Ze()}],"rounded-se":[{"rounded-se":Ze()}],"rounded-ee":[{"rounded-ee":Ze()}],"rounded-es":[{"rounded-es":Ze()}],"rounded-tl":[{"rounded-tl":Ze()}],"rounded-tr":[{"rounded-tr":Ze()}],"rounded-br":[{"rounded-br":Ze()}],"rounded-bl":[{"rounded-bl":Ze()}],"border-w":[{border:mt()}],"border-w-x":[{"border-x":mt()}],"border-w-y":[{"border-y":mt()}],"border-w-s":[{"border-s":mt()}],"border-w-e":[{"border-e":mt()}],"border-w-t":[{"border-t":mt()}],"border-w-r":[{"border-r":mt()}],"border-w-b":[{"border-b":mt()}],"border-w-l":[{"border-l":mt()}],"divide-x":[{"divide-x":mt()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":mt()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...It(),"hidden","none"]}],"divide-style":[{divide:[...It(),"hidden","none"]}],"border-color":[{border:it()}],"border-color-x":[{"border-x":it()}],"border-color-y":[{"border-y":it()}],"border-color-s":[{"border-s":it()}],"border-color-e":[{"border-e":it()}],"border-color-t":[{"border-t":it()}],"border-color-r":[{"border-r":it()}],"border-color-b":[{"border-b":it()}],"border-color-l":[{"border-l":it()}],"divide-color":[{divide:it()}],"outline-style":[{outline:[...It(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Fi,Ht,$t]}],"outline-w":[{outline:["",Fi,Rp,sd]}],"outline-color":[{outline:it()}],shadow:[{shadow:["","none",oe,Dm,Pm]}],"shadow-color":[{shadow:it()}],"inset-shadow":[{"inset-shadow":["none",ce,Dm,Pm]}],"inset-shadow-color":[{"inset-shadow":it()}],"ring-w":[{ring:mt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:it()}],"ring-offset-w":[{"ring-offset":[Fi,sd]}],"ring-offset-color":[{"ring-offset":it()}],"inset-ring-w":[{"inset-ring":mt()}],"inset-ring-color":[{"inset-ring":it()}],"text-shadow":[{"text-shadow":["none",ge,Dm,Pm]}],"text-shadow-color":[{"text-shadow":it()}],opacity:[{opacity:[Fi,Ht,$t]}],"mix-blend":[{"mix-blend":[...Pt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Pt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Fi]}],"mask-image-linear-from-pos":[{"mask-linear-from":Rt()}],"mask-image-linear-to-pos":[{"mask-linear-to":Rt()}],"mask-image-linear-from-color":[{"mask-linear-from":it()}],"mask-image-linear-to-color":[{"mask-linear-to":it()}],"mask-image-t-from-pos":[{"mask-t-from":Rt()}],"mask-image-t-to-pos":[{"mask-t-to":Rt()}],"mask-image-t-from-color":[{"mask-t-from":it()}],"mask-image-t-to-color":[{"mask-t-to":it()}],"mask-image-r-from-pos":[{"mask-r-from":Rt()}],"mask-image-r-to-pos":[{"mask-r-to":Rt()}],"mask-image-r-from-color":[{"mask-r-from":it()}],"mask-image-r-to-color":[{"mask-r-to":it()}],"mask-image-b-from-pos":[{"mask-b-from":Rt()}],"mask-image-b-to-pos":[{"mask-b-to":Rt()}],"mask-image-b-from-color":[{"mask-b-from":it()}],"mask-image-b-to-color":[{"mask-b-to":it()}],"mask-image-l-from-pos":[{"mask-l-from":Rt()}],"mask-image-l-to-pos":[{"mask-l-to":Rt()}],"mask-image-l-from-color":[{"mask-l-from":it()}],"mask-image-l-to-color":[{"mask-l-to":it()}],"mask-image-x-from-pos":[{"mask-x-from":Rt()}],"mask-image-x-to-pos":[{"mask-x-to":Rt()}],"mask-image-x-from-color":[{"mask-x-from":it()}],"mask-image-x-to-color":[{"mask-x-to":it()}],"mask-image-y-from-pos":[{"mask-y-from":Rt()}],"mask-image-y-to-pos":[{"mask-y-to":Rt()}],"mask-image-y-from-color":[{"mask-y-from":it()}],"mask-image-y-to-color":[{"mask-y-to":it()}],"mask-image-radial":[{"mask-radial":[Ht,$t]}],"mask-image-radial-from-pos":[{"mask-radial-from":Rt()}],"mask-image-radial-to-pos":[{"mask-radial-to":Rt()}],"mask-image-radial-from-color":[{"mask-radial-from":it()}],"mask-image-radial-to-color":[{"mask-radial-to":it()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":Ke()}],"mask-image-conic-pos":[{"mask-conic":[Fi]}],"mask-image-conic-from-pos":[{"mask-conic-from":Rt()}],"mask-image-conic-to-pos":[{"mask-conic-to":Rt()}],"mask-image-conic-from-color":[{"mask-conic-from":it()}],"mask-image-conic-to-color":[{"mask-conic-to":it()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:dt()}],"mask-repeat":[{mask:Kt()}],"mask-size":[{mask:fe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ht,$t]}],filter:[{filter:["","none",Ht,$t]}],blur:[{blur:Dt()}],brightness:[{brightness:[Fi,Ht,$t]}],contrast:[{contrast:[Fi,Ht,$t]}],"drop-shadow":[{"drop-shadow":["","none",Me,Dm,Pm]}],"drop-shadow-color":[{"drop-shadow":it()}],grayscale:[{grayscale:["",Fi,Ht,$t]}],"hue-rotate":[{"hue-rotate":[Fi,Ht,$t]}],invert:[{invert:["",Fi,Ht,$t]}],saturate:[{saturate:[Fi,Ht,$t]}],sepia:[{sepia:["",Fi,Ht,$t]}],"backdrop-filter":[{"backdrop-filter":["","none",Ht,$t]}],"backdrop-blur":[{"backdrop-blur":Dt()}],"backdrop-brightness":[{"backdrop-brightness":[Fi,Ht,$t]}],"backdrop-contrast":[{"backdrop-contrast":[Fi,Ht,$t]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fi,Ht,$t]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fi,Ht,$t]}],"backdrop-invert":[{"backdrop-invert":["",Fi,Ht,$t]}],"backdrop-opacity":[{"backdrop-opacity":[Fi,Ht,$t]}],"backdrop-saturate":[{"backdrop-saturate":[Fi,Ht,$t]}],"backdrop-sepia":[{"backdrop-sepia":["",Fi,Ht,$t]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":be()}],"border-spacing-x":[{"border-spacing-x":be()}],"border-spacing-y":[{"border-spacing-y":be()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ht,$t]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fi,"initial",Ht,$t]}],ease:[{ease:["linear","initial",ot,Ht,$t]}],delay:[{delay:[Fi,Ht,$t]}],animate:[{animate:["none",Ye,Ht,$t]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[ie,Ht,$t]}],"perspective-origin":[{"perspective-origin":_t()}],rotate:[{rotate:Bt()}],"rotate-x":[{"rotate-x":Bt()}],"rotate-y":[{"rotate-y":Bt()}],"rotate-z":[{"rotate-z":Bt()}],scale:[{scale:bi()}],"scale-x":[{"scale-x":bi()}],"scale-y":[{"scale-y":bi()}],"scale-z":[{"scale-z":bi()}],"scale-3d":["scale-3d"],skew:[{skew:Qt()}],"skew-x":[{"skew-x":Qt()}],"skew-y":[{"skew-y":Qt()}],transform:[{transform:[Ht,$t,"","none","gpu","cpu"]}],"transform-origin":[{origin:_t()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ri()}],"translate-x":[{"translate-x":ri()}],"translate-y":[{"translate-y":ri()}],"translate-z":[{"translate-z":ri()}],"translate-none":["translate-none"],accent:[{accent:it()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:it()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ht,$t]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":be()}],"scroll-mx":[{"scroll-mx":be()}],"scroll-my":[{"scroll-my":be()}],"scroll-ms":[{"scroll-ms":be()}],"scroll-me":[{"scroll-me":be()}],"scroll-mt":[{"scroll-mt":be()}],"scroll-mr":[{"scroll-mr":be()}],"scroll-mb":[{"scroll-mb":be()}],"scroll-ml":[{"scroll-ml":be()}],"scroll-p":[{"scroll-p":be()}],"scroll-px":[{"scroll-px":be()}],"scroll-py":[{"scroll-py":be()}],"scroll-ps":[{"scroll-ps":be()}],"scroll-pe":[{"scroll-pe":be()}],"scroll-pt":[{"scroll-pt":be()}],"scroll-pr":[{"scroll-pr":be()}],"scroll-pb":[{"scroll-pb":be()}],"scroll-pl":[{"scroll-pl":be()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ht,$t]}],fill:[{fill:["none",...it()]}],"stroke-w":[{stroke:[Fi,Rp,sd,Ag]}],stroke:[{stroke:["none",...it()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Vv=Sv(Zv);function Qy(...h){return Vv(Uy(h))}const Gv=Ny("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pf=Hi.forwardRef(({className:h,variant:y,size:w,asChild:S=!1,...P},G)=>{const z=S?rv:"button";return Ct.jsx(z,{className:Qy(Gv({variant:y,size:w,className:h})),ref:G,...P})});pf.displayName="Button";const qv=Ny("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),$v=({className:h,variant:y,...w})=>Ct.jsx("div",{className:Qy(qv({variant:y}),h),...w}),j_=h=>{let y;const w=new Set,S=($,oe)=>{const ce=typeof $=="function"?$(y):$;if(!Object.is(ce,y)){const ge=y;y=oe??(typeof ce!="object"||ce===null)?ce:Object.assign({},y,ce),w.forEach(Me=>Me(y,ge))}},P=()=>y,c={setState:S,getState:P,getInitialState:()=>K,subscribe:$=>(w.add($),()=>w.delete($))},K=y=h(S,P,c);return c},Hv=(h=>h?j_(h):j_),Xv=h=>h;function Yv(h,y=Xv){const w=Op.useSyncExternalStore(h.subscribe,Op.useCallback(()=>y(h.getState()),[h,y]),Op.useCallback(()=>y(h.getInitialState()),[h,y]));return Op.useDebugValue(w),w}const Wv=h=>{const y=Hv(h),w=S=>Yv(y,S);return Object.assign(w,y),w},Kv=(h=>Wv);var Jy=Symbol.for("immer-nothing"),U_=Symbol.for("immer-draftable"),oo=Symbol.for("immer-state");function Tl(h,...y){throw new Error(`[Immer] minified error nr: ${h}. Full error at: https://bit.ly/3cXEKWf`)}var jp=Object.getPrototypeOf;function bf(h){return!!h&&!!h[oo]}function ld(h){return h?e0(h)||Array.isArray(h)||!!h[U_]||!!h.constructor?.[U_]||Gp(h)||ng(h):!1}var Qv=Object.prototype.constructor.toString(),N_=new WeakMap;function e0(h){if(!h||typeof h!="object")return!1;const y=Object.getPrototypeOf(h);if(y===null||y===Object.prototype)return!0;const w=Object.hasOwnProperty.call(y,"constructor")&&y.constructor;if(w===Object)return!0;if(typeof w!="function")return!1;let S=N_.get(w);return S===void 0&&(S=Function.toString.call(w),N_.set(w,S)),S===Qv}function Xm(h,y,w=!0){ig(h)===0?(w?Reflect.ownKeys(h):Object.keys(h)).forEach(P=>{y(P,h[P],h)}):h.forEach((S,P)=>y(P,S,h))}function ig(h){const y=h[oo];return y?y.type_:Array.isArray(h)?1:Gp(h)?2:ng(h)?3:0}function Wg(h,y){return ig(h)===2?h.has(y):Object.prototype.hasOwnProperty.call(h,y)}function t0(h,y,w){const S=ig(h);S===2?h.set(y,w):S===3?h.add(w):h[y]=w}function Jv(h,y){return h===y?h!==0||1/h===1/y:h!==h&&y!==y}function Gp(h){return h instanceof Map}function ng(h){return h instanceof Set}function od(h){return h.copy_||h.base_}function Kg(h,y){if(Gp(h))return new Map(h);if(ng(h))return new Set(h);if(Array.isArray(h))return Array.prototype.slice.call(h);const w=e0(h);if(y===!0||y==="class_only"&&!w){const S=Object.getOwnPropertyDescriptors(h);delete S[oo];let P=Reflect.ownKeys(S);for(let G=0;G<P.length;G++){const z=P[G],c=S[z];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(S[z]={configurable:!0,writable:!0,enumerable:c.enumerable,value:h[z]})}return Object.create(jp(h),S)}else{const S=jp(h);if(S!==null&&w)return{...h};const P=Object.create(S);return Object.assign(P,h)}}function c_(h,y=!1){return rg(h)||bf(h)||!ld(h)||(ig(h)>1&&Object.defineProperties(h,{set:km,add:km,clear:km,delete:km}),Object.freeze(h),y&&Object.values(h).forEach(w=>c_(w,!0))),h}function e1(){Tl(2)}var km={value:e1};function rg(h){return h===null||typeof h!="object"?!0:Object.isFrozen(h)}var t1={};function cd(h){const y=t1[h];return y||Tl(0,h),y}var Up;function i0(){return Up}function i1(h,y){return{drafts_:[],parent_:h,immer_:y,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Z_(h,y){y&&(cd("Patches"),h.patches_=[],h.inversePatches_=[],h.patchListener_=y)}function Qg(h){Jg(h),h.drafts_.forEach(n1),h.drafts_=null}function Jg(h){h===Up&&(Up=h.parent_)}function V_(h){return Up=i1(Up,h)}function n1(h){const y=h[oo];y.type_===0||y.type_===1?y.revoke_():y.revoked_=!0}function G_(h,y){y.unfinalizedDrafts_=y.drafts_.length;const w=y.drafts_[0];return h!==void 0&&h!==w?(w[oo].modified_&&(Qg(y),Tl(4)),ld(h)&&(h=Ym(y,h),y.parent_||Wm(y,h)),y.patches_&&cd("Patches").generateReplacementPatches_(w[oo].base_,h,y.patches_,y.inversePatches_)):h=Ym(y,w,[]),Qg(y),y.patches_&&y.patchListener_(y.patches_,y.inversePatches_),h!==Jy?h:void 0}function Ym(h,y,w){if(rg(y))return y;const S=h.immer_.shouldUseStrictIteration(),P=y[oo];if(!P)return Xm(y,(G,z)=>q_(h,P,y,G,z,w),S),y;if(P.scope_!==h)return y;if(!P.modified_)return Wm(h,P.base_,!0),P.base_;if(!P.finalized_){P.finalized_=!0,P.scope_.unfinalizedDrafts_--;const G=P.copy_;let z=G,c=!1;P.type_===3&&(z=new Set(G),G.clear(),c=!0),Xm(z,(K,$)=>q_(h,P,G,K,$,w,c),S),Wm(h,G,!1),w&&h.patches_&&cd("Patches").generatePatches_(P,w,h.patches_,h.inversePatches_)}return P.copy_}function q_(h,y,w,S,P,G,z){if(P==null||typeof P!="object"&&!z)return;const c=rg(P);if(!(c&&!z)){if(bf(P)){const K=G&&y&&y.type_!==3&&!Wg(y.assigned_,S)?G.concat(S):void 0,$=Ym(h,P,K);if(t0(w,S,$),bf($))h.canAutoFreeze_=!1;else return}else z&&w.add(P);if(ld(P)&&!c){if(!h.immer_.autoFreeze_&&h.unfinalizedDrafts_<1||y&&y.base_&&y.base_[S]===P&&c)return;Ym(h,P),(!y||!y.scope_.parent_)&&typeof S!="symbol"&&(Gp(w)?w.has(S):Object.prototype.propertyIsEnumerable.call(w,S))&&Wm(h,P)}}}function Wm(h,y,w=!1){!h.parent_&&h.immer_.autoFreeze_&&h.canAutoFreeze_&&c_(y,w)}function r1(h,y){const w=Array.isArray(h),S={type_:w?1:0,scope_:y?y.scope_:i0(),modified_:!1,finalized_:!1,assigned_:{},parent_:y,base_:h,draft_:null,copy_:null,revoke_:null,isManual_:!1};let P=S,G=u_;w&&(P=[S],G=Np);const{revoke:z,proxy:c}=Proxy.revocable(P,G);return S.draft_=c,S.revoke_=z,c}var u_={get(h,y){if(y===oo)return h;const w=od(h);if(!Wg(w,y))return a1(h,w,y);const S=w[y];return h.finalized_||!ld(S)?S:S===zg(h.base_,y)?(Cg(h),h.copy_[y]=t_(S,h)):S},has(h,y){return y in od(h)},ownKeys(h){return Reflect.ownKeys(od(h))},set(h,y,w){const S=n0(od(h),y);if(S?.set)return S.set.call(h.draft_,w),!0;if(!h.modified_){const P=zg(od(h),y),G=P?.[oo];if(G&&G.base_===w)return h.copy_[y]=w,h.assigned_[y]=!1,!0;if(Jv(w,P)&&(w!==void 0||Wg(h.base_,y)))return!0;Cg(h),e_(h)}return h.copy_[y]===w&&(w!==void 0||y in h.copy_)||Number.isNaN(w)&&Number.isNaN(h.copy_[y])||(h.copy_[y]=w,h.assigned_[y]=!0),!0},deleteProperty(h,y){return zg(h.base_,y)!==void 0||y in h.base_?(h.assigned_[y]=!1,Cg(h),e_(h)):delete h.assigned_[y],h.copy_&&delete h.copy_[y],!0},getOwnPropertyDescriptor(h,y){const w=od(h),S=Reflect.getOwnPropertyDescriptor(w,y);return S&&{writable:!0,configurable:h.type_!==1||y!=="length",enumerable:S.enumerable,value:w[y]}},defineProperty(){Tl(11)},getPrototypeOf(h){return jp(h.base_)},setPrototypeOf(){Tl(12)}},Np={};Xm(u_,(h,y)=>{Np[h]=function(){return arguments[0]=arguments[0][0],y.apply(this,arguments)}});Np.deleteProperty=function(h,y){return Np.set.call(this,h,y,void 0)};Np.set=function(h,y,w){return u_.set.call(this,h[0],y,w,h[0])};function zg(h,y){const w=h[oo];return(w?od(w):h)[y]}function a1(h,y,w){const S=n0(y,w);return S?"value"in S?S.value:S.get?.call(h.draft_):void 0}function n0(h,y){if(!(y in h))return;let w=jp(h);for(;w;){const S=Object.getOwnPropertyDescriptor(w,y);if(S)return S;w=jp(w)}}function e_(h){h.modified_||(h.modified_=!0,h.parent_&&e_(h.parent_))}function Cg(h){h.copy_||(h.copy_=Kg(h.base_,h.scope_.immer_.useStrictShallowCopy_))}var s1=class{constructor(h){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(y,w,S)=>{if(typeof y=="function"&&typeof w!="function"){const G=w;w=y;const z=this;return function(K=G,...$){return z.produce(K,oe=>w.call(this,oe,...$))}}typeof w!="function"&&Tl(6),S!==void 0&&typeof S!="function"&&Tl(7);let P;if(ld(y)){const G=V_(this),z=t_(y,void 0);let c=!0;try{P=w(z),c=!1}finally{c?Qg(G):Jg(G)}return Z_(G,S),G_(P,G)}else if(!y||typeof y!="object"){if(P=w(y),P===void 0&&(P=y),P===Jy&&(P=void 0),this.autoFreeze_&&c_(P,!0),S){const G=[],z=[];cd("Patches").generateReplacementPatches_(y,P,G,z),S(G,z)}return P}else Tl(1,y)},this.produceWithPatches=(y,w)=>{if(typeof y=="function")return(z,...c)=>this.produceWithPatches(z,K=>y(K,...c));let S,P;return[this.produce(y,w,(z,c)=>{S=z,P=c}),S,P]},typeof h?.autoFreeze=="boolean"&&this.setAutoFreeze(h.autoFreeze),typeof h?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(h.useStrictShallowCopy),typeof h?.useStrictIteration=="boolean"&&this.setUseStrictIteration(h.useStrictIteration)}createDraft(h){ld(h)||Tl(8),bf(h)&&(h=o1(h));const y=V_(this),w=t_(h,void 0);return w[oo].isManual_=!0,Jg(y),w}finishDraft(h,y){const w=h&&h[oo];(!w||!w.isManual_)&&Tl(9);const{scope_:S}=w;return Z_(S,y),G_(void 0,S)}setAutoFreeze(h){this.autoFreeze_=h}setUseStrictShallowCopy(h){this.useStrictShallowCopy_=h}setUseStrictIteration(h){this.useStrictIteration_=h}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(h,y){let w;for(w=y.length-1;w>=0;w--){const P=y[w];if(P.path.length===0&&P.op==="replace"){h=P.value;break}}w>-1&&(y=y.slice(w+1));const S=cd("Patches").applyPatches_;return bf(h)?S(h,y):this.produce(h,P=>S(P,y))}};function t_(h,y){const w=Gp(h)?cd("MapSet").proxyMap_(h,y):ng(h)?cd("MapSet").proxySet_(h,y):r1(h,y);return(y?y.scope_:i0()).drafts_.push(w),w}function o1(h){return bf(h)||Tl(10,h),r0(h)}function r0(h){if(!ld(h)||rg(h))return h;const y=h[oo];let w,S=!0;if(y){if(!y.modified_)return y.base_;y.finalized_=!0,w=Kg(h,y.scope_.immer_.useStrictShallowCopy_),S=y.scope_.immer_.shouldUseStrictIteration()}else w=Kg(h,!0);return Xm(w,(P,G)=>{t0(w,P,r0(G))},S),y&&(y.finalized_=!1),w}var l1=new s1,c1=l1.produce;const u1=h=>(y,w,S)=>(S.setState=(P,G,...z)=>{const c=typeof P=="function"?c1(P):P;return y(c,G,...z)},h(S.setState,w,S)),h1=u1;var Zm={exports:{}};var d1=Zm.exports,$_;function f1(){return $_||($_=1,(function(h,y){((w,S)=>{h.exports=S()})(d1,function w(){var S=typeof self<"u"?self:typeof window<"u"?window:S!==void 0?S:{},P,G=!S.document&&!!S.postMessage,z=S.IS_PAPA_WORKER||!1,c={},K=0,$={};function oe(be){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(Ie){var tt=_t(Ie);tt.chunkSize=parseInt(tt.chunkSize),Ie.step||Ie.chunk||(tt.chunkSize=null),this._handle=new ie(tt),(this._handle.streamer=this)._config=tt}).call(this,be),this.parseChunk=function(Ie,tt){var bt=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<bt){let Wt=this._config.newline;Wt||(wt=this._config.quoteChar||'"',Wt=this._handle.guessLineEndings(Ie,wt)),Ie=[...Ie.split(Wt).slice(bt)].join(Wt)}this.isFirstChunk&&St(this._config.beforeFirstChunk)&&(wt=this._config.beforeFirstChunk(Ie))!==void 0&&(Ie=wt),this.isFirstChunk=!1,this._halted=!1;var bt=this._partialLine+Ie,wt=(this._partialLine="",this._handle.parse(bt,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(Ie=wt.meta.cursor,bt=(this._finished||(this._partialLine=bt.substring(Ie-this._baseIndex),this._baseIndex=Ie),wt&&wt.data&&(this._rowCount+=wt.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),z)S.postMessage({results:wt,workerId:$.WORKER_ID,finished:bt});else if(St(this._config.chunk)&&!tt){if(this._config.chunk(wt,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=wt=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(wt.data),this._completeResults.errors=this._completeResults.errors.concat(wt.errors),this._completeResults.meta=wt.meta),this._completed||!bt||!St(this._config.complete)||wt&&wt.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),bt||wt&&wt.meta.paused||this._nextChunk(),wt}this._halted=!0},this._sendError=function(Ie){St(this._config.error)?this._config.error(Ie):z&&this._config.error&&S.postMessage({workerId:$.WORKER_ID,error:Ie,finished:!1})}}function ce(be){var Ie;(be=be||{}).chunkSize||(be.chunkSize=$.RemoteChunkSize),oe.call(this,be),this._nextChunk=G?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(tt){this._input=tt,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(Ie=new XMLHttpRequest,this._config.withCredentials&&(Ie.withCredentials=this._config.withCredentials),G||(Ie.onload=ht(this._chunkLoaded,this),Ie.onerror=ht(this._chunkError,this)),Ie.open(this._config.downloadRequestBody?"POST":"GET",this._input,!G),this._config.downloadRequestHeaders){var tt,bt=this._config.downloadRequestHeaders;for(tt in bt)Ie.setRequestHeader(tt,bt[tt])}var wt;this._config.chunkSize&&(wt=this._start+this._config.chunkSize-1,Ie.setRequestHeader("Range","bytes="+this._start+"-"+wt));try{Ie.send(this._config.downloadRequestBody)}catch(Wt){this._chunkError(Wt.message)}G&&Ie.status===0&&this._chunkError()}},this._chunkLoaded=function(){Ie.readyState===4&&(Ie.status<200||400<=Ie.status?this._chunkError():(this._start+=this._config.chunkSize||Ie.responseText.length,this._finished=!this._config.chunkSize||this._start>=(tt=>(tt=tt.getResponseHeader("Content-Range"))!==null?parseInt(tt.substring(tt.lastIndexOf("/")+1)):-1)(Ie),this.parseChunk(Ie.responseText)))},this._chunkError=function(tt){tt=Ie.statusText||tt,this._sendError(new Error(tt))}}function ge(be){(be=be||{}).chunkSize||(be.chunkSize=$.LocalChunkSize),oe.call(this,be);var Ie,tt,bt=typeof FileReader<"u";this.stream=function(wt){this._input=wt,tt=wt.slice||wt.webkitSlice||wt.mozSlice,bt?((Ie=new FileReader).onload=ht(this._chunkLoaded,this),Ie.onerror=ht(this._chunkError,this)):Ie=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var wt=this._input,Wt=(this._config.chunkSize&&(Wt=Math.min(this._start+this._config.chunkSize,this._input.size),wt=tt.call(wt,this._start,Wt)),Ie.readAsText(wt,this._config.encoding));bt||this._chunkLoaded({target:{result:Wt}})},this._chunkLoaded=function(wt){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(wt.target.result)},this._chunkError=function(){this._sendError(Ie.error)}}function Me(be){var Ie;oe.call(this,be=be||{}),this.stream=function(tt){return Ie=tt,this._nextChunk()},this._nextChunk=function(){var tt,bt;if(!this._finished)return tt=this._config.chunkSize,Ie=tt?(bt=Ie.substring(0,tt),Ie.substring(tt)):(bt=Ie,""),this._finished=!Ie,this.parseChunk(bt)}}function Ae(be){oe.call(this,be=be||{});var Ie=[],tt=!0,bt=!1;this.pause=function(){oe.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){oe.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(wt){this._input=wt,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){bt&&Ie.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),Ie.length?this.parseChunk(Ie.shift()):tt=!0},this._streamData=ht(function(wt){try{Ie.push(typeof wt=="string"?wt:wt.toString(this._config.encoding)),tt&&(tt=!1,this._checkIsFinished(),this.parseChunk(Ie.shift()))}catch(Wt){this._streamError(Wt)}},this),this._streamError=ht(function(wt){this._streamCleanUp(),this._sendError(wt)},this),this._streamEnd=ht(function(){this._streamCleanUp(),bt=!0,this._streamData("")},this),this._streamCleanUp=ht(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ie(be){var Ie,tt,bt,wt,Wt=Math.pow(2,53),vi=-Wt,Si=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ue=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,et=this,it=0,dt=0,Kt=!1,fe=!1,Re=[],Ze={data:[],errors:[],meta:{}};function mt(Dt){return be.skipEmptyLines==="greedy"?Dt.join("").trim()==="":Dt.length===1&&Dt[0].length===0}function It(){if(Ze&&bt&&(Rt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+$.DefaultDelimiter+"'"),bt=!1),be.skipEmptyLines&&(Ze.data=Ze.data.filter(function(ri){return!mt(ri)})),Pt()){let ri=function(Pi,Yt){St(be.transformHeader)&&(Pi=be.transformHeader(Pi,Yt)),Re.push(Pi)};var Qt=ri;if(Ze)if(Array.isArray(Ze.data[0])){for(var Dt=0;Pt()&&Dt<Ze.data.length;Dt++)Ze.data[Dt].forEach(ri);Ze.data.splice(0,1)}else Ze.data.forEach(ri)}function Bt(ri,Pi){for(var Yt=be.header?{}:[],gi=0;gi<ri.length;gi++){var jt=gi,nn=ri[gi],nn=((Ti,zi)=>(Gi=>(be.dynamicTypingFunction&&be.dynamicTyping[Gi]===void 0&&(be.dynamicTyping[Gi]=be.dynamicTypingFunction(Gi)),(be.dynamicTyping[Gi]||be.dynamicTyping)===!0))(Ti)?zi==="true"||zi==="TRUE"||zi!=="false"&&zi!=="FALSE"&&((Gi=>{if(Si.test(Gi)&&(Gi=parseFloat(Gi),vi<Gi&&Gi<Wt))return 1})(zi)?parseFloat(zi):Ue.test(zi)?new Date(zi):zi===""?null:zi):zi)(jt=be.header?gi>=Re.length?"__parsed_extra":Re[gi]:jt,nn=be.transform?be.transform(nn,jt):nn);jt==="__parsed_extra"?(Yt[jt]=Yt[jt]||[],Yt[jt].push(nn)):Yt[jt]=nn}return be.header&&(gi>Re.length?Rt("FieldMismatch","TooManyFields","Too many fields: expected "+Re.length+" fields but parsed "+gi,dt+Pi):gi<Re.length&&Rt("FieldMismatch","TooFewFields","Too few fields: expected "+Re.length+" fields but parsed "+gi,dt+Pi)),Yt}var bi;Ze&&(be.header||be.dynamicTyping||be.transform)&&(bi=1,!Ze.data.length||Array.isArray(Ze.data[0])?(Ze.data=Ze.data.map(Bt),bi=Ze.data.length):Ze.data=Bt(Ze.data,0),be.header&&Ze.meta&&(Ze.meta.fields=Re),dt+=bi)}function Pt(){return be.header&&Re.length===0}function Rt(Dt,Bt,bi,Qt){Dt={type:Dt,code:Bt,message:bi},Qt!==void 0&&(Dt.row=Qt),Ze.errors.push(Dt)}St(be.step)&&(wt=be.step,be.step=function(Dt){Ze=Dt,Pt()?It():(It(),Ze.data.length!==0&&(it+=Dt.data.length,be.preview&&it>be.preview?tt.abort():(Ze.data=Ze.data[0],wt(Ze,et))))}),this.parse=function(Dt,Bt,bi){var Qt=be.quoteChar||'"',Qt=(be.newline||(be.newline=this.guessLineEndings(Dt,Qt)),bt=!1,be.delimiter?St(be.delimiter)&&(be.delimiter=be.delimiter(Dt),Ze.meta.delimiter=be.delimiter):((Qt=((ri,Pi,Yt,gi,jt)=>{var nn,Ti,zi,Gi;jt=jt||[",","	","|",";",$.RECORD_SEP,$.UNIT_SEP];for(var er=0;er<jt.length;er++){for(var Xi,tr=jt[er],Ei=0,mn=0,Ui=0,ee=(zi=void 0,new ot({comments:gi,delimiter:tr,newline:Pi,preview:10}).parse(ri)),O=0;O<ee.data.length;O++)Yt&&mt(ee.data[O])?Ui++:(Xi=ee.data[O].length,mn+=Xi,zi===void 0?zi=Xi:0<Xi&&(Ei+=Math.abs(Xi-zi),zi=Xi));0<ee.data.length&&(mn/=ee.data.length-Ui),(Ti===void 0||Ei<=Ti)&&(Gi===void 0||Gi<mn)&&1.99<mn&&(Ti=Ei,nn=tr,Gi=mn)}return{successful:!!(be.delimiter=nn),bestDelimiter:nn}})(Dt,be.newline,be.skipEmptyLines,be.comments,be.delimitersToGuess)).successful?be.delimiter=Qt.bestDelimiter:(bt=!0,be.delimiter=$.DefaultDelimiter),Ze.meta.delimiter=be.delimiter),_t(be));return be.preview&&be.header&&Qt.preview++,Ie=Dt,tt=new ot(Qt),Ze=tt.parse(Ie,Bt,bi),It(),Kt?{meta:{paused:!0}}:Ze||{meta:{paused:!1}}},this.paused=function(){return Kt},this.pause=function(){Kt=!0,tt.abort(),Ie=St(be.chunk)?"":Ie.substring(tt.getCharIndex())},this.resume=function(){et.streamer._halted?(Kt=!1,et.streamer.parseChunk(Ie,!0)):setTimeout(et.resume,3)},this.aborted=function(){return fe},this.abort=function(){fe=!0,tt.abort(),Ze.meta.aborted=!0,St(be.complete)&&be.complete(Ze),Ie=""},this.guessLineEndings=function(ri,Qt){ri=ri.substring(0,1048576);var Qt=new RegExp(Ve(Qt)+"([^]*?)"+Ve(Qt),"gm"),bi=(ri=ri.replace(Qt,"")).split("\r"),Qt=ri.split(`
`),ri=1<Qt.length&&Qt[0].length<bi[0].length;if(bi.length===1||ri)return`
`;for(var Pi=0,Yt=0;Yt<bi.length;Yt++)bi[Yt][0]===`
`&&Pi++;return Pi>=bi.length/2?`\r
`:"\r"}}function Ve(be){return be.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ot(be){var Ie=(be=be||{}).delimiter,tt=be.newline,bt=be.comments,wt=be.step,Wt=be.preview,vi=be.fastMode,Si=null,Ue=!1,et=be.quoteChar==null?'"':be.quoteChar,it=et;if(be.escapeChar!==void 0&&(it=be.escapeChar),(typeof Ie!="string"||-1<$.BAD_DELIMITERS.indexOf(Ie))&&(Ie=","),bt===Ie)throw new Error("Comment character same as delimiter");bt===!0?bt="#":(typeof bt!="string"||-1<$.BAD_DELIMITERS.indexOf(bt))&&(bt=!1),tt!==`
`&&tt!=="\r"&&tt!==`\r
`&&(tt=`
`);var dt=0,Kt=!1;this.parse=function(fe,Re,Ze){if(typeof fe!="string")throw new Error("Input must be a string");var mt=fe.length,It=Ie.length,Pt=tt.length,Rt=bt.length,Dt=St(wt),Bt=[],bi=[],Qt=[],ri=dt=0;if(!fe)return Ei();if(vi||vi!==!1&&fe.indexOf(et)===-1){for(var Pi=fe.split(tt),Yt=0;Yt<Pi.length;Yt++){if(Qt=Pi[Yt],dt+=Qt.length,Yt!==Pi.length-1)dt+=tt.length;else if(Ze)return Ei();if(!bt||Qt.substring(0,Rt)!==bt){if(Dt){if(Bt=[],Gi(Qt.split(Ie)),mn(),Kt)return Ei()}else Gi(Qt.split(Ie));if(Wt&&Wt<=Yt)return Bt=Bt.slice(0,Wt),Ei(!0)}}return Ei()}for(var gi=fe.indexOf(Ie,dt),jt=fe.indexOf(tt,dt),nn=new RegExp(Ve(it)+Ve(et),"g"),Ti=fe.indexOf(et,dt);;)if(fe[dt]===et)for(Ti=dt,dt++;;){if((Ti=fe.indexOf(et,Ti+1))===-1)return Ze||bi.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Bt.length,index:dt}),Xi();if(Ti===mt-1)return Xi(fe.substring(dt,Ti).replace(nn,et));if(et===it&&fe[Ti+1]===it)Ti++;else if(et===it||Ti===0||fe[Ti-1]!==it){gi!==-1&&gi<Ti+1&&(gi=fe.indexOf(Ie,Ti+1));var zi=er((jt=jt!==-1&&jt<Ti+1?fe.indexOf(tt,Ti+1):jt)===-1?gi:Math.min(gi,jt));if(fe.substr(Ti+1+zi,It)===Ie){Qt.push(fe.substring(dt,Ti).replace(nn,et)),fe[dt=Ti+1+zi+It]!==et&&(Ti=fe.indexOf(et,dt)),gi=fe.indexOf(Ie,dt),jt=fe.indexOf(tt,dt);break}if(zi=er(jt),fe.substring(Ti+1+zi,Ti+1+zi+Pt)===tt){if(Qt.push(fe.substring(dt,Ti).replace(nn,et)),tr(Ti+1+zi+Pt),gi=fe.indexOf(Ie,dt),Ti=fe.indexOf(et,dt),Dt&&(mn(),Kt))return Ei();if(Wt&&Bt.length>=Wt)return Ei(!0);break}bi.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Bt.length,index:dt}),Ti++}}else if(bt&&Qt.length===0&&fe.substring(dt,dt+Rt)===bt){if(jt===-1)return Ei();dt=jt+Pt,jt=fe.indexOf(tt,dt),gi=fe.indexOf(Ie,dt)}else if(gi!==-1&&(gi<jt||jt===-1))Qt.push(fe.substring(dt,gi)),dt=gi+It,gi=fe.indexOf(Ie,dt);else{if(jt===-1)break;if(Qt.push(fe.substring(dt,jt)),tr(jt+Pt),Dt&&(mn(),Kt))return Ei();if(Wt&&Bt.length>=Wt)return Ei(!0)}return Xi();function Gi(Ui){Bt.push(Ui),ri=dt}function er(Ui){var ee=0;return ee=Ui!==-1&&(Ui=fe.substring(Ti+1,Ui))&&Ui.trim()===""?Ui.length:ee}function Xi(Ui){return Ze||(Ui===void 0&&(Ui=fe.substring(dt)),Qt.push(Ui),dt=mt,Gi(Qt),Dt&&mn()),Ei()}function tr(Ui){dt=Ui,Gi(Qt),Qt=[],jt=fe.indexOf(tt,dt)}function Ei(Ui){if(be.header&&!Re&&Bt.length&&!Ue){var ee=Bt[0],O=Object.create(null),U=new Set(ee);let q=!1;for(let L=0;L<ee.length;L++){let F=ee[L];if(O[F=St(be.transformHeader)?be.transformHeader(F,L):F]){let H,ae=O[F];for(;H=F+"_"+ae,ae++,U.has(H););U.add(H),ee[L]=H,O[F]++,q=!0,(Si=Si===null?{}:Si)[H]=F}else O[F]=1,ee[L]=F;U.add(F)}q&&console.warn("Duplicate headers found and renamed."),Ue=!0}return{data:Bt,errors:bi,meta:{delimiter:Ie,linebreak:tt,aborted:Kt,truncated:!!Ui,cursor:ri+(Re||0),renamedHeaders:Si}}}function mn(){wt(Ei()),Bt=[],bi=[]}},this.abort=function(){Kt=!0},this.getCharIndex=function(){return dt}}function Ye(be){var Ie=be.data,tt=c[Ie.workerId],bt=!1;if(Ie.error)tt.userError(Ie.error,Ie.file);else if(Ie.results&&Ie.results.data){var wt={abort:function(){bt=!0,Le(Ie.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ke,resume:Ke};if(St(tt.userStep)){for(var Wt=0;Wt<Ie.results.data.length&&(tt.userStep({data:Ie.results.data[Wt],errors:Ie.results.errors,meta:Ie.results.meta},wt),!bt);Wt++);delete Ie.results}else St(tt.userChunk)&&(tt.userChunk(Ie.results,wt,Ie.file),delete Ie.results)}Ie.finished&&!bt&&Le(Ie.workerId,Ie.results)}function Le(be,Ie){var tt=c[be];St(tt.userComplete)&&tt.userComplete(Ie),tt.terminate(),delete c[be]}function Ke(){throw new Error("Not implemented.")}function _t(be){if(typeof be!="object"||be===null)return be;var Ie,tt=Array.isArray(be)?[]:{};for(Ie in be)tt[Ie]=_t(be[Ie]);return tt}function ht(be,Ie){return function(){be.apply(Ie,arguments)}}function St(be){return typeof be=="function"}return $.parse=function(be,Ie){var tt=(Ie=Ie||{}).dynamicTyping||!1;if(St(tt)&&(Ie.dynamicTypingFunction=tt,tt={}),Ie.dynamicTyping=tt,Ie.transform=!!St(Ie.transform)&&Ie.transform,!Ie.worker||!$.WORKERS_SUPPORTED)return tt=null,$.NODE_STREAM_INPUT,typeof be=="string"?(be=(bt=>bt.charCodeAt(0)!==65279?bt:bt.slice(1))(be),tt=new(Ie.download?ce:Me)(Ie)):be.readable===!0&&St(be.read)&&St(be.on)?tt=new Ae(Ie):(S.File&&be instanceof File||be instanceof Object)&&(tt=new ge(Ie)),tt.stream(be);(tt=(()=>{var bt;return!!$.WORKERS_SUPPORTED&&(bt=(()=>{var wt=S.URL||S.webkitURL||null,Wt=w.toString();return $.BLOB_URL||($.BLOB_URL=wt.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Wt,")();"],{type:"text/javascript"})))})(),(bt=new S.Worker(bt)).onmessage=Ye,bt.id=K++,c[bt.id]=bt)})()).userStep=Ie.step,tt.userChunk=Ie.chunk,tt.userComplete=Ie.complete,tt.userError=Ie.error,Ie.step=St(Ie.step),Ie.chunk=St(Ie.chunk),Ie.complete=St(Ie.complete),Ie.error=St(Ie.error),delete Ie.worker,tt.postMessage({input:be,config:Ie,workerId:tt.id})},$.unparse=function(be,Ie){var tt=!1,bt=!0,wt=",",Wt=`\r
`,vi='"',Si=vi+vi,Ue=!1,et=null,it=!1,dt=((()=>{if(typeof Ie=="object"){if(typeof Ie.delimiter!="string"||$.BAD_DELIMITERS.filter(function(Re){return Ie.delimiter.indexOf(Re)!==-1}).length||(wt=Ie.delimiter),typeof Ie.quotes!="boolean"&&typeof Ie.quotes!="function"&&!Array.isArray(Ie.quotes)||(tt=Ie.quotes),typeof Ie.skipEmptyLines!="boolean"&&typeof Ie.skipEmptyLines!="string"||(Ue=Ie.skipEmptyLines),typeof Ie.newline=="string"&&(Wt=Ie.newline),typeof Ie.quoteChar=="string"&&(vi=Ie.quoteChar),typeof Ie.header=="boolean"&&(bt=Ie.header),Array.isArray(Ie.columns)){if(Ie.columns.length===0)throw new Error("Option columns is empty");et=Ie.columns}Ie.escapeChar!==void 0&&(Si=Ie.escapeChar+vi),Ie.escapeFormulae instanceof RegExp?it=Ie.escapeFormulae:typeof Ie.escapeFormulae=="boolean"&&Ie.escapeFormulae&&(it=/^[=+\-@\t\r].*$/)}})(),new RegExp(Ve(vi),"g"));if(typeof be=="string"&&(be=JSON.parse(be)),Array.isArray(be)){if(!be.length||Array.isArray(be[0]))return Kt(null,be,Ue);if(typeof be[0]=="object")return Kt(et||Object.keys(be[0]),be,Ue)}else if(typeof be=="object")return typeof be.data=="string"&&(be.data=JSON.parse(be.data)),Array.isArray(be.data)&&(be.fields||(be.fields=be.meta&&be.meta.fields||et),be.fields||(be.fields=Array.isArray(be.data[0])?be.fields:typeof be.data[0]=="object"?Object.keys(be.data[0]):[]),Array.isArray(be.data[0])||typeof be.data[0]=="object"||(be.data=[be.data])),Kt(be.fields||[],be.data||[],Ue);throw new Error("Unable to serialize unrecognized input");function Kt(Re,Ze,mt){var It="",Pt=(typeof Re=="string"&&(Re=JSON.parse(Re)),typeof Ze=="string"&&(Ze=JSON.parse(Ze)),Array.isArray(Re)&&0<Re.length),Rt=!Array.isArray(Ze[0]);if(Pt&&bt){for(var Dt=0;Dt<Re.length;Dt++)0<Dt&&(It+=wt),It+=fe(Re[Dt],Dt);0<Ze.length&&(It+=Wt)}for(var Bt=0;Bt<Ze.length;Bt++){var bi=(Pt?Re:Ze[Bt]).length,Qt=!1,ri=Pt?Object.keys(Ze[Bt]).length===0:Ze[Bt].length===0;if(mt&&!Pt&&(Qt=mt==="greedy"?Ze[Bt].join("").trim()==="":Ze[Bt].length===1&&Ze[Bt][0].length===0),mt==="greedy"&&Pt){for(var Pi=[],Yt=0;Yt<bi;Yt++){var gi=Rt?Re[Yt]:Yt;Pi.push(Ze[Bt][gi])}Qt=Pi.join("").trim()===""}if(!Qt){for(var jt=0;jt<bi;jt++){0<jt&&!ri&&(It+=wt);var nn=Pt&&Rt?Re[jt]:jt;It+=fe(Ze[Bt][nn],jt)}Bt<Ze.length-1&&(!mt||0<bi&&!ri)&&(It+=Wt)}}return It}function fe(Re,Ze){var mt,It;return Re==null?"":Re.constructor===Date?JSON.stringify(Re).slice(1,25):(It=!1,it&&typeof Re=="string"&&it.test(Re)&&(Re="'"+Re,It=!0),mt=Re.toString().replace(dt,Si),(It=It||tt===!0||typeof tt=="function"&&tt(Re,Ze)||Array.isArray(tt)&&tt[Ze]||((Pt,Rt)=>{for(var Dt=0;Dt<Rt.length;Dt++)if(-1<Pt.indexOf(Rt[Dt]))return!0;return!1})(mt,$.BAD_DELIMITERS)||-1<mt.indexOf(wt)||mt.charAt(0)===" "||mt.charAt(mt.length-1)===" ")?vi+mt+vi:mt)}},$.RECORD_SEP="",$.UNIT_SEP="",$.BYTE_ORDER_MARK="\uFEFF",$.BAD_DELIMITERS=["\r",`
`,'"',$.BYTE_ORDER_MARK],$.WORKERS_SUPPORTED=!G&&!!S.Worker,$.NODE_STREAM_INPUT=1,$.LocalChunkSize=10485760,$.RemoteChunkSize=5242880,$.DefaultDelimiter=",",$.Parser=ot,$.ParserHandle=ie,$.NetworkStreamer=ce,$.FileStreamer=ge,$.StringStreamer=Me,$.ReadableStreamStreamer=Ae,S.jQuery&&((P=S.jQuery).fn.parse=function(be){var Ie=be.config||{},tt=[];return this.each(function(Wt){if(!(P(this).prop("tagName").toUpperCase()==="INPUT"&&P(this).attr("type").toLowerCase()==="file"&&S.FileReader)||!this.files||this.files.length===0)return!0;for(var vi=0;vi<this.files.length;vi++)tt.push({file:this.files[vi],inputElem:this,instanceConfig:P.extend({},Ie)})}),bt(),this;function bt(){if(tt.length===0)St(be.complete)&&be.complete();else{var Wt,vi,Si,Ue,et=tt[0];if(St(be.before)){var it=be.before(et.file,et.inputElem);if(typeof it=="object"){if(it.action==="abort")return Wt="AbortError",vi=et.file,Si=et.inputElem,Ue=it.reason,void(St(be.error)&&be.error({name:Wt},vi,Si,Ue));if(it.action==="skip")return void wt();typeof it.config=="object"&&(et.instanceConfig=P.extend(et.instanceConfig,it.config))}else if(it==="skip")return void wt()}var dt=et.instanceConfig.complete;et.instanceConfig.complete=function(Kt){St(dt)&&dt(Kt,et.file,et.inputElem),wt()},$.parse(et.file,et.instanceConfig)}}function wt(){tt.splice(0,1),bt()}}),z&&(S.onmessage=function(be){be=be.data,$.WORKER_ID===void 0&&be&&($.WORKER_ID=be.workerId),typeof be.input=="string"?S.postMessage({workerId:$.WORKER_ID,results:$.parse(be.input,be.config),finished:!0}):(S.File&&be.input instanceof File||be.input instanceof Object)&&(be=$.parse(be.input,be.config))&&S.postMessage({workerId:$.WORKER_ID,results:be,finished:!0})}),(ce.prototype=Object.create(oe.prototype)).constructor=ce,(ge.prototype=Object.create(oe.prototype)).constructor=ge,(Me.prototype=Object.create(Me.prototype)).constructor=Me,(Ae.prototype=Object.create(oe.prototype)).constructor=Ae,$})})(Zm)),Zm.exports}var p1=f1();const m1=tg(p1);var Ig={exports:{}},Pg={},Bp={},H_;function g1(){if(H_)return Bp;H_=1,Bp.byteLength=c,Bp.toByteArray=$,Bp.fromByteArray=ge;for(var h=[],y=[],w=typeof Uint8Array<"u"?Uint8Array:Array,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=0,G=S.length;P<G;++P)h[P]=S[P],y[S.charCodeAt(P)]=P;y[45]=62,y[95]=63;function z(Me){var Ae=Me.length;if(Ae%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var ie=Me.indexOf("=");ie===-1&&(ie=Ae);var Ve=ie===Ae?0:4-ie%4;return[ie,Ve]}function c(Me){var Ae=z(Me),ie=Ae[0],Ve=Ae[1];return(ie+Ve)*3/4-Ve}function K(Me,Ae,ie){return(Ae+ie)*3/4-ie}function $(Me){var Ae,ie=z(Me),Ve=ie[0],ot=ie[1],Ye=new w(K(Me,Ve,ot)),Le=0,Ke=ot>0?Ve-4:Ve,_t;for(_t=0;_t<Ke;_t+=4)Ae=y[Me.charCodeAt(_t)]<<18|y[Me.charCodeAt(_t+1)]<<12|y[Me.charCodeAt(_t+2)]<<6|y[Me.charCodeAt(_t+3)],Ye[Le++]=Ae>>16&255,Ye[Le++]=Ae>>8&255,Ye[Le++]=Ae&255;return ot===2&&(Ae=y[Me.charCodeAt(_t)]<<2|y[Me.charCodeAt(_t+1)]>>4,Ye[Le++]=Ae&255),ot===1&&(Ae=y[Me.charCodeAt(_t)]<<10|y[Me.charCodeAt(_t+1)]<<4|y[Me.charCodeAt(_t+2)]>>2,Ye[Le++]=Ae>>8&255,Ye[Le++]=Ae&255),Ye}function oe(Me){return h[Me>>18&63]+h[Me>>12&63]+h[Me>>6&63]+h[Me&63]}function ce(Me,Ae,ie){for(var Ve,ot=[],Ye=Ae;Ye<ie;Ye+=3)Ve=(Me[Ye]<<16&16711680)+(Me[Ye+1]<<8&65280)+(Me[Ye+2]&255),ot.push(oe(Ve));return ot.join("")}function ge(Me){for(var Ae,ie=Me.length,Ve=ie%3,ot=[],Ye=16383,Le=0,Ke=ie-Ve;Le<Ke;Le+=Ye)ot.push(ce(Me,Le,Le+Ye>Ke?Ke:Le+Ye));return Ve===1?(Ae=Me[ie-1],ot.push(h[Ae>>2]+h[Ae<<4&63]+"==")):Ve===2&&(Ae=(Me[ie-2]<<8)+Me[ie-1],ot.push(h[Ae>>10]+h[Ae>>4&63]+h[Ae<<2&63]+"=")),ot.join("")}return Bp}var Rm={};var X_;function _1(){return X_||(X_=1,Rm.read=function(h,y,w,S,P){var G,z,c=P*8-S-1,K=(1<<c)-1,$=K>>1,oe=-7,ce=w?P-1:0,ge=w?-1:1,Me=h[y+ce];for(ce+=ge,G=Me&(1<<-oe)-1,Me>>=-oe,oe+=c;oe>0;G=G*256+h[y+ce],ce+=ge,oe-=8);for(z=G&(1<<-oe)-1,G>>=-oe,oe+=S;oe>0;z=z*256+h[y+ce],ce+=ge,oe-=8);if(G===0)G=1-$;else{if(G===K)return z?NaN:(Me?-1:1)*(1/0);z=z+Math.pow(2,S),G=G-$}return(Me?-1:1)*z*Math.pow(2,G-S)},Rm.write=function(h,y,w,S,P,G){var z,c,K,$=G*8-P-1,oe=(1<<$)-1,ce=oe>>1,ge=P===23?Math.pow(2,-24)-Math.pow(2,-77):0,Me=S?0:G-1,Ae=S?1:-1,ie=y<0||y===0&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(c=isNaN(y)?1:0,z=oe):(z=Math.floor(Math.log(y)/Math.LN2),y*(K=Math.pow(2,-z))<1&&(z--,K*=2),z+ce>=1?y+=ge/K:y+=ge*Math.pow(2,1-ce),y*K>=2&&(z++,K/=2),z+ce>=oe?(c=0,z=oe):z+ce>=1?(c=(y*K-1)*Math.pow(2,P),z=z+ce):(c=y*Math.pow(2,ce-1)*Math.pow(2,P),z=0));P>=8;h[w+Me]=c&255,Me+=Ae,c/=256,P-=8);for(z=z<<P|c,$+=P;$>0;h[w+Me]=z&255,Me+=Ae,z/=256,$-=8);h[w+Me-Ae]|=ie*128}),Rm}var Y_;function a0(){return Y_||(Y_=1,(function(h){const y=g1(),w=_1(),S=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;h.Buffer=c,h.SlowBuffer=Ye,h.INSPECT_MAX_BYTES=50;const P=2147483647;h.kMaxLength=P,c.TYPED_ARRAY_SUPPORT=G(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function G(){try{const ee=new Uint8Array(1),O={foo:function(){return 42}};return Object.setPrototypeOf(O,Uint8Array.prototype),Object.setPrototypeOf(ee,O),ee.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function z(ee){if(ee>P)throw new RangeError('The value "'+ee+'" is invalid for option "size"');const O=new Uint8Array(ee);return Object.setPrototypeOf(O,c.prototype),O}function c(ee,O,U){if(typeof ee=="number"){if(typeof O=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ce(ee)}return K(ee,O,U)}c.poolSize=8192;function K(ee,O,U){if(typeof ee=="string")return ge(ee,O);if(ArrayBuffer.isView(ee))return Ae(ee);if(ee==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee);if(Xi(ee,ArrayBuffer)||ee&&Xi(ee.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Xi(ee,SharedArrayBuffer)||ee&&Xi(ee.buffer,SharedArrayBuffer)))return ie(ee,O,U);if(typeof ee=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const q=ee.valueOf&&ee.valueOf();if(q!=null&&q!==ee)return c.from(q,O,U);const L=Ve(ee);if(L)return L;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ee[Symbol.toPrimitive]=="function")return c.from(ee[Symbol.toPrimitive]("string"),O,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ee)}c.from=function(ee,O,U){return K(ee,O,U)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function $(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be of type number');if(ee<0)throw new RangeError('The value "'+ee+'" is invalid for option "size"')}function oe(ee,O,U){return $(ee),ee<=0?z(ee):O!==void 0?typeof U=="string"?z(ee).fill(O,U):z(ee).fill(O):z(ee)}c.alloc=function(ee,O,U){return oe(ee,O,U)};function ce(ee){return $(ee),z(ee<0?0:ot(ee)|0)}c.allocUnsafe=function(ee){return ce(ee)},c.allocUnsafeSlow=function(ee){return ce(ee)};function ge(ee,O){if((typeof O!="string"||O==="")&&(O="utf8"),!c.isEncoding(O))throw new TypeError("Unknown encoding: "+O);const U=Le(ee,O)|0;let q=z(U);const L=q.write(ee,O);return L!==U&&(q=q.slice(0,L)),q}function Me(ee){const O=ee.length<0?0:ot(ee.length)|0,U=z(O);for(let q=0;q<O;q+=1)U[q]=ee[q]&255;return U}function Ae(ee){if(Xi(ee,Uint8Array)){const O=new Uint8Array(ee);return ie(O.buffer,O.byteOffset,O.byteLength)}return Me(ee)}function ie(ee,O,U){if(O<0||ee.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(ee.byteLength<O+(U||0))throw new RangeError('"length" is outside of buffer bounds');let q;return O===void 0&&U===void 0?q=new Uint8Array(ee):U===void 0?q=new Uint8Array(ee,O):q=new Uint8Array(ee,O,U),Object.setPrototypeOf(q,c.prototype),q}function Ve(ee){if(c.isBuffer(ee)){const O=ot(ee.length)|0,U=z(O);return U.length===0||ee.copy(U,0,0,O),U}if(ee.length!==void 0)return typeof ee.length!="number"||tr(ee.length)?z(0):Me(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return Me(ee.data)}function ot(ee){if(ee>=P)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+P.toString(16)+" bytes");return ee|0}function Ye(ee){return+ee!=ee&&(ee=0),c.alloc(+ee)}c.isBuffer=function(O){return O!=null&&O._isBuffer===!0&&O!==c.prototype},c.compare=function(O,U){if(Xi(O,Uint8Array)&&(O=c.from(O,O.offset,O.byteLength)),Xi(U,Uint8Array)&&(U=c.from(U,U.offset,U.byteLength)),!c.isBuffer(O)||!c.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(O===U)return 0;let q=O.length,L=U.length;for(let F=0,H=Math.min(q,L);F<H;++F)if(O[F]!==U[F]){q=O[F],L=U[F];break}return q<L?-1:L<q?1:0},c.isEncoding=function(O){switch(String(O).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(O,U){if(!Array.isArray(O))throw new TypeError('"list" argument must be an Array of Buffers');if(O.length===0)return c.alloc(0);let q;if(U===void 0)for(U=0,q=0;q<O.length;++q)U+=O[q].length;const L=c.allocUnsafe(U);let F=0;for(q=0;q<O.length;++q){let H=O[q];if(Xi(H,Uint8Array))F+H.length>L.length?(c.isBuffer(H)||(H=c.from(H)),H.copy(L,F)):Uint8Array.prototype.set.call(L,H,F);else if(c.isBuffer(H))H.copy(L,F);else throw new TypeError('"list" argument must be an Array of Buffers');F+=H.length}return L};function Le(ee,O){if(c.isBuffer(ee))return ee.length;if(ArrayBuffer.isView(ee)||Xi(ee,ArrayBuffer))return ee.byteLength;if(typeof ee!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ee);const U=ee.length,q=arguments.length>2&&arguments[2]===!0;if(!q&&U===0)return 0;let L=!1;for(;;)switch(O){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return nn(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U*2;case"hex":return U>>>1;case"base64":return Gi(ee).length;default:if(L)return q?-1:nn(ee).length;O=(""+O).toLowerCase(),L=!0}}c.byteLength=Le;function Ke(ee,O,U){let q=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0,O>>>=0,U<=O))return"";for(ee||(ee="utf8");;)switch(ee){case"hex":return dt(this,O,U);case"utf8":case"utf-8":return vi(this,O,U);case"ascii":return et(this,O,U);case"latin1":case"binary":return it(this,O,U);case"base64":return Wt(this,O,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kt(this,O,U);default:if(q)throw new TypeError("Unknown encoding: "+ee);ee=(ee+"").toLowerCase(),q=!0}}c.prototype._isBuffer=!0;function _t(ee,O,U){const q=ee[O];ee[O]=ee[U],ee[U]=q}c.prototype.swap16=function(){const O=this.length;if(O%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let U=0;U<O;U+=2)_t(this,U,U+1);return this},c.prototype.swap32=function(){const O=this.length;if(O%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let U=0;U<O;U+=4)_t(this,U,U+3),_t(this,U+1,U+2);return this},c.prototype.swap64=function(){const O=this.length;if(O%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let U=0;U<O;U+=8)_t(this,U,U+7),_t(this,U+1,U+6),_t(this,U+2,U+5),_t(this,U+3,U+4);return this},c.prototype.toString=function(){const O=this.length;return O===0?"":arguments.length===0?vi(this,0,O):Ke.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(O){if(!c.isBuffer(O))throw new TypeError("Argument must be a Buffer");return this===O?!0:c.compare(this,O)===0},c.prototype.inspect=function(){let O="";const U=h.INSPECT_MAX_BYTES;return O=this.toString("hex",0,U).replace(/(.{2})/g,"$1 ").trim(),this.length>U&&(O+=" ... "),"<Buffer "+O+">"},S&&(c.prototype[S]=c.prototype.inspect),c.prototype.compare=function(O,U,q,L,F){if(Xi(O,Uint8Array)&&(O=c.from(O,O.offset,O.byteLength)),!c.isBuffer(O))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof O);if(U===void 0&&(U=0),q===void 0&&(q=O?O.length:0),L===void 0&&(L=0),F===void 0&&(F=this.length),U<0||q>O.length||L<0||F>this.length)throw new RangeError("out of range index");if(L>=F&&U>=q)return 0;if(L>=F)return-1;if(U>=q)return 1;if(U>>>=0,q>>>=0,L>>>=0,F>>>=0,this===O)return 0;let H=F-L,ae=q-U;const pe=Math.min(H,ae),we=this.slice(L,F),ke=O.slice(U,q);for(let Te=0;Te<pe;++Te)if(we[Te]!==ke[Te]){H=we[Te],ae=ke[Te];break}return H<ae?-1:ae<H?1:0};function ht(ee,O,U,q,L){if(ee.length===0)return-1;if(typeof U=="string"?(q=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),U=+U,tr(U)&&(U=L?0:ee.length-1),U<0&&(U=ee.length+U),U>=ee.length){if(L)return-1;U=ee.length-1}else if(U<0)if(L)U=0;else return-1;if(typeof O=="string"&&(O=c.from(O,q)),c.isBuffer(O))return O.length===0?-1:St(ee,O,U,q,L);if(typeof O=="number")return O=O&255,typeof Uint8Array.prototype.indexOf=="function"?L?Uint8Array.prototype.indexOf.call(ee,O,U):Uint8Array.prototype.lastIndexOf.call(ee,O,U):St(ee,[O],U,q,L);throw new TypeError("val must be string, number or Buffer")}function St(ee,O,U,q,L){let F=1,H=ee.length,ae=O.length;if(q!==void 0&&(q=String(q).toLowerCase(),q==="ucs2"||q==="ucs-2"||q==="utf16le"||q==="utf-16le")){if(ee.length<2||O.length<2)return-1;F=2,H/=2,ae/=2,U/=2}function pe(ke,Te){return F===1?ke[Te]:ke.readUInt16BE(Te*F)}let we;if(L){let ke=-1;for(we=U;we<H;we++)if(pe(ee,we)===pe(O,ke===-1?0:we-ke)){if(ke===-1&&(ke=we),we-ke+1===ae)return ke*F}else ke!==-1&&(we-=we-ke),ke=-1}else for(U+ae>H&&(U=H-ae),we=U;we>=0;we--){let ke=!0;for(let Te=0;Te<ae;Te++)if(pe(ee,we+Te)!==pe(O,Te)){ke=!1;break}if(ke)return we}return-1}c.prototype.includes=function(O,U,q){return this.indexOf(O,U,q)!==-1},c.prototype.indexOf=function(O,U,q){return ht(this,O,U,q,!0)},c.prototype.lastIndexOf=function(O,U,q){return ht(this,O,U,q,!1)};function be(ee,O,U,q){U=Number(U)||0;const L=ee.length-U;q?(q=Number(q),q>L&&(q=L)):q=L;const F=O.length;q>F/2&&(q=F/2);let H;for(H=0;H<q;++H){const ae=parseInt(O.substr(H*2,2),16);if(tr(ae))return H;ee[U+H]=ae}return H}function Ie(ee,O,U,q){return er(nn(O,ee.length-U),ee,U,q)}function tt(ee,O,U,q){return er(Ti(O),ee,U,q)}function bt(ee,O,U,q){return er(Gi(O),ee,U,q)}function wt(ee,O,U,q){return er(zi(O,ee.length-U),ee,U,q)}c.prototype.write=function(O,U,q,L){if(U===void 0)L="utf8",q=this.length,U=0;else if(q===void 0&&typeof U=="string")L=U,q=this.length,U=0;else if(isFinite(U))U=U>>>0,isFinite(q)?(q=q>>>0,L===void 0&&(L="utf8")):(L=q,q=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const F=this.length-U;if((q===void 0||q>F)&&(q=F),O.length>0&&(q<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");let H=!1;for(;;)switch(L){case"hex":return be(this,O,U,q);case"utf8":case"utf-8":return Ie(this,O,U,q);case"ascii":case"latin1":case"binary":return tt(this,O,U,q);case"base64":return bt(this,O,U,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wt(this,O,U,q);default:if(H)throw new TypeError("Unknown encoding: "+L);L=(""+L).toLowerCase(),H=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Wt(ee,O,U){return O===0&&U===ee.length?y.fromByteArray(ee):y.fromByteArray(ee.slice(O,U))}function vi(ee,O,U){U=Math.min(ee.length,U);const q=[];let L=O;for(;L<U;){const F=ee[L];let H=null,ae=F>239?4:F>223?3:F>191?2:1;if(L+ae<=U){let pe,we,ke,Te;switch(ae){case 1:F<128&&(H=F);break;case 2:pe=ee[L+1],(pe&192)===128&&(Te=(F&31)<<6|pe&63,Te>127&&(H=Te));break;case 3:pe=ee[L+1],we=ee[L+2],(pe&192)===128&&(we&192)===128&&(Te=(F&15)<<12|(pe&63)<<6|we&63,Te>2047&&(Te<55296||Te>57343)&&(H=Te));break;case 4:pe=ee[L+1],we=ee[L+2],ke=ee[L+3],(pe&192)===128&&(we&192)===128&&(ke&192)===128&&(Te=(F&15)<<18|(pe&63)<<12|(we&63)<<6|ke&63,Te>65535&&Te<1114112&&(H=Te))}}H===null?(H=65533,ae=1):H>65535&&(H-=65536,q.push(H>>>10&1023|55296),H=56320|H&1023),q.push(H),L+=ae}return Ue(q)}const Si=4096;function Ue(ee){const O=ee.length;if(O<=Si)return String.fromCharCode.apply(String,ee);let U="",q=0;for(;q<O;)U+=String.fromCharCode.apply(String,ee.slice(q,q+=Si));return U}function et(ee,O,U){let q="";U=Math.min(ee.length,U);for(let L=O;L<U;++L)q+=String.fromCharCode(ee[L]&127);return q}function it(ee,O,U){let q="";U=Math.min(ee.length,U);for(let L=O;L<U;++L)q+=String.fromCharCode(ee[L]);return q}function dt(ee,O,U){const q=ee.length;(!O||O<0)&&(O=0),(!U||U<0||U>q)&&(U=q);let L="";for(let F=O;F<U;++F)L+=Ei[ee[F]];return L}function Kt(ee,O,U){const q=ee.slice(O,U);let L="";for(let F=0;F<q.length-1;F+=2)L+=String.fromCharCode(q[F]+q[F+1]*256);return L}c.prototype.slice=function(O,U){const q=this.length;O=~~O,U=U===void 0?q:~~U,O<0?(O+=q,O<0&&(O=0)):O>q&&(O=q),U<0?(U+=q,U<0&&(U=0)):U>q&&(U=q),U<O&&(U=O);const L=this.subarray(O,U);return Object.setPrototypeOf(L,c.prototype),L};function fe(ee,O,U){if(ee%1!==0||ee<0)throw new RangeError("offset is not uint");if(ee+O>U)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(O,U,q){O=O>>>0,U=U>>>0,q||fe(O,U,this.length);let L=this[O],F=1,H=0;for(;++H<U&&(F*=256);)L+=this[O+H]*F;return L},c.prototype.readUintBE=c.prototype.readUIntBE=function(O,U,q){O=O>>>0,U=U>>>0,q||fe(O,U,this.length);let L=this[O+--U],F=1;for(;U>0&&(F*=256);)L+=this[O+--U]*F;return L},c.prototype.readUint8=c.prototype.readUInt8=function(O,U){return O=O>>>0,U||fe(O,1,this.length),this[O]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(O,U){return O=O>>>0,U||fe(O,2,this.length),this[O]|this[O+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(O,U){return O=O>>>0,U||fe(O,2,this.length),this[O]<<8|this[O+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),(this[O]|this[O+1]<<8|this[O+2]<<16)+this[O+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),this[O]*16777216+(this[O+1]<<16|this[O+2]<<8|this[O+3])},c.prototype.readBigUInt64LE=mn(function(O){O=O>>>0,Pi(O,"offset");const U=this[O],q=this[O+7];(U===void 0||q===void 0)&&Yt(O,this.length-8);const L=U+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24,F=this[++O]+this[++O]*2**8+this[++O]*2**16+q*2**24;return BigInt(L)+(BigInt(F)<<BigInt(32))}),c.prototype.readBigUInt64BE=mn(function(O){O=O>>>0,Pi(O,"offset");const U=this[O],q=this[O+7];(U===void 0||q===void 0)&&Yt(O,this.length-8);const L=U*2**24+this[++O]*2**16+this[++O]*2**8+this[++O],F=this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+q;return(BigInt(L)<<BigInt(32))+BigInt(F)}),c.prototype.readIntLE=function(O,U,q){O=O>>>0,U=U>>>0,q||fe(O,U,this.length);let L=this[O],F=1,H=0;for(;++H<U&&(F*=256);)L+=this[O+H]*F;return F*=128,L>=F&&(L-=Math.pow(2,8*U)),L},c.prototype.readIntBE=function(O,U,q){O=O>>>0,U=U>>>0,q||fe(O,U,this.length);let L=U,F=1,H=this[O+--L];for(;L>0&&(F*=256);)H+=this[O+--L]*F;return F*=128,H>=F&&(H-=Math.pow(2,8*U)),H},c.prototype.readInt8=function(O,U){return O=O>>>0,U||fe(O,1,this.length),this[O]&128?(255-this[O]+1)*-1:this[O]},c.prototype.readInt16LE=function(O,U){O=O>>>0,U||fe(O,2,this.length);const q=this[O]|this[O+1]<<8;return q&32768?q|4294901760:q},c.prototype.readInt16BE=function(O,U){O=O>>>0,U||fe(O,2,this.length);const q=this[O+1]|this[O]<<8;return q&32768?q|4294901760:q},c.prototype.readInt32LE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),this[O]|this[O+1]<<8|this[O+2]<<16|this[O+3]<<24},c.prototype.readInt32BE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),this[O]<<24|this[O+1]<<16|this[O+2]<<8|this[O+3]},c.prototype.readBigInt64LE=mn(function(O){O=O>>>0,Pi(O,"offset");const U=this[O],q=this[O+7];(U===void 0||q===void 0)&&Yt(O,this.length-8);const L=this[O+4]+this[O+5]*2**8+this[O+6]*2**16+(q<<24);return(BigInt(L)<<BigInt(32))+BigInt(U+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24)}),c.prototype.readBigInt64BE=mn(function(O){O=O>>>0,Pi(O,"offset");const U=this[O],q=this[O+7];(U===void 0||q===void 0)&&Yt(O,this.length-8);const L=(U<<24)+this[++O]*2**16+this[++O]*2**8+this[++O];return(BigInt(L)<<BigInt(32))+BigInt(this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+q)}),c.prototype.readFloatLE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),w.read(this,O,!0,23,4)},c.prototype.readFloatBE=function(O,U){return O=O>>>0,U||fe(O,4,this.length),w.read(this,O,!1,23,4)},c.prototype.readDoubleLE=function(O,U){return O=O>>>0,U||fe(O,8,this.length),w.read(this,O,!0,52,8)},c.prototype.readDoubleBE=function(O,U){return O=O>>>0,U||fe(O,8,this.length),w.read(this,O,!1,52,8)};function Re(ee,O,U,q,L,F){if(!c.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>L||O<F)throw new RangeError('"value" argument is out of bounds');if(U+q>ee.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(O,U,q,L){if(O=+O,U=U>>>0,q=q>>>0,!L){const ae=Math.pow(2,8*q)-1;Re(this,O,U,q,ae,0)}let F=1,H=0;for(this[U]=O&255;++H<q&&(F*=256);)this[U+H]=O/F&255;return U+q},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(O,U,q,L){if(O=+O,U=U>>>0,q=q>>>0,!L){const ae=Math.pow(2,8*q)-1;Re(this,O,U,q,ae,0)}let F=q-1,H=1;for(this[U+F]=O&255;--F>=0&&(H*=256);)this[U+F]=O/H&255;return U+q},c.prototype.writeUint8=c.prototype.writeUInt8=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,1,255,0),this[U]=O&255,U+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,2,65535,0),this[U]=O&255,this[U+1]=O>>>8,U+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,2,65535,0),this[U]=O>>>8,this[U+1]=O&255,U+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,4,4294967295,0),this[U+3]=O>>>24,this[U+2]=O>>>16,this[U+1]=O>>>8,this[U]=O&255,U+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,4,4294967295,0),this[U]=O>>>24,this[U+1]=O>>>16,this[U+2]=O>>>8,this[U+3]=O&255,U+4};function Ze(ee,O,U,q,L){ri(O,q,L,ee,U,7);let F=Number(O&BigInt(4294967295));ee[U++]=F,F=F>>8,ee[U++]=F,F=F>>8,ee[U++]=F,F=F>>8,ee[U++]=F;let H=Number(O>>BigInt(32)&BigInt(4294967295));return ee[U++]=H,H=H>>8,ee[U++]=H,H=H>>8,ee[U++]=H,H=H>>8,ee[U++]=H,U}function mt(ee,O,U,q,L){ri(O,q,L,ee,U,7);let F=Number(O&BigInt(4294967295));ee[U+7]=F,F=F>>8,ee[U+6]=F,F=F>>8,ee[U+5]=F,F=F>>8,ee[U+4]=F;let H=Number(O>>BigInt(32)&BigInt(4294967295));return ee[U+3]=H,H=H>>8,ee[U+2]=H,H=H>>8,ee[U+1]=H,H=H>>8,ee[U]=H,U+8}c.prototype.writeBigUInt64LE=mn(function(O,U=0){return Ze(this,O,U,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=mn(function(O,U=0){return mt(this,O,U,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(O,U,q,L){if(O=+O,U=U>>>0,!L){const pe=Math.pow(2,8*q-1);Re(this,O,U,q,pe-1,-pe)}let F=0,H=1,ae=0;for(this[U]=O&255;++F<q&&(H*=256);)O<0&&ae===0&&this[U+F-1]!==0&&(ae=1),this[U+F]=(O/H>>0)-ae&255;return U+q},c.prototype.writeIntBE=function(O,U,q,L){if(O=+O,U=U>>>0,!L){const pe=Math.pow(2,8*q-1);Re(this,O,U,q,pe-1,-pe)}let F=q-1,H=1,ae=0;for(this[U+F]=O&255;--F>=0&&(H*=256);)O<0&&ae===0&&this[U+F+1]!==0&&(ae=1),this[U+F]=(O/H>>0)-ae&255;return U+q},c.prototype.writeInt8=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,1,127,-128),O<0&&(O=255+O+1),this[U]=O&255,U+1},c.prototype.writeInt16LE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,2,32767,-32768),this[U]=O&255,this[U+1]=O>>>8,U+2},c.prototype.writeInt16BE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,2,32767,-32768),this[U]=O>>>8,this[U+1]=O&255,U+2},c.prototype.writeInt32LE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,4,2147483647,-2147483648),this[U]=O&255,this[U+1]=O>>>8,this[U+2]=O>>>16,this[U+3]=O>>>24,U+4},c.prototype.writeInt32BE=function(O,U,q){return O=+O,U=U>>>0,q||Re(this,O,U,4,2147483647,-2147483648),O<0&&(O=4294967295+O+1),this[U]=O>>>24,this[U+1]=O>>>16,this[U+2]=O>>>8,this[U+3]=O&255,U+4},c.prototype.writeBigInt64LE=mn(function(O,U=0){return Ze(this,O,U,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=mn(function(O,U=0){return mt(this,O,U,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function It(ee,O,U,q,L,F){if(U+q>ee.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function Pt(ee,O,U,q,L){return O=+O,U=U>>>0,L||It(ee,O,U,4),w.write(ee,O,U,q,23,4),U+4}c.prototype.writeFloatLE=function(O,U,q){return Pt(this,O,U,!0,q)},c.prototype.writeFloatBE=function(O,U,q){return Pt(this,O,U,!1,q)};function Rt(ee,O,U,q,L){return O=+O,U=U>>>0,L||It(ee,O,U,8),w.write(ee,O,U,q,52,8),U+8}c.prototype.writeDoubleLE=function(O,U,q){return Rt(this,O,U,!0,q)},c.prototype.writeDoubleBE=function(O,U,q){return Rt(this,O,U,!1,q)},c.prototype.copy=function(O,U,q,L){if(!c.isBuffer(O))throw new TypeError("argument should be a Buffer");if(q||(q=0),!L&&L!==0&&(L=this.length),U>=O.length&&(U=O.length),U||(U=0),L>0&&L<q&&(L=q),L===q||O.length===0||this.length===0)return 0;if(U<0)throw new RangeError("targetStart out of bounds");if(q<0||q>=this.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length),O.length-U<L-q&&(L=O.length-U+q);const F=L-q;return this===O&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(U,q,L):Uint8Array.prototype.set.call(O,this.subarray(q,L),U),F},c.prototype.fill=function(O,U,q,L){if(typeof O=="string"){if(typeof U=="string"?(L=U,U=0,q=this.length):typeof q=="string"&&(L=q,q=this.length),L!==void 0&&typeof L!="string")throw new TypeError("encoding must be a string");if(typeof L=="string"&&!c.isEncoding(L))throw new TypeError("Unknown encoding: "+L);if(O.length===1){const H=O.charCodeAt(0);(L==="utf8"&&H<128||L==="latin1")&&(O=H)}}else typeof O=="number"?O=O&255:typeof O=="boolean"&&(O=Number(O));if(U<0||this.length<U||this.length<q)throw new RangeError("Out of range index");if(q<=U)return this;U=U>>>0,q=q===void 0?this.length:q>>>0,O||(O=0);let F;if(typeof O=="number")for(F=U;F<q;++F)this[F]=O;else{const H=c.isBuffer(O)?O:c.from(O,L),ae=H.length;if(ae===0)throw new TypeError('The value "'+O+'" is invalid for argument "value"');for(F=0;F<q-U;++F)this[F+U]=H[F%ae]}return this};const Dt={};function Bt(ee,O,U){Dt[ee]=class extends U{constructor(){super(),Object.defineProperty(this,"message",{value:O.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ee}]`,this.stack,delete this.name}get code(){return ee}set code(L){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:L,writable:!0})}toString(){return`${this.name} [${ee}]: ${this.message}`}}}Bt("ERR_BUFFER_OUT_OF_BOUNDS",function(ee){return ee?`${ee} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Bt("ERR_INVALID_ARG_TYPE",function(ee,O){return`The "${ee}" argument must be of type number. Received type ${typeof O}`},TypeError),Bt("ERR_OUT_OF_RANGE",function(ee,O,U){let q=`The value of "${ee}" is out of range.`,L=U;return Number.isInteger(U)&&Math.abs(U)>2**32?L=bi(String(U)):typeof U=="bigint"&&(L=String(U),(U>BigInt(2)**BigInt(32)||U<-(BigInt(2)**BigInt(32)))&&(L=bi(L)),L+="n"),q+=` It must be ${O}. Received ${L}`,q},RangeError);function bi(ee){let O="",U=ee.length;const q=ee[0]==="-"?1:0;for(;U>=q+4;U-=3)O=`_${ee.slice(U-3,U)}${O}`;return`${ee.slice(0,U)}${O}`}function Qt(ee,O,U){Pi(O,"offset"),(ee[O]===void 0||ee[O+U]===void 0)&&Yt(O,ee.length-(U+1))}function ri(ee,O,U,q,L,F){if(ee>U||ee<O){const H=typeof O=="bigint"?"n":"";let ae;throw O===0||O===BigInt(0)?ae=`>= 0${H} and < 2${H} ** ${(F+1)*8}${H}`:ae=`>= -(2${H} ** ${(F+1)*8-1}${H}) and < 2 ** ${(F+1)*8-1}${H}`,new Dt.ERR_OUT_OF_RANGE("value",ae,ee)}Qt(q,L,F)}function Pi(ee,O){if(typeof ee!="number")throw new Dt.ERR_INVALID_ARG_TYPE(O,"number",ee)}function Yt(ee,O,U){throw Math.floor(ee)!==ee?(Pi(ee,U),new Dt.ERR_OUT_OF_RANGE("offset","an integer",ee)):O<0?new Dt.ERR_BUFFER_OUT_OF_BOUNDS:new Dt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${O}`,ee)}const gi=/[^+/0-9A-Za-z-_]/g;function jt(ee){if(ee=ee.split("=")[0],ee=ee.trim().replace(gi,""),ee.length<2)return"";for(;ee.length%4!==0;)ee=ee+"=";return ee}function nn(ee,O){O=O||1/0;let U;const q=ee.length;let L=null;const F=[];for(let H=0;H<q;++H){if(U=ee.charCodeAt(H),U>55295&&U<57344){if(!L){if(U>56319){(O-=3)>-1&&F.push(239,191,189);continue}else if(H+1===q){(O-=3)>-1&&F.push(239,191,189);continue}L=U;continue}if(U<56320){(O-=3)>-1&&F.push(239,191,189),L=U;continue}U=(L-55296<<10|U-56320)+65536}else L&&(O-=3)>-1&&F.push(239,191,189);if(L=null,U<128){if((O-=1)<0)break;F.push(U)}else if(U<2048){if((O-=2)<0)break;F.push(U>>6|192,U&63|128)}else if(U<65536){if((O-=3)<0)break;F.push(U>>12|224,U>>6&63|128,U&63|128)}else if(U<1114112){if((O-=4)<0)break;F.push(U>>18|240,U>>12&63|128,U>>6&63|128,U&63|128)}else throw new Error("Invalid code point")}return F}function Ti(ee){const O=[];for(let U=0;U<ee.length;++U)O.push(ee.charCodeAt(U)&255);return O}function zi(ee,O){let U,q,L;const F=[];for(let H=0;H<ee.length&&!((O-=2)<0);++H)U=ee.charCodeAt(H),q=U>>8,L=U%256,F.push(L),F.push(q);return F}function Gi(ee){return y.toByteArray(jt(ee))}function er(ee,O,U,q){let L;for(L=0;L<q&&!(L+U>=O.length||L>=ee.length);++L)O[L+U]=ee[L];return L}function Xi(ee,O){return ee instanceof O||ee!=null&&ee.constructor!=null&&ee.constructor.name!=null&&ee.constructor.name===O.name}function tr(ee){return ee!==ee}const Ei=(function(){const ee="0123456789abcdef",O=new Array(256);for(let U=0;U<16;++U){const q=U*16;for(let L=0;L<16;++L)O[q+L]=ee[U]+ee[L]}return O})();function mn(ee){return typeof BigInt>"u"?Ui:ee}function Ui(){throw new Error("BigInt not supported")}})(Pg)),Pg}var Dg,W_;function ah(){if(W_)return Dg;W_=1;var h=a0(),y=h.Buffer,w={},S;for(S in h)h.hasOwnProperty(S)&&(S==="SlowBuffer"||S==="Buffer"||(w[S]=h[S]));var P=w.Buffer={};for(S in y)y.hasOwnProperty(S)&&(S==="allocUnsafe"||S==="allocUnsafeSlow"||(P[S]=y[S]));if(w.Buffer.prototype=y.prototype,(!P.from||P.from===Uint8Array.from)&&(P.from=function(G,z,c){if(typeof G=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof G);if(G&&typeof G.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof G);return y(G,z,c)}),P.alloc||(P.alloc=function(G,z,c){if(typeof G!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof G);if(G<0||G>=2*(1<<30))throw new RangeError('The value "'+G+'" is invalid for option "size"');var K=y(G);return!z||z.length===0?K.fill(0):typeof c=="string"?K.fill(z,c):K.fill(z),K}),!w.kStringMaxLength)try{w.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}return w.constants||(w.constants={MAX_LENGTH:w.kMaxLength},w.kStringMaxLength&&(w.constants.MAX_STRING_LENGTH=w.kStringMaxLength)),Dg=w,Dg}var Bm={},K_;function y1(){if(K_)return Bm;K_=1;var h="\uFEFF";Bm.PrependBOM=y;function y(S,P){this.encoder=S,this.addBOM=!0}y.prototype.write=function(S){return this.addBOM&&(S=h+S,this.addBOM=!1),this.encoder.write(S)},y.prototype.end=function(){return this.encoder.end()},Bm.StripBOM=w;function w(S,P){this.decoder=S,this.pass=!1,this.options=P||{}}return w.prototype.write=function(S){var P=this.decoder.write(S);return this.pass||!P||(P[0]===h&&(P=P.slice(1),typeof this.options.stripBOM=="function"&&this.options.stripBOM()),this.pass=!0),P},w.prototype.end=function(){return this.decoder.end()},Bm}var kg={};const v1={},b1=Object.freeze(Object.defineProperty({__proto__:null,default:v1},Symbol.toStringTag,{value:"Module"})),s0=Z0(b1);var Rg,Q_;function x1(){if(Q_)return Rg;Q_=1;var h=ah().Buffer;Rg={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:y};function y(K,$){this.enc=K.encodingName,this.bomAware=K.bomAware,this.enc==="base64"?this.encoder=G:this.enc==="cesu8"&&(this.enc="utf8",this.encoder=z,h.from("eda0bdedb2a9","hex").toString()!==""&&(this.decoder=c,this.defaultCharUnicode=$.defaultCharUnicode))}y.prototype.encoder=P,y.prototype.decoder=S;var w=s0.StringDecoder;w.prototype.end||(w.prototype.end=function(){});function S(K,$){this.decoder=new w($.enc)}S.prototype.write=function(K){return h.isBuffer(K)||(K=h.from(K)),this.decoder.write(K)},S.prototype.end=function(){return this.decoder.end()};function P(K,$){this.enc=$.enc}P.prototype.write=function(K){return h.from(K,this.enc)},P.prototype.end=function(){};function G(K,$){this.prevStr=""}G.prototype.write=function(K){K=this.prevStr+K;var $=K.length-K.length%4;return this.prevStr=K.slice($),K=K.slice(0,$),h.from(K,"base64")},G.prototype.end=function(){return h.from(this.prevStr,"base64")};function z(K,$){}z.prototype.write=function(K){for(var $=h.alloc(K.length*3),oe=0,ce=0;ce<K.length;ce++){var ge=K.charCodeAt(ce);ge<128?$[oe++]=ge:ge<2048?($[oe++]=192+(ge>>>6),$[oe++]=128+(ge&63)):($[oe++]=224+(ge>>>12),$[oe++]=128+(ge>>>6&63),$[oe++]=128+(ge&63))}return $.slice(0,oe)},z.prototype.end=function(){};function c(K,$){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=$.defaultCharUnicode}return c.prototype.write=function(K){for(var $=this.acc,oe=this.contBytes,ce=this.accBytes,ge="",Me=0;Me<K.length;Me++){var Ae=K[Me];(Ae&192)!==128?(oe>0&&(ge+=this.defaultCharUnicode,oe=0),Ae<128?ge+=String.fromCharCode(Ae):Ae<224?($=Ae&31,oe=1,ce=1):Ae<240?($=Ae&15,oe=2,ce=1):ge+=this.defaultCharUnicode):oe>0?($=$<<6|Ae&63,oe--,ce++,oe===0&&(ce===2&&$<128&&$>0?ge+=this.defaultCharUnicode:ce===3&&$<2048?ge+=this.defaultCharUnicode:ge+=String.fromCharCode($))):ge+=this.defaultCharUnicode}return this.acc=$,this.contBytes=oe,this.accBytes=ce,ge},c.prototype.end=function(){var K=0;return this.contBytes>0&&(K+=this.defaultCharUnicode),K},Rg}var tu={},J_;function w1(){if(J_)return tu;J_=1;var h=ah().Buffer;tu._utf32=y;function y($,oe){this.iconv=oe,this.bomAware=!0,this.isLE=$.isLE}tu.utf32le={type:"_utf32",isLE:!0},tu.utf32be={type:"_utf32",isLE:!1},tu.ucs4le="utf32le",tu.ucs4be="utf32be",y.prototype.encoder=w,y.prototype.decoder=S;function w($,oe){this.isLE=oe.isLE,this.highSurrogate=0}w.prototype.write=function($){for(var oe=h.from($,"ucs2"),ce=h.alloc(oe.length*2),ge=this.isLE?ce.writeUInt32LE:ce.writeUInt32BE,Me=0,Ae=0;Ae<oe.length;Ae+=2){var ie=oe.readUInt16LE(Ae),Ve=55296<=ie&&ie<56320,ot=56320<=ie&&ie<57344;if(this.highSurrogate)if(Ve||!ot)ge.call(ce,this.highSurrogate,Me),Me+=4;else{var Ye=(this.highSurrogate-55296<<10|ie-56320)+65536;ge.call(ce,Ye,Me),Me+=4,this.highSurrogate=0;continue}Ve?this.highSurrogate=ie:(ge.call(ce,ie,Me),Me+=4,this.highSurrogate=0)}return Me<ce.length&&(ce=ce.slice(0,Me)),ce},w.prototype.end=function(){if(this.highSurrogate){var $=h.alloc(4);return this.isLE?$.writeUInt32LE(this.highSurrogate,0):$.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,$}};function S($,oe){this.isLE=oe.isLE,this.badChar=oe.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}S.prototype.write=function($){if($.length===0)return"";var oe=0,ce=0,ge=h.alloc($.length+4),Me=0,Ae=this.isLE,ie=this.overflow,Ve=this.badChar;if(ie.length>0){for(;oe<$.length&&ie.length<4;oe++)ie.push($[oe]);ie.length===4&&(Ae?ce=ie[oe]|ie[oe+1]<<8|ie[oe+2]<<16|ie[oe+3]<<24:ce=ie[oe+3]|ie[oe+2]<<8|ie[oe+1]<<16|ie[oe]<<24,ie.length=0,Me=P(ge,Me,ce,Ve))}for(;oe<$.length-3;oe+=4)Ae?ce=$[oe]|$[oe+1]<<8|$[oe+2]<<16|$[oe+3]<<24:ce=$[oe+3]|$[oe+2]<<8|$[oe+1]<<16|$[oe]<<24,Me=P(ge,Me,ce,Ve);for(;oe<$.length;oe++)ie.push($[oe]);return ge.slice(0,Me).toString("ucs2")};function P($,oe,ce,ge){if((ce<0||ce>1114111)&&(ce=ge),ce>=65536){ce-=65536;var Me=55296|ce>>10;$[oe++]=Me&255,$[oe++]=Me>>8;var ce=56320|ce&1023}return $[oe++]=ce&255,$[oe++]=ce>>8,oe}S.prototype.end=function(){this.overflow.length=0},tu.utf32=G,tu.ucs4="utf32";function G($,oe){this.iconv=oe}G.prototype.encoder=z,G.prototype.decoder=c;function z($,oe){$=$||{},$.addBOM===void 0&&($.addBOM=!0),this.encoder=oe.iconv.getEncoder($.defaultEncoding||"utf-32le",$)}z.prototype.write=function($){return this.encoder.write($)},z.prototype.end=function(){return this.encoder.end()};function c($,oe){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=$||{},this.iconv=oe.iconv}c.prototype.write=function($){if(!this.decoder){if(this.initialBufs.push($),this.initialBufsLen+=$.length,this.initialBufsLen<32)return"";var oe=K(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(oe,this.options);for(var ce="",ge=0;ge<this.initialBufs.length;ge++)ce+=this.decoder.write(this.initialBufs[ge]);return this.initialBufs.length=this.initialBufsLen=0,ce}return this.decoder.write($)},c.prototype.end=function(){if(!this.decoder){var $=K(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder($,this.options);for(var oe="",ce=0;ce<this.initialBufs.length;ce++)oe+=this.decoder.write(this.initialBufs[ce]);var ge=this.decoder.end();return ge&&(oe+=ge),this.initialBufs.length=this.initialBufsLen=0,oe}return this.decoder.end()};function K($,oe){var ce=[],ge=0,Me=0,Ae=0,ie=0,Ve=0;e:for(var ot=0;ot<$.length;ot++)for(var Ye=$[ot],Le=0;Le<Ye.length;Le++)if(ce.push(Ye[Le]),ce.length===4){if(ge===0){if(ce[0]===255&&ce[1]===254&&ce[2]===0&&ce[3]===0)return"utf-32le";if(ce[0]===0&&ce[1]===0&&ce[2]===254&&ce[3]===255)return"utf-32be"}if((ce[0]!==0||ce[1]>16)&&Ae++,(ce[3]!==0||ce[2]>16)&&Me++,ce[0]===0&&ce[1]===0&&(ce[2]!==0||ce[3]!==0)&&Ve++,(ce[0]!==0||ce[1]!==0)&&ce[2]===0&&ce[3]===0&&ie++,ce.length=0,ge++,ge>=100)break e}return Ve-Ae>ie-Me?"utf-32be":Ve-Ae<ie-Me?"utf-32le":oe||"utf-32le"}return tu}var Lm={},ey;function S1(){if(ey)return Lm;ey=1;var h=ah().Buffer;Lm.utf16be=y;function y(){}y.prototype.encoder=w,y.prototype.decoder=S,y.prototype.bomAware=!0;function w(){}w.prototype.write=function(K){for(var $=h.from(K,"ucs2"),oe=0;oe<$.length;oe+=2){var ce=$[oe];$[oe]=$[oe+1],$[oe+1]=ce}return $},w.prototype.end=function(){};function S(){this.overflowByte=-1}S.prototype.write=function(K){if(K.length==0)return"";var $=h.alloc(K.length+1),oe=0,ce=0;for(this.overflowByte!==-1&&($[0]=K[0],$[1]=this.overflowByte,oe=1,ce=2);oe<K.length-1;oe+=2,ce+=2)$[ce]=K[oe+1],$[ce+1]=K[oe];return this.overflowByte=oe==K.length-1?K[K.length-1]:-1,$.slice(0,ce).toString("ucs2")},S.prototype.end=function(){this.overflowByte=-1},Lm.utf16=P;function P(K,$){this.iconv=$}P.prototype.encoder=G,P.prototype.decoder=z;function G(K,$){K=K||{},K.addBOM===void 0&&(K.addBOM=!0),this.encoder=$.iconv.getEncoder("utf-16le",K)}G.prototype.write=function(K){return this.encoder.write(K)},G.prototype.end=function(){return this.encoder.end()};function z(K,$){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=K||{},this.iconv=$.iconv}z.prototype.write=function(K){if(!this.decoder){if(this.initialBufs.push(K),this.initialBufsLen+=K.length,this.initialBufsLen<16)return"";var $=c(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder($,this.options);for(var oe="",ce=0;ce<this.initialBufs.length;ce++)oe+=this.decoder.write(this.initialBufs[ce]);return this.initialBufs.length=this.initialBufsLen=0,oe}return this.decoder.write(K)},z.prototype.end=function(){if(!this.decoder){var K=c(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(K,this.options);for(var $="",oe=0;oe<this.initialBufs.length;oe++)$+=this.decoder.write(this.initialBufs[oe]);var ce=this.decoder.end();return ce&&($+=ce),this.initialBufs.length=this.initialBufsLen=0,$}return this.decoder.end()};function c(K,$){var oe=[],ce=0,ge=0,Me=0;e:for(var Ae=0;Ae<K.length;Ae++)for(var ie=K[Ae],Ve=0;Ve<ie.length;Ve++)if(oe.push(ie[Ve]),oe.length===2){if(ce===0){if(oe[0]===255&&oe[1]===254)return"utf-16le";if(oe[0]===254&&oe[1]===255)return"utf-16be"}if(oe[0]===0&&oe[1]!==0&&Me++,oe[0]!==0&&oe[1]===0&&ge++,oe.length=0,ce++,ce>=100)break e}return Me>ge?"utf-16be":Me<ge?"utf-16le":$||"utf-16le"}return Lm}var Lp={},ty;function T1(){if(ty)return Lp;ty=1;var h=ah().Buffer;Lp.utf7=y,Lp.unicode11utf7="utf7";function y(ie,Ve){this.iconv=Ve}y.prototype.encoder=S,y.prototype.decoder=P,y.prototype.bomAware=!0;var w=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function S(ie,Ve){this.iconv=Ve.iconv}S.prototype.write=function(ie){return h.from(ie.replace(w,(function(Ve){return"+"+(Ve==="+"?"":this.iconv.encode(Ve,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}).bind(this)))},S.prototype.end=function(){};function P(ie,Ve){this.iconv=Ve.iconv,this.inBase64=!1,this.base64Accum=""}for(var G=/[A-Za-z0-9\/+]/,z=[],c=0;c<256;c++)z[c]=G.test(String.fromCharCode(c));var K=43,$=45,oe=38;P.prototype.write=function(ie){for(var Ve="",ot=0,Ye=this.inBase64,Le=this.base64Accum,Ke=0;Ke<ie.length;Ke++)if(!Ye)ie[Ke]==K&&(Ve+=this.iconv.decode(ie.slice(ot,Ke),"ascii"),ot=Ke+1,Ye=!0);else if(!z[ie[Ke]]){if(Ke==ot&&ie[Ke]==$)Ve+="+";else{var _t=Le+this.iconv.decode(ie.slice(ot,Ke),"ascii");Ve+=this.iconv.decode(h.from(_t,"base64"),"utf16-be")}ie[Ke]!=$&&Ke--,ot=Ke+1,Ye=!1,Le=""}if(!Ye)Ve+=this.iconv.decode(ie.slice(ot),"ascii");else{var _t=Le+this.iconv.decode(ie.slice(ot),"ascii"),ht=_t.length-_t.length%8;Le=_t.slice(ht),_t=_t.slice(0,ht),Ve+=this.iconv.decode(h.from(_t,"base64"),"utf16-be")}return this.inBase64=Ye,this.base64Accum=Le,Ve},P.prototype.end=function(){var ie="";return this.inBase64&&this.base64Accum.length>0&&(ie=this.iconv.decode(h.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",ie},Lp.utf7imap=ce;function ce(ie,Ve){this.iconv=Ve}ce.prototype.encoder=ge,ce.prototype.decoder=Me,ce.prototype.bomAware=!0;function ge(ie,Ve){this.iconv=Ve.iconv,this.inBase64=!1,this.base64Accum=h.alloc(6),this.base64AccumIdx=0}ge.prototype.write=function(ie){for(var Ve=this.inBase64,ot=this.base64Accum,Ye=this.base64AccumIdx,Le=h.alloc(ie.length*5+10),Ke=0,_t=0;_t<ie.length;_t++){var ht=ie.charCodeAt(_t);32<=ht&&ht<=126?(Ve&&(Ye>0&&(Ke+=Le.write(ot.slice(0,Ye).toString("base64").replace(/\//g,",").replace(/=+$/,""),Ke),Ye=0),Le[Ke++]=$,Ve=!1),Ve||(Le[Ke++]=ht,ht===oe&&(Le[Ke++]=$))):(Ve||(Le[Ke++]=oe,Ve=!0),Ve&&(ot[Ye++]=ht>>8,ot[Ye++]=ht&255,Ye==ot.length&&(Ke+=Le.write(ot.toString("base64").replace(/\//g,","),Ke),Ye=0)))}return this.inBase64=Ve,this.base64AccumIdx=Ye,Le.slice(0,Ke)},ge.prototype.end=function(){var ie=h.alloc(10),Ve=0;return this.inBase64&&(this.base64AccumIdx>0&&(Ve+=ie.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),Ve),this.base64AccumIdx=0),ie[Ve++]=$,this.inBase64=!1),ie.slice(0,Ve)};function Me(ie,Ve){this.iconv=Ve.iconv,this.inBase64=!1,this.base64Accum=""}var Ae=z.slice();return Ae[44]=!0,Me.prototype.write=function(ie){for(var Ve="",ot=0,Ye=this.inBase64,Le=this.base64Accum,Ke=0;Ke<ie.length;Ke++)if(!Ye)ie[Ke]==oe&&(Ve+=this.iconv.decode(ie.slice(ot,Ke),"ascii"),ot=Ke+1,Ye=!0);else if(!Ae[ie[Ke]]){if(Ke==ot&&ie[Ke]==$)Ve+="&";else{var _t=Le+this.iconv.decode(ie.slice(ot,Ke),"ascii").replace(/,/g,"/");Ve+=this.iconv.decode(h.from(_t,"base64"),"utf16-be")}ie[Ke]!=$&&Ke--,ot=Ke+1,Ye=!1,Le=""}if(!Ye)Ve+=this.iconv.decode(ie.slice(ot),"ascii");else{var _t=Le+this.iconv.decode(ie.slice(ot),"ascii").replace(/,/g,"/"),ht=_t.length-_t.length%8;Le=_t.slice(ht),_t=_t.slice(0,ht),Ve+=this.iconv.decode(h.from(_t,"base64"),"utf16-be")}return this.inBase64=Ye,this.base64Accum=Le,Ve},Me.prototype.end=function(){var ie="";return this.inBase64&&this.base64Accum.length>0&&(ie=this.iconv.decode(h.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",ie},Lp}var Bg={},iy;function E1(){if(iy)return Bg;iy=1;var h=ah().Buffer;Bg._sbcs=y;function y(P,G){if(!P)throw new Error("SBCS codec is called without the data.");if(!P.chars||P.chars.length!==128&&P.chars.length!==256)throw new Error("Encoding '"+P.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(P.chars.length===128){for(var z="",c=0;c<128;c++)z+=String.fromCharCode(c);P.chars=z+P.chars}this.decodeBuf=h.from(P.chars,"ucs2");for(var K=h.alloc(65536,G.defaultCharSingleByte.charCodeAt(0)),c=0;c<P.chars.length;c++)K[P.chars.charCodeAt(c)]=c;this.encodeBuf=K}y.prototype.encoder=w,y.prototype.decoder=S;function w(P,G){this.encodeBuf=G.encodeBuf}w.prototype.write=function(P){for(var G=h.alloc(P.length),z=0;z<P.length;z++)G[z]=this.encodeBuf[P.charCodeAt(z)];return G},w.prototype.end=function(){};function S(P,G){this.decodeBuf=G.decodeBuf}return S.prototype.write=function(P){for(var G=this.decodeBuf,z=h.alloc(P.length*2),c=0,K=0,$=0;$<P.length;$++)c=P[$]*2,K=$*2,z[K]=G[c],z[K+1]=G[c+1];return z.toString("ucs2")},S.prototype.end=function(){},Bg}var Lg,ny;function M1(){return ny||(ny=1,Lg={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}),Lg}var Og,ry;function A1(){return ry||(ry=1,Og={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\uFEFF"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`},iso646cn:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}`},iso646jp:{type:"_sbcs",chars:`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_\`abcdefghijklmnopqrstuvwxyz{|}`},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}),Og}var Fg={},ay;function z1(){if(ay)return Fg;ay=1;var h=ah().Buffer;Fg._dbcs=K;for(var y=-1,w=-2,S=-10,P=-1e3,G=new Array(256),z=-1,c=0;c<256;c++)G[c]=y;function K(ge,Me){if(this.encodingName=ge.encodingName,!ge)throw new Error("DBCS codec is called without the data.");if(!ge.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var Ae=ge.table();this.decodeTables=[],this.decodeTables[0]=G.slice(0),this.decodeTableSeq=[];for(var ie=0;ie<Ae.length;ie++)this._addDecodeChunk(Ae[ie]);if(typeof ge.gb18030=="function"){this.gb18030=ge.gb18030();var Ve=this.decodeTables.length;this.decodeTables.push(G.slice(0));var ot=this.decodeTables.length;this.decodeTables.push(G.slice(0));for(var Ye=this.decodeTables[0],ie=129;ie<=254;ie++)for(var Le=this.decodeTables[P-Ye[ie]],Ke=48;Ke<=57;Ke++){if(Le[Ke]===y)Le[Ke]=P-Ve;else if(Le[Ke]>P)throw new Error("gb18030 decode tables conflict at byte 2");for(var _t=this.decodeTables[P-Le[Ke]],ht=129;ht<=254;ht++){if(_t[ht]===y)_t[ht]=P-ot;else{if(_t[ht]===P-ot)continue;if(_t[ht]>P)throw new Error("gb18030 decode tables conflict at byte 3")}for(var St=this.decodeTables[P-_t[ht]],be=48;be<=57;be++)St[be]===y&&(St[be]=w)}}}this.defaultCharUnicode=Me.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var Ie={};if(ge.encodeSkipVals)for(var ie=0;ie<ge.encodeSkipVals.length;ie++){var tt=ge.encodeSkipVals[ie];if(typeof tt=="number")Ie[tt]=!0;else for(var Ke=tt.from;Ke<=tt.to;Ke++)Ie[Ke]=!0}if(this._fillEncodeTable(0,0,Ie),ge.encodeAdd)for(var bt in ge.encodeAdd)Object.prototype.hasOwnProperty.call(ge.encodeAdd,bt)&&this._setEncodeChar(bt.charCodeAt(0),ge.encodeAdd[bt]);this.defCharSB=this.encodeTable[0][Me.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===y&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===y&&(this.defCharSB=63)}K.prototype.encoder=$,K.prototype.decoder=oe,K.prototype._getDecodeTrieNode=function(ge){for(var Me=[];ge>0;ge>>>=8)Me.push(ge&255);Me.length==0&&Me.push(0);for(var Ae=this.decodeTables[0],ie=Me.length-1;ie>0;ie--){var Ve=Ae[Me[ie]];if(Ve==y)Ae[Me[ie]]=P-this.decodeTables.length,this.decodeTables.push(Ae=G.slice(0));else if(Ve<=P)Ae=this.decodeTables[P-Ve];else throw new Error("Overwrite byte in "+this.encodingName+", addr: "+ge.toString(16))}return Ae},K.prototype._addDecodeChunk=function(ge){var Me=parseInt(ge[0],16),Ae=this._getDecodeTrieNode(Me);Me=Me&255;for(var ie=1;ie<ge.length;ie++){var Ve=ge[ie];if(typeof Ve=="string")for(var ot=0;ot<Ve.length;){var Ye=Ve.charCodeAt(ot++);if(55296<=Ye&&Ye<56320){var Le=Ve.charCodeAt(ot++);if(56320<=Le&&Le<57344)Ae[Me++]=65536+(Ye-55296)*1024+(Le-56320);else throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+ge[0])}else if(4080<Ye&&Ye<=4095){for(var Ke=4095-Ye+2,_t=[],ht=0;ht<Ke;ht++)_t.push(Ve.charCodeAt(ot++));Ae[Me++]=S-this.decodeTableSeq.length,this.decodeTableSeq.push(_t)}else Ae[Me++]=Ye}else if(typeof Ve=="number")for(var St=Ae[Me-1]+1,ot=0;ot<Ve;ot++)Ae[Me++]=St++;else throw new Error("Incorrect type '"+typeof Ve+"' given in "+this.encodingName+" at chunk "+ge[0])}if(Me>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+ge[0]+": too long"+Me)},K.prototype._getEncodeBucket=function(ge){var Me=ge>>8;return this.encodeTable[Me]===void 0&&(this.encodeTable[Me]=G.slice(0)),this.encodeTable[Me]},K.prototype._setEncodeChar=function(ge,Me){var Ae=this._getEncodeBucket(ge),ie=ge&255;Ae[ie]<=S?this.encodeTableSeq[S-Ae[ie]][z]=Me:Ae[ie]==y&&(Ae[ie]=Me)},K.prototype._setEncodeSequence=function(ge,Me){var Ae=ge[0],ie=this._getEncodeBucket(Ae),Ve=Ae&255,ot;ie[Ve]<=S?ot=this.encodeTableSeq[S-ie[Ve]]:(ot={},ie[Ve]!==y&&(ot[z]=ie[Ve]),ie[Ve]=S-this.encodeTableSeq.length,this.encodeTableSeq.push(ot));for(var Ye=1;Ye<ge.length-1;Ye++){var Le=ot[Ae];typeof Le=="object"?ot=Le:(ot=ot[Ae]={},Le!==void 0&&(ot[z]=Le))}Ae=ge[ge.length-1],ot[Ae]=Me},K.prototype._fillEncodeTable=function(ge,Me,Ae){for(var ie=this.decodeTables[ge],Ve=!1,ot={},Ye=0;Ye<256;Ye++){var Le=ie[Ye],Ke=Me+Ye;if(!Ae[Ke])if(Le>=0)this._setEncodeChar(Le,Ke),Ve=!0;else if(Le<=P){var _t=P-Le;if(!ot[_t]){var ht=Ke<<8>>>0;this._fillEncodeTable(_t,ht,Ae)?Ve=!0:ot[_t]=!0}}else Le<=S&&(this._setEncodeSequence(this.decodeTableSeq[S-Le],Ke),Ve=!0)}return Ve};function $(ge,Me){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=Me.encodeTable,this.encodeTableSeq=Me.encodeTableSeq,this.defaultCharSingleByte=Me.defCharSB,this.gb18030=Me.gb18030}$.prototype.write=function(ge){for(var Me=h.alloc(ge.length*(this.gb18030?4:3)),Ae=this.leadSurrogate,ie=this.seqObj,Ve=-1,ot=0,Ye=0;;){if(Ve===-1){if(ot==ge.length)break;var Le=ge.charCodeAt(ot++)}else{var Le=Ve;Ve=-1}if(55296<=Le&&Le<57344)if(Le<56320)if(Ae===-1){Ae=Le;continue}else Ae=Le,Le=y;else Ae!==-1?(Le=65536+(Ae-55296)*1024+(Le-56320),Ae=-1):Le=y;else Ae!==-1&&(Ve=Le,Le=y,Ae=-1);var Ke=y;if(ie!==void 0&&Le!=y){var _t=ie[Le];if(typeof _t=="object"){ie=_t;continue}else typeof _t=="number"?Ke=_t:_t==null&&(_t=ie[z],_t!==void 0&&(Ke=_t,Ve=Le));ie=void 0}else if(Le>=0){var ht=this.encodeTable[Le>>8];if(ht!==void 0&&(Ke=ht[Le&255]),Ke<=S){ie=this.encodeTableSeq[S-Ke];continue}if(Ke==y&&this.gb18030){var St=ce(this.gb18030.uChars,Le);if(St!=-1){var Ke=this.gb18030.gbChars[St]+(Le-this.gb18030.uChars[St]);Me[Ye++]=129+Math.floor(Ke/12600),Ke=Ke%12600,Me[Ye++]=48+Math.floor(Ke/1260),Ke=Ke%1260,Me[Ye++]=129+Math.floor(Ke/10),Ke=Ke%10,Me[Ye++]=48+Ke;continue}}}Ke===y&&(Ke=this.defaultCharSingleByte),Ke<256?Me[Ye++]=Ke:Ke<65536?(Me[Ye++]=Ke>>8,Me[Ye++]=Ke&255):Ke<16777216?(Me[Ye++]=Ke>>16,Me[Ye++]=Ke>>8&255,Me[Ye++]=Ke&255):(Me[Ye++]=Ke>>>24,Me[Ye++]=Ke>>>16&255,Me[Ye++]=Ke>>>8&255,Me[Ye++]=Ke&255)}return this.seqObj=ie,this.leadSurrogate=Ae,Me.slice(0,Ye)},$.prototype.end=function(){if(!(this.leadSurrogate===-1&&this.seqObj===void 0)){var ge=h.alloc(10),Me=0;if(this.seqObj){var Ae=this.seqObj[z];Ae!==void 0&&(Ae<256?ge[Me++]=Ae:(ge[Me++]=Ae>>8,ge[Me++]=Ae&255)),this.seqObj=void 0}return this.leadSurrogate!==-1&&(ge[Me++]=this.defaultCharSingleByte,this.leadSurrogate=-1),ge.slice(0,Me)}},$.prototype.findIdx=ce;function oe(ge,Me){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=Me.decodeTables,this.decodeTableSeq=Me.decodeTableSeq,this.defaultCharUnicode=Me.defaultCharUnicode,this.gb18030=Me.gb18030}oe.prototype.write=function(ge){for(var Me=h.alloc(ge.length*2),Ae=this.nodeIdx,ie=this.prevBytes,Ve=this.prevBytes.length,ot=-this.prevBytes.length,Ye,Le=0,Ke=0;Le<ge.length;Le++){var _t=Le>=0?ge[Le]:ie[Le+Ve],Ye=this.decodeTables[Ae][_t];if(!(Ye>=0))if(Ye===y)Ye=this.defaultCharUnicode.charCodeAt(0),Le=ot;else if(Ye===w){if(Le>=3)var ht=(ge[Le-3]-129)*12600+(ge[Le-2]-48)*1260+(ge[Le-1]-129)*10+(_t-48);else var ht=(ie[Le-3+Ve]-129)*12600+((Le-2>=0?ge[Le-2]:ie[Le-2+Ve])-48)*1260+((Le-1>=0?ge[Le-1]:ie[Le-1+Ve])-129)*10+(_t-48);var St=ce(this.gb18030.gbChars,ht);Ye=this.gb18030.uChars[St]+ht-this.gb18030.gbChars[St]}else if(Ye<=P){Ae=P-Ye;continue}else if(Ye<=S){for(var be=this.decodeTableSeq[S-Ye],Ie=0;Ie<be.length-1;Ie++)Ye=be[Ie],Me[Ke++]=Ye&255,Me[Ke++]=Ye>>8;Ye=be[be.length-1]}else throw new Error("iconv-lite internal error: invalid decoding table value "+Ye+" at "+Ae+"/"+_t);if(Ye>=65536){Ye-=65536;var tt=55296|Ye>>10;Me[Ke++]=tt&255,Me[Ke++]=tt>>8,Ye=56320|Ye&1023}Me[Ke++]=Ye&255,Me[Ke++]=Ye>>8,Ae=0,ot=Le+1}return this.nodeIdx=Ae,this.prevBytes=ot>=0?Array.prototype.slice.call(ge,ot):ie.slice(ot+Ve).concat(Array.prototype.slice.call(ge)),Me.slice(0,Ke).toString("ucs2")},oe.prototype.end=function(){for(var ge="";this.prevBytes.length>0;){ge+=this.defaultCharUnicode;var Me=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,Me.length>0&&(ge+=this.write(Me))}return this.prevBytes=[],this.nodeIdx=0,ge};function ce(ge,Me){if(ge[0]>Me)return-1;for(var Ae=0,ie=ge.length;Ae<ie-1;){var Ve=Ae+(ie-Ae+1>>1);ge[Ve]<=Me?Ae=Ve:ie=Ve}return Ae}return Fg}const C1=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],I1=JSON.parse('[["0","\\u0000",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]'),jg=JSON.parse('[["0","\\u0000",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]'),sy=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],P1=[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],D1=[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3],k1={uChars:P1,gbChars:D1},R1=JSON.parse('[["0","\\u0000",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]'),oy=JSON.parse('[["0","\\u0000",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]'),B1=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var Ug,ly;function L1(){return ly||(ly=1,Ug={shiftjis:{type:"_dbcs",table:function(){return C1},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return I1},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return jg}},gbk:{type:"_dbcs",table:function(){return jg.concat(sy)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return jg.concat(sy)},gb18030:function(){return k1},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return R1}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return oy}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return oy.concat(B1)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}),Ug}var cy;function O1(){return cy||(cy=1,(function(h){for(var y=[x1(),w1(),S1(),T1(),E1(),M1(),A1(),z1(),L1()],w=0;w<y.length;w++){var S=y[w];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(h[P]=S[P])}})(kg)),kg}var Ng,uy;function F1(){if(uy)return Ng;uy=1;var h=ah().Buffer;return Ng=function(y){var w=y.Transform;function S(G,z){this.conv=G,z=z||{},z.decodeStrings=!1,w.call(this,z)}S.prototype=Object.create(w.prototype,{constructor:{value:S}}),S.prototype._transform=function(G,z,c){if(typeof G!="string")return c(new Error("Iconv encoding stream needs strings as its input."));try{var K=this.conv.write(G);K&&K.length&&this.push(K),c()}catch($){c($)}},S.prototype._flush=function(G){try{var z=this.conv.end();z&&z.length&&this.push(z),G()}catch(c){G(c)}},S.prototype.collect=function(G){var z=[];return this.on("error",G),this.on("data",function(c){z.push(c)}),this.on("end",function(){G(null,h.concat(z))}),this};function P(G,z){this.conv=G,z=z||{},z.encoding=this.encoding="utf8",w.call(this,z)}return P.prototype=Object.create(w.prototype,{constructor:{value:P}}),P.prototype._transform=function(G,z,c){if(!h.isBuffer(G)&&!(G instanceof Uint8Array))return c(new Error("Iconv decoding stream needs buffers as its input."));try{var K=this.conv.write(G);K&&K.length&&this.push(K,this.encoding),c()}catch($){c($)}},P.prototype._flush=function(G){try{var z=this.conv.end();z&&z.length&&this.push(z,this.encoding),G()}catch(c){G(c)}},P.prototype.collect=function(G){var z="";return this.on("error",G),this.on("data",function(c){z+=c}),this.on("end",function(){G(null,z)}),this},{IconvLiteEncoderStream:S,IconvLiteDecoderStream:P}},Ng}var hy;function j1(){return hy||(hy=1,(function(h){var y=ah().Buffer,w=y1(),S=h.exports;S.encodings=null,S.defaultCharUnicode="",S.defaultCharSingleByte="?",S.encode=function(z,c,K){z=""+(z||"");var $=S.getEncoder(c,K),oe=$.write(z),ce=$.end();return ce&&ce.length>0?y.concat([oe,ce]):oe},S.decode=function(z,c,K){typeof z=="string"&&(S.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),S.skipDecodeWarning=!0),z=y.from(""+(z||""),"binary"));var $=S.getDecoder(c,K),oe=$.write(z),ce=$.end();return ce?oe+ce:oe},S.encodingExists=function(z){try{return S.getCodec(z),!0}catch{return!1}},S.toEncoding=S.encode,S.fromEncoding=S.decode,S._codecDataCache={},S.getCodec=function(z){S.encodings||(S.encodings=O1());for(var c=S._canonicalizeEncoding(z),K={};;){var $=S._codecDataCache[c];if($)return $;var oe=S.encodings[c];switch(typeof oe){case"string":c=oe;break;case"object":for(var ce in oe)K[ce]=oe[ce];K.encodingName||(K.encodingName=c),c=oe.type;break;case"function":return K.encodingName||(K.encodingName=c),$=new oe(K,S),S._codecDataCache[K.encodingName]=$,$;default:throw new Error("Encoding not recognized: '"+z+"' (searched as: '"+c+"')")}}},S._canonicalizeEncoding=function(G){return(""+G).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},S.getEncoder=function(z,c){var K=S.getCodec(z),$=new K.encoder(c,K);return K.bomAware&&c&&c.addBOM&&($=new w.PrependBOM($,c)),$},S.getDecoder=function(z,c){var K=S.getCodec(z),$=new K.decoder(c,K);return K.bomAware&&!(c&&c.stripBOM===!1)&&($=new w.StripBOM($,c)),$},S.enableStreamingAPI=function(z){if(!S.supportsStreams){var c=F1()(z);S.IconvLiteEncoderStream=c.IconvLiteEncoderStream,S.IconvLiteDecoderStream=c.IconvLiteDecoderStream,S.encodeStream=function($,oe){return new S.IconvLiteEncoderStream(S.getEncoder($,oe),oe)},S.decodeStream=function($,oe){return new S.IconvLiteDecoderStream(S.getDecoder($,oe),oe)},S.supportsStreams=!0}};var P;try{P=s0}catch{}P&&P.Transform?S.enableStreamingAPI(P):S.encodeStream=S.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}})(Ig)),Ig.exports}var U1=j1();const dy=tg(U1);var ao=Uint8Array,mf=Uint16Array,N1=Int32Array,o0=new ao([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l0=new ao([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Z1=new ao([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c0=function(h,y){for(var w=new mf(31),S=0;S<31;++S)w[S]=y+=1<<h[S-1];for(var P=new N1(w[30]),S=1;S<30;++S)for(var G=w[S];G<w[S+1];++G)P[G]=G-w[S]<<5|S;return{b:w,r:P}},u0=c0(o0,2),h0=u0.b,V1=u0.r;h0[28]=258,V1[258]=28;var G1=c0(l0,0),q1=G1.b,i_=new mf(32768);for(var Jn=0;Jn<32768;++Jn){var rh=(Jn&43690)>>1|(Jn&21845)<<1;rh=(rh&52428)>>2|(rh&13107)<<2,rh=(rh&61680)>>4|(rh&3855)<<4,i_[Jn]=((rh&65280)>>8|(rh&255)<<8)>>1}var Fp=(function(h,y,w){for(var S=h.length,P=0,G=new mf(y);P<S;++P)h[P]&&++G[h[P]-1];var z=new mf(y);for(P=1;P<y;++P)z[P]=z[P-1]+G[P-1]<<1;var c;if(w){c=new mf(1<<y);var K=15-y;for(P=0;P<S;++P)if(h[P])for(var $=P<<4|h[P],oe=y-h[P],ce=z[h[P]-1]++<<oe,ge=ce|(1<<oe)-1;ce<=ge;++ce)c[i_[ce]>>K]=$}else for(c=new mf(S),P=0;P<S;++P)h[P]&&(c[P]=i_[z[h[P]-1]++]>>15-h[P]);return c}),qp=new ao(288);for(var Jn=0;Jn<144;++Jn)qp[Jn]=8;for(var Jn=144;Jn<256;++Jn)qp[Jn]=9;for(var Jn=256;Jn<280;++Jn)qp[Jn]=7;for(var Jn=280;Jn<288;++Jn)qp[Jn]=8;var d0=new ao(32);for(var Jn=0;Jn<32;++Jn)d0[Jn]=5;var $1=Fp(qp,9,1),H1=Fp(d0,5,1),Zg=function(h){for(var y=h[0],w=1;w<h.length;++w)h[w]>y&&(y=h[w]);return y},wl=function(h,y,w){var S=y/8|0;return(h[S]|h[S+1]<<8)>>(y&7)&w},Vg=function(h,y){var w=y/8|0;return(h[w]|h[w+1]<<8|h[w+2]<<16)>>(y&7)},X1=function(h){return(h+7)/8|0},h_=function(h,y,w){return(y==null||y<0)&&(y=0),(w==null||w>h.length)&&(w=h.length),new ao(h.subarray(y,w))},Y1=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Bo=function(h,y,w){var S=new Error(y||Y1[h]);if(S.code=h,Error.captureStackTrace&&Error.captureStackTrace(S,Bo),!w)throw S;return S},W1=function(h,y,w,S){var P=h.length,G=S?S.length:0;if(!P||y.f&&!y.l)return w||new ao(0);var z=!w,c=z||y.i!=2,K=y.i;z&&(w=new ao(P*3));var $=function(Qt){var ri=w.length;if(Qt>ri){var Pi=new ao(Math.max(ri*2,Qt));Pi.set(w),w=Pi}},oe=y.f||0,ce=y.p||0,ge=y.b||0,Me=y.l,Ae=y.d,ie=y.m,Ve=y.n,ot=P*8;do{if(!Me){oe=wl(h,ce,1);var Ye=wl(h,ce+1,3);if(ce+=3,Ye)if(Ye==1)Me=$1,Ae=H1,ie=9,Ve=5;else if(Ye==2){var ht=wl(h,ce,31)+257,St=wl(h,ce+10,15)+4,be=ht+wl(h,ce+5,31)+1;ce+=14;for(var Ie=new ao(be),tt=new ao(19),bt=0;bt<St;++bt)tt[Z1[bt]]=wl(h,ce+bt*3,7);ce+=St*3;for(var wt=Zg(tt),Wt=(1<<wt)-1,vi=Fp(tt,wt,1),bt=0;bt<be;){var Si=vi[wl(h,ce,Wt)];ce+=Si&15;var Le=Si>>4;if(Le<16)Ie[bt++]=Le;else{var Ue=0,et=0;for(Le==16?(et=3+wl(h,ce,3),ce+=2,Ue=Ie[bt-1]):Le==17?(et=3+wl(h,ce,7),ce+=3):Le==18&&(et=11+wl(h,ce,127),ce+=7);et--;)Ie[bt++]=Ue}}var it=Ie.subarray(0,ht),dt=Ie.subarray(ht);ie=Zg(it),Ve=Zg(dt),Me=Fp(it,ie,1),Ae=Fp(dt,Ve,1)}else Bo(1);else{var Le=X1(ce)+4,Ke=h[Le-4]|h[Le-3]<<8,_t=Le+Ke;if(_t>P){K&&Bo(0);break}c&&$(ge+Ke),w.set(h.subarray(Le,_t),ge),y.b=ge+=Ke,y.p=ce=_t*8,y.f=oe;continue}if(ce>ot){K&&Bo(0);break}}c&&$(ge+131072);for(var Kt=(1<<ie)-1,fe=(1<<Ve)-1,Re=ce;;Re=ce){var Ue=Me[Vg(h,ce)&Kt],Ze=Ue>>4;if(ce+=Ue&15,ce>ot){K&&Bo(0);break}if(Ue||Bo(2),Ze<256)w[ge++]=Ze;else if(Ze==256){Re=ce,Me=null;break}else{var mt=Ze-254;if(Ze>264){var bt=Ze-257,It=o0[bt];mt=wl(h,ce,(1<<It)-1)+h0[bt],ce+=It}var Pt=Ae[Vg(h,ce)&fe],Rt=Pt>>4;Pt||Bo(3),ce+=Pt&15;var dt=q1[Rt];if(Rt>3){var It=l0[Rt];dt+=Vg(h,ce)&(1<<It)-1,ce+=It}if(ce>ot){K&&Bo(0);break}c&&$(ge+131072);var Dt=ge+mt;if(ge<dt){var Bt=G-dt,bi=Math.min(dt,Dt);for(Bt+ge<0&&Bo(3);ge<bi;++ge)w[ge]=S[Bt+ge]}for(;ge<Dt;++ge)w[ge]=w[ge-dt]}}y.l=Me,y.p=Re,y.b=ge,y.f=oe,Me&&(oe=1,y.m=ie,y.d=Ae,y.n=Ve)}while(!oe);return ge!=w.length&&z?h_(w,0,ge):w.subarray(0,ge)},K1=new ao(0),ec=function(h,y){return h[y]|h[y+1]<<8},Sl=function(h,y){return(h[y]|h[y+1]<<8|h[y+2]<<16|h[y+3]<<24)>>>0},Gg=function(h,y){return Sl(h,y)+Sl(h,y+4)*4294967296};function Q1(h,y){return W1(h,{i:2},y&&y.out,y&&y.dictionary)}var n_=typeof TextDecoder<"u"&&new TextDecoder,J1=0;try{n_.decode(K1,{stream:!0}),J1=1}catch{}var eb=function(h){for(var y="",w=0;;){var S=h[w++],P=(S>127)+(S>223)+(S>239);if(w+P>h.length)return{s:y,r:h_(h,w-1)};P?P==3?(S=((S&15)<<18|(h[w++]&63)<<12|(h[w++]&63)<<6|h[w++]&63)-65536,y+=String.fromCharCode(55296|S>>10,56320|S&1023)):P&1?y+=String.fromCharCode((S&31)<<6|h[w++]&63):y+=String.fromCharCode((S&15)<<12|(h[w++]&63)<<6|h[w++]&63):y+=String.fromCharCode(S)}};function tb(h,y){if(y){for(var w="",S=0;S<h.length;S+=16384)w+=String.fromCharCode.apply(null,h.subarray(S,S+16384));return w}else{if(n_)return n_.decode(h);var P=eb(h),G=P.s,w=P.r;return w.length&&Bo(8),G}}var ib=function(h,y){return y+30+ec(h,y+26)+ec(h,y+28)},nb=function(h,y,w){var S=ec(h,y+28),P=tb(h.subarray(y+46,y+46+S),!(ec(h,y+8)&2048)),G=y+46+S,z=Sl(h,y+20),c=w&&z==4294967295?rb(h,G):[z,Sl(h,y+24),Sl(h,y+42)],K=c[0],$=c[1],oe=c[2];return[ec(h,y+10),K,$,P,G+ec(h,y+30)+ec(h,y+32),oe]},rb=function(h,y){for(;ec(h,y)!=1;y+=4+ec(h,y+2));return[Gg(h,y+12),Gg(h,y+4),Gg(h,y+20)]};function ab(h,y){for(var w={},S=h.length-22;Sl(h,S)!=101010256;--S)(!S||h.length-S>65558)&&Bo(13);var P=ec(h,S+8);if(!P)return{};var G=Sl(h,S+16),z=G==4294967295||P==65535;if(z){var c=Sl(h,S-12);z=Sl(h,c)==101075792,z&&(P=Sl(h,c+32),G=Sl(h,c+48))}for(var K=y&&y.filter,$=0;$<P;++$){var oe=nb(h,G,z),ce=oe[0],ge=oe[1],Me=oe[2],Ae=oe[3],ie=oe[4],Ve=oe[5],ot=ib(h,Ve);G=ie,(!K||K({name:Ae,size:ge,originalSize:Me,compression:ce}))&&(ce?ce==8?w[Ae]=Q1(h.subarray(ot,ot+ge),{out:new ao(Me)}):Bo(14,"unknown compression type "+ce):w[Ae]=h_(h,ot,ot+ge))}return w}var fy=a0();const sb=["stops.txt","routes.txt"];function ob(h,y){if(y==="utf8")return new TextDecoder("utf-8").decode(h);if(y==="shift_jis")return dy.decode(fy.Buffer.from(h),"shift_jis");try{return new TextDecoder("utf-8",{fatal:!0}).decode(h)}catch{return dy.decode(fy.Buffer.from(h),"shift_jis")}}function lb(h){const y=m1.parse(h,{header:!0,skipEmptyLines:!0,dynamicTyping:!1});if(y.errors.length>0){const w=y.errors[0]?.message??"CSV parsing error";throw new Error(`CSV: ${w}`)}return y.data}async function cb(h,y){const w=await h.arrayBuffer(),S=new Uint8Array(w),P=ab(S,{filter:z=>z.name.endsWith(".txt")});sb.forEach(z=>{if(!P[z])throw new Error(`ZIP ${z} `)});const G=z=>{const c=P[z];if(!c)return[];const K=ob(c,y);return lb(K)};return{stops:G("stops.txt"),routes:G("routes.txt"),trips:G("trips.txt"),shapes:G("shapes.txt"),stopTimes:G("stop_times.txt")}}function ub(h){return{stopCount:h.stops.length,routeCount:h.routes.length,tripCount:h.trips.length,shapeCount:h.shapes.length,stopTimeCount:h.stopTimes.length}}function Km(h,y=0){if(!h)return y;const w=Number.parseFloat(h);return Number.isFinite(w)?w:y}function hb(h){const y=h.stop_id??h.stopId;if(!y)return null;const w=Km(h.stop_lon??h.stopLon),S=Km(h.stop_lat??h.stopLat);return{id:y,name:h.stop_name??h.stopName??y,lon:w,lat:S}}function db(h){const y=h.route_short_name??h.routeShortName,w=h.route_long_name??h.routeLongName;return y&&w?`${y} / ${w}`:w||y||(h.route_id??"")}function fb(h,y){const w=y.filter(P=>P.shape_id===h).sort((P,G)=>Number.parseInt(P.shape_pt_sequence??"0",10)-Number.parseInt(G.shape_pt_sequence??"0",10));if(w.length===0)return null;const S=w.map(P=>[Km(P.shape_pt_lon),Km(P.shape_pt_lat)]);return S.length<2?null:{type:"LineString",coordinates:S}}function pb(h,y,w){const S=y.filter(z=>z.trip_id===h).sort((z,c)=>Number.parseInt(z.stop_sequence??"0",10)-Number.parseInt(c.stop_sequence??"0",10)),P=[],G=[];for(const z of S){const c=z.stop_id;if(!c)continue;const K=w.get(c);K&&(G.push(c),P.push([K.lon,K.lat]))}return P.length<2?{geometry:null,stopIds:G}:{geometry:{type:"LineString",coordinates:P},stopIds:G}}function mb(h,y){const w=new Map;y.forEach(S=>w.set(S,0));for(const S of h){const P=S.stop_id;P&&w.set(P,(w.get(P)??0)+1)}return Array.from(w.entries()).map(([S,P])=>({stopId:S,boardings:P,alightings:P}))}function gb(h){const y=new Map;for(const z of h.stops){const c=hb(z);c&&y.set(c.id,c)}const w=[],S=new Set;for(const z of h.routes){const c=z.route_id??z.routeId;if(!c)continue;const K=h.trips.filter(ge=>ge.route_id===c);let $=null,oe=[];const ce=K.find(ge=>ge.shape_id&&ge.shape_id.length>0);if(ce?.shape_id&&($=fb(ce.shape_id,h.shapes)),!$&&K.length>0){const ge=pb(K[0].trip_id,h.stopTimes,y);$=ge.geometry,oe=ge.stopIds}$&&(oe.length===0&&(oe=$.coordinates.map(ge=>Array.from(y.values()).find(Ae=>Ae.lon===ge[0]&&Ae.lat===ge[1])?.id).filter(ge=>!!ge)),oe.forEach(ge=>S.add(ge)),w.push({id:c,name:db(z),geometry:$,stopIds:oe}))}const P=Array.from(y.values()),G=h.stopTimes.length>0?mb(h.stopTimes,S):void 0;return{stops:P,routes:w,usage:G}}function pt(h,y,w){function S(c,K){var $;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),($=c._zod).traits??($.traits=new Set),c._zod.traits.add(h),y(c,K);for(const oe in z.prototype)oe in c||Object.defineProperty(c,oe,{value:z.prototype[oe].bind(c)});c._zod.constr=z,c._zod.def=K}const P=w?.Parent??Object;class G extends P{}Object.defineProperty(G,"name",{value:h});function z(c){var K;const $=w?.Parent?new G:this;S($,c),(K=$._zod).deferred??(K.deferred=[]);for(const oe of $._zod.deferred)oe();return $}return Object.defineProperty(z,"init",{value:S}),Object.defineProperty(z,Symbol.hasInstance,{value:c=>w?.Parent&&c instanceof w.Parent?!0:c?._zod?.traits?.has(h)}),Object.defineProperty(z,"name",{value:h}),z}class yf extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class f0 extends Error{constructor(y){super(`Encountered unidirectional transform during encode: ${y}`),this.name="ZodEncodeError"}}const p0={};function ud(h){return p0}function _b(h){const y=Object.values(h).filter(S=>typeof S=="number");return Object.entries(h).filter(([S,P])=>y.indexOf(+S)===-1).map(([S,P])=>P)}function r_(h,y){return typeof y=="bigint"?y.toString():y}function d_(h){return{get value(){{const y=h();return Object.defineProperty(this,"value",{value:y}),y}}}}function f_(h){return h==null}function p_(h){const y=h.startsWith("^")?1:0,w=h.endsWith("$")?h.length-1:h.length;return h.slice(y,w)}function yb(h,y){const w=(h.toString().split(".")[1]||"").length,S=y.toString();let P=(S.split(".")[1]||"").length;if(P===0&&/\d?e-\d?/.test(S)){const K=S.match(/\d?e-(\d?)/);K?.[1]&&(P=Number.parseInt(K[1]))}const G=w>P?w:P,z=Number.parseInt(h.toFixed(G).replace(".","")),c=Number.parseInt(y.toFixed(G).replace(".",""));return z%c/10**G}const py=Symbol("evaluating");function Nn(h,y,w){let S;Object.defineProperty(h,y,{get(){if(S!==py)return S===void 0&&(S=py,S=w()),S},set(P){Object.defineProperty(h,y,{value:P})},configurable:!0})}function dd(h,y,w){Object.defineProperty(h,y,{value:w,writable:!0,enumerable:!0,configurable:!0})}function fd(...h){const y={};for(const w of h){const S=Object.getOwnPropertyDescriptors(w);Object.assign(y,S)}return Object.defineProperties({},y)}function my(h){return JSON.stringify(h)}const m0="captureStackTrace"in Error?Error.captureStackTrace:(...h)=>{};function Qm(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}const vb=d_(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const h=Function;return new h(""),!0}catch{return!1}});function Zp(h){if(Qm(h)===!1)return!1;const y=h.constructor;if(y===void 0)return!0;const w=y.prototype;return!(Qm(w)===!1||Object.prototype.hasOwnProperty.call(w,"isPrototypeOf")===!1)}function g0(h){return Zp(h)?{...h}:Array.isArray(h)?[...h]:h}const bb=new Set(["string","number","symbol"]);function xf(h){return h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sh(h,y,w){const S=new h._zod.constr(y??h._zod.def);return(!y||w?.parent)&&(S._zod.parent=h),S}function ii(h){const y=h;if(!y)return{};if(typeof y=="string")return{error:()=>y};if(y?.message!==void 0){if(y?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");y.error=y.message}return delete y.message,typeof y.error=="string"?{...y,error:()=>y.error}:y}function xb(h){return Object.keys(h).filter(y=>h[y]._zod.optin==="optional"&&h[y]._zod.optout==="optional")}const wb={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Sb(h,y){const w=h._zod.def,S=fd(h._zod.def,{get shape(){const P={};for(const G in y){if(!(G in w.shape))throw new Error(`Unrecognized key: "${G}"`);y[G]&&(P[G]=w.shape[G])}return dd(this,"shape",P),P},checks:[]});return sh(h,S)}function Tb(h,y){const w=h._zod.def,S=fd(h._zod.def,{get shape(){const P={...h._zod.def.shape};for(const G in y){if(!(G in w.shape))throw new Error(`Unrecognized key: "${G}"`);y[G]&&delete P[G]}return dd(this,"shape",P),P},checks:[]});return sh(h,S)}function Eb(h,y){if(!Zp(y))throw new Error("Invalid input to extend: expected a plain object");const w=h._zod.def.checks;if(w&&w.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const P=fd(h._zod.def,{get shape(){const G={...h._zod.def.shape,...y};return dd(this,"shape",G),G},checks:[]});return sh(h,P)}function Mb(h,y){if(!Zp(y))throw new Error("Invalid input to safeExtend: expected a plain object");const w={...h._zod.def,get shape(){const S={...h._zod.def.shape,...y};return dd(this,"shape",S),S},checks:h._zod.def.checks};return sh(h,w)}function Ab(h,y){const w=fd(h._zod.def,{get shape(){const S={...h._zod.def.shape,...y._zod.def.shape};return dd(this,"shape",S),S},get catchall(){return y._zod.def.catchall},checks:[]});return sh(h,w)}function zb(h,y,w){const S=fd(y._zod.def,{get shape(){const P=y._zod.def.shape,G={...P};if(w)for(const z in w){if(!(z in P))throw new Error(`Unrecognized key: "${z}"`);w[z]&&(G[z]=h?new h({type:"optional",innerType:P[z]}):P[z])}else for(const z in P)G[z]=h?new h({type:"optional",innerType:P[z]}):P[z];return dd(this,"shape",G),G},checks:[]});return sh(y,S)}function Cb(h,y,w){const S=fd(y._zod.def,{get shape(){const P=y._zod.def.shape,G={...P};if(w)for(const z in w){if(!(z in G))throw new Error(`Unrecognized key: "${z}"`);w[z]&&(G[z]=new h({type:"nonoptional",innerType:P[z]}))}else for(const z in P)G[z]=new h({type:"nonoptional",innerType:P[z]});return dd(this,"shape",G),G},checks:[]});return sh(y,S)}function gf(h,y=0){if(h.aborted===!0)return!0;for(let w=y;w<h.issues.length;w++)if(h.issues[w]?.continue!==!0)return!0;return!1}function m_(h,y){return y.map(w=>{var S;return(S=w).path??(S.path=[]),w.path.unshift(h),w})}function Om(h){return typeof h=="string"?h:h?.message}function hd(h,y,w){const S={...h,path:h.path??[]};if(!h.message){const P=Om(h.inst?._zod.def?.error?.(h))??Om(y?.error?.(h))??Om(w.customError?.(h))??Om(w.localeError?.(h))??"Invalid input";S.message=P}return delete S.inst,delete S.continue,y?.reportInput||delete S.input,S}function g_(h){return Array.isArray(h)?"array":typeof h=="string"?"string":"unknown"}function Vp(...h){const[y,w,S]=h;return typeof y=="string"?{message:y,code:"custom",input:w,inst:S}:{...y}}const _0=(h,y)=>{h.name="$ZodError",Object.defineProperty(h,"_zod",{value:h._zod,enumerable:!1}),Object.defineProperty(h,"issues",{value:y,enumerable:!1}),h.message=JSON.stringify(y,r_,2),Object.defineProperty(h,"toString",{value:()=>h.message,enumerable:!1})},y0=pt("$ZodError",_0),v0=pt("$ZodError",_0,{Parent:Error});function Ib(h,y=w=>w.message){const w={},S=[];for(const P of h.issues)P.path.length>0?(w[P.path[0]]=w[P.path[0]]||[],w[P.path[0]].push(y(P))):S.push(y(P));return{formErrors:S,fieldErrors:w}}function Pb(h,y=w=>w.message){const w={_errors:[]},S=P=>{for(const G of P.issues)if(G.code==="invalid_union"&&G.errors.length)G.errors.map(z=>S({issues:z}));else if(G.code==="invalid_key")S({issues:G.issues});else if(G.code==="invalid_element")S({issues:G.issues});else if(G.path.length===0)w._errors.push(y(G));else{let z=w,c=0;for(;c<G.path.length;){const K=G.path[c];c===G.path.length-1?(z[K]=z[K]||{_errors:[]},z[K]._errors.push(y(G))):z[K]=z[K]||{_errors:[]},z=z[K],c++}}};return S(h),w}const __=h=>(y,w,S,P)=>{const G=S?Object.assign(S,{async:!1}):{async:!1},z=y._zod.run({value:w,issues:[]},G);if(z instanceof Promise)throw new yf;if(z.issues.length){const c=new(P?.Err??h)(z.issues.map(K=>hd(K,G,ud())));throw m0(c,P?.callee),c}return z.value},y_=h=>async(y,w,S,P)=>{const G=S?Object.assign(S,{async:!0}):{async:!0};let z=y._zod.run({value:w,issues:[]},G);if(z instanceof Promise&&(z=await z),z.issues.length){const c=new(P?.Err??h)(z.issues.map(K=>hd(K,G,ud())));throw m0(c,P?.callee),c}return z.value},ag=h=>(y,w,S)=>{const P=S?{...S,async:!1}:{async:!1},G=y._zod.run({value:w,issues:[]},P);if(G instanceof Promise)throw new yf;return G.issues.length?{success:!1,error:new(h??y0)(G.issues.map(z=>hd(z,P,ud())))}:{success:!0,data:G.value}},Db=ag(v0),sg=h=>async(y,w,S)=>{const P=S?Object.assign(S,{async:!0}):{async:!0};let G=y._zod.run({value:w,issues:[]},P);return G instanceof Promise&&(G=await G),G.issues.length?{success:!1,error:new h(G.issues.map(z=>hd(z,P,ud())))}:{success:!0,data:G.value}},kb=sg(v0),Rb=h=>(y,w,S)=>{const P=S?Object.assign(S,{direction:"backward"}):{direction:"backward"};return __(h)(y,w,P)},Bb=h=>(y,w,S)=>__(h)(y,w,S),Lb=h=>async(y,w,S)=>{const P=S?Object.assign(S,{direction:"backward"}):{direction:"backward"};return y_(h)(y,w,P)},Ob=h=>async(y,w,S)=>y_(h)(y,w,S),Fb=h=>(y,w,S)=>{const P=S?Object.assign(S,{direction:"backward"}):{direction:"backward"};return ag(h)(y,w,P)},jb=h=>(y,w,S)=>ag(h)(y,w,S),Ub=h=>async(y,w,S)=>{const P=S?Object.assign(S,{direction:"backward"}):{direction:"backward"};return sg(h)(y,w,P)},Nb=h=>async(y,w,S)=>sg(h)(y,w,S),Zb=/^[cC][^\s-]{8,}$/,Vb=/^[0-9a-z]+$/,Gb=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,qb=/^[0-9a-vA-V]{20}$/,$b=/^[A-Za-z0-9]{27}$/,Hb=/^[a-zA-Z0-9_-]{21}$/,Xb=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Yb=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,gy=h=>h?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${h}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Wb=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Kb="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Qb(){return new RegExp(Kb,"u")}const Jb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ex=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,tx=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ix=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nx=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,b0=/^[A-Za-z0-9_-]*$/,rx=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,ax=/^\+(?:[0-9]){6,14}[0-9]$/,x0="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",sx=new RegExp(`^${x0}$`);function w0(h){const y="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof h.precision=="number"?h.precision===-1?`${y}`:h.precision===0?`${y}:[0-5]\\d`:`${y}:[0-5]\\d\\.\\d{${h.precision}}`:`${y}(?::[0-5]\\d(?:\\.\\d+)?)?`}function ox(h){return new RegExp(`^${w0(h)}$`)}function lx(h){const y=w0({precision:h.precision}),w=["Z"];h.local&&w.push(""),h.offset&&w.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const S=`${y}(?:${w.join("|")})`;return new RegExp(`^${x0}T(?:${S})$`)}const cx=h=>{const y=h?`[\\s\\S]{${h?.minimum??0},${h?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${y}$`)},ux=/^-?\d+$/,hx=/^-?\d+(?:\.\d+)?/,dx=/^(?:true|false)$/i,fx=/^[^A-Z]*$/,px=/^[^a-z]*$/,Ms=pt("$ZodCheck",(h,y)=>{var w;h._zod??(h._zod={}),h._zod.def=y,(w=h._zod).onattach??(w.onattach=[])}),S0={number:"number",bigint:"bigint",object:"date"},T0=pt("$ZodCheckLessThan",(h,y)=>{Ms.init(h,y);const w=S0[typeof y.value];h._zod.onattach.push(S=>{const P=S._zod.bag,G=(y.inclusive?P.maximum:P.exclusiveMaximum)??Number.POSITIVE_INFINITY;y.value<G&&(y.inclusive?P.maximum=y.value:P.exclusiveMaximum=y.value)}),h._zod.check=S=>{(y.inclusive?S.value<=y.value:S.value<y.value)||S.issues.push({origin:w,code:"too_big",maximum:y.value,input:S.value,inclusive:y.inclusive,inst:h,continue:!y.abort})}}),E0=pt("$ZodCheckGreaterThan",(h,y)=>{Ms.init(h,y);const w=S0[typeof y.value];h._zod.onattach.push(S=>{const P=S._zod.bag,G=(y.inclusive?P.minimum:P.exclusiveMinimum)??Number.NEGATIVE_INFINITY;y.value>G&&(y.inclusive?P.minimum=y.value:P.exclusiveMinimum=y.value)}),h._zod.check=S=>{(y.inclusive?S.value>=y.value:S.value>y.value)||S.issues.push({origin:w,code:"too_small",minimum:y.value,input:S.value,inclusive:y.inclusive,inst:h,continue:!y.abort})}}),mx=pt("$ZodCheckMultipleOf",(h,y)=>{Ms.init(h,y),h._zod.onattach.push(w=>{var S;(S=w._zod.bag).multipleOf??(S.multipleOf=y.value)}),h._zod.check=w=>{if(typeof w.value!=typeof y.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof w.value=="bigint"?w.value%y.value===BigInt(0):yb(w.value,y.value)===0)||w.issues.push({origin:typeof w.value,code:"not_multiple_of",divisor:y.value,input:w.value,inst:h,continue:!y.abort})}}),gx=pt("$ZodCheckNumberFormat",(h,y)=>{Ms.init(h,y),y.format=y.format||"float64";const w=y.format?.includes("int"),S=w?"int":"number",[P,G]=wb[y.format];h._zod.onattach.push(z=>{const c=z._zod.bag;c.format=y.format,c.minimum=P,c.maximum=G,w&&(c.pattern=ux)}),h._zod.check=z=>{const c=z.value;if(w){if(!Number.isInteger(c)){z.issues.push({expected:S,format:y.format,code:"invalid_type",continue:!1,input:c,inst:h});return}if(!Number.isSafeInteger(c)){c>0?z.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:h,origin:S,continue:!y.abort}):z.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:h,origin:S,continue:!y.abort});return}}c<P&&z.issues.push({origin:"number",input:c,code:"too_small",minimum:P,inclusive:!0,inst:h,continue:!y.abort}),c>G&&z.issues.push({origin:"number",input:c,code:"too_big",maximum:G,inst:h})}}),_x=pt("$ZodCheckMaxLength",(h,y)=>{var w;Ms.init(h,y),(w=h._zod.def).when??(w.when=S=>{const P=S.value;return!f_(P)&&P.length!==void 0}),h._zod.onattach.push(S=>{const P=S._zod.bag.maximum??Number.POSITIVE_INFINITY;y.maximum<P&&(S._zod.bag.maximum=y.maximum)}),h._zod.check=S=>{const P=S.value;if(P.length<=y.maximum)return;const z=g_(P);S.issues.push({origin:z,code:"too_big",maximum:y.maximum,inclusive:!0,input:P,inst:h,continue:!y.abort})}}),yx=pt("$ZodCheckMinLength",(h,y)=>{var w;Ms.init(h,y),(w=h._zod.def).when??(w.when=S=>{const P=S.value;return!f_(P)&&P.length!==void 0}),h._zod.onattach.push(S=>{const P=S._zod.bag.minimum??Number.NEGATIVE_INFINITY;y.minimum>P&&(S._zod.bag.minimum=y.minimum)}),h._zod.check=S=>{const P=S.value;if(P.length>=y.minimum)return;const z=g_(P);S.issues.push({origin:z,code:"too_small",minimum:y.minimum,inclusive:!0,input:P,inst:h,continue:!y.abort})}}),vx=pt("$ZodCheckLengthEquals",(h,y)=>{var w;Ms.init(h,y),(w=h._zod.def).when??(w.when=S=>{const P=S.value;return!f_(P)&&P.length!==void 0}),h._zod.onattach.push(S=>{const P=S._zod.bag;P.minimum=y.length,P.maximum=y.length,P.length=y.length}),h._zod.check=S=>{const P=S.value,G=P.length;if(G===y.length)return;const z=g_(P),c=G>y.length;S.issues.push({origin:z,...c?{code:"too_big",maximum:y.length}:{code:"too_small",minimum:y.length},inclusive:!0,exact:!0,input:S.value,inst:h,continue:!y.abort})}}),og=pt("$ZodCheckStringFormat",(h,y)=>{var w,S;Ms.init(h,y),h._zod.onattach.push(P=>{const G=P._zod.bag;G.format=y.format,y.pattern&&(G.patterns??(G.patterns=new Set),G.patterns.add(y.pattern))}),y.pattern?(w=h._zod).check??(w.check=P=>{y.pattern.lastIndex=0,!y.pattern.test(P.value)&&P.issues.push({origin:"string",code:"invalid_format",format:y.format,input:P.value,...y.pattern?{pattern:y.pattern.toString()}:{},inst:h,continue:!y.abort})}):(S=h._zod).check??(S.check=()=>{})}),bx=pt("$ZodCheckRegex",(h,y)=>{og.init(h,y),h._zod.check=w=>{y.pattern.lastIndex=0,!y.pattern.test(w.value)&&w.issues.push({origin:"string",code:"invalid_format",format:"regex",input:w.value,pattern:y.pattern.toString(),inst:h,continue:!y.abort})}}),xx=pt("$ZodCheckLowerCase",(h,y)=>{y.pattern??(y.pattern=fx),og.init(h,y)}),wx=pt("$ZodCheckUpperCase",(h,y)=>{y.pattern??(y.pattern=px),og.init(h,y)}),Sx=pt("$ZodCheckIncludes",(h,y)=>{Ms.init(h,y);const w=xf(y.includes),S=new RegExp(typeof y.position=="number"?`^.{${y.position}}${w}`:w);y.pattern=S,h._zod.onattach.push(P=>{const G=P._zod.bag;G.patterns??(G.patterns=new Set),G.patterns.add(S)}),h._zod.check=P=>{P.value.includes(y.includes,y.position)||P.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:y.includes,input:P.value,inst:h,continue:!y.abort})}}),Tx=pt("$ZodCheckStartsWith",(h,y)=>{Ms.init(h,y);const w=new RegExp(`^${xf(y.prefix)}.*`);y.pattern??(y.pattern=w),h._zod.onattach.push(S=>{const P=S._zod.bag;P.patterns??(P.patterns=new Set),P.patterns.add(w)}),h._zod.check=S=>{S.value.startsWith(y.prefix)||S.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:y.prefix,input:S.value,inst:h,continue:!y.abort})}}),Ex=pt("$ZodCheckEndsWith",(h,y)=>{Ms.init(h,y);const w=new RegExp(`.*${xf(y.suffix)}$`);y.pattern??(y.pattern=w),h._zod.onattach.push(S=>{const P=S._zod.bag;P.patterns??(P.patterns=new Set),P.patterns.add(w)}),h._zod.check=S=>{S.value.endsWith(y.suffix)||S.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:y.suffix,input:S.value,inst:h,continue:!y.abort})}}),Mx=pt("$ZodCheckOverwrite",(h,y)=>{Ms.init(h,y),h._zod.check=w=>{w.value=y.tx(w.value)}});class Ax{constructor(y=[]){this.content=[],this.indent=0,this&&(this.args=y)}indented(y){this.indent+=1,y(this),this.indent-=1}write(y){if(typeof y=="function"){y(this,{execution:"sync"}),y(this,{execution:"async"});return}const S=y.split(`
`).filter(z=>z),P=Math.min(...S.map(z=>z.length-z.trimStart().length)),G=S.map(z=>z.slice(P)).map(z=>" ".repeat(this.indent*2)+z);for(const z of G)this.content.push(z)}compile(){const y=Function,w=this?.args,P=[...(this?.content??[""]).map(G=>`  ${G}`)];return new y(...w,P.join(`
`))}}const zx={major:4,minor:1,patch:12},ur=pt("$ZodType",(h,y)=>{var w;h??(h={}),h._zod.def=y,h._zod.bag=h._zod.bag||{},h._zod.version=zx;const S=[...h._zod.def.checks??[]];h._zod.traits.has("$ZodCheck")&&S.unshift(h);for(const P of S)for(const G of P._zod.onattach)G(h);if(S.length===0)(w=h._zod).deferred??(w.deferred=[]),h._zod.deferred?.push(()=>{h._zod.run=h._zod.parse});else{const P=(z,c,K)=>{let $=gf(z),oe;for(const ce of c){if(ce._zod.def.when){if(!ce._zod.def.when(z))continue}else if($)continue;const ge=z.issues.length,Me=ce._zod.check(z);if(Me instanceof Promise&&K?.async===!1)throw new yf;if(oe||Me instanceof Promise)oe=(oe??Promise.resolve()).then(async()=>{await Me,z.issues.length!==ge&&($||($=gf(z,ge)))});else{if(z.issues.length===ge)continue;$||($=gf(z,ge))}}return oe?oe.then(()=>z):z},G=(z,c,K)=>{if(gf(z))return z.aborted=!0,z;const $=P(c,S,K);if($ instanceof Promise){if(K.async===!1)throw new yf;return $.then(oe=>h._zod.parse(oe,K))}return h._zod.parse($,K)};h._zod.run=(z,c)=>{if(c.skipChecks)return h._zod.parse(z,c);if(c.direction==="backward"){const $=h._zod.parse({value:z.value,issues:[]},{...c,skipChecks:!0});return $ instanceof Promise?$.then(oe=>G(oe,z,c)):G($,z,c)}const K=h._zod.parse(z,c);if(K instanceof Promise){if(c.async===!1)throw new yf;return K.then($=>P($,S,c))}return P(K,S,c)}}h["~standard"]={validate:P=>{try{const G=Db(h,P);return G.success?{value:G.data}:{issues:G.error?.issues}}catch{return kb(h,P).then(z=>z.success?{value:z.data}:{issues:z.error?.issues})}},vendor:"zod",version:1}}),v_=pt("$ZodString",(h,y)=>{ur.init(h,y),h._zod.pattern=[...h?._zod.bag?.patterns??[]].pop()??cx(h._zod.bag),h._zod.parse=(w,S)=>{if(y.coerce)try{w.value=String(w.value)}catch{}return typeof w.value=="string"||w.issues.push({expected:"string",code:"invalid_type",input:w.value,inst:h}),w}}),hr=pt("$ZodStringFormat",(h,y)=>{og.init(h,y),v_.init(h,y)}),Cx=pt("$ZodGUID",(h,y)=>{y.pattern??(y.pattern=Yb),hr.init(h,y)}),Ix=pt("$ZodUUID",(h,y)=>{if(y.version){const S={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[y.version];if(S===void 0)throw new Error(`Invalid UUID version: "${y.version}"`);y.pattern??(y.pattern=gy(S))}else y.pattern??(y.pattern=gy());hr.init(h,y)}),Px=pt("$ZodEmail",(h,y)=>{y.pattern??(y.pattern=Wb),hr.init(h,y)}),Dx=pt("$ZodURL",(h,y)=>{hr.init(h,y),h._zod.check=w=>{try{const S=w.value.trim(),P=new URL(S);y.hostname&&(y.hostname.lastIndex=0,y.hostname.test(P.hostname)||w.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:rx.source,input:w.value,inst:h,continue:!y.abort})),y.protocol&&(y.protocol.lastIndex=0,y.protocol.test(P.protocol.endsWith(":")?P.protocol.slice(0,-1):P.protocol)||w.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:y.protocol.source,input:w.value,inst:h,continue:!y.abort})),y.normalize?w.value=P.href:w.value=S;return}catch{w.issues.push({code:"invalid_format",format:"url",input:w.value,inst:h,continue:!y.abort})}}}),kx=pt("$ZodEmoji",(h,y)=>{y.pattern??(y.pattern=Qb()),hr.init(h,y)}),Rx=pt("$ZodNanoID",(h,y)=>{y.pattern??(y.pattern=Hb),hr.init(h,y)}),Bx=pt("$ZodCUID",(h,y)=>{y.pattern??(y.pattern=Zb),hr.init(h,y)}),Lx=pt("$ZodCUID2",(h,y)=>{y.pattern??(y.pattern=Vb),hr.init(h,y)}),Ox=pt("$ZodULID",(h,y)=>{y.pattern??(y.pattern=Gb),hr.init(h,y)}),Fx=pt("$ZodXID",(h,y)=>{y.pattern??(y.pattern=qb),hr.init(h,y)}),jx=pt("$ZodKSUID",(h,y)=>{y.pattern??(y.pattern=$b),hr.init(h,y)}),Ux=pt("$ZodISODateTime",(h,y)=>{y.pattern??(y.pattern=lx(y)),hr.init(h,y)}),Nx=pt("$ZodISODate",(h,y)=>{y.pattern??(y.pattern=sx),hr.init(h,y)}),Zx=pt("$ZodISOTime",(h,y)=>{y.pattern??(y.pattern=ox(y)),hr.init(h,y)}),Vx=pt("$ZodISODuration",(h,y)=>{y.pattern??(y.pattern=Xb),hr.init(h,y)}),Gx=pt("$ZodIPv4",(h,y)=>{y.pattern??(y.pattern=Jb),hr.init(h,y),h._zod.onattach.push(w=>{const S=w._zod.bag;S.format="ipv4"})}),qx=pt("$ZodIPv6",(h,y)=>{y.pattern??(y.pattern=ex),hr.init(h,y),h._zod.onattach.push(w=>{const S=w._zod.bag;S.format="ipv6"}),h._zod.check=w=>{try{new URL(`http://[${w.value}]`)}catch{w.issues.push({code:"invalid_format",format:"ipv6",input:w.value,inst:h,continue:!y.abort})}}}),$x=pt("$ZodCIDRv4",(h,y)=>{y.pattern??(y.pattern=tx),hr.init(h,y)}),Hx=pt("$ZodCIDRv6",(h,y)=>{y.pattern??(y.pattern=ix),hr.init(h,y),h._zod.check=w=>{const S=w.value.split("/");try{if(S.length!==2)throw new Error;const[P,G]=S;if(!G)throw new Error;const z=Number(G);if(`${z}`!==G)throw new Error;if(z<0||z>128)throw new Error;new URL(`http://[${P}]`)}catch{w.issues.push({code:"invalid_format",format:"cidrv6",input:w.value,inst:h,continue:!y.abort})}}});function M0(h){if(h==="")return!0;if(h.length%4!==0)return!1;try{return atob(h),!0}catch{return!1}}const Xx=pt("$ZodBase64",(h,y)=>{y.pattern??(y.pattern=nx),hr.init(h,y),h._zod.onattach.push(w=>{w._zod.bag.contentEncoding="base64"}),h._zod.check=w=>{M0(w.value)||w.issues.push({code:"invalid_format",format:"base64",input:w.value,inst:h,continue:!y.abort})}});function Yx(h){if(!b0.test(h))return!1;const y=h.replace(/[-_]/g,S=>S==="-"?"+":"/"),w=y.padEnd(Math.ceil(y.length/4)*4,"=");return M0(w)}const Wx=pt("$ZodBase64URL",(h,y)=>{y.pattern??(y.pattern=b0),hr.init(h,y),h._zod.onattach.push(w=>{w._zod.bag.contentEncoding="base64url"}),h._zod.check=w=>{Yx(w.value)||w.issues.push({code:"invalid_format",format:"base64url",input:w.value,inst:h,continue:!y.abort})}}),Kx=pt("$ZodE164",(h,y)=>{y.pattern??(y.pattern=ax),hr.init(h,y)});function Qx(h,y=null){try{const w=h.split(".");if(w.length!==3)return!1;const[S]=w;if(!S)return!1;const P=JSON.parse(atob(S));return!("typ"in P&&P?.typ!=="JWT"||!P.alg||y&&(!("alg"in P)||P.alg!==y))}catch{return!1}}const Jx=pt("$ZodJWT",(h,y)=>{hr.init(h,y),h._zod.check=w=>{Qx(w.value,y.alg)||w.issues.push({code:"invalid_format",format:"jwt",input:w.value,inst:h,continue:!y.abort})}}),A0=pt("$ZodNumber",(h,y)=>{ur.init(h,y),h._zod.pattern=h._zod.bag.pattern??hx,h._zod.parse=(w,S)=>{if(y.coerce)try{w.value=Number(w.value)}catch{}const P=w.value;if(typeof P=="number"&&!Number.isNaN(P)&&Number.isFinite(P))return w;const G=typeof P=="number"?Number.isNaN(P)?"NaN":Number.isFinite(P)?void 0:"Infinity":void 0;return w.issues.push({expected:"number",code:"invalid_type",input:P,inst:h,...G?{received:G}:{}}),w}}),ew=pt("$ZodNumber",(h,y)=>{gx.init(h,y),A0.init(h,y)}),tw=pt("$ZodBoolean",(h,y)=>{ur.init(h,y),h._zod.pattern=dx,h._zod.parse=(w,S)=>{if(y.coerce)try{w.value=!!w.value}catch{}const P=w.value;return typeof P=="boolean"||w.issues.push({expected:"boolean",code:"invalid_type",input:P,inst:h}),w}}),iw=pt("$ZodUnknown",(h,y)=>{ur.init(h,y),h._zod.parse=w=>w}),nw=pt("$ZodNever",(h,y)=>{ur.init(h,y),h._zod.parse=(w,S)=>(w.issues.push({expected:"never",code:"invalid_type",input:w.value,inst:h}),w)});function _y(h,y,w){h.issues.length&&y.issues.push(...m_(w,h.issues)),y.value[w]=h.value}const rw=pt("$ZodArray",(h,y)=>{ur.init(h,y),h._zod.parse=(w,S)=>{const P=w.value;if(!Array.isArray(P))return w.issues.push({expected:"array",code:"invalid_type",input:P,inst:h}),w;w.value=Array(P.length);const G=[];for(let z=0;z<P.length;z++){const c=P[z],K=y.element._zod.run({value:c,issues:[]},S);K instanceof Promise?G.push(K.then($=>_y($,w,z))):_y(K,w,z)}return G.length?Promise.all(G).then(()=>w):w}});function Jm(h,y,w,S){h.issues.length&&y.issues.push(...m_(w,h.issues)),h.value===void 0?w in S&&(y.value[w]=void 0):y.value[w]=h.value}function z0(h){const y=Object.keys(h.shape);for(const S of y)if(!h.shape?.[S]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${S}": expected a Zod schema`);const w=xb(h.shape);return{...h,keys:y,keySet:new Set(y),numKeys:y.length,optionalKeys:new Set(w)}}function C0(h,y,w,S,P,G){const z=[],c=P.keySet,K=P.catchall._zod,$=K.def.type;for(const oe of Object.keys(y)){if(c.has(oe))continue;if($==="never"){z.push(oe);continue}const ce=K.run({value:y[oe],issues:[]},S);ce instanceof Promise?h.push(ce.then(ge=>Jm(ge,w,oe,y))):Jm(ce,w,oe,y)}return z.length&&w.issues.push({code:"unrecognized_keys",keys:z,input:y,inst:G}),h.length?Promise.all(h).then(()=>w):w}const aw=pt("$ZodObject",(h,y)=>{if(ur.init(h,y),!Object.getOwnPropertyDescriptor(y,"shape")?.get){const c=y.shape;Object.defineProperty(y,"shape",{get:()=>{const K={...c};return Object.defineProperty(y,"shape",{value:K}),K}})}const S=d_(()=>z0(y));Nn(h._zod,"propValues",()=>{const c=y.shape,K={};for(const $ in c){const oe=c[$]._zod;if(oe.values){K[$]??(K[$]=new Set);for(const ce of oe.values)K[$].add(ce)}}return K});const P=Qm,G=y.catchall;let z;h._zod.parse=(c,K)=>{z??(z=S.value);const $=c.value;if(!P($))return c.issues.push({expected:"object",code:"invalid_type",input:$,inst:h}),c;c.value={};const oe=[],ce=z.shape;for(const ge of z.keys){const Ae=ce[ge]._zod.run({value:$[ge],issues:[]},K);Ae instanceof Promise?oe.push(Ae.then(ie=>Jm(ie,c,ge,$))):Jm(Ae,c,ge,$)}return G?C0(oe,$,c,K,S.value,h):oe.length?Promise.all(oe).then(()=>c):c}}),sw=pt("$ZodObjectJIT",(h,y)=>{aw.init(h,y);const w=h._zod.parse,S=d_(()=>z0(y)),P=ge=>{const Me=new Ax(["shape","payload","ctx"]),Ae=S.value,ie=Le=>{const Ke=my(Le);return`shape[${Ke}]._zod.run({ value: input[${Ke}], issues: [] }, ctx)`};Me.write("const input = payload.value;");const Ve=Object.create(null);let ot=0;for(const Le of Ae.keys)Ve[Le]=`key_${ot++}`;Me.write("const newResult = {};");for(const Le of Ae.keys){const Ke=Ve[Le],_t=my(Le);Me.write(`const ${Ke} = ${ie(Le)};`),Me.write(`
        if (${Ke}.issues.length) {
          payload.issues = payload.issues.concat(${Ke}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${_t}, ...iss.path] : [${_t}]
          })));
        }
        
        
        if (${Ke}.value === undefined) {
          if (${_t} in input) {
            newResult[${_t}] = undefined;
          }
        } else {
          newResult[${_t}] = ${Ke}.value;
        }
        
      `)}Me.write("payload.value = newResult;"),Me.write("return payload;");const Ye=Me.compile();return(Le,Ke)=>Ye(ge,Le,Ke)};let G;const z=Qm,c=!p0.jitless,$=c&&vb.value,oe=y.catchall;let ce;h._zod.parse=(ge,Me)=>{ce??(ce=S.value);const Ae=ge.value;return z(Ae)?c&&$&&Me?.async===!1&&Me.jitless!==!0?(G||(G=P(y.shape)),ge=G(ge,Me),oe?C0([],Ae,ge,Me,ce,h):ge):w(ge,Me):(ge.issues.push({expected:"object",code:"invalid_type",input:Ae,inst:h}),ge)}});function yy(h,y,w,S){for(const G of h)if(G.issues.length===0)return y.value=G.value,y;const P=h.filter(G=>!gf(G));return P.length===1?(y.value=P[0].value,P[0]):(y.issues.push({code:"invalid_union",input:y.value,inst:w,errors:h.map(G=>G.issues.map(z=>hd(z,S,ud())))}),y)}const ow=pt("$ZodUnion",(h,y)=>{ur.init(h,y),Nn(h._zod,"optin",()=>y.options.some(P=>P._zod.optin==="optional")?"optional":void 0),Nn(h._zod,"optout",()=>y.options.some(P=>P._zod.optout==="optional")?"optional":void 0),Nn(h._zod,"values",()=>{if(y.options.every(P=>P._zod.values))return new Set(y.options.flatMap(P=>Array.from(P._zod.values)))}),Nn(h._zod,"pattern",()=>{if(y.options.every(P=>P._zod.pattern)){const P=y.options.map(G=>G._zod.pattern);return new RegExp(`^(${P.map(G=>p_(G.source)).join("|")})$`)}});const w=y.options.length===1,S=y.options[0]._zod.run;h._zod.parse=(P,G)=>{if(w)return S(P,G);let z=!1;const c=[];for(const K of y.options){const $=K._zod.run({value:P.value,issues:[]},G);if($ instanceof Promise)c.push($),z=!0;else{if($.issues.length===0)return $;c.push($)}}return z?Promise.all(c).then(K=>yy(K,P,h,G)):yy(c,P,h,G)}}),lw=pt("$ZodIntersection",(h,y)=>{ur.init(h,y),h._zod.parse=(w,S)=>{const P=w.value,G=y.left._zod.run({value:P,issues:[]},S),z=y.right._zod.run({value:P,issues:[]},S);return G instanceof Promise||z instanceof Promise?Promise.all([G,z]).then(([K,$])=>vy(w,K,$)):vy(w,G,z)}});function a_(h,y){if(h===y)return{valid:!0,data:h};if(h instanceof Date&&y instanceof Date&&+h==+y)return{valid:!0,data:h};if(Zp(h)&&Zp(y)){const w=Object.keys(y),S=Object.keys(h).filter(G=>w.indexOf(G)!==-1),P={...h,...y};for(const G of S){const z=a_(h[G],y[G]);if(!z.valid)return{valid:!1,mergeErrorPath:[G,...z.mergeErrorPath]};P[G]=z.data}return{valid:!0,data:P}}if(Array.isArray(h)&&Array.isArray(y)){if(h.length!==y.length)return{valid:!1,mergeErrorPath:[]};const w=[];for(let S=0;S<h.length;S++){const P=h[S],G=y[S],z=a_(P,G);if(!z.valid)return{valid:!1,mergeErrorPath:[S,...z.mergeErrorPath]};w.push(z.data)}return{valid:!0,data:w}}return{valid:!1,mergeErrorPath:[]}}function vy(h,y,w){if(y.issues.length&&h.issues.push(...y.issues),w.issues.length&&h.issues.push(...w.issues),gf(h))return h;const S=a_(y.value,w.value);if(!S.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(S.mergeErrorPath)}`);return h.value=S.data,h}const cw=pt("$ZodTuple",(h,y)=>{ur.init(h,y);const w=y.items,S=w.length-[...w].reverse().findIndex(P=>P._zod.optin!=="optional");h._zod.parse=(P,G)=>{const z=P.value;if(!Array.isArray(z))return P.issues.push({input:z,inst:h,expected:"tuple",code:"invalid_type"}),P;P.value=[];const c=[];if(!y.rest){const $=z.length>w.length,oe=z.length<S-1;if($||oe)return P.issues.push({...$?{code:"too_big",maximum:w.length}:{code:"too_small",minimum:w.length},input:z,inst:h,origin:"array"}),P}let K=-1;for(const $ of w){if(K++,K>=z.length&&K>=S)continue;const oe=$._zod.run({value:z[K],issues:[]},G);oe instanceof Promise?c.push(oe.then(ce=>Fm(ce,P,K))):Fm(oe,P,K)}if(y.rest){const $=z.slice(w.length);for(const oe of $){K++;const ce=y.rest._zod.run({value:oe,issues:[]},G);ce instanceof Promise?c.push(ce.then(ge=>Fm(ge,P,K))):Fm(ce,P,K)}}return c.length?Promise.all(c).then(()=>P):P}});function Fm(h,y,w){h.issues.length&&y.issues.push(...m_(w,h.issues)),y.value[w]=h.value}const uw=pt("$ZodEnum",(h,y)=>{ur.init(h,y);const w=_b(y.entries),S=new Set(w);h._zod.values=S,h._zod.pattern=new RegExp(`^(${w.filter(P=>bb.has(typeof P)).map(P=>typeof P=="string"?xf(P):P.toString()).join("|")})$`),h._zod.parse=(P,G)=>{const z=P.value;return S.has(z)||P.issues.push({code:"invalid_value",values:w,input:z,inst:h}),P}}),hw=pt("$ZodLiteral",(h,y)=>{if(ur.init(h,y),y.values.length===0)throw new Error("Cannot create literal schema with no valid values");h._zod.values=new Set(y.values),h._zod.pattern=new RegExp(`^(${y.values.map(w=>typeof w=="string"?xf(w):w?xf(w.toString()):String(w)).join("|")})$`),h._zod.parse=(w,S)=>{const P=w.value;return h._zod.values.has(P)||w.issues.push({code:"invalid_value",values:y.values,input:P,inst:h}),w}}),dw=pt("$ZodTransform",(h,y)=>{ur.init(h,y),h._zod.parse=(w,S)=>{if(S.direction==="backward")throw new f0(h.constructor.name);const P=y.transform(w.value,w);if(S.async)return(P instanceof Promise?P:Promise.resolve(P)).then(z=>(w.value=z,w));if(P instanceof Promise)throw new yf;return w.value=P,w}});function by(h,y){return h.issues.length&&y===void 0?{issues:[],value:void 0}:h}const fw=pt("$ZodOptional",(h,y)=>{ur.init(h,y),h._zod.optin="optional",h._zod.optout="optional",Nn(h._zod,"values",()=>y.innerType._zod.values?new Set([...y.innerType._zod.values,void 0]):void 0),Nn(h._zod,"pattern",()=>{const w=y.innerType._zod.pattern;return w?new RegExp(`^(${p_(w.source)})?$`):void 0}),h._zod.parse=(w,S)=>{if(y.innerType._zod.optin==="optional"){const P=y.innerType._zod.run(w,S);return P instanceof Promise?P.then(G=>by(G,w.value)):by(P,w.value)}return w.value===void 0?w:y.innerType._zod.run(w,S)}}),pw=pt("$ZodNullable",(h,y)=>{ur.init(h,y),Nn(h._zod,"optin",()=>y.innerType._zod.optin),Nn(h._zod,"optout",()=>y.innerType._zod.optout),Nn(h._zod,"pattern",()=>{const w=y.innerType._zod.pattern;return w?new RegExp(`^(${p_(w.source)}|null)$`):void 0}),Nn(h._zod,"values",()=>y.innerType._zod.values?new Set([...y.innerType._zod.values,null]):void 0),h._zod.parse=(w,S)=>w.value===null?w:y.innerType._zod.run(w,S)}),mw=pt("$ZodDefault",(h,y)=>{ur.init(h,y),h._zod.optin="optional",Nn(h._zod,"values",()=>y.innerType._zod.values),h._zod.parse=(w,S)=>{if(S.direction==="backward")return y.innerType._zod.run(w,S);if(w.value===void 0)return w.value=y.defaultValue,w;const P=y.innerType._zod.run(w,S);return P instanceof Promise?P.then(G=>xy(G,y)):xy(P,y)}});function xy(h,y){return h.value===void 0&&(h.value=y.defaultValue),h}const gw=pt("$ZodPrefault",(h,y)=>{ur.init(h,y),h._zod.optin="optional",Nn(h._zod,"values",()=>y.innerType._zod.values),h._zod.parse=(w,S)=>(S.direction==="backward"||w.value===void 0&&(w.value=y.defaultValue),y.innerType._zod.run(w,S))}),_w=pt("$ZodNonOptional",(h,y)=>{ur.init(h,y),Nn(h._zod,"values",()=>{const w=y.innerType._zod.values;return w?new Set([...w].filter(S=>S!==void 0)):void 0}),h._zod.parse=(w,S)=>{const P=y.innerType._zod.run(w,S);return P instanceof Promise?P.then(G=>wy(G,h)):wy(P,h)}});function wy(h,y){return!h.issues.length&&h.value===void 0&&h.issues.push({code:"invalid_type",expected:"nonoptional",input:h.value,inst:y}),h}const yw=pt("$ZodCatch",(h,y)=>{ur.init(h,y),Nn(h._zod,"optin",()=>y.innerType._zod.optin),Nn(h._zod,"optout",()=>y.innerType._zod.optout),Nn(h._zod,"values",()=>y.innerType._zod.values),h._zod.parse=(w,S)=>{if(S.direction==="backward")return y.innerType._zod.run(w,S);const P=y.innerType._zod.run(w,S);return P instanceof Promise?P.then(G=>(w.value=G.value,G.issues.length&&(w.value=y.catchValue({...w,error:{issues:G.issues.map(z=>hd(z,S,ud()))},input:w.value}),w.issues=[]),w)):(w.value=P.value,P.issues.length&&(w.value=y.catchValue({...w,error:{issues:P.issues.map(G=>hd(G,S,ud()))},input:w.value}),w.issues=[]),w)}}),vw=pt("$ZodPipe",(h,y)=>{ur.init(h,y),Nn(h._zod,"values",()=>y.in._zod.values),Nn(h._zod,"optin",()=>y.in._zod.optin),Nn(h._zod,"optout",()=>y.out._zod.optout),Nn(h._zod,"propValues",()=>y.in._zod.propValues),h._zod.parse=(w,S)=>{if(S.direction==="backward"){const G=y.out._zod.run(w,S);return G instanceof Promise?G.then(z=>jm(z,y.in,S)):jm(G,y.in,S)}const P=y.in._zod.run(w,S);return P instanceof Promise?P.then(G=>jm(G,y.out,S)):jm(P,y.out,S)}});function jm(h,y,w){return h.issues.length?(h.aborted=!0,h):y._zod.run({value:h.value,issues:h.issues},w)}const bw=pt("$ZodReadonly",(h,y)=>{ur.init(h,y),Nn(h._zod,"propValues",()=>y.innerType._zod.propValues),Nn(h._zod,"values",()=>y.innerType._zod.values),Nn(h._zod,"optin",()=>y.innerType._zod.optin),Nn(h._zod,"optout",()=>y.innerType._zod.optout),h._zod.parse=(w,S)=>{if(S.direction==="backward")return y.innerType._zod.run(w,S);const P=y.innerType._zod.run(w,S);return P instanceof Promise?P.then(Sy):Sy(P)}});function Sy(h){return h.value=Object.freeze(h.value),h}const xw=pt("$ZodCustom",(h,y)=>{Ms.init(h,y),ur.init(h,y),h._zod.parse=(w,S)=>w,h._zod.check=w=>{const S=w.value,P=y.fn(S);if(P instanceof Promise)return P.then(G=>Ty(G,w,S,h));Ty(P,w,S,h)}});function Ty(h,y,w,S){if(!h){const P={code:"custom",input:w,inst:S,path:[...S._zod.def.path??[]],continue:!S._zod.def.abort};S._zod.def.params&&(P.params=S._zod.def.params),y.issues.push(Vp(P))}}class ww{constructor(){this._map=new WeakMap,this._idmap=new Map}add(y,...w){const S=w[0];if(this._map.set(y,S),S&&typeof S=="object"&&"id"in S){if(this._idmap.has(S.id))throw new Error(`ID ${S.id} already exists in the registry`);this._idmap.set(S.id,y)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(y){const w=this._map.get(y);return w&&typeof w=="object"&&"id"in w&&this._idmap.delete(w.id),this._map.delete(y),this}get(y){const w=y._zod.parent;if(w){const S={...this.get(w)??{}};delete S.id;const P={...S,...this._map.get(y)};return Object.keys(P).length?P:void 0}return this._map.get(y)}has(y){return this._map.has(y)}}function Sw(){return new ww}const Um=Sw();function Tw(h,y){return new h({type:"string",...ii(y)})}function Ew(h,y){return new h({type:"string",format:"email",check:"string_format",abort:!1,...ii(y)})}function Ey(h,y){return new h({type:"string",format:"guid",check:"string_format",abort:!1,...ii(y)})}function Mw(h,y){return new h({type:"string",format:"uuid",check:"string_format",abort:!1,...ii(y)})}function Aw(h,y){return new h({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ii(y)})}function zw(h,y){return new h({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ii(y)})}function Cw(h,y){return new h({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ii(y)})}function Iw(h,y){return new h({type:"string",format:"url",check:"string_format",abort:!1,...ii(y)})}function Pw(h,y){return new h({type:"string",format:"emoji",check:"string_format",abort:!1,...ii(y)})}function Dw(h,y){return new h({type:"string",format:"nanoid",check:"string_format",abort:!1,...ii(y)})}function kw(h,y){return new h({type:"string",format:"cuid",check:"string_format",abort:!1,...ii(y)})}function Rw(h,y){return new h({type:"string",format:"cuid2",check:"string_format",abort:!1,...ii(y)})}function Bw(h,y){return new h({type:"string",format:"ulid",check:"string_format",abort:!1,...ii(y)})}function Lw(h,y){return new h({type:"string",format:"xid",check:"string_format",abort:!1,...ii(y)})}function Ow(h,y){return new h({type:"string",format:"ksuid",check:"string_format",abort:!1,...ii(y)})}function Fw(h,y){return new h({type:"string",format:"ipv4",check:"string_format",abort:!1,...ii(y)})}function jw(h,y){return new h({type:"string",format:"ipv6",check:"string_format",abort:!1,...ii(y)})}function Uw(h,y){return new h({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ii(y)})}function Nw(h,y){return new h({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ii(y)})}function Zw(h,y){return new h({type:"string",format:"base64",check:"string_format",abort:!1,...ii(y)})}function Vw(h,y){return new h({type:"string",format:"base64url",check:"string_format",abort:!1,...ii(y)})}function Gw(h,y){return new h({type:"string",format:"e164",check:"string_format",abort:!1,...ii(y)})}function qw(h,y){return new h({type:"string",format:"jwt",check:"string_format",abort:!1,...ii(y)})}function $w(h,y){return new h({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ii(y)})}function Hw(h,y){return new h({type:"string",format:"date",check:"string_format",...ii(y)})}function Xw(h,y){return new h({type:"string",format:"time",check:"string_format",precision:null,...ii(y)})}function Yw(h,y){return new h({type:"string",format:"duration",check:"string_format",...ii(y)})}function Ww(h,y){return new h({type:"number",checks:[],...ii(y)})}function Kw(h,y){return new h({type:"number",check:"number_format",abort:!1,format:"safeint",...ii(y)})}function Qw(h,y){return new h({type:"boolean",...ii(y)})}function Jw(h){return new h({type:"unknown"})}function e2(h,y){return new h({type:"never",...ii(y)})}function My(h,y){return new T0({check:"less_than",...ii(y),value:h,inclusive:!1})}function qg(h,y){return new T0({check:"less_than",...ii(y),value:h,inclusive:!0})}function Ay(h,y){return new E0({check:"greater_than",...ii(y),value:h,inclusive:!1})}function $g(h,y){return new E0({check:"greater_than",...ii(y),value:h,inclusive:!0})}function zy(h,y){return new mx({check:"multiple_of",...ii(y),value:h})}function I0(h,y){return new _x({check:"max_length",...ii(y),maximum:h})}function eg(h,y){return new yx({check:"min_length",...ii(y),minimum:h})}function P0(h,y){return new vx({check:"length_equals",...ii(y),length:h})}function t2(h,y){return new bx({check:"string_format",format:"regex",...ii(y),pattern:h})}function i2(h){return new xx({check:"string_format",format:"lowercase",...ii(h)})}function n2(h){return new wx({check:"string_format",format:"uppercase",...ii(h)})}function r2(h,y){return new Sx({check:"string_format",format:"includes",...ii(y),includes:h})}function a2(h,y){return new Tx({check:"string_format",format:"starts_with",...ii(y),prefix:h})}function s2(h,y){return new Ex({check:"string_format",format:"ends_with",...ii(y),suffix:h})}function $p(h){return new Mx({check:"overwrite",tx:h})}function o2(h){return $p(y=>y.normalize(h))}function l2(){return $p(h=>h.trim())}function c2(){return $p(h=>h.toLowerCase())}function u2(){return $p(h=>h.toUpperCase())}function h2(h,y,w){return new h({type:"array",element:y,...ii(w)})}function d2(h,y,w){return new h({type:"custom",check:"custom",fn:y,...ii(w)})}function f2(h){const y=p2(w=>(w.addIssue=S=>{if(typeof S=="string")w.issues.push(Vp(S,w.value,y._zod.def));else{const P=S;P.fatal&&(P.continue=!1),P.code??(P.code="custom"),P.input??(P.input=w.value),P.inst??(P.inst=y),P.continue??(P.continue=!y._zod.def.abort),w.issues.push(Vp(P))}},h(w.value,w)));return y}function p2(h,y){const w=new Ms({check:"custom",...ii(y)});return w._zod.check=h,w}const m2=pt("ZodISODateTime",(h,y)=>{Ux.init(h,y),gr.init(h,y)});function g2(h){return $w(m2,h)}const _2=pt("ZodISODate",(h,y)=>{Nx.init(h,y),gr.init(h,y)});function y2(h){return Hw(_2,h)}const v2=pt("ZodISOTime",(h,y)=>{Zx.init(h,y),gr.init(h,y)});function b2(h){return Xw(v2,h)}const x2=pt("ZodISODuration",(h,y)=>{Vx.init(h,y),gr.init(h,y)});function w2(h){return Yw(x2,h)}const S2=(h,y)=>{y0.init(h,y),h.name="ZodError",Object.defineProperties(h,{format:{value:w=>Pb(h,w)},flatten:{value:w=>Ib(h,w)},addIssue:{value:w=>{h.issues.push(w),h.message=JSON.stringify(h.issues,r_,2)}},addIssues:{value:w=>{h.issues.push(...w),h.message=JSON.stringify(h.issues,r_,2)}},isEmpty:{get(){return h.issues.length===0}}})},Oo=pt("ZodError",S2,{Parent:Error}),T2=__(Oo),E2=y_(Oo),M2=ag(Oo),A2=sg(Oo),z2=Rb(Oo),C2=Bb(Oo),I2=Lb(Oo),P2=Ob(Oo),D2=Fb(Oo),k2=jb(Oo),R2=Ub(Oo),B2=Nb(Oo),Cr=pt("ZodType",(h,y)=>(ur.init(h,y),h.def=y,h.type=y.type,Object.defineProperty(h,"_def",{value:y}),h.check=(...w)=>h.clone(fd(y,{checks:[...y.checks??[],...w.map(S=>typeof S=="function"?{_zod:{check:S,def:{check:"custom"},onattach:[]}}:S)]})),h.clone=(w,S)=>sh(h,w,S),h.brand=()=>h,h.register=((w,S)=>(w.add(h,S),h)),h.parse=(w,S)=>T2(h,w,S,{callee:h.parse}),h.safeParse=(w,S)=>M2(h,w,S),h.parseAsync=async(w,S)=>E2(h,w,S,{callee:h.parseAsync}),h.safeParseAsync=async(w,S)=>A2(h,w,S),h.spa=h.safeParseAsync,h.encode=(w,S)=>z2(h,w,S),h.decode=(w,S)=>C2(h,w,S),h.encodeAsync=async(w,S)=>I2(h,w,S),h.decodeAsync=async(w,S)=>P2(h,w,S),h.safeEncode=(w,S)=>D2(h,w,S),h.safeDecode=(w,S)=>k2(h,w,S),h.safeEncodeAsync=async(w,S)=>R2(h,w,S),h.safeDecodeAsync=async(w,S)=>B2(h,w,S),h.refine=(w,S)=>h.check(AS(w,S)),h.superRefine=w=>h.check(zS(w)),h.overwrite=w=>h.check($p(w)),h.optional=()=>Dy(h),h.nullable=()=>ky(h),h.nullish=()=>Dy(ky(h)),h.nonoptional=w=>bS(h,w),h.array=()=>iu(h),h.or=w=>R0([h,w]),h.and=w=>cS(h,w),h.transform=w=>Ry(h,pS(w)),h.default=w=>_S(h,w),h.prefault=w=>vS(h,w),h.catch=w=>wS(h,w),h.pipe=w=>Ry(h,w),h.readonly=()=>ES(h),h.describe=w=>{const S=h.clone();return Um.add(S,{description:w}),S},Object.defineProperty(h,"description",{get(){return Um.get(h)?.description},configurable:!0}),h.meta=(...w)=>{if(w.length===0)return Um.get(h);const S=h.clone();return Um.add(S,w[0]),S},h.isOptional=()=>h.safeParse(void 0).success,h.isNullable=()=>h.safeParse(null).success,h)),D0=pt("_ZodString",(h,y)=>{v_.init(h,y),Cr.init(h,y);const w=h._zod.bag;h.format=w.format??null,h.minLength=w.minimum??null,h.maxLength=w.maximum??null,h.regex=(...S)=>h.check(t2(...S)),h.includes=(...S)=>h.check(r2(...S)),h.startsWith=(...S)=>h.check(a2(...S)),h.endsWith=(...S)=>h.check(s2(...S)),h.min=(...S)=>h.check(eg(...S)),h.max=(...S)=>h.check(I0(...S)),h.length=(...S)=>h.check(P0(...S)),h.nonempty=(...S)=>h.check(eg(1,...S)),h.lowercase=S=>h.check(i2(S)),h.uppercase=S=>h.check(n2(S)),h.trim=()=>h.check(l2()),h.normalize=(...S)=>h.check(o2(...S)),h.toLowerCase=()=>h.check(c2()),h.toUpperCase=()=>h.check(u2())}),L2=pt("ZodString",(h,y)=>{v_.init(h,y),D0.init(h,y),h.email=w=>h.check(Ew(O2,w)),h.url=w=>h.check(Iw(F2,w)),h.jwt=w=>h.check(qw(J2,w)),h.emoji=w=>h.check(Pw(j2,w)),h.guid=w=>h.check(Ey(Cy,w)),h.uuid=w=>h.check(Mw(Nm,w)),h.uuidv4=w=>h.check(Aw(Nm,w)),h.uuidv6=w=>h.check(zw(Nm,w)),h.uuidv7=w=>h.check(Cw(Nm,w)),h.nanoid=w=>h.check(Dw(U2,w)),h.guid=w=>h.check(Ey(Cy,w)),h.cuid=w=>h.check(kw(N2,w)),h.cuid2=w=>h.check(Rw(Z2,w)),h.ulid=w=>h.check(Bw(V2,w)),h.base64=w=>h.check(Zw(W2,w)),h.base64url=w=>h.check(Vw(K2,w)),h.xid=w=>h.check(Lw(G2,w)),h.ksuid=w=>h.check(Ow(q2,w)),h.ipv4=w=>h.check(Fw($2,w)),h.ipv6=w=>h.check(jw(H2,w)),h.cidrv4=w=>h.check(Uw(X2,w)),h.cidrv6=w=>h.check(Nw(Y2,w)),h.e164=w=>h.check(Gw(Q2,w)),h.datetime=w=>h.check(g2(w)),h.date=w=>h.check(y2(w)),h.time=w=>h.check(b2(w)),h.duration=w=>h.check(w2(w))});function so(h){return Tw(L2,h)}const gr=pt("ZodStringFormat",(h,y)=>{hr.init(h,y),D0.init(h,y)}),O2=pt("ZodEmail",(h,y)=>{Px.init(h,y),gr.init(h,y)}),Cy=pt("ZodGUID",(h,y)=>{Cx.init(h,y),gr.init(h,y)}),Nm=pt("ZodUUID",(h,y)=>{Ix.init(h,y),gr.init(h,y)}),F2=pt("ZodURL",(h,y)=>{Dx.init(h,y),gr.init(h,y)}),j2=pt("ZodEmoji",(h,y)=>{kx.init(h,y),gr.init(h,y)}),U2=pt("ZodNanoID",(h,y)=>{Rx.init(h,y),gr.init(h,y)}),N2=pt("ZodCUID",(h,y)=>{Bx.init(h,y),gr.init(h,y)}),Z2=pt("ZodCUID2",(h,y)=>{Lx.init(h,y),gr.init(h,y)}),V2=pt("ZodULID",(h,y)=>{Ox.init(h,y),gr.init(h,y)}),G2=pt("ZodXID",(h,y)=>{Fx.init(h,y),gr.init(h,y)}),q2=pt("ZodKSUID",(h,y)=>{jx.init(h,y),gr.init(h,y)}),$2=pt("ZodIPv4",(h,y)=>{Gx.init(h,y),gr.init(h,y)}),H2=pt("ZodIPv6",(h,y)=>{qx.init(h,y),gr.init(h,y)}),X2=pt("ZodCIDRv4",(h,y)=>{$x.init(h,y),gr.init(h,y)}),Y2=pt("ZodCIDRv6",(h,y)=>{Hx.init(h,y),gr.init(h,y)}),W2=pt("ZodBase64",(h,y)=>{Xx.init(h,y),gr.init(h,y)}),K2=pt("ZodBase64URL",(h,y)=>{Wx.init(h,y),gr.init(h,y)}),Q2=pt("ZodE164",(h,y)=>{Kx.init(h,y),gr.init(h,y)}),J2=pt("ZodJWT",(h,y)=>{Jx.init(h,y),gr.init(h,y)}),k0=pt("ZodNumber",(h,y)=>{A0.init(h,y),Cr.init(h,y),h.gt=(S,P)=>h.check(Ay(S,P)),h.gte=(S,P)=>h.check($g(S,P)),h.min=(S,P)=>h.check($g(S,P)),h.lt=(S,P)=>h.check(My(S,P)),h.lte=(S,P)=>h.check(qg(S,P)),h.max=(S,P)=>h.check(qg(S,P)),h.int=S=>h.check(Iy(S)),h.safe=S=>h.check(Iy(S)),h.positive=S=>h.check(Ay(0,S)),h.nonnegative=S=>h.check($g(0,S)),h.negative=S=>h.check(My(0,S)),h.nonpositive=S=>h.check(qg(0,S)),h.multipleOf=(S,P)=>h.check(zy(S,P)),h.step=(S,P)=>h.check(zy(S,P)),h.finite=()=>h;const w=h._zod.bag;h.minValue=Math.max(w.minimum??Number.NEGATIVE_INFINITY,w.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,h.maxValue=Math.min(w.maximum??Number.POSITIVE_INFINITY,w.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,h.isInt=(w.format??"").includes("int")||Number.isSafeInteger(w.multipleOf??.5),h.isFinite=!0,h.format=w.format??null});function Lo(h){return Ww(k0,h)}const eS=pt("ZodNumberFormat",(h,y)=>{ew.init(h,y),k0.init(h,y)});function Iy(h){return Kw(eS,h)}const tS=pt("ZodBoolean",(h,y)=>{tw.init(h,y),Cr.init(h,y)});function vf(h){return Qw(tS,h)}const iS=pt("ZodUnknown",(h,y)=>{iw.init(h,y),Cr.init(h,y)});function Py(){return Jw(iS)}const nS=pt("ZodNever",(h,y)=>{nw.init(h,y),Cr.init(h,y)});function rS(h){return e2(nS,h)}const aS=pt("ZodArray",(h,y)=>{rw.init(h,y),Cr.init(h,y),h.element=y.element,h.min=(w,S)=>h.check(eg(w,S)),h.nonempty=w=>h.check(eg(1,w)),h.max=(w,S)=>h.check(I0(w,S)),h.length=(w,S)=>h.check(P0(w,S)),h.unwrap=()=>h.element});function iu(h,y){return h2(aS,h,y)}const sS=pt("ZodObject",(h,y)=>{sw.init(h,y),Cr.init(h,y),Nn(h,"shape",()=>y.shape),h.keyof=()=>Hp(Object.keys(h._zod.def.shape)),h.catchall=w=>h.clone({...h._zod.def,catchall:w}),h.passthrough=()=>h.clone({...h._zod.def,catchall:Py()}),h.loose=()=>h.clone({...h._zod.def,catchall:Py()}),h.strict=()=>h.clone({...h._zod.def,catchall:rS()}),h.strip=()=>h.clone({...h._zod.def,catchall:void 0}),h.extend=w=>Eb(h,w),h.safeExtend=w=>Mb(h,w),h.merge=w=>Ab(h,w),h.pick=w=>Sb(h,w),h.omit=w=>Tb(h,w),h.partial=(...w)=>zb(B0,h,w[0]),h.required=(...w)=>Cb(L0,h,w[0])});function lo(h,y){const w={type:"object",shape:h??{},...ii(y)};return new sS(w)}const oS=pt("ZodUnion",(h,y)=>{ow.init(h,y),Cr.init(h,y),h.options=y.options});function R0(h,y){return new oS({type:"union",options:h,...ii(y)})}const lS=pt("ZodIntersection",(h,y)=>{lw.init(h,y),Cr.init(h,y)});function cS(h,y){return new lS({type:"intersection",left:h,right:y})}const uS=pt("ZodTuple",(h,y)=>{cw.init(h,y),Cr.init(h,y),h.rest=w=>h.clone({...h._zod.def,rest:w})});function hS(h,y,w){const S=y instanceof ur,P=S?w:y,G=S?y:null;return new uS({type:"tuple",items:h,rest:G,...ii(P)})}const s_=pt("ZodEnum",(h,y)=>{uw.init(h,y),Cr.init(h,y),h.enum=y.entries,h.options=Object.values(y.entries);const w=new Set(Object.keys(y.entries));h.extract=(S,P)=>{const G={};for(const z of S)if(w.has(z))G[z]=y.entries[z];else throw new Error(`Key ${z} not found in enum`);return new s_({...y,checks:[],...ii(P),entries:G})},h.exclude=(S,P)=>{const G={...y.entries};for(const z of S)if(w.has(z))delete G[z];else throw new Error(`Key ${z} not found in enum`);return new s_({...y,checks:[],...ii(P),entries:G})}});function Hp(h,y){const w=Array.isArray(h)?Object.fromEntries(h.map(S=>[S,S])):h;return new s_({type:"enum",entries:w,...ii(y)})}const dS=pt("ZodLiteral",(h,y)=>{hw.init(h,y),Cr.init(h,y),h.values=new Set(y.values),Object.defineProperty(h,"value",{get(){if(y.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return y.values[0]}})});function b_(h,y){return new dS({type:"literal",values:Array.isArray(h)?h:[h],...ii(y)})}const fS=pt("ZodTransform",(h,y)=>{dw.init(h,y),Cr.init(h,y),h._zod.parse=(w,S)=>{if(S.direction==="backward")throw new f0(h.constructor.name);w.addIssue=G=>{if(typeof G=="string")w.issues.push(Vp(G,w.value,y));else{const z=G;z.fatal&&(z.continue=!1),z.code??(z.code="custom"),z.input??(z.input=w.value),z.inst??(z.inst=h),w.issues.push(Vp(z))}};const P=y.transform(w.value,w);return P instanceof Promise?P.then(G=>(w.value=G,w)):(w.value=P,w)}});function pS(h){return new fS({type:"transform",transform:h})}const B0=pt("ZodOptional",(h,y)=>{fw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType});function Dy(h){return new B0({type:"optional",innerType:h})}const mS=pt("ZodNullable",(h,y)=>{pw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType});function ky(h){return new mS({type:"nullable",innerType:h})}const gS=pt("ZodDefault",(h,y)=>{mw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType,h.removeDefault=h.unwrap});function _S(h,y){return new gS({type:"default",innerType:h,get defaultValue(){return typeof y=="function"?y():g0(y)}})}const yS=pt("ZodPrefault",(h,y)=>{gw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType});function vS(h,y){return new yS({type:"prefault",innerType:h,get defaultValue(){return typeof y=="function"?y():g0(y)}})}const L0=pt("ZodNonOptional",(h,y)=>{_w.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType});function bS(h,y){return new L0({type:"nonoptional",innerType:h,...ii(y)})}const xS=pt("ZodCatch",(h,y)=>{yw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType,h.removeCatch=h.unwrap});function wS(h,y){return new xS({type:"catch",innerType:h,catchValue:typeof y=="function"?y:()=>y})}const SS=pt("ZodPipe",(h,y)=>{vw.init(h,y),Cr.init(h,y),h.in=y.in,h.out=y.out});function Ry(h,y){return new SS({type:"pipe",in:h,out:y})}const TS=pt("ZodReadonly",(h,y)=>{bw.init(h,y),Cr.init(h,y),h.unwrap=()=>h._zod.def.innerType});function ES(h){return new TS({type:"readonly",innerType:h})}const MS=pt("ZodCustom",(h,y)=>{xw.init(h,y),Cr.init(h,y)});function AS(h,y={}){return d2(MS,h,y)}function zS(h){return f2(h)}const x_=hS([Lo(),Lo()]),O0=lo({type:b_("LineString"),coordinates:iu(x_).min(2)}),CS=lo({type:b_("Point"),coordinates:x_}),IS=lo({type:b_("Polygon"),coordinates:iu(iu(x_).min(4)).min(1)}),PS=lo({id:so().min(1),name:so().min(1),lon:Lo(),lat:Lo()}),DS=lo({id:so().min(1),name:so().min(1),geometry:O0,stopIds:iu(so().min(1)).min(1)}),kS=lo({stopId:so().min(1),boardings:Lo().min(0),alightings:Lo().min(0)}),RS=lo({stops:iu(PS),routes:iu(DS),usage:iu(kS).optional()}),F0=lo({coverageRate:Lo(),avgTravelTime:Lo(),operatingCost:Lo(),serviceLevelRetention:Lo()}),j0=so().min(1),BS=Hp(["","","","DRT"]),LS=Hp(["","",""]),OS=Hp(["line","point","polygon"]),FS=lo({kind:OS,feature:R0([O0,CS,IS]),note:so().min(1).optional()}),jS=lo({spatial:vf(),measureMix:vf(),strengthMix:vf()}),US=Hp(["not_evaluated","evaluating","achieved","not_achieved"]),NS=lo({id:j0,title:so().min(1),reason:so().min(1),measure:BS,strength:LS,annotations:iu(FS),diversityFlags:jS,status:US,progress:Lo().min(0).max(100).optional(),lastUpdatedAt:so().datetime().optional(),kpi:F0.optional(),recommended:vf().optional()}),ZS=lo({kpi:F0,achieved:vf()}),VS=lo({candidateId:j0,progress:Lo().min(0).max(100),lastUpdatedAt:so().datetime(),done:vf().optional(),result:ZS.optional(),errorCode:so().min(1).optional()}),GS={stops:[{id:"S1",name:"Alpha",lon:139.7,lat:35.69},{id:"S2",name:"Bravo",lon:139.71,lat:35.69},{id:"S3",name:"Charlie",lon:139.72,lat:35.69},{id:"S4",name:"Delta",lon:139.73,lat:35.688}],routes:[{id:"R1",name:"",geometry:{type:"LineString",coordinates:[[139.7,35.69],[139.71,35.69],[139.72,35.69]]},stopIds:["S1","S2","S3"]},{id:"R2",name:"",geometry:{type:"LineString",coordinates:[[139.71,35.69],[139.73,35.688]]},stopIds:["S2","S4"]}],usage:[{stopId:"S1",boardings:120,alightings:110},{stopId:"S2",boardings:240,alightings:230},{stopId:"S3",boardings:180,alightings:175},{stopId:"S4",boardings:90,alightings:95}]},qS=[{id:"C01",title:"",reason:"    ",measure:"",strength:"",annotations:[{kind:"line",feature:{type:"LineString",coordinates:[[139.72,35.69],[139.71,35.69]]},note:"2"}],diversityFlags:{spatial:!0,measureMix:!0,strengthMix:!0},status:"not_evaluated"},{id:"C02",title:"S2-S3 ",reason:"    ",measure:"",strength:"",annotations:[{kind:"point",feature:{type:"Point",coordinates:[139.715,35.69]},note:"S2/S3"}],diversityFlags:{spatial:!0,measureMix:!0,strengthMix:!0},status:"evaluating",progress:60,lastUpdatedAt:"2025-05-01T08:30:00Z"},{id:"C03",title:"DRT",reason:"    DRT",measure:"DRT",strength:"",annotations:[{kind:"polygon",feature:{type:"Polygon",coordinates:[[[139.728,35.686],[139.734,35.686],[139.734,35.692],[139.728,35.692],[139.728,35.686]]]},note:""}],diversityFlags:{spatial:!0,measureMix:!0,strengthMix:!0},status:"not_evaluated"}],$S=[{candidateId:"C01",progress:100,lastUpdatedAt:"2025-05-01T09:05:00Z",done:!0,result:{kpi:{coverageRate:84.2,avgTravelTime:24.5,operatingCost:92.1,serviceLevelRetention:88.4},achieved:!0}},{candidateId:"C02",progress:60,lastUpdatedAt:"2025-05-01T08:30:00Z"},{candidateId:"C03",progress:0,lastUpdatedAt:"2025-05-01T08:10:00Z"}],Vm=RS.parse(GS),HS={stopCount:Vm.stops.length,routeCount:Vm.routes.length,tripCount:0,shapeCount:Vm.routes.reduce((h,y)=>h+y.geometry.coordinates.length,0),stopTimeCount:0};NS.array().parse(qS);VS.array().parse($S);const By={file:null,encoding:"auto",status:"idle",error:null,lastUpdatedAt:null,data:null,summary:null,network:null},wf=Kv()(h1((h,y)=>({...By,setFile:w=>h(S=>{S.file=w,S.status=w?"ready":"idle",S.error=null,S.data=null,S.summary=null,S.network=null,S.lastUpdatedAt=w?Date.now():S.lastUpdatedAt}),setEncoding:w=>h(S=>{S.encoding=w}),setStatus:w=>h(S=>{S.status=w}),setError:w=>h(S=>{S.error=w,w&&(S.status="error")}),loadGtfs:async()=>{const w=y().file,S=y().encoding;if(!w){h(P=>{P.error="GTFS ZIP",P.status="error"});return}h(P=>{P.status="reading",P.error=null});try{const P=await cb(w,S),G=ub(P),z=gb(P);h(c=>{c.data=P,c.summary=G,c.network=z,c.status="ready",c.lastUpdatedAt=Date.now()})}catch(P){const G=P instanceof Error?P.message:"GTFS";h(z=>{z.error=G,z.status="error"})}},loadSampleNetwork:()=>h(w=>{w.file=null,w.data=null,w.summary=HS,w.network=Vm,w.status="ready",w.error=null,w.lastUpdatedAt=Date.now(),w.encoding="auto"}),reset:()=>h(()=>({...By}))}))),XS=[".zip"],YS=["application/zip","application/x-zip-compressed","application/octet-stream"];function WS(h){if(h===0)return"0 B";const y=1024,w=["B","KB","MB","GB","TB"],S=Math.floor(Math.log(h)/Math.log(y)),P=h/Math.pow(y,S);return`${P.toFixed(P>=10||P%1===0?0:1)} ${w[S]}`}function KS(h){const y=h.name.toLowerCase();return XS.some(P=>y.endsWith(P))?!h.type||YS.includes(h.type.toLowerCase())?null:"ZIP":"ZIP.zipGTFS"}function QS(){const h=wf(w=>w.status),y=Hi.useMemo(()=>{switch(h){case"ready":return{text:"",variant:"secondary"};case"reading":return{text:"",variant:"outline"};case"error":return{text:"",variant:"destructive"};default:return{text:"",variant:"outline"}}},[h]);return Ct.jsx($v,{variant:y.variant,children:y.text})}function JS(){const h=Hi.useRef(null),{file:y,encoding:w,error:S,lastUpdatedAt:P,summary:G,status:z}=wf(Hi.useCallback(ht=>({file:ht.file,encoding:ht.encoding,error:ht.error,lastUpdatedAt:ht.lastUpdatedAt,summary:ht.summary,status:ht.status}),[])),{setFile:c,setEncoding:K,setError:$,reset:oe,loadGtfs:ce,loadSampleNetwork:ge}=wf(Hi.useCallback(ht=>({setFile:ht.setFile,setEncoding:ht.setEncoding,setError:ht.setError,reset:ht.reset,loadGtfs:ht.loadGtfs,loadSampleNetwork:ht.loadSampleNetwork}),[])),Me=()=>{h.current?.click()},Ae=Hi.useCallback(ht=>{if(!ht){oe();return}const St=KS(ht);if(St){$(St),c(null);return}c(ht),$(null)},[oe,$,c]),ie=Hi.useCallback(ht=>{const St=ht.target.files?.[0]??null;Ae(St)},[Ae]),Ve=Hi.useCallback(ht=>{ht.preventDefault();const St=ht.dataTransfer.files?.[0]??null;Ae(St)},[Ae]),ot=Hi.useCallback(ht=>{ht.preventDefault(),ht.dataTransfer.dropEffect="copy"},[]),Ye=Hi.useCallback(ht=>{K(ht.target.value)},[K]),Le=()=>{oe(),h.current&&(h.current.value="")},Ke=()=>{ce()},_t=()=>{ge(),h.current&&(h.current.value="")};return Ct.jsxs("section",{className:"flex flex-col gap-4",children:[Ct.jsxs("header",{className:"flex items-center justify-between gap-2",children:[Ct.jsxs("div",{children:[Ct.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"GTFS"}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:"ZIP"})]}),Ct.jsx(QS,{})]}),Ct.jsxs("label",{onDrop:Ve,onDragOver:ot,className:"group relative flex cursor-pointer flex-col items-center justify-center gap-3 rounded-lg border border-dashed border-border bg-muted/50 px-4 py-8 text-center transition hover:border-primary hover:bg-muted",children:[Ct.jsx("input",{ref:h,type:"file",accept:".zip",className:"sr-only",onChange:ie}),Ct.jsxs("p",{className:"text-sm font-medium text-foreground",children:["",Ct.jsx(pf,{type:"button",variant:"link",className:"px-1 py-0 text-sm",onClick:ht=>{ht.preventDefault(),Me()},children:""})]}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:": GTFS ZIPShift_JIS / UTF-8"})]}),Ct.jsxs("div",{className:"space-y-3 rounded-lg border border-border bg-card/60 p-3 text-sm",children:[Ct.jsxs("div",{className:"flex items-center justify-between gap-2",children:[Ct.jsx("span",{className:"text-muted-foreground",children:""}),Ct.jsx("span",{className:"font-medium",children:y?y.name:""})]}),Ct.jsxs("div",{className:"flex items-center justify-between gap-2 text-xs text-muted-foreground",children:[Ct.jsx("span",{children:""}),Ct.jsx("span",{children:y?WS(y.size):"-"})]}),Ct.jsxs("div",{className:"flex items-center justify-between gap-2 text-xs text-muted-foreground",children:[Ct.jsx("span",{children:""}),Ct.jsx("span",{children:P?new Date(P).toLocaleString("ja-JP"):"-"})]}),Ct.jsxs("div",{className:"flex items-center justify-between gap-2",children:[Ct.jsx("label",{htmlFor:"gtfs-encoding",className:"text-xs text-muted-foreground",children:""}),Ct.jsxs("select",{id:"gtfs-encoding",value:w,onChange:Ye,className:"rounded-md border border-border bg-background px-2 py-1 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:[Ct.jsx("option",{value:"auto",children:""}),Ct.jsx("option",{value:"utf8",children:"UTF-8 "}),Ct.jsx("option",{value:"shift_jis",children:"Shift_JIS "})]})]}),Ct.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-2",children:[Ct.jsx(pf,{type:"button",variant:"ghost",className:"px-2 py-0 text-xs",disabled:z==="reading",onClick:_t,children:""}),Ct.jsxs("div",{className:"flex gap-2",children:[Ct.jsx(pf,{type:"button",variant:"outline",disabled:!y||z==="reading",onClick:Ke,children:"GTFS"}),Ct.jsx(pf,{type:"button",variant:"secondary",disabled:!y,onClick:Le,children:""})]})]})]}),G?Ct.jsxs("div",{className:"rounded-lg border border-border bg-background/70 p-3 text-xs",children:[Ct.jsx("p",{className:"font-semibold text-foreground",children:""}),Ct.jsxs("dl",{className:"mt-2 grid grid-cols-2 gap-x-3 gap-y-1",children:[Ct.jsx("dt",{className:"text-muted-foreground",children:""}),Ct.jsx("dd",{children:G.stopCount.toLocaleString()}),Ct.jsx("dt",{className:"text-muted-foreground",children:""}),Ct.jsx("dd",{children:G.routeCount.toLocaleString()}),Ct.jsx("dt",{className:"text-muted-foreground",children:""}),Ct.jsx("dd",{children:G.tripCount.toLocaleString()}),Ct.jsx("dt",{className:"text-muted-foreground",children:""}),Ct.jsx("dd",{children:G.shapeCount.toLocaleString()}),Ct.jsx("dt",{className:"text-muted-foreground",children:""}),Ct.jsx("dd",{children:G.stopTimeCount.toLocaleString()})]})]}):null,S?Ct.jsx("p",{className:"rounded-md border border-destructive/40 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:S}):Ct.jsx("p",{className:"text-xs text-muted-foreground",children:""})]})}var Gm={exports:{}};var eT=Gm.exports,Ly;function tT(){return Ly||(Ly=1,(function(h,y){(function(w,S){h.exports=S()})(eT,(function(){var w={},S={};function P(z,c,K){if(S[z]=K,z==="index"){var $="var sharedModule = {}; ("+S.shared+")(sharedModule); ("+S.worker+")(sharedModule);",oe={};return S.shared(oe),S.index(w,oe),typeof window<"u"&&w.setWorkerUrl(window.URL.createObjectURL(new Blob([$],{type:"text/javascript"}))),w}}P("shared",["exports"],(function(z){function c(r,t,n,o){return new(n||(n=Promise))((function(d,_){function v(I){try{T(o.next(I))}catch(D){_(D)}}function x(I){try{T(o.throw(I))}catch(D){_(D)}}function T(I){var D;I.done?d(I.value):(D=I.value,D instanceof n?D:new n((function(B){B(D)}))).then(v,x)}T((o=o.apply(r,t||[])).next())}))}function K(r,t){this.x=r,this.y=t}function $(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var oe,ce;typeof SuppressedError=="function"&&SuppressedError,K.prototype={clone(){return new K(this.x,this.y)},add(r){return this.clone()._add(r)},sub(r){return this.clone()._sub(r)},multByPoint(r){return this.clone()._multByPoint(r)},divByPoint(r){return this.clone()._divByPoint(r)},mult(r){return this.clone()._mult(r)},div(r){return this.clone()._div(r)},rotate(r){return this.clone()._rotate(r)},rotateAround(r,t){return this.clone()._rotateAround(r,t)},matMult(r){return this.clone()._matMult(r)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(r){return this.x===r.x&&this.y===r.y},dist(r){return Math.sqrt(this.distSqr(r))},distSqr(r){const t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith(r){return this.angleWithSep(r.x,r.y)},angleWithSep(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult(r){const t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add(r){return this.x+=r.x,this.y+=r.y,this},_sub(r){return this.x-=r.x,this.y-=r.y,this},_mult(r){return this.x*=r,this.y*=r,this},_div(r){return this.x/=r,this.y/=r,this},_multByPoint(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint(r){return this.x/=r.x,this.y/=r.y,this},_unit(){return this._div(this.mag()),this},_perp(){const r=this.y;return this.y=this.x,this.x=-r,this},_rotate(r){const t=Math.cos(r),n=Math.sin(r),o=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=o,this},_rotateAround(r,t){const n=Math.cos(r),o=Math.sin(r),d=t.y+o*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-o*(this.y-t.y),this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:K},K.convert=function(r){if(r instanceof K)return r;if(Array.isArray(r))return new K(+r[0],+r[1]);if(r.x!==void 0&&r.y!==void 0)return new K(+r.x,+r.y);throw new Error("Expected [x, y] or {x, y} point format")};var ge=(function(){if(ce)return oe;function r(t,n,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=d}return ce=1,oe=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var _=this.sampleCurveX(o)-t;if(Math.abs(_)<n)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=_/v}var x=0,T=1;for(o=t,d=0;d<20&&(_=this.sampleCurveX(o),!(Math.abs(_-t)<n));d++)t>_?x=o:T=o,o=.5*(T-x)+x;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},oe})(),Me=$(ge);let Ae,ie;function Ve(){return Ae==null&&(Ae=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ae}function ot(){if(ie==null&&(ie=!1,Ve())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<25;o++){const d=4*o;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let o=0;o<100;o++)if(o%4!=3&&n[o]!==o){ie=!0;break}}}return ie||!1}var Ye=1e-6,Le=typeof Float32Array<"u"?Float32Array:Array;function Ke(){var r=new Le(9);return Le!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function _t(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ht(){var r=new Le(3);return Le!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function St(r){var t=r[0],n=r[1],o=r[2];return Math.sqrt(t*t+n*n+o*o)}function be(r,t,n){var o=new Le(3);return o[0]=r,o[1]=t,o[2]=n,o}function Ie(r,t,n){return r[0]=t[0]+n[0],r[1]=t[1]+n[1],r[2]=t[2]+n[2],r}function tt(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r}function bt(r,t,n){var o=t[0],d=t[1],_=t[2],v=n[0],x=n[1],T=n[2];return r[0]=d*T-_*x,r[1]=_*v-o*T,r[2]=o*x-d*v,r}var wt,Wt=St;function vi(r,t,n){var o=t[0],d=t[1],_=t[2],v=t[3];return r[0]=n[0]*o+n[4]*d+n[8]*_+n[12]*v,r[1]=n[1]*o+n[5]*d+n[9]*_+n[13]*v,r[2]=n[2]*o+n[6]*d+n[10]*_+n[14]*v,r[3]=n[3]*o+n[7]*d+n[11]*_+n[15]*v,r}function Si(){var r=new Le(4);return Le!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Ue(r,t,n,o){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;t*=_,o*=_,n*=_;var v=Math.sin(t),x=Math.cos(t),T=Math.sin(n),I=Math.cos(n),D=Math.sin(o),B=Math.cos(o);switch(d){case"xyz":r[0]=v*I*B+x*T*D,r[1]=x*T*B-v*I*D,r[2]=x*I*D+v*T*B,r[3]=x*I*B-v*T*D;break;case"xzy":r[0]=v*I*B-x*T*D,r[1]=x*T*B-v*I*D,r[2]=x*I*D+v*T*B,r[3]=x*I*B+v*T*D;break;case"yxz":r[0]=v*I*B+x*T*D,r[1]=x*T*B-v*I*D,r[2]=x*I*D-v*T*B,r[3]=x*I*B+v*T*D;break;case"yzx":r[0]=v*I*B+x*T*D,r[1]=x*T*B+v*I*D,r[2]=x*I*D-v*T*B,r[3]=x*I*B-v*T*D;break;case"zxy":r[0]=v*I*B-x*T*D,r[1]=x*T*B+v*I*D,r[2]=x*I*D+v*T*B,r[3]=x*I*B-v*T*D;break;case"zyx":r[0]=v*I*B-x*T*D,r[1]=x*T*B+v*I*D,r[2]=x*I*D-v*T*B,r[3]=x*I*B+v*T*D;break;default:throw new Error("Unknown angle order "+d)}return r}function et(){var r=new Le(2);return Le!=Float32Array&&(r[0]=0,r[1]=0),r}function it(r,t){var n=new Le(2);return n[0]=r,n[1]=t,n}ht(),wt=new Le(4),Le!=Float32Array&&(wt[0]=0,wt[1]=0,wt[2]=0,wt[3]=0),ht(),be(1,0,0),be(0,1,0),Si(),Si(),Ke(),et();const dt=8192;function Kt(r,t,n){return t*(dt/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}function fe(r,t){return(r%t+t)%t}function Re(r,t,n){return r*(1-n)+t*n}function Ze(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,n=t*r;return 4*(r<.5?n:3*(r-t)+n-.75)}function mt(r,t,n,o){const d=new Me(r,t,n,o);return _=>d.solve(_)}const It=mt(.25,.1,.25,1);function Pt(r,t,n){return Math.min(n,Math.max(t,r))}function Rt(r,t,n){const o=n-t,d=((r-t)%o+o)%o+t;return d===t?n:d}function Dt(r,...t){for(const n of t)for(const o in n)r[o]=n[o];return r}let Bt=1;function bi(r,t,n){const o={};for(const d in r)o[d]=t.call(this,r[d],d,r);return o}function Qt(r,t,n){const o={};for(const d in r)t.call(this,r[d],d,r)&&(o[d]=r[d]);return o}function ri(r){return Array.isArray(r)?r.map(ri):typeof r=="object"&&r?bi(r,ri):r}const Pi={};function Yt(r){Pi[r]||(typeof console<"u"&&console.warn(r),Pi[r]=!0)}function gi(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function jt(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let nn=null;function Ti(r){if(nn==null){const t=r.navigator?r.navigator.userAgent:null;nn=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return nn}function zi(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Gi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function er(r,t,n,o,d){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(r,{timestamp:0});try{const v=_?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const x=v.startsWith("BGR"),T=new Uint8ClampedArray(o*d*4);if(yield _.copyTo(T,(function(I,D,B,V,X){const W=4*Math.max(-D,0),J=(Math.max(0,B)-B)*V*4+W,ne=4*V,ue=Math.max(0,D),Ce=Math.max(0,B);return{rect:{x:ue,y:Ce,width:Math.min(I.width,D+V)-ue,height:Math.min(I.height,B+X)-Ce},layout:[{offset:J,stride:ne}]}})(r,t,n,o,d)),x)for(let I=0;I<T.length;I+=4){const D=T[I];T[I]=T[I+2],T[I+2]=D}return T}finally{_.close()}}))}let Xi,tr;function Ei(r,t,n,o){return r.addEventListener(t,n,o),{unsubscribe:()=>{r.removeEventListener(t,n,o)}}}function mn(r){return r*Math.PI/180}function Ui(r){return r/Math.PI*180}const ee={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},O={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},U="AbortError";function q(){return new Error(U)}const L={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function F(r){return L.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const H="global-dispatcher";class ae extends Error{constructor(t,n,o,d){super(`AJAXError: ${n} (${t}): ${o}`),this.status=t,this.statusText=n,this.url=o,this.body=d}}const pe=()=>jt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,we=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const o=F(r.url);if(o)return o(r,t);if(jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:H},t)}if(!(/^file:/.test(n=r.url)||/^file:/.test(pe())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(o,d){return c(this,void 0,void 0,(function*(){const _=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:pe(),signal:d.signal});let v,x;o.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{v=yield fetch(_)}catch(I){throw new ae(0,I.message,o.url,new Blob)}if(!v.ok){const I=yield v.blob();throw new ae(v.status,v.statusText,o.url,I)}x=o.type==="arrayBuffer"||o.type==="image"?v.arrayBuffer():o.type==="json"?v.json():v.text();const T=yield x;if(d.signal.aborted)throw q();return{data:T,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(r,t);if(jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:H},t)}var n;return(function(o,d){return new Promise(((_,v)=>{var x;const T=new XMLHttpRequest;T.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(T.responseType="arraybuffer");for(const I in o.headers)T.setRequestHeader(I,o.headers[I]);o.type==="json"&&(T.responseType="text",!((x=o.headers)===null||x===void 0)&&x.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=o.credentials==="include",T.onerror=()=>{v(new Error(T.statusText))},T.onload=()=>{if(!d.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let I=T.response;if(o.type==="json")try{I=JSON.parse(T.response)}catch(D){return void v(D)}_({data:I,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const I=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});v(new ae(T.status,T.statusText,o.url,I))}},d.signal.addEventListener("abort",(()=>{T.abort(),v(q())})),T.send(o.body)}))})(r,t)};function ke(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function Te(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function qe(r,t,n){if(n&&n[r]){const o=n[r].indexOf(t);o!==-1&&n[r].splice(o,1)}}class ct{constructor(t,n={}){Dt(this,n),this.type=t}}class Je extends ct{constructor(t,n={}){super("error",Dt({error:t},n))}}class Ft{on(t,n){return this._listeners=this._listeners||{},Te(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return qe(t,n,this._listeners),qe(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Te(t,n,this._oneTimeListeners),this):new Promise((o=>this.once(t,o)))}fire(t,n){typeof t=="string"&&(t=new ct(t,n||{}));const o=t.type;if(this.listens(o)){t.target=this;const d=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const x of d)x.call(this,t);const _=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const x of _)qe(o,x,this._oneTimeListeners),x.call(this,t);const v=this._eventedParent;v&&(Dt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof Je&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var De={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const _i=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function rn(r,t){const n={};for(const o in r)o!=="ref"&&(n[o]=r[o]);return _i.forEach((o=>{o in t&&(n[o]=t[o])})),n}function Gt(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!Gt(r[n],t[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(!Gt(r[n],t[n]))return!1;return!0}return r===t}function xi(r,t){r.push(t)}function Yi(r,t,n){xi(n,{command:"addSource",args:[r,t[r]]})}function gn(r,t,n){xi(t,{command:"removeSource",args:[r]}),n[r]=!0}function _r(r,t,n,o){gn(r,n,o),Yi(r,t,n)}function Sn(r,t,n){let o;for(o in r[n])if(Object.prototype.hasOwnProperty.call(r[n],o)&&o!=="data"&&!Gt(r[n][o],t[n][o]))return!1;for(o in t[n])if(Object.prototype.hasOwnProperty.call(t[n],o)&&o!=="data"&&!Gt(r[n][o],t[n][o]))return!1;return!0}function Zn(r,t,n,o,d,_){r=r||{},t=t||{};for(const v in r)Object.prototype.hasOwnProperty.call(r,v)&&(Gt(r[v],t[v])||n.push({command:_,args:[o,v,t[v],d]}));for(const v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(r,v)&&(Gt(r[v],t[v])||n.push({command:_,args:[o,v,t[v],d]}))}function _n(r){return r.id}function Vn(r,t){return r[t.id]=t,r}class at{constructor(t,n,o,d){this.message=(t?`${t}: `:"")+o,d&&(this.identifier=d),n!=null&&n.__line__&&(this.line=n.__line__)}}function Rn(r,...t){for(const n of t)for(const o in n)r[o]=n[o];return r}class jr extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class ga{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[o,d]of n)this.bindings[o]=d}concat(t){return new ga(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Ni={kind:"null"},gt={kind:"number"},ai={kind:"string"},yi={kind:"boolean"},$a={kind:"color"},tc={kind:"projectionDefinition"},As={kind:"object"},ci={kind:"value"},Fo={kind:"collator"},za={kind:"formatted"},Xr={kind:"padding"},Ca={kind:"colorArray"},os={kind:"numberArray"},Cn={kind:"resolvedImage"},ic={kind:"variableAnchorOffsetCollection"};function Ir(r,t){return{kind:"array",itemType:r,N:t}}function Wi(r){if(r.kind==="array"){const t=Wi(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Ha=[Ni,gt,ai,yi,$a,tc,za,As,Ir(ci),Xr,os,Ca,Cn,ic];function jo(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!jo(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of Ha)if(!jo(n,t))return null}}return`Expected ${Wi(r)} but found ${Wi(t)} instead.`}function Gn(r,t){return t.some((n=>n.kind===r.kind))}function co(r,t){return t.some((n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r))}function zs(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const Cs=.96422,El=.82521,ls=4/29,Pr=6/29,nu=3*Pr*Pr,Ef=Pr*Pr*Pr,ru=Math.PI/180,pd=180/Math.PI;function nc(r){return(r%=360)<0&&(r+=360),r}function md([r,t,n,o]){let d,_;const v=rc((.2225045*(r=la(r))+.7168786*(t=la(t))+.0606169*(n=la(n)))/1);r===t&&t===n?d=_=v:(d=rc((.4360747*r+.3850649*t+.1430804*n)/Cs),_=rc((.0139322*r+.0971045*t+.7141733*n)/El));const x=116*v-16;return[x<0?0:x,500*(d-v),200*(v-_),o]}function la(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function rc(r){return r>Ef?Math.pow(r,1/3):r/nu+ls}function oh([r,t,n,o]){let d=(r+16)/116,_=isNaN(t)?d:d+t/500,v=isNaN(n)?d:d-n/200;return d=1*Is(d),_=Cs*Is(_),v=El*Is(v),[ac(3.1338561*_-1.6168667*d-.4906146*v),ac(-.9787684*_+1.9161415*d+.033454*v),ac(.0719453*_-.2289914*d+1.4052427*v),o]}function ac(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Is(r){return r>Pr?r*r*r:nu*(r-ls)}const Ml=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function Al(r,t){return Ml(r,t)?r[t]:void 0}function Ps(r){return parseInt(r.padEnd(2,r),16)/255}function zl(r,t){return Uo(t?r/100:r,0,1)}function Uo(r,t,n){return Math.min(Math.max(t,r),n)}function lh(r){return!r.some(Number.isNaN)}const ch={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ds(r,t,n){return r+n*(t-r)}function No(r,t,n){return r.map(((o,d)=>Ds(o,t[d],n)))}class ni{constructor(t,n,o,d=1,_=!0){this.r=t,this.g=n,this.b=o,this.a=d,_||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,n,o,d]))}static parse(t){if(t instanceof ni)return t;if(typeof t!="string")return;const n=(function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Al(ch,o);if(d){const[v,x,T]=d;return[v/255,x/255,T/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const v=o.length<6?1:2;let x=1;return[Ps(o.slice(x,x+=v)),Ps(o.slice(x,x+=v)),Ps(o.slice(x,x+=v)),Ps(o.slice(x,x+v)||"ff")]}if(o.startsWith("rgb")){const v=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,T,I,D,B,V,X,W,J,ne,ue,Ce]=v,_e=[D||" ",X||" ",ne].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const xe=[I,V,J].join(""),Fe=xe==="%%%"?100:xe===""?255:0;if(Fe){const We=[Uo(+T/Fe,0,1),Uo(+B/Fe,0,1),Uo(+W/Fe,0,1),ue?zl(+ue,Ce):1];if(lh(We))return We}}return}}const _=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,x,T,I,D,B,V,X,W]=_,J=[T||" ",D||" ",V].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const ne=[+x,Uo(+I,0,100),Uo(+B,0,100),X?zl(+X,W):1];if(lh(ne))return(function([ue,Ce,_e,xe]){function Fe(We){const ut=(We+ue/30)%12,At=Ce*Math.min(_e,1-_e);return _e-At*Math.max(-1,Math.min(ut-3,9-ut,1))}return ue=nc(ue),Ce/=100,_e/=100,[Fe(0),Fe(8),Fe(4),xe]})(ne)}}})(t);return n?new ni(...n,!1):void 0}get rgb(){const{r:t,g:n,b:o,a:d}=this,_=d||1/0;return this.overwriteGetter("rgb",[t/_,n/_,o/_,d])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[n,o,d,_]=md(t),v=Math.sqrt(o*o+d*d);return[Math.round(1e4*v)?nc(Math.atan2(d,o)*pd):NaN,v,n,_]})(this.rgb))}get lab(){return this.overwriteGetter("lab",md(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,o,d]=this.rgb;return`rgba(${[t,n,o].map((_=>Math.round(255*_))).join(",")},${d})`}static interpolate(t,n,o,d="rgb"){switch(d){case"rgb":{const[_,v,x,T]=No(t.rgb,n.rgb,o);return new ni(_,v,x,T,!1)}case"hcl":{const[_,v,x,T]=t.hcl,[I,D,B,V]=n.hcl;let X,W;if(isNaN(_)||isNaN(I))isNaN(_)?isNaN(I)?X=NaN:(X=I,x!==1&&x!==0||(W=D)):(X=_,B!==1&&B!==0||(W=v));else{let _e=I-_;I>_&&_e>180?_e-=360:I<_&&_-I>180&&(_e+=360),X=_+o*_e}const[J,ne,ue,Ce]=(function([_e,xe,Fe,We]){return _e=isNaN(_e)?0:_e*ru,oh([Fe,Math.cos(_e)*xe,Math.sin(_e)*xe,We])})([X,W??Ds(v,D,o),Ds(x,B,o),Ds(T,V,o)]);return new ni(J,ne,ue,Ce,!1)}case"lab":{const[_,v,x,T]=oh(No(t.lab,n.lab,o));return new ni(_,v,x,T,!1)}}}}ni.black=new ni(0,0,0,1),ni.white=new ni(1,1,1,1),ni.transparent=new ni(0,0,0,0),ni.red=new ni(1,0,0,1);class di{constructor(t,n,o){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const uo=["bottom","center","top"];class Ia{constructor(t,n,o,d,_,v){this.text=t,this.image=n,this.scale=o,this.fontStack=d,this.textColor=_,this.verticalAlign=v}}class dr{constructor(t){this.sections=t}static fromString(t){return new dr([new Ia(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof dr?t:dr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class qn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qn)return t;if(typeof t=="number")return new qn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new qn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){return new qn(No(t.values,n.values,o))}}class yr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof yr)return t;if(typeof t=="number")return new yr([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new yr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){return new yr(No(t.values,n.values,o))}}class Bn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Bn)return t;if(typeof t=="string"){const o=ni.parse(t);return o?new Bn([o]):void 0}if(!Array.isArray(t))return;const n=[];for(const o of t){if(typeof o!="string")return;const d=ni.parse(o);if(!d)return;n.push(d)}return new Bn(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o,d="rgb"){const _=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let v=0;v<t.values.length;v++)_.push(ni.interpolate(t.values[v],n.values[v],o,d));return new Bn(_)}}class un extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Cl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class In{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof In)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const o=t[n],d=t[n+1];if(typeof o!="string"||!Cl.has(o)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new In(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){const d=t.values,_=n.values;if(d.length!==_.length)throw new un(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const v=[];for(let x=0;x<d.length;x+=2){if(d[x]!==_[x])throw new un(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${d[x]}, to[${x}]: ${_[x]}`);v.push(d[x]);const[T,I]=d[x+1],[D,B]=_[x+1];v.push([Ds(T,D,o),Ds(I,B,o)])}return new In(v)}}class Dr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Dr({name:t,available:!1}):null}}class kr{constructor(t,n,o){this.from=t,this.to=n,this.transition=o}static interpolate(t,n,o){return new kr(t,n,o)}static parse(t){return t instanceof kr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new kr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new kr(t.from,t.to,t.transition):typeof t=="string"?new kr(t,t,1):void 0}}function Pa(r,t,n,o){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[r,t,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[r,t,n,o]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Da(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof kr||r instanceof ni||r instanceof di||r instanceof dr||r instanceof qn||r instanceof yr||r instanceof Bn||r instanceof In||r instanceof Dr)return!0;if(Array.isArray(r)){for(const t of r)if(!Da(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Da(r[t]))return!1;return!0}return!1}function Tn(r){if(r===null)return Ni;if(typeof r=="string")return ai;if(typeof r=="boolean")return yi;if(typeof r=="number")return gt;if(r instanceof ni)return $a;if(r instanceof kr)return tc;if(r instanceof di)return Fo;if(r instanceof dr)return za;if(r instanceof qn)return Xr;if(r instanceof yr)return os;if(r instanceof Bn)return Ca;if(r instanceof In)return ic;if(r instanceof Dr)return Cn;if(Array.isArray(r)){const t=r.length;let n;for(const o of r){const d=Tn(o);if(n){if(n===d)continue;n=ci;break}n=d}return Ir(n||ci,t)}return As}function Zo(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof ni||r instanceof kr||r instanceof dr||r instanceof qn||r instanceof yr||r instanceof Bn||r instanceof In||r instanceof Dr?r.toString():JSON.stringify(r)}class Xa{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Da(t[1]))return n.error("invalid value");const o=t[1];let d=Tn(o);const _=n.expectedType;return d.kind!=="array"||d.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(d=_),new Xa(d,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const cs={string:ai,number:gt,boolean:yi,object:As};class Ri{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o,d=1;const _=t[0];if(_==="array"){let x,T;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in cs)||I==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);x=cs[I],d++}else x=ci;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=t[2],d++}o=Ir(x,T)}else{if(!cs[_])throw new Error(`Types doesn't contain name = ${_}`);o=cs[_]}const v=[];for(;d<t.length;d++){const x=n.parse(t[d],d,ci);if(!x)return null;v.push(x)}return new Ri(o,v)}evaluate(t){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(t);if(!jo(this.type,Tn(o)))return o;if(n===this.args.length-1)throw new un(`Expected value to be of type ${Wi(this.type)}, but found ${Wi(Tn(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Rr={"to-boolean":yi,"to-color":$a,"to-number":gt,"to-string":ai};class ui{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[0];if(!Rr[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return n.error("Expected one argument.");const d=Rr[o],_=[];for(let v=1;v<t.length;v++){const x=n.parse(t[v],v,ci);if(!x)return null;_.push(x)}return new ui(d,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,o;for(const d of this.args){if(n=d.evaluate(t),o=null,n instanceof ni)return n;if(typeof n=="string"){const _=t.parseColor(n);if(_)return _}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Pa(n[0],n[1],n[2],n[3]),!o))return new ni(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new un(o||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const o of this.args){n=o.evaluate(t);const d=qn.parse(n);if(d)return d}throw new un(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const o of this.args){n=o.evaluate(t);const d=yr.parse(n);if(d)return d}throw new un(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const o of this.args){n=o.evaluate(t);const d=Bn.parse(n);if(d)return d}throw new un(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const o of this.args){n=o.evaluate(t);const d=In.parse(n);if(d)return d}throw new un(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const o of this.args){if(n=o.evaluate(t),n===null)return 0;const d=Number(n);if(!isNaN(d))return d}throw new un(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return dr.fromString(Zo(this.args[0].evaluate(t)));case"resolvedImage":return Dr.fromString(Zo(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Zo(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const fi=["Unknown","Point","LineString","Polygon"];class ho{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=ni.parse(t),this._parseColorCache.set(t,n)),n}}class Di{constructor(t,n,o=[],d,_=new ga,v=[]){this.registry=t,this.path=o,this.key=o.map((x=>`[${x}]`)).join(""),this.scope=_,this.errors=v,this.expectedType=d,this._isConstant=n}parse(t,n,o,d,_={}){return n?this.concat(n,o,d)._parse(t,_):this._parse(t,_)}_parse(t,n){function o(d,_,v){return v==="assert"?new Ri(_,[d]):v==="coerce"?new ui(_,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[d];if(_){let v=_.parse(t,this);if(!v)return null;if(this.expectedType){const x=this.expectedType,T=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value"){if(x.kind==="projectionDefinition"&&["string","array"].includes(T.kind)||["color","formatted","resolvedImage"].includes(x.kind)&&["value","string"].includes(T.kind)||["padding","numberArray"].includes(x.kind)&&["value","number","array"].includes(T.kind)||x.kind==="colorArray"&&["value","string","array"].includes(T.kind)||x.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(T.kind))v=o(v,x,n.typeAnnotation||"coerce");else if(this.checkSubtype(x,T))return null}else v=o(v,x,n.typeAnnotation||"assert")}if(!(v instanceof Xa)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const x=new ho;try{v=new Xa(v.type,v.evaluate(x))}catch(T){return this.error(T.message),null}}return v}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,o){const d=typeof t=="number"?this.path.concat(t):this.path,_=o?this.scope.concat(o):this.scope;return new Di(this.registry,this._isConstant,d,n||null,_,this.errors)}error(t,...n){const o=`${this.key}${n.map((d=>`[${d}]`)).join("")}`;this.errors.push(new jr(o,t))}checkSubtype(t,n){const o=jo(t,n);return o&&this.error(o),o}}class fo{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let _=1;_<t.length-1;_+=2){const v=t[_];if(typeof v!="string")return n.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return n.error("Variable names must contain only alphanumeric characters or '_'.",_);const x=n.parse(t[_+1],_+1);if(!x)return null;o.push([v,x])}const d=n.parse(t[t.length-1],t.length-1,n.expectedType,o);return d?new fo(o,d):null}outputDefined(){return this.result.outputDefined()}}class ca{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=t[1];return n.scope.has(o)?new ca(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ks{constructor(t,n,o){this.type=t,this.index=n,this.input=o}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,gt),d=n.parse(t[2],2,Ir(n.expectedType||ci));return o&&d?new ks(d.type.itemType,o,d):null}evaluate(t){const n=this.index.evaluate(t),o=this.input.evaluate(t);if(n<0)throw new un(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new un(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new un(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Rs{constructor(t,n){this.type=yi,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,ci),d=n.parse(t[2],2,ci);return o&&d?Gn(o.type,[yi,ai,gt,Ni,ci])?new Rs(o,d):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(o.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!co(n,["boolean","string","number","null"]))throw new un(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(Tn(n))} instead.`);if(!co(o,["string","array"]))throw new un(`Expected second argument to be of type array or string, but found ${Wi(Tn(o))} instead.`);return o.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Il{constructor(t,n,o){this.type=gt,this.needle=t,this.haystack=n,this.fromIndex=o}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,ci),d=n.parse(t[2],2,ci);if(!o||!d)return null;if(!Gn(o.type,[yi,ai,gt,Ni,ci]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(o.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,gt);return _?new Il(o,d,_):null}return new Il(o,d)}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!co(n,["boolean","string","number","null"]))throw new un(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(Tn(n))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),co(o,["string"])){const _=o.indexOf(n,d);return _===-1?-1:[...o.slice(0,_)].length}if(co(o,["array"]))return o.indexOf(n,d);throw new un(`Expected second argument to be of type array or string, but found ${Wi(Tn(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class sc{constructor(t,n,o,d,_,v){this.inputType=t,this.type=n,this.input=o,this.cases=d,this.outputs=_,this.otherwise=v}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let o,d;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);const _={},v=[];for(let I=2;I<t.length-1;I+=2){let D=t[I];const B=t[I+1];Array.isArray(D)||(D=[D]);const V=n.concat(I);if(D.length===0)return V.error("Expected at least one branch label.");for(const W of D){if(typeof W!="number"&&typeof W!="string")return V.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return V.error("Numeric branch labels must be integer values.");if(o){if(V.checkSubtype(o,Tn(W)))return null}else o=Tn(W);if(_[String(W)]!==void 0)return V.error("Branch labels must be unique.");_[String(W)]=v.length}const X=n.parse(B,I,d);if(!X)return null;d=d||X.type,v.push(X)}const x=n.parse(t[1],1,ci);if(!x)return null;const T=n.parse(t[t.length-1],t.length-1,d);return T?x.type.kind!=="value"&&n.concat(1).checkSubtype(o,x.type)?null:new sc(o,d,x,_,v,T):null}evaluate(t){const n=this.input.evaluate(t);return(Tn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class au{constructor(t,n,o){this.type=t,this.branches=n,this.otherwise=o}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const d=[];for(let v=1;v<t.length-1;v+=2){const x=n.parse(t[v],v,yi);if(!x)return null;const T=n.parse(t[v+1],v+1,o);if(!T)return null;d.push([x,T]),o=o||T.type}const _=n.parse(t[t.length-1],t.length-1,o);if(!_)return null;if(!o)throw new Error("Can't infer output type");return new au(o,d,_)}evaluate(t){for(const[n,o]of this.branches)if(n.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,o]of this.branches)t(n),t(o);t(this.otherwise)}outputDefined(){return this.branches.every((([t,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class su{constructor(t,n,o,d){this.type=t,this.input=n,this.beginIndex=o,this.endIndex=d}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,ci),d=n.parse(t[2],2,gt);if(!o||!d)return null;if(!Gn(o.type,[Ir(ci),ai,ci]))return n.error(`Expected first argument to be of type array or string, but found ${Wi(o.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,gt);return _?new su(o.type,o,d,_):null}return new su(o.type,o,d)}evaluate(t){const n=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),co(n,["string"]))return[...n].slice(o,d).join("");if(co(n,["array"]))return n.slice(o,d);throw new un(`Expected first argument to be of type array or string, but found ${Wi(Tn(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Vo(r,t){const n=r.length-1;let o,d,_=0,v=n,x=0;for(;_<=v;)if(x=Math.floor((_+v)/2),o=r[x],d=r[x+1],o<=t){if(x===n||t<d)return x;_=x+1}else{if(!(o>t))throw new un("Input is not a number.");v=x-1}return 0}class Pl{constructor(t,n,o){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[d,_]of o)this.labels.push(d),this.outputs.push(_)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(t[1],1,gt);if(!o)return null;const d=[];let _=null;n.expectedType&&n.expectedType.kind!=="value"&&(_=n.expectedType);for(let v=1;v<t.length;v+=2){const x=v===1?-1/0:t[v],T=t[v+1],I=v,D=v+1;if(typeof x!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=x)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const B=n.parse(T,D,_);if(!B)return null;_=_||B.type,d.push([x,B])}return new Pl(_,o,d)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return o[0].evaluate(t);const _=n.length;return d>=n[_-1]?o[_-1].evaluate(t):o[Vo(n,d)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function po(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var vr,oc,gd=(function(){if(oc)return vr;function r(t,n,o,d){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=d}return oc=1,vr=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,d=0;d<8;d++){var _=this.sampleCurveX(o)-t;if(Math.abs(_)<n)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=_/v}var x=0,T=1;for(o=t,d=0;d<20&&(_=this.sampleCurveX(o),!(Math.abs(_-t)<n));d++)t>_?x=o:T=o,o=.5*(T-x)+x;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},vr})(),lc=po(gd);class qi{constructor(t,n,o,d,_){this.type=t,this.operator=n,this.interpolation=o,this.input=d,this.labels=[],this.outputs=[];for(const[v,x]of _)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(t,n,o,d){let _=0;if(t.name==="exponential")_=ou(n,t.base,o,d);else if(t.name==="linear")_=ou(n,1,o,d);else if(t.name==="cubic-bezier"){const v=t.controlPoints;_=new lc(v[0],v[1],v[2],v[3]).solve(ou(n,1,o,d))}return _}static parse(t,n){let[o,d,_,...v]=t;if(!Array.isArray(d)||d.length===0)return n.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some((D=>typeof D!="number"||D<0||D>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(_=n.parse(_,2,gt),!_)return null;const x=[];let T=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||n.expectedType==Ca?n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType):T=$a;for(let I=0;I<v.length;I+=2){const D=v[I],B=v[I+1],V=I+3,X=I+4;if(typeof D!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(x.length&&x[x.length-1][0]>=D)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const W=n.parse(B,X,T);if(!W)return null;T=T||W.type,x.push([D,W])}return zs(T,gt)||zs(T,tc)||zs(T,$a)||zs(T,Xr)||zs(T,os)||zs(T,Ca)||zs(T,ic)||zs(T,Ir(gt))?new qi(T,o,d,_,x):n.error(`Type ${Wi(T)} is not interpolatable.`)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const d=this.input.evaluate(t);if(d<=n[0])return o[0].evaluate(t);const _=n.length;if(d>=n[_-1])return o[_-1].evaluate(t);const v=Vo(n,d),x=qi.interpolationFactor(this.interpolation,d,n[v],n[v+1]),T=o[v].evaluate(t),I=o[v+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ds(T,I,x);case"color":return ni.interpolate(T,I,x);case"padding":return qn.interpolate(T,I,x);case"colorArray":return Bn.interpolate(T,I,x);case"numberArray":return yr.interpolate(T,I,x);case"variableAnchorOffsetCollection":return In.interpolate(T,I,x);case"array":return No(T,I,x);case"projectionDefinition":return kr.interpolate(T,I,x)}case"interpolate-hcl":switch(this.type.kind){case"color":return ni.interpolate(T,I,x,"hcl");case"colorArray":return Bn.interpolate(T,I,x,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ni.interpolate(T,I,x,"lab");case"colorArray":return Bn.interpolate(T,I,x,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ou(r,t,n,o){const d=o-n,_=r-n;return d===0?0:t===1?_/d:(Math.pow(t,_)-1)/(Math.pow(t,d)-1)}const ka={color:ni.interpolate,number:Ds,padding:qn.interpolate,numberArray:yr.interpolate,colorArray:Bn.interpolate,variableAnchorOffsetCollection:In.interpolate,array:No};class cc{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o=null;const d=n.expectedType;d&&d.kind!=="value"&&(o=d);const _=[];for(const x of t.slice(1)){const T=n.parse(x,1+_.length,o,void 0,{typeAnnotation:"omit"});if(!T)return null;o=o||T.type,_.push(T)}if(!o)throw new Error("No output type");const v=d&&_.some((x=>jo(d,x.type)));return new cc(v?ci:o,_)}evaluate(t){let n,o=null,d=0;for(const _ of this.args)if(d++,o=_.evaluate(t),o&&o instanceof Dr&&!o.available&&(n||(n=o.name),o=null,d===this.args.length&&(o=n)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function lu(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Go(r,t,n,o){return o.compare(t,n)===0}function Bs(r,t,n){const o=r!=="=="&&r!=="!=";return class U0{constructor(_,v,x){this.type=yi,this.lhs=_,this.rhs=v,this.collator=x,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const x=_[0];let T=v.parse(_[1],1,ci);if(!T)return null;if(!lu(x,T.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${Wi(T.type)}'.`);let I=v.parse(_[2],2,ci);if(!I)return null;if(!lu(x,I.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${Wi(I.type)}'.`);if(T.type.kind!==I.type.kind&&T.type.kind!=="value"&&I.type.kind!=="value")return v.error(`Cannot compare types '${Wi(T.type)}' and '${Wi(I.type)}'.`);o&&(T.type.kind==="value"&&I.type.kind!=="value"?T=new Ri(I.type,[T]):T.type.kind!=="value"&&I.type.kind==="value"&&(I=new Ri(T.type,[I])));let D=null;if(_.length===4){if(T.type.kind!=="string"&&I.type.kind!=="string"&&T.type.kind!=="value"&&I.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(D=v.parse(_[3],3,Fo),!D)return null}return new U0(T,I,D)}evaluate(_){const v=this.lhs.evaluate(_),x=this.rhs.evaluate(_);if(o&&this.hasUntypedArgument){const T=Tn(v),I=Tn(x);if(T.kind!==I.kind||T.kind!=="string"&&T.kind!=="number")throw new un(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${I.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const T=Tn(v),I=Tn(x);if(T.kind!=="string"||I.kind!=="string")return t(_,v,x)}return this.collator?n(_,v,x,this.collator.evaluate(_)):t(_,v,x)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const uh=Bs("==",(function(r,t,n){return t===n}),Go),_d=Bs("!=",(function(r,t,n){return t!==n}),(function(r,t,n,o){return!Go(0,t,n,o)})),yd=Bs("<",(function(r,t,n){return t<n}),(function(r,t,n,o){return o.compare(t,n)<0})),cu=Bs(">",(function(r,t,n){return t>n}),(function(r,t,n,o){return o.compare(t,n)>0})),uu=Bs("<=",(function(r,t,n){return t<=n}),(function(r,t,n,o){return o.compare(t,n)<=0})),Ya=Bs(">=",(function(r,t,n){return t>=n}),(function(r,t,n,o){return o.compare(t,n)>=0}));class uc{constructor(t,n,o){this.type=Fo,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const d=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,yi);if(!d)return null;const _=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,yi);if(!_)return null;let v=null;return o.locale&&(v=n.parse(o.locale,1,ai),!v)?null:new uc(d,_,v)}evaluate(t){return new di(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Dl{constructor(t,n,o,d,_){this.type=ai,this.number=t,this.locale=n,this.currency=o,this.minFractionDigits=d,this.maxFractionDigits=_}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const o=n.parse(t[1],1,gt);if(!o)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return n.error("NumberFormat options argument must be an object.");let _=null;if(d.locale&&(_=n.parse(d.locale,1,ai),!_))return null;let v=null;if(d.currency&&(v=n.parse(d.currency,1,ai),!v))return null;let x=null;if(d["min-fraction-digits"]&&(x=n.parse(d["min-fraction-digits"],1,gt),!x))return null;let T=null;return d["max-fraction-digits"]&&(T=n.parse(d["max-fraction-digits"],1,gt),!T)?null:new Dl(o,_,v,x,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class hu{constructor(t){this.type=za,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const d=[];let _=!1;for(let v=1;v<=t.length-1;++v){const x=t[v];if(_&&typeof x=="object"&&!Array.isArray(x)){_=!1;let T=null;if(x["font-scale"]&&(T=n.parse(x["font-scale"],1,gt),!T))return null;let I=null;if(x["text-font"]&&(I=n.parse(x["text-font"],1,Ir(ai)),!I))return null;let D=null;if(x["text-color"]&&(D=n.parse(x["text-color"],1,$a),!D))return null;let B=null;if(x["vertical-align"]){if(typeof x["vertical-align"]=="string"&&!uo.includes(x["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${x["vertical-align"]}' instead.`);if(B=n.parse(x["vertical-align"],1,ai),!B)return null}const V=d[d.length-1];V.scale=T,V.font=I,V.textColor=D,V.verticalAlign=B}else{const T=n.parse(t[v],1,ci);if(!T)return null;const I=T.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,d.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new hu(d)}evaluate(t){return new dr(this.sections.map((n=>{const o=n.content.evaluate(t);return Tn(o)===Cn?new Ia("",o,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new Ia(Zo(o),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class hc{constructor(t){this.type=Cn,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const o=n.parse(t[1],1,ai);return o?new hc(o):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),o=Dr.fromString(n);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(n)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class hh{constructor(t){this.type=gt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=n.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Wi(o.type)} instead.`):new hh(o):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new un(`Expected value to be of type string or array, but found ${Wi(Tn(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ra=8192;function dc(r,t){const n=(180+r[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(n*d*Ra),Math.round(o*d*Ra)]}function dh(r,t){const n=Math.pow(2,t.z);return[(d=(r[0]/Ra+t.x)/n,360*d-180),(o=(r[1]/Ra+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,d}function Ls(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function kl(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function fh(r,t,n){const o=r[0]-t[0],d=r[1]-t[1],_=r[0]-n[0],v=r[1]-n[1];return o*v-_*d==0&&o*_<=0&&d*v<=0}function Rl(r,t,n,o){return(d=[o[0]-n[0],o[1]-n[1]])[0]*(_=[t[0]-r[0],t[1]-r[1]])[1]-d[1]*_[0]!=0&&!(!ph(r,t,n,o)||!ph(n,o,r,t));var d,_}function vd(r,t,n){for(const o of n)for(let d=0;d<o.length-1;++d)if(Rl(r,t,o[d],o[d+1]))return!0;return!1}function Ba(r,t,n=!1){let o=!1;for(const x of t)for(let T=0;T<x.length-1;T++){if(fh(r,x[T],x[T+1]))return n;(_=x[T])[1]>(d=r)[1]!=(v=x[T+1])[1]>d[1]&&d[0]<(v[0]-_[0])*(d[1]-_[1])/(v[1]-_[1])+_[0]&&(o=!o)}var d,_,v;return o}function Mf(r,t){for(const n of t)if(Ba(r,n))return!0;return!1}function bd(r,t){for(const n of r)if(!Ba(n,t))return!1;for(let n=0;n<r.length-1;++n)if(vd(r[n],r[n+1],t))return!1;return!0}function Af(r,t){for(const n of t)if(bd(r,n))return!0;return!1}function ph(r,t,n,o){const d=o[0]-n[0],_=o[1]-n[1],v=(r[0]-n[0])*_-d*(r[1]-n[1]),x=(t[0]-n[0])*_-d*(t[1]-n[1]);return v>0&&x<0||v<0&&x>0}function du(r,t,n){const o=[];for(let d=0;d<r.length;d++){const _=[];for(let v=0;v<r[d].length;v++){const x=dc(r[d][v],n);Ls(t,x),_.push(x)}o.push(_)}return o}function qo(r,t,n){const o=[];for(let d=0;d<r.length;d++){const _=du(r[d],t,n);o.push(_)}return o}function $o(r,t,n,o){if(r[0]<n[0]||r[0]>n[2]){const d=.5*o;let _=r[0]-n[0]>d?-o:n[0]-r[0]>d?o:0;_===0&&(_=r[0]-n[2]>d?-o:n[2]-r[0]>d?o:0),r[0]+=_}Ls(t,r)}function mh(r,t,n,o){const d=Math.pow(2,o.z)*Ra,_=[o.x*Ra,o.y*Ra],v=[];for(const x of r)for(const T of x){const I=[T.x+_[0],T.y+_[1]];$o(I,t,n,d),v.push(I)}return v}function fc(r,t,n,o){const d=Math.pow(2,o.z)*Ra,_=[o.x*Ra,o.y*Ra],v=[];for(const T of r){const I=[];for(const D of T){const B=[D.x+_[0],D.y+_[1]];Ls(t,B),I.push(B)}v.push(I)}if(t[2]-t[0]<=d/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const T of v)for(const I of T)$o(I,t,n,d)}var x;return v}class mo{constructor(t,n){this.type=yi,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Da(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const d=[];for(const _ of o.features){const{type:v,coordinates:x}=_.geometry;v==="Polygon"&&d.push(x),v==="MultiPolygon"&&d.push(...x)}if(d.length)return new mo(o,{type:"MultiPolygon",coordinates:d})}else if(o.type==="Feature"){const d=o.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new mo(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new mo(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,o){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(o.type==="Polygon"){const x=du(o.coordinates,_,v),T=mh(n.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of T)if(!Ba(I,x))return!1}if(o.type==="MultiPolygon"){const x=qo(o.coordinates,_,v),T=mh(n.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of T)if(!Mf(I,x))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,o){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=n.canonicalID();if(o.type==="Polygon"){const x=du(o.coordinates,_,v),T=fc(n.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of T)if(!bd(I,x))return!1}if(o.type==="MultiPolygon"){const x=qo(o.coordinates,_,v),T=fc(n.geometry(),d,_,v);if(!kl(d,_))return!1;for(const I of T)if(!Af(I,x))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let gh=class{constructor(r=[],t=(n,o)=>n<o?-1:n>o?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,o=t[r];for(;r>0;){const d=r-1>>1,_=t[d];if(n(o,_)>=0)break;t[r]=_,r=d}t[r]=o}_down(r){const{data:t,compare:n}=this,o=this.length>>1,d=t[r];for(;r<o;){let _=1+(r<<1);const v=_+1;if(v<this.length&&n(t[v],t[_])<0&&(_=v),n(t[_],d)>=0)break;t[r]=t[_],r=_}t[r]=d}};function fu(r,t,n=0,o=r.length-1,d=xd){for(;o>n;){if(o-n>600){const T=o-n+1,I=t-n+1,D=Math.log(T),B=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*B*(T-B)/T)*(I-T/2<0?-1:1);fu(r,t,Math.max(n,Math.floor(t-I*B/T+V)),Math.min(o,Math.floor(t+(T-I)*B/T+V)),d)}const _=r[t];let v=n,x=o;for(us(r,n,t),d(r[o],_)>0&&us(r,n,o);v<x;){for(us(r,v,x),v++,x--;d(r[v],_)<0;)v++;for(;d(r[x],_)>0;)x--}d(r[n],_)===0?us(r,n,x):(x++,us(r,x,o)),x<=t&&(n=x+1),t<=x&&(o=x-1)}}function us(r,t,n){const o=r[t];r[t]=r[n],r[n]=o}function xd(r,t){return r<t?-1:r>t?1:0}function pc(r,t){if(r.length<=1)return[r];const n=[];let o,d;for(const _ of r){const v=zf(_);v!==0&&(_.area=Math.abs(v),d===void 0&&(d=v<0),d===v<0?(o&&n.push(o),o=[_]):o.push(_))}if(o&&n.push(o),t>1)for(let _=0;_<n.length;_++)n[_].length<=t||(fu(n[_],t,1,n[_].length-1,wd),n[_]=n[_].slice(0,t));return n}function wd(r,t){return t.area-r.area}function zf(r){let t=0;for(let n,o,d=0,_=r.length,v=_-1;d<_;v=d++)n=r[d],o=r[v],t+=(o.x-n.x)*(n.y+o.y);return t}const pu=1/298.257223563,_h=pu*(2-pu),Sd=Math.PI/180;class yh{constructor(t){const n=6378.137*Sd*1e3,o=Math.cos(t*Sd),d=1/(1-_h*(1-o*o)),_=Math.sqrt(d);this.kx=n*_*o,this.ky=n*_*d*(1-_h)}distance(t,n){const o=this.wrap(t[0]-n[0])*this.kx,d=(t[1]-n[1])*this.ky;return Math.sqrt(o*o+d*d)}pointOnLine(t,n){let o,d,_,v,x=1/0;for(let T=0;T<t.length-1;T++){let I=t[T][0],D=t[T][1],B=this.wrap(t[T+1][0]-I)*this.kx,V=(t[T+1][1]-D)*this.ky,X=0;B===0&&V===0||(X=(this.wrap(n[0]-I)*this.kx*B+(n[1]-D)*this.ky*V)/(B*B+V*V),X>1?(I=t[T+1][0],D=t[T+1][1]):X>0&&(I+=B/this.kx*X,D+=V/this.ky*X)),B=this.wrap(n[0]-I)*this.kx,V=(n[1]-D)*this.ky;const W=B*B+V*V;W<x&&(x=W,o=I,d=D,_=T,v=X)}return{point:[o,d],index:_,t:Math.max(0,Math.min(1,v))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Yr(r,t){return t[0]-r[0]}function Os(r){return r[1]-r[0]+1}function hs(r,t){return r[1]>=r[0]&&r[1]<t}function mu(r,t){if(r[0]>r[1])return[null,null];const n=Os(r);if(t){if(n===2)return[r,null];const d=Math.floor(n/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(n===1)return[r,null];const o=Math.floor(n/2)-1;return[[r[0],r[0]+o],[r[0]+o+1,r[1]]]}function gu(r,t){if(!hs(t,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)Ls(n,r[o]);return n}function mc(r){const t=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const o of n)Ls(t,o);return t}function _u(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function vh(r,t,n){if(!_u(r)||!_u(t))return NaN;let o=0,d=0;return r[2]<t[0]&&(o=t[0]-r[2]),r[0]>t[2]&&(o=r[0]-t[2]),r[1]>t[3]&&(d=r[1]-t[3]),r[3]<t[1]&&(d=t[1]-r[3]),n.distance([0,0],[o,d])}function La(r,t,n){const o=n.pointOnLine(t,r);return n.distance(r,o.point)}function gc(r,t,n,o,d){const _=Math.min(La(r,[n,o],d),La(t,[n,o],d)),v=Math.min(La(n,[r,t],d),La(o,[r,t],d));return Math.min(_,v)}function Bi(r,t,n,o,d){if(!hs(t,r.length)||!hs(o,n.length))return 1/0;let _=1/0;for(let v=t[0];v<t[1];++v){const x=r[v],T=r[v+1];for(let I=o[0];I<o[1];++I){const D=n[I],B=n[I+1];if(Rl(x,T,D,B))return 0;_=Math.min(_,gc(x,T,D,B,d))}}return _}function bh(r,t,n,o,d){if(!hs(t,r.length)||!hs(o,n.length))return NaN;let _=1/0;for(let v=t[0];v<=t[1];++v)for(let x=o[0];x<=o[1];++x)if(_=Math.min(_,d.distance(r[v],n[x])),_===0)return _;return _}function Td(r,t,n){if(Ba(r,t,!0))return 0;let o=1/0;for(const d of t){const _=d[0],v=d[d.length-1];if(_!==v&&(o=Math.min(o,La(r,[v,_],n)),o===0))return o;const x=n.pointOnLine(d,r);if(o=Math.min(o,n.distance(r,x.point)),o===0)return o}return o}function Ho(r,t,n,o){if(!hs(t,r.length))return NaN;for(let _=t[0];_<=t[1];++_)if(Ba(r[_],n,!0))return 0;let d=1/0;for(let _=t[0];_<t[1];++_){const v=r[_],x=r[_+1];for(const T of n)for(let I=0,D=T.length,B=D-1;I<D;B=I++){const V=T[B],X=T[I];if(Rl(v,x,V,X))return 0;d=Math.min(d,gc(v,x,V,X,o))}}return d}function Xo(r,t){for(const n of r)for(const o of n)if(Ba(o,t,!0))return!0;return!1}function xh(r,t,n,o=1/0){const d=mc(r),_=mc(t);if(o!==1/0&&vh(d,_,n)>=o)return o;if(kl(d,_)){if(Xo(r,t))return 0}else if(Xo(t,r))return 0;let v=1/0;for(const x of r)for(let T=0,I=x.length,D=I-1;T<I;D=T++){const B=x[D],V=x[T];for(const X of t)for(let W=0,J=X.length,ne=J-1;W<J;ne=W++){const ue=X[ne],Ce=X[W];if(Rl(B,V,ue,Ce))return 0;v=Math.min(v,gc(B,V,ue,Ce,n))}}return v}function wh(r,t,n,o,d,_){if(!_)return;const v=vh(gu(o,_),d,n);v<t&&r.push([v,_,[0,0]])}function ds(r,t,n,o,d,_,v){if(!_||!v)return;const x=vh(gu(o,_),gu(d,v),n);x<t&&r.push([x,_,v])}function _c(r,t,n,o,d=1/0){let _=Math.min(o.distance(r[0],n[0][0]),d);if(_===0)return _;const v=new gh([[0,[0,r.length-1],[0,0]]],Yr),x=mc(n);for(;v.length>0;){const T=v.pop();if(T[0]>=_)continue;const I=T[1],D=t?50:100;if(Os(I)<=D){if(!hs(I,r.length))return NaN;if(t){const B=Ho(r,I,n,o);if(isNaN(B)||B===0)return B;_=Math.min(_,B)}else for(let B=I[0];B<=I[1];++B){const V=Td(r[B],n,o);if(_=Math.min(_,V),_===0)return 0}}else{const B=mu(I,t);wh(v,_,o,r,x,B[0]),wh(v,_,o,r,x,B[1])}}return _}function yc(r,t,n,o,d,_=1/0){let v=Math.min(_,d.distance(r[0],n[0]));if(v===0)return v;const x=new gh([[0,[0,r.length-1],[0,n.length-1]]],Yr);for(;x.length>0;){const T=x.pop();if(T[0]>=v)continue;const I=T[1],D=T[2],B=t?50:100,V=o?50:100;if(Os(I)<=B&&Os(D)<=V){if(!hs(I,r.length)&&hs(D,n.length))return NaN;let X;if(t&&o)X=Bi(r,I,n,D,d),v=Math.min(v,X);else if(t&&!o){const W=r.slice(I[0],I[1]+1);for(let J=D[0];J<=D[1];++J)if(X=La(n[J],W,d),v=Math.min(v,X),v===0)return v}else if(!t&&o){const W=n.slice(D[0],D[1]+1);for(let J=I[0];J<=I[1];++J)if(X=La(r[J],W,d),v=Math.min(v,X),v===0)return v}else X=bh(r,I,n,D,d),v=Math.min(v,X)}else{const X=mu(I,t),W=mu(D,o);ds(x,v,d,r,n,X[0],W[0]),ds(x,v,d,r,n,X[0],W[1]),ds(x,v,d,r,n,X[1],W[0]),ds(x,v,d,r,n,X[1],W[1])}}return v}function yu(r){return r.type==="MultiPolygon"?r.coordinates.map((t=>({type:"Polygon",coordinates:t}))):r.type==="MultiLineString"?r.coordinates.map((t=>({type:"LineString",coordinates:t}))):r.type==="MultiPoint"?r.coordinates.map((t=>({type:"Point",coordinates:t}))):[r]}class Yo{constructor(t,n){this.type=gt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Da(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new Yo(o,o.features.map((d=>yu(d.geometry))).flat());if(o.type==="Feature")return new Yo(o,yu(o.geometry));if("type"in o&&"coordinates"in o)return new Yo(o,yu(o))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,o){const d=n.geometry(),_=d.flat().map((T=>dh([T.x,T.y],n.canonical)));if(d.length===0)return NaN;const v=new yh(_[0][1]);let x=1/0;for(const T of o){switch(T.type){case"Point":x=Math.min(x,yc(_,!1,[T.coordinates],!1,v,x));break;case"LineString":x=Math.min(x,yc(_,!1,T.coordinates,!0,v,x));break;case"Polygon":x=Math.min(x,_c(_,!1,T.coordinates,v,x))}if(x===0)return x}return x})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,o){const d=n.geometry(),_=d.flat().map((T=>dh([T.x,T.y],n.canonical)));if(d.length===0)return NaN;const v=new yh(_[0][1]);let x=1/0;for(const T of o){switch(T.type){case"Point":x=Math.min(x,yc(_,!0,[T.coordinates],!1,v,x));break;case"LineString":x=Math.min(x,yc(_,!0,T.coordinates,!0,v,x));break;case"Polygon":x=Math.min(x,_c(_,!0,T.coordinates,v,x))}if(x===0)return x}return x})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(n,o){const d=n.geometry();if(d.length===0||d[0].length===0)return NaN;const _=pc(d,0).map((T=>T.map((I=>I.map((D=>dh([D.x,D.y],n.canonical))))))),v=new yh(_[0][0][0][1]);let x=1/0;for(const T of o)for(const I of _){switch(T.type){case"Point":x=Math.min(x,_c([T.coordinates],!1,I,v,x));break;case"LineString":x=Math.min(x,_c(T.coordinates,!0,I,v,x));break;case"Polygon":x=Math.min(x,xh(I,T.coordinates,v,x))}if(x===0)return x}return x})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class vc{constructor(t){this.type=ci,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=t[1];return o==null?n.error("Global state property must be defined."):typeof o!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new vc(o)}evaluate(t){var n;const o=(n=t.globals)===null||n===void 0?void 0:n.globalState;return o&&Object.keys(o).length!==0?Al(o,this.key):null}eachChild(){}outputDefined(){return!1}}const Bl={"==":uh,"!=":_d,">":cu,"<":yd,">=":Ya,"<=":uu,array:Ri,at:ks,boolean:Ri,case:au,coalesce:cc,collator:uc,format:hu,image:hc,in:Rs,"index-of":Il,interpolate:qi,"interpolate-hcl":qi,"interpolate-lab":qi,length:hh,let:fo,literal:Xa,match:sc,number:Ri,"number-format":Dl,object:Ri,slice:su,step:Pl,string:Ri,"to-boolean":ui,"to-color":ui,"to-number":ui,"to-string":ui,var:ca,within:mo,distance:Yo,"global-state":vc};class _a{constructor(t,n,o,d){this.name=t,this.type=n,this._evaluate=o,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const o=t[0],d=_a.definitions[o];if(!d)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(d)?d[0]:d.type,v=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=v.filter((([I])=>!Array.isArray(I)||I.length===t.length-1));let T=null;for(const[I,D]of x){T=new Di(n.registry,Wr,n.path,null,n.scope);const B=[];let V=!1;for(let X=1;X<t.length;X++){const W=t[X],J=Array.isArray(I)?I[X-1]:I.type,ne=T.parse(W,1+B.length,J);if(!ne){V=!0;break}B.push(ne)}if(!V)if(Array.isArray(I)&&I.length!==B.length)T.error(`Expected ${I.length} arguments, but found ${B.length} instead.`);else{for(let X=0;X<B.length;X++){const W=Array.isArray(I)?I[X]:I.type,J=B[X];T.concat(X+1).checkSubtype(W,J.type)}if(T.errors.length===0)return new _a(o,_,D,B)}}if(x.length===1)n.errors.push(...T.errors);else{const I=(x.length?x:v).map((([B])=>{return V=B,Array.isArray(V)?`(${V.map(Wi).join(", ")})`:`(${Wi(V.type)}...)`;var V})).join(" | "),D=[];for(let B=1;B<t.length;B++){const V=n.parse(t[B],1+D.length);if(!V)return null;D.push(Wi(V.type))}n.error(`Expected arguments of type ${I}, but found (${D.join(", ")}) instead.`)}return null}static register(t,n){_a.definitions=n;for(const o in n)t[o]=_a}}function Sh(r,[t,n,o,d]){t=t.evaluate(r),n=n.evaluate(r),o=o.evaluate(r);const _=d?d.evaluate(r):1,v=Pa(t,n,o,_);if(v)throw new un(v);return new ni(t/255,n/255,o/255,_,!1)}function vu(r,t){return r in t}function ya(r,t){const n=t[r];return n===void 0?null:n}function fs(r){return{type:r}}function Wr(r){if(r instanceof ca)return Wr(r.boundExpression);if(r instanceof _a&&r.name==="error"||r instanceof uc||r instanceof mo||r instanceof Yo||r instanceof vc)return!1;const t=r instanceof ui||r instanceof Ri;let n=!0;return r.eachChild((o=>{n=t?n&&Wr(o):n&&o instanceof Xa})),!!n&&Fs(r)&&Ko(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Fs(r){if(r instanceof _a&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof mo||r instanceof Yo)return!1;let t=!0;return r.eachChild((n=>{t&&!Fs(n)&&(t=!1)})),t}function Wo(r){if(r instanceof _a&&r.name==="feature-state")return!1;let t=!0;return r.eachChild((n=>{t&&!Wo(n)&&(t=!1)})),t}function Ko(r,t){if(r instanceof _a&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild((o=>{n&&!Ko(o,t)&&(n=!1)})),n}function bc(r){return{result:"success",value:r}}function go(r){return{result:"error",value:r}}function Oa(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Th(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Ll(r){return!!r.expression&&r.expression.interpolated}function pi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function bu(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&Tn(r)===As}function va(r){return r}function xu(r,t){const n=r.stops&&typeof r.stops[0][0]=="object",o=n||!(n||r.property!==void 0),d=r.type||(Ll(t)?"exponential":"interval"),_=(function(D){switch(D.type){case"color":return ni.parse;case"padding":return qn.parse;case"numberArray":return yr.parse;case"colorArray":return Bn.parse;default:return null}})(t);if(_&&((r=Rn({},r)).stops&&(r.stops=r.stops.map((D=>[D[0],_(D[1])]))),r.default=_(r.default?r.default:t.default)),r.colorSpace&&(v=r.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var v;const x=(function(D){switch(D){case"exponential":return _o;case"interval":return wu;case"categorical":return Ed;case"identity":return Su;default:throw new Error(`Unknown function type "${D}"`)}})(d);let T,I;if(d==="categorical"){T=Object.create(null);for(const D of r.stops)T[D[0]]=D[1];I=typeof r.stops[0][0]}if(n){const D={},B=[];for(let W=0;W<r.stops.length;W++){const J=r.stops[W],ne=J[0].zoom;D[ne]===void 0&&(D[ne]={zoom:ne,type:r.type,property:r.property,default:r.default,stops:[]},B.push(ne)),D[ne].stops.push([J[0].value,J[1]])}const V=[];for(const W of B)V.push([D[W].zoom,xu(D[W],t)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:qi.interpolationFactor.bind(void 0,X),zoomStops:V.map((W=>W[0])),evaluate:({zoom:W},J)=>_o({stops:V,base:r.base},t,W).evaluate(W,J)}}if(o){const D=d==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:qi.interpolationFactor.bind(void 0,D),zoomStops:r.stops.map((B=>B[0])),evaluate:({zoom:B})=>x(r,t,B,T,I)}}return{kind:"source",evaluate(D,B){const V=B&&B.properties?B.properties[r.property]:void 0;return V===void 0?Kr(r.default,t.default):x(r,t,V,T,I)}}}function Kr(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function Ed(r,t,n,o,d){return Kr(typeof n===d?o[n]:void 0,r.default,t.default)}function wu(r,t,n){if(pi(n)!=="number")return Kr(r.default,t.default);const o=r.stops.length;if(o===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[o-1][0])return r.stops[o-1][1];const d=Vo(r.stops.map((_=>_[0])),n);return r.stops[d][1]}function _o(r,t,n){const o=r.base!==void 0?r.base:1;if(pi(n)!=="number")return Kr(r.default,t.default);const d=r.stops.length;if(d===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[d-1][0])return r.stops[d-1][1];const _=Vo(r.stops.map((D=>D[0])),n),v=(function(D,B,V,X){const W=X-V,J=D-V;return W===0?0:B===1?J/W:(Math.pow(B,J)-1)/(Math.pow(B,W)-1)})(n,o,r.stops[_][0],r.stops[_+1][0]),x=r.stops[_][1],T=r.stops[_+1][1],I=ka[t.type]||va;return typeof x.evaluate=="function"?{evaluate(...D){const B=x.evaluate.apply(void 0,D),V=T.evaluate.apply(void 0,D);if(B!==void 0&&V!==void 0)return I(B,V,v,r.colorSpace)}}:I(x,T,v,r.colorSpace)}function Su(r,t,n){switch(t.type){case"color":n=ni.parse(n);break;case"formatted":n=dr.fromString(n.toString());break;case"resolvedImage":n=Dr.fromString(n.toString());break;case"padding":n=qn.parse(n);break;case"colorArray":n=Bn.parse(n);break;case"numberArray":n=yr.parse(n);break;default:pi(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return Kr(n,r.default,t.default)}_a.register(Bl,{error:[{kind:"error"},[ai],(r,[t])=>{throw new un(t.evaluate(r))}],typeof:[ai,[ci],(r,[t])=>Wi(Tn(t.evaluate(r)))],"to-rgba":[Ir(gt,4),[$a],(r,[t])=>{const[n,o,d,_]=t.evaluate(r).rgb;return[255*n,255*o,255*d,_]}],rgb:[$a,[gt,gt,gt],Sh],rgba:[$a,[gt,gt,gt,gt],Sh],has:{type:yi,overloads:[[[ai],(r,[t])=>vu(t.evaluate(r),r.properties())],[[ai,As],(r,[t,n])=>vu(t.evaluate(r),n.evaluate(r))]]},get:{type:ci,overloads:[[[ai],(r,[t])=>ya(t.evaluate(r),r.properties())],[[ai,As],(r,[t,n])=>ya(t.evaluate(r),n.evaluate(r))]]},"feature-state":[ci,[ai],(r,[t])=>ya(t.evaluate(r),r.featureState||{})],properties:[As,[],r=>r.properties()],"geometry-type":[ai,[],r=>r.geometryType()],id:[ci,[],r=>r.id()],zoom:[gt,[],r=>r.globals.zoom],"heatmap-density":[gt,[],r=>r.globals.heatmapDensity||0],elevation:[gt,[],r=>r.globals.elevation||0],"line-progress":[gt,[],r=>r.globals.lineProgress||0],accumulated:[ci,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[gt,fs(gt),(r,t)=>{let n=0;for(const o of t)n+=o.evaluate(r);return n}],"*":[gt,fs(gt),(r,t)=>{let n=1;for(const o of t)n*=o.evaluate(r);return n}],"-":{type:gt,overloads:[[[gt,gt],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[gt],(r,[t])=>-t.evaluate(r)]]},"/":[gt,[gt,gt],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[gt,[gt,gt],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[gt,[],()=>Math.LN2],pi:[gt,[],()=>Math.PI],e:[gt,[],()=>Math.E],"^":[gt,[gt,gt],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[gt,[gt],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))],log2:[gt,[gt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[gt,[gt],(r,[t])=>Math.sin(t.evaluate(r))],cos:[gt,[gt],(r,[t])=>Math.cos(t.evaluate(r))],tan:[gt,[gt],(r,[t])=>Math.tan(t.evaluate(r))],asin:[gt,[gt],(r,[t])=>Math.asin(t.evaluate(r))],acos:[gt,[gt],(r,[t])=>Math.acos(t.evaluate(r))],atan:[gt,[gt],(r,[t])=>Math.atan(t.evaluate(r))],min:[gt,fs(gt),(r,t)=>Math.min(...t.map((n=>n.evaluate(r))))],max:[gt,fs(gt),(r,t)=>Math.max(...t.map((n=>n.evaluate(r))))],abs:[gt,[gt],(r,[t])=>Math.abs(t.evaluate(r))],round:[gt,[gt],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[gt,[gt],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[gt,[gt],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[yi,[ai,ci],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[yi,[ci],(r,[t])=>r.id()===t.value],"filter-type-==":[yi,[ai],(r,[t])=>r.geometryType()===t.value],"filter-<":[yi,[ai,ci],(r,[t,n])=>{const o=r.properties()[t.value],d=n.value;return typeof o==typeof d&&o<d}],"filter-id-<":[yi,[ci],(r,[t])=>{const n=r.id(),o=t.value;return typeof n==typeof o&&n<o}],"filter->":[yi,[ai,ci],(r,[t,n])=>{const o=r.properties()[t.value],d=n.value;return typeof o==typeof d&&o>d}],"filter-id->":[yi,[ci],(r,[t])=>{const n=r.id(),o=t.value;return typeof n==typeof o&&n>o}],"filter-<=":[yi,[ai,ci],(r,[t,n])=>{const o=r.properties()[t.value],d=n.value;return typeof o==typeof d&&o<=d}],"filter-id-<=":[yi,[ci],(r,[t])=>{const n=r.id(),o=t.value;return typeof n==typeof o&&n<=o}],"filter->=":[yi,[ai,ci],(r,[t,n])=>{const o=r.properties()[t.value],d=n.value;return typeof o==typeof d&&o>=d}],"filter-id->=":[yi,[ci],(r,[t])=>{const n=r.id(),o=t.value;return typeof n==typeof o&&n>=o}],"filter-has":[yi,[ci],(r,[t])=>t.value in r.properties()],"filter-has-id":[yi,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[yi,[Ir(ai)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[yi,[Ir(ci)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[yi,[ai,Ir(ci)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[yi,[ai,Ir(ci)],(r,[t,n])=>(function(o,d,_,v){for(;_<=v;){const x=_+v>>1;if(d[x]===o)return!0;d[x]>o?v=x-1:_=x+1}return!1})(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:yi,overloads:[[[yi,yi],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[fs(yi),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:yi,overloads:[[[yi,yi],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[fs(yi),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[yi,[yi],(r,[t])=>!t.evaluate(r)],"is-supported-script":[yi,[ai],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[ai,[ai],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[ai,[ai],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[ai,fs(ci),(r,t)=>t.map((n=>Zo(n.evaluate(r)))).join("")],"resolved-locale":[ai,[Fo],(r,[t])=>t.evaluate(r).resolvedLocale()]});class Tu{constructor(t,n,o){this.expression=t,this._warningHistory={},this._evaluator=new ho,this._defaultValue=n?(function(d){if(d.type==="color"&&bu(d.default))return new ni(0,0,0,0);switch(d.type){case"color":return ni.parse(d.default)||null;case"padding":return qn.parse(d.default)||null;case"numberArray":return yr.parse(d.default)||null;case"colorArray":return Bn.parse(d.default)||null;case"variableAnchorOffsetCollection":return In.parse(d.default)||null;case"projectionDefinition":return kr.parse(d.default)||null;default:return d.default===void 0?null:d.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=o}evaluateWithoutErrorHandling(t,n,o,d,_,v){return this._globalState&&(t=br(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(t,n,o,d,_,v){this._globalState&&(t=br(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new un(`Expected value to be one of ${Object.keys(this._enumValues).map((T=>JSON.stringify(T))).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Ol(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Bl}function yo(r,t,n){const o=new Di(Bl,Wr,[],t?(function(_){const v={color:$a,string:ai,number:gt,enum:ai,boolean:yi,formatted:za,padding:Xr,numberArray:os,colorArray:Ca,projectionDefinition:tc,resolvedImage:Cn,variableAnchorOffsetCollection:ic};return _.type==="array"?Ir(v[_.value]||ci,_.length):v[_.type]})(t):void 0),d=o.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?bc(new Tu(d,t,n)):go(o.errors)}class Ur{constructor(t,n,o){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Wo(n.expression),this.globalStateRefs=Qr(n.expression),this._globalState=o}evaluateWithoutErrorHandling(t,n,o,d,_,v){return this._globalState&&(t=br(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,o,d,_,v)}evaluate(t,n,o,d,_,v){return this._globalState&&(t=br(t,this._globalState)),this._styleExpression.evaluate(t,n,o,d,_,v)}}class vo{constructor(t,n,o,d,_){this.kind=t,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Wo(n.expression),this.globalStateRefs=Qr(n.expression),this.interpolationType=d,this._globalState=_}evaluateWithoutErrorHandling(t,n,o,d,_,v){return this._globalState&&(t=br(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,o,d,_,v)}evaluate(t,n,o,d,_,v){return this._globalState&&(t=br(t,this._globalState)),this._styleExpression.evaluate(t,n,o,d,_,v)}interpolationFactor(t,n,o){return this.interpolationType?qi.interpolationFactor(this.interpolationType,t,n,o):0}}function Qo(r,t,n){const o=yo(r,t,n);if(o.result==="error")return o;const d=o.value.expression,_=Fs(d);if(!_&&!Oa(t))return go([new jr("","data expressions not supported")]);const v=Ko(d,["zoom"]);if(!v&&!Th(t))return go([new jr("","zoom expressions not supported")]);const x=bo(d);return x||v?x instanceof jr?go([x]):x instanceof qi&&!Ll(t)?go([new jr("",'"interpolate" expressions cannot be used with this property')]):bc(x?new vo(_?"camera":"composite",o.value,x.labels,x instanceof qi?x.interpolation:void 0,n):new Ur(_?"constant":"source",o.value,n)):go([new jr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jo{constructor(t,n){this._parameters=t,this._specification=n,Rn(this,xu(this._parameters,this._specification))}static deserialize(t){return new Jo(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function bo(r){let t=null;if(r instanceof fo)t=bo(r.result);else if(r instanceof cc){for(const n of r.args)if(t=bo(n),t)break}else(r instanceof Pl||r instanceof qi)&&r.input instanceof _a&&r.input.name==="zoom"&&(t=r);return t instanceof jr||r.eachChild((n=>{const o=bo(n);o instanceof jr?t=o:!t&&o?t=new jr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new jr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function Qr(r,t=new Set){return r instanceof vc&&t.add(r.key),r.eachChild((n=>{Qr(n,t)})),t}function br(r,t){const{zoom:n,heatmapDensity:o,elevation:d,lineProgress:_,isSupportedScript:v,accumulated:x}=r??{};return{zoom:n,heatmapDensity:o,elevation:d,lineProgress:_,isSupportedScript:v,accumulated:x,globalState:t}}function Wa(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Wa(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const ps={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ua(r,t){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Wa(r)||(r=el(r));const n=yo(r,ps,t);if(n.result==="error")throw new Error(n.value.map((o=>`${o.key}: ${o.message}`)).join(", "));return{filter:(o,d,_)=>n.value.evaluate(o,d,{},_),needGeometry:Eu(r),getGlobalStateRefs:()=>Qr(n.value.expression)}}function ms(r,t){return r<t?-1:r>t?1:0}function Eu(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Eu(r[t]))return!0;return!1}function el(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?xc(r[1],r[2],"=="):t==="!="?an(xc(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?xc(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map(el))):t==="all"?["all"].concat(r.slice(1).map(el)):t==="none"?["all"].concat(r.slice(1).map(el).map(an)):t==="in"?Eh(r[1],r.slice(2)):t==="!in"?an(Eh(r[1],r.slice(2))):t==="has"?xr(r[1]):t!=="!has"||an(xr(r[1]));var n}function xc(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function Eh(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((n=>typeof n!=typeof t[0]))?["filter-in-large",r,["literal",t.sort(ms)]]:["filter-in-small",r,["literal",t]]}}function xr(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function an(r){return["!",r]}function Ii(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(const _ of r)d+=`${Ii(_)},`;return`${d}]`}const n=Object.keys(r).sort();let o="{";for(let d=0;d<n.length;d++)o+=`${JSON.stringify(n[d])}:${Ii(r[n[d]])},`;return`${o}}`}function js(r){let t="";for(const n of _i)t+=`/${Ii(r[n])}`;return t}function Jr(r){const t=r.value;return t?[new at(r.key,t,"constants have been deprecated as of v8")]:[]}function yn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Nr(r){if(Array.isArray(r))return r.map(Nr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=Nr(r[n]);return t}return yn(r)}function ea(r){const t=r.key,n=r.value,o=r.valueSpec||{},d=r.objectElementValidators||{},_=r.style,v=r.styleSpec,x=r.validateSpec;let T=[];const I=pi(n);if(I!=="object")return[new at(t,n,`object expected, ${I} found`)];for(const D in n){const B=D.split(".")[0],V=Al(o,B)||o["*"];let X;if(Al(d,B))X=d[B];else if(Al(o,B))X=x;else if(d["*"])X=d["*"];else{if(!o["*"]){T.push(new at(t,n[D],`unknown property "${D}"`));continue}X=x}T=T.concat(X({key:(t&&`${t}.`)+D,value:n[D],valueSpec:V,style:_,styleSpec:v,object:n,objectKey:D,validateSpec:x},n))}for(const D in o)d[D]||o[D].required&&o[D].default===void 0&&n[D]===void 0&&T.push(new at(t,n,`missing required property "${D}"`));return T}function tl(r){const t=r.value,n=r.valueSpec,o=r.style,d=r.styleSpec,_=r.key,v=r.arrayElementValidator||r.validateSpec;if(pi(t)!=="array")return[new at(_,t,`array expected, ${pi(t)} found`)];if(n.length&&t.length!==n.length)return[new at(_,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new at(_,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let x={type:n.value,values:n.values};d.$version<7&&(x.function=n.function),pi(n.value)==="object"&&(x=n.value);let T=[];for(let I=0;I<t.length;I++)T=T.concat(v({array:t,arrayIndex:I,value:t[I],valueSpec:x,validateSpec:r.validateSpec,style:o,styleSpec:d,key:`${_}[${I}]`}));return T}function Us(r){const t=r.key,n=r.value,o=r.valueSpec;let d=pi(n);return d==="number"&&n!=n&&(d="NaN"),d!=="number"?[new at(t,n,`number expected, ${d} found`)]:"minimum"in o&&n<o.minimum?[new at(t,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new at(t,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function xo(r){const t=r.valueSpec,n=yn(r.value.type);let o,d,_,v={};const x=n!=="categorical"&&r.value.property===void 0,T=!x,I=pi(r.value.stops)==="array"&&pi(r.value.stops[0])==="array"&&pi(r.value.stops[0][0])==="object",D=ea({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(X){if(n==="identity")return[new at(X.key,X.value,'identity function may not have a "stops" property')];let W=[];const J=X.value;return W=W.concat(tl({key:X.key,value:J,valueSpec:X.valueSpec,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:B})),pi(J)==="array"&&J.length===0&&W.push(new at(X.key,J,"array must have at least one stop")),W},default:function(X){return X.validateSpec({key:X.key,value:X.value,valueSpec:t,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec})}}});return n==="identity"&&x&&D.push(new at(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||D.push(new at(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!Ll(r.valueSpec)&&D.push(new at(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!Oa(r.valueSpec)?D.push(new at(r.key,r.value,"property functions not supported")):x&&!Th(r.valueSpec)&&D.push(new at(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!I||r.value.property!==void 0||D.push(new at(r.key,r.value,'"property" property is required')),D;function B(X){let W=[];const J=X.value,ne=X.key;if(pi(J)!=="array")return[new at(ne,J,`array expected, ${pi(J)} found`)];if(J.length!==2)return[new at(ne,J,`array length 2 expected, length ${J.length} found`)];if(I){if(pi(J[0])!=="object")return[new at(ne,J,`object expected, ${pi(J[0])} found`)];if(J[0].zoom===void 0)return[new at(ne,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new at(ne,J,"object stop key must have value")];if(_&&_>yn(J[0].zoom))return[new at(ne,J[0].zoom,"stop zoom values must appear in ascending order")];yn(J[0].zoom)!==_&&(_=yn(J[0].zoom),d=void 0,v={}),W=W.concat(ea({key:`${ne}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Us,value:V}}))}else W=W.concat(V({key:`${ne}[0]`,value:J[0],validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec},J));return Ol(Nr(J[1]))?W.concat([new at(`${ne}[1]`,J[1],"expressions are not allowed in function stops.")]):W.concat(X.validateSpec({key:`${ne}[1]`,value:J[1],valueSpec:t,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec}))}function V(X,W){const J=pi(X.value),ne=yn(X.value),ue=X.value!==null?X.value:W;if(o){if(J!==o)return[new at(X.key,ue,`${J} stop domain type must match previous stop domain type ${o}`)]}else o=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new at(X.key,ue,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&n!=="categorical"){let Ce=`number expected, ${J} found`;return Oa(t)&&n===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new at(X.key,ue,Ce)]}return n!=="categorical"||J!=="number"||isFinite(ne)&&Math.floor(ne)===ne?n!=="categorical"&&J==="number"&&d!==void 0&&ne<d?[new at(X.key,ue,"stop domain values must appear in ascending order")]:(d=ne,n==="categorical"&&ne in v?[new at(X.key,ue,"stop domain values must be unique")]:(v[ne]=!0,[])):[new at(X.key,ue,`integer expected, found ${ne}`)]}}function wo(r){const t=(r.expressionContext==="property"?Qo:yo)(Nr(r.value),r.valueSpec);if(t.result==="error")return t.value.map((o=>new at(`${r.key}${o.key}`,r.value,o.message)));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new at(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Wo(n))return[new at(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Wo(n))return[new at(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ko(n,["zoom","feature-state"]))return[new at(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Fs(n))return[new at(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function il(r){const t=r.key,n=r.value,o=pi(n);return o!=="string"?[new at(t,n,`color expected, ${o} found`)]:ni.parse(String(n))?[]:[new at(t,n,`color expected, "${n}" found`)]}function nl(r){const t=r.key,n=r.value,o=r.valueSpec,d=[];return Array.isArray(o.values)?o.values.indexOf(yn(n))===-1&&d.push(new at(t,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(yn(n))===-1&&d.push(new at(t,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),d}function Ns(r){return Wa(Nr(r.value))?wo(Rn({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ka(r)}function Ka(r){const t=r.value,n=r.key;if(pi(t)!=="array")return[new at(n,t,`array expected, ${pi(t)} found`)];const o=r.styleSpec;let d,_=[];if(t.length<1)return[new at(n,t,"filter array must have at least 1 element")];switch(_=_.concat(nl({key:`${n}[0]`,value:t[0],valueSpec:o.filter_operator,style:r.style,styleSpec:r.styleSpec})),yn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&yn(t[1])==="$type"&&_.push(new at(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new at(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=pi(t[1]),d!=="string"&&_.push(new at(`${n}[1]`,t[1],`string expected, ${d} found`)));for(let v=2;v<t.length;v++)d=pi(t[v]),yn(t[1])==="$type"?_=_.concat(nl({key:`${n}[${v}]`,value:t[v],valueSpec:o.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&_.push(new at(`${n}[${v}]`,t[v],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)_=_.concat(Ka({key:`${n}[${v}]`,value:t[v],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=pi(t[1]),t.length!==2?_.push(new at(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&_.push(new at(`${n}[1]`,t[1],`string expected, ${d} found`))}return _}function gs(r,t){const n=r.key,o=r.validateSpec,d=r.style,_=r.styleSpec,v=r.value,x=r.objectKey,T=_[`${t}_${r.layerType}`];if(!T)return[];const I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&T[I[1]]&&T[I[1]].transition)return o({key:n,value:v,valueSpec:_.transition,style:d,styleSpec:_});const D=r.valueSpec||T[x];if(!D)return[new at(n,v,`unknown property "${x}"`)];let B;if(pi(v)==="string"&&Oa(D)&&!D.tokens&&(B=/^{([^}]+)}$/.exec(v)))return[new at(n,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const V=[];return r.layerType==="symbol"&&x==="text-font"&&bu(Nr(v))&&yn(v.type)==="identity"&&V.push(new at(n,v,'"text-font" does not support identity functions')),V.concat(o({key:r.key,value:v,valueSpec:D,style:d,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:x}))}function ba(r){return gs(r,"paint")}function Mu(r){return gs(r,"layout")}function wc(r){let t=[];const n=r.value,o=r.key,d=r.style,_=r.styleSpec;if(pi(n)!=="object")return[new at(o,n,`object expected, ${pi(n)} found`)];n.type||n.ref||t.push(new at(o,n,'either "type" or "ref" is required'));let v=yn(n.type);const x=yn(n.ref);if(n.id){const T=yn(n.id);for(let I=0;I<r.arrayIndex;I++){const D=d.layers[I];yn(D.id)===T&&t.push(new at(o,n.id,`duplicate layer id "${n.id}", previously used at line ${D.id.__line__}`))}}if("ref"in n){let T;["type","source","source-layer","filter","layout"].forEach((I=>{I in n&&t.push(new at(o,n[I],`"${I}" is prohibited for ref layers`))})),d.layers.forEach((I=>{yn(I.id)===x&&(T=I)})),T?T.ref?t.push(new at(o,n.ref,"ref cannot reference another ref layer")):v=yn(T.type):t.push(new at(o,n.ref,`ref layer "${x}" not found`))}else if(v!=="background")if(n.source){const T=d.sources&&d.sources[n.source],I=T&&yn(T.type);T?I==="vector"&&v==="raster"?t.push(new at(o,n.source,`layer "${n.id}" requires a raster source`)):I!=="raster-dem"&&v==="hillshade"||I!=="raster-dem"&&v==="color-relief"?t.push(new at(o,n.source,`layer "${n.id}" requires a raster-dem source`)):I==="raster"&&v!=="raster"?t.push(new at(o,n.source,`layer "${n.id}" requires a vector source`)):I!=="vector"||n["source-layer"]?I==="raster-dem"&&v!=="hillshade"&&v!=="color-relief"?t.push(new at(o,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):v!=="line"||!n.paint||!n.paint["line-gradient"]||I==="geojson"&&T.lineMetrics||t.push(new at(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new at(o,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new at(o,n.source,`source "${n.source}" not found`))}else t.push(new at(o,n,'missing required property "source"'));return t=t.concat(ea({key:o,value:n,valueSpec:_.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${o}.type`,value:n.type,valueSpec:_.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:Ns,layout:T=>ea({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>Mu(Rn({layerType:v},I))}}),paint:T=>ea({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":I=>ba(Rn({layerType:v},I))}})}})),t}function xa(r){const t=r.value,n=r.key,o=pi(t);return o!=="string"?[new at(n,t,`string expected, ${o} found`)]:[]}const Sc={promoteId:function({key:r,value:t}){if(pi(t)==="string")return xa({key:r,value:t});{const n=[];for(const o in t)n.push(...xa({key:`${r}.${o}`,value:t[o]}));return n}}};function Zs(r){const t=r.value,n=r.key,o=r.styleSpec,d=r.style,_=r.validateSpec;if(!t.type)return[new at(n,t,'"type" is required')];const v=yn(t.type);let x;switch(v){case"vector":case"raster":return x=ea({key:n,value:t,valueSpec:o[`source_${v.replace("-","_")}`],style:r.style,styleSpec:o,objectElementValidators:Sc,validateSpec:_}),x;case"raster-dem":return x=(function(T){var I;const D=(I=T.sourceName)!==null&&I!==void 0?I:"",B=T.value,V=T.styleSpec,X=V.source_raster_dem,W=T.style;let J=[];const ne=pi(B);if(B===void 0)return J;if(ne!=="object")return J.push(new at("source_raster_dem",B,`object expected, ${ne} found`)),J;const ue=yn(B.encoding)==="custom",Ce=["redFactor","greenFactor","blueFactor","baseShift"],_e=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const xe in B)!ue&&Ce.includes(xe)?J.push(new at(xe,B[xe],`In "${D}": "${xe}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):X[xe]?J=J.concat(T.validateSpec({key:xe,value:B[xe],valueSpec:X[xe],validateSpec:T.validateSpec,style:W,styleSpec:V})):J.push(new at(xe,B[xe],`unknown property "${xe}"`));return J})({sourceName:n,value:t,style:r.style,styleSpec:o,validateSpec:_}),x;case"geojson":if(x=ea({key:n,value:t,valueSpec:o.source_geojson,style:d,styleSpec:o,validateSpec:_,objectElementValidators:Sc}),t.cluster)for(const T in t.clusterProperties){const[I,D]=t.clusterProperties[T],B=typeof I=="string"?[I,["accumulated"],["get",T]]:I;x.push(...wo({key:`${n}.${T}.map`,value:D,expressionContext:"cluster-map"})),x.push(...wo({key:`${n}.${T}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return x;case"video":return ea({key:n,value:t,valueSpec:o.source_video,style:d,validateSpec:_,styleSpec:o});case"image":return ea({key:n,value:t,valueSpec:o.source_image,style:d,validateSpec:_,styleSpec:o});case"canvas":return[new at(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return nl({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function fr(r){const t=r.value,n=r.styleSpec,o=n.light,d=r.style;let _=[];const v=pi(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new at("light",t,`object expected, ${v} found`)]),_;for(const x in t){const T=x.match(/^(.*)-transition$/);_=_.concat(T&&o[T[1]]&&o[T[1]].transition?r.validateSpec({key:x,value:t[x],valueSpec:n.transition,validateSpec:r.validateSpec,style:d,styleSpec:n}):o[x]?r.validateSpec({key:x,value:t[x],valueSpec:o[x],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new at(x,t[x],`unknown property "${x}"`)])}return _}function Vs(r){const t=r.value,n=r.styleSpec,o=n.sky,d=r.style,_=pi(t);if(t===void 0)return[];if(_!=="object")return[new at("sky",t,`object expected, ${_} found`)];let v=[];for(const x in t)v=v.concat(o[x]?r.validateSpec({key:x,value:t[x],valueSpec:o[x],style:d,styleSpec:n}):[new at(x,t[x],`unknown property "${x}"`)]);return v}function Mh(r){const t=r.value,n=r.styleSpec,o=n.terrain,d=r.style;let _=[];const v=pi(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new at("terrain",t,`object expected, ${v} found`)]),_;for(const x in t)_=_.concat(o[x]?r.validateSpec({key:x,value:t[x],valueSpec:o[x],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new at(x,t[x],`unknown property "${x}"`)]);return _}function Md(r){let t=[];const n=r.value,o=r.key;if(Array.isArray(n)){const d=[],_=[];for(const v in n)n[v].id&&d.includes(n[v].id)&&t.push(new at(o,n,`all the sprites' ids must be unique, but ${n[v].id} is duplicated`)),d.push(n[v].id),n[v].url&&_.includes(n[v].url)&&t.push(new at(o,n,`all the sprites' URLs must be unique, but ${n[v].url} is duplicated`)),_.push(n[v].url),t=t.concat(ea({key:`${o}[${v}]`,value:n[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return xa({key:o,value:n})}function Ad(r){return t=r.value,t&&t.constructor===Object?[]:[new at(r.key,r.value,`object expected, ${pi(r.value)} found`)];var t}const zd={"*":()=>[],array:tl,boolean:function(r){const t=r.value,n=r.key,o=pi(t);return o!=="boolean"?[new at(n,t,`boolean expected, ${o} found`)]:[]},number:Us,color:il,constants:Jr,enum:nl,filter:Ns,function:xo,layer:wc,object:ea,source:Zs,light:fr,sky:Vs,terrain:Mh,projection:function(r){const t=r.value,n=r.styleSpec,o=n.projection,d=r.style,_=pi(t);if(t===void 0)return[];if(_!=="object")return[new at("projection",t,`object expected, ${_} found`)];let v=[];for(const x in t)v=v.concat(o[x]?r.validateSpec({key:x,value:t[x],valueSpec:o[x],style:d,styleSpec:n}):[new at(x,t[x],`unknown property "${x}"`)]);return v},projectionDefinition:function(r){const t=r.key;let n=r.value;n=n instanceof String?n.valueOf():n;const o=pi(n);return o!=="array"||(function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"})(n)||(function(d){return!!["interpolate","step","literal"].includes(d[0])})(n)?["array","string"].includes(o)?[]:[new at(t,n,`projection expected, invalid type "${o}" found`)]:[new at(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:xa,formatted:function(r){return xa(r).length===0?[]:wo(r)},resolvedImage:function(r){return xa(r).length===0?[]:wo(r)},padding:function(r){const t=r.key,n=r.value;if(pi(n)==="array"){if(n.length<1||n.length>4)return[new at(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const o={type:"number"};let d=[];for(let _=0;_<n.length;_++)d=d.concat(r.validateSpec({key:`${t}[${_}]`,value:n[_],validateSpec:r.validateSpec,valueSpec:o}));return d}return Us({key:t,value:n,valueSpec:{}})},numberArray:function(r){const t=r.key,n=r.value;if(pi(n)==="array"){const o={type:"number"};if(n.length<1)return[new at(t,n,"array length at least 1 expected, length 0 found")];let d=[];for(let _=0;_<n.length;_++)d=d.concat(r.validateSpec({key:`${t}[${_}]`,value:n[_],validateSpec:r.validateSpec,valueSpec:o}));return d}return Us({key:t,value:n,valueSpec:{}})},colorArray:function(r){const t=r.key,n=r.value;if(pi(n)==="array"){if(n.length<1)return[new at(t,n,"array length at least 1 expected, length 0 found")];let o=[];for(let d=0;d<n.length;d++)o=o.concat(il({key:`${t}[${d}]`,value:n[d]}));return o}return il({key:t,value:n})},variableAnchorOffsetCollection:function(r){const t=r.key,n=r.value,o=pi(n),d=r.styleSpec;if(o!=="array"||n.length<1||n.length%2!=0)return[new at(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let v=0;v<n.length;v+=2)_=_.concat(nl({key:`${t}[${v}]`,value:n[v],valueSpec:d.layout_symbol["text-anchor"]})),_=_.concat(tl({key:`${t}[${v+1}]`,value:n[v+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return _},sprite:Md,state:Ad};function Ln(r){const t=r.value,n=r.valueSpec,o=r.styleSpec;return r.validateSpec=Ln,n.expression&&bu(yn(t))?xo(r):n.expression&&Ol(Nr(t))?wo(r):n.type&&zd[n.type]?zd[n.type](r):ea(Rn({},r,{valueSpec:n.type?o[n.type]:n}))}function Au(r){const t=r.value,n=r.key,o=xa(r);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new at(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new at(n,t,'"glyphs" url must include a "{range}" token'))),o}function ir(r,t=De){let n=[];return n=n.concat(Ln({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:Ln,objectElementValidators:{glyphs:Au,"*":()=>[]}})),r.constants&&(n=n.concat(Jr({key:"constants",value:r.constants}))),Zr(n)}function pr(r){return function(t){return r(Object.assign({},t,{validateSpec:Ln}))}}function Zr(r){return[].concat(r).sort(((t,n)=>t.line-n.line))}function nr(r){return function(...t){return Zr(r.apply(this,t))}}ir.source=nr(pr(Zs)),ir.sprite=nr(pr(Md)),ir.glyphs=nr(pr(Au)),ir.light=nr(pr(fr)),ir.sky=nr(pr(Vs)),ir.terrain=nr(pr(Mh)),ir.state=nr(pr(Ad)),ir.layer=nr(pr(wc)),ir.filter=nr(pr(Ns)),ir.paintProperty=nr(pr(ba)),ir.layoutProperty=nr(pr(Mu));const rl=De,Fl=ir,Cd=Fl.light,Tc=Fl.sky,Ah=Fl.paintProperty,Gs=Fl.layoutProperty;function zu(r,t){let n=!1;if(t&&t.length)for(const o of t)r.fire(new Je(new Error(o.message))),n=!0;return n}class _s{constructor(t,n,o){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const v=new Int32Array(this.arrayBuffer);t=v[0],this.d=(n=v[1])+2*(o=v[2]);for(let T=0;T<this.d*this.d;T++){const I=v[3+T],D=v[3+T+1];d.push(I===D?null:v.subarray(I,D))}const x=v[3+d.length+1];this.keys=v.subarray(v[3+d.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=n+2*o;for(let v=0;v<this.d*this.d;v++)d.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=o,this.scale=n/t,this.uid=0;const _=o/n*t;this.min=-_,this.max=t+_}insert(t,n,o,d,_){this._forEachCell(n,o,d,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(d),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,o,d,_,v){this.cells[_].push(v)}query(t,n,o,d,_){const v=this.min,x=this.max;if(t<=v&&n<=v&&x<=o&&x<=d&&!_)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,n,o,d,this._queryCell,T,{},_),T}}_queryCell(t,n,o,d,_,v,x,T){const I=this.cells[_];if(I!==null){const D=this.keys,B=this.bboxes;for(let V=0;V<I.length;V++){const X=I[V];if(x[X]===void 0){const W=4*X;(T?T(B[W+0],B[W+1],B[W+2],B[W+3]):t<=B[W+2]&&n<=B[W+3]&&o>=B[W+0]&&d>=B[W+1])?(x[X]=!0,v.push(D[X])):x[X]=!1}}}}_forEachCell(t,n,o,d,_,v,x,T){const I=this._convertToCellCoord(t),D=this._convertToCellCoord(n),B=this._convertToCellCoord(o),V=this._convertToCellCoord(d);for(let X=I;X<=B;X++)for(let W=D;W<=V;W++){const J=this.d*W+X;if((!T||T(this._convertFromCellCoord(X),this._convertFromCellCoord(W),this._convertFromCellCoord(X+1),this._convertFromCellCoord(W+1)))&&_.call(this,t,n,o,d,J,v,x,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let o=0;for(let v=0;v<this.cells.length;v++)o+=this.cells[v].length;const d=new Int32Array(n+o+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let _=n;for(let v=0;v<t.length;v++){const x=t[v];d[3+v]=_,d.set(x,_),_+=x.length}return d[3+t.length]=_,d.set(this.keys,_),_+=this.keys.length,d[3+t.length+1]=_,d.set(this.bboxes,_),_+=this.bboxes.length,d.buffer}static serialize(t,n){const o=t.toArrayBuffer();return n&&n.push(o),{buffer:o}}static deserialize(t){return new _s(t.buffer)}}const ys={};function zt(r,t,n={}){if(ys[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),ys[r]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}zt("Object",Object),zt("Set",Set),zt("TransferableGridIndex",_s),zt("Color",ni),zt("Error",Error),zt("AJAXError",ae),zt("ResolvedImage",Dr),zt("StylePropertyFunction",Jo),zt("StyleExpression",Tu,{omit:["_evaluator"]}),zt("ZoomDependentExpression",vo),zt("ZoomConstantExpression",Ur),zt("CompoundExpression",_a,{omit:["_evaluate"]});for(const r in Bl)Bl[r]._classRegistryKey||zt(`Expression_${r}`,Bl[r]);function Cu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function jl(r){return r.$name||r.constructor._classRegistryKey}function Ec(r){return!(function(t){if(t===null||typeof t!="object")return!1;const n=jl(t);return!(!n||n==="Object")})(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Cu(r)||zi(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function vs(r,t){if(Ec(r))return(Cu(r)||zi(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const _=[];for(const v of r)_.push(vs(v,t));return _}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=jl(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!ys[n])throw new Error(`${n} is not registered.`);const{klass:o}=ys[n],d=o.serialize?o.serialize(r,t):{};if(o.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in r){if(!r.hasOwnProperty(_)||ys[n].omit.indexOf(_)>=0)continue;const v=r[_];d[_]=ys[n].shallow.indexOf(_)>=0?v:vs(v,t)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(d.$name=n),d}function Ul(r){if(Ec(r))return r;if(Array.isArray(r))return r.map(Ul);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=jl(r)||"Object";if(!ys[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=ys[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const o=Object.create(n.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const _=r[d];o[d]=ys[t].shallow.indexOf(d)>=0?_:Ul(_)}return o}class qs{constructor(){this.first=!0}update(t,n){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const hi={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Iu(r){for(const t of r)if(sl(t.charCodeAt(0)))return!0;return!1}function Pu(r){for(const t of r)if(!Mc(t.charCodeAt(0)))return!1;return!0}function Qa(r){const t=r.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(t.join("|"),"u")}const Nl=Qa(["Arab","Dupl","Mong","Ougr","Syrc"]);function Mc(r){return!Nl.test(String.fromCodePoint(r))}const al=Qa(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function sl(r){return!(r!==746&&r!==747&&(r<4352||!(hi["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||hi["CJK Compatibility"](r)||hi["CJK Strokes"](r)||!(!hi["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||hi["Enclosed CJK Letters and Months"](r)||hi["Ideographic Description Characters"](r)||hi.Kanbun(r)||hi.Katakana(r)&&r!==12540||!(!hi["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!hi["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||hi["Vertical Forms"](r)||hi["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||al.test(String.fromCodePoint(r)))))}function Ac(r){return!(sl(r)||(function(t){return!!(hi["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||hi["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||hi["Letterlike Symbols"](t)||hi["Number Forms"](t)||hi["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||hi["Control Pictures"](t)&&t!==9251||hi["Optical Character Recognition"](t)||hi["Enclosed Alphanumerics"](t)||hi["Geometric Shapes"](t)||hi["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||hi["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||hi["CJK Symbols and Punctuation"](t)||hi.Katakana(t)||hi["Private Use Area"](t)||hi["CJK Compatibility Forms"](t)||hi["Small Form Variants"](t)||hi["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(r))}const So=Qa(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function zh(r){return So.test(String.fromCodePoint(r))}function $s(r,t){return!(!t&&zh(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||hi.Khmer(r))}function Ch(r){for(const t of r)if(zh(t.charCodeAt(0)))return!0;return!1}const Ja=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(Ja.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const n=r.pluginURL,o=new Promise((_=>{this.loadScriptResolve=_}));t(n);const d=new Promise((_=>setTimeout((()=>_()),this.TIMEOUT)));if(yield Promise.race([o,d]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:n};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class Li{constructor(t,n){this.isSupportedScript=Hs,this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new qs,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new qs,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}function Hs(r){return(function(t,n){for(const o of t)if(!$s(o.charCodeAt(0),n))return!1;return!0})(r,Ja.getRTLTextPluginStatus()==="loaded")}class Xs{constructor(t,n,o){this.property=t,this.value=n,this.expression=(function(d,_,v){if(bu(d))return new Jo(d,_);if(Ol(d)){const x=Qo(d,_,v);if(x.result==="error")throw new Error(x.value.map((T=>`${T.key}: ${T.message}`)).join(", "));return x.value}{let x=d;return _.type==="color"&&typeof d=="string"?x=ni.parse(d):_.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?_.type!=="numberArray"||typeof d!="number"&&!Array.isArray(d)?_.type!=="colorArray"||typeof d!="string"&&!Array.isArray(d)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?x=In.parse(d):_.type==="projectionDefinition"&&typeof d=="string"&&(x=kr.parse(d)):x=Bn.parse(d):x=yr.parse(d):x=qn.parse(d),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>x}}})(n===void 0?t.specification.default:n,t.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,o){return this.property.possiblyEvaluate(this,t,n,o)}}class zc{constructor(t,n){this.property=t,this.value=new Xs(t,void 0,n)}transitioned(t,n){return new ol(this.property,this.value,n,Dt({},t.transition,this.transition),t.now)}untransitioned(){return new ol(this.property,this.value,null,{},0)}}class Du{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=n}getValue(t){return ri(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new zc(this._values[t].property,this._globalState)),this._values[t].value=new Xs(this._values[t].property,n===null?void 0:ri(n),this._globalState)}getTransition(t){return ri(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new zc(this._values[t].property,this._globalState)),this._values[t].transition=ri(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o);const d=this.getTransition(n);d!==void 0&&(t[`${n}-transition`]=d)}return t}transitioned(t,n){const o=new ll(this._properties);for(const d of Object.keys(this._values))o._values[d]=this._values[d].transitioned(t,n._values[d]);return o}untransitioned(){const t=new ll(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class ol{constructor(t,n,o,d,_){this.property=t,this.value=n,this.begin=_+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=o)}possiblyEvaluate(t,n,o){const d=t.now||0,_=this.value.possiblyEvaluate(t,n,o),v=this.prior;if(v){if(d>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(d<this.begin)return v.possiblyEvaluate(t,n,o);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,n,o),_,Ze(x))}}return _}}class ll{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,o){const d=new ja(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(t,n,o);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ih{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=n}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ri(this._values[t].value)}setValue(t,n){this._values[t]=new Xs(this._values[t].property,n===null?void 0:ri(n),this._globalState)}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o)}return t}possiblyEvaluate(t,n,o){const d=new ja(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(t,n,o);return d}}class Fa{constructor(t,n,o){this.property=t,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,o,d){return this.property.evaluate(this.value,this.parameters,t,n,o,d)}}class ja{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ot{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,o){const d=ka[this.specification.type];return d?d(t,n,o):t}}class qt{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,o,d){return new Fa(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},o,d)}:t.expression,n)}interpolate(t,n,o){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Fa(this,{kind:"constant",value:void 0},t.parameters);const d=ka[this.specification.type];if(d){const _=d(t.value.value,n.value.value,o);return new Fa(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,n,o,d,_,v){return t.kind==="constant"?t.value:t.evaluate(n,o,d,_,v)}}class cl extends qt{possiblyEvaluate(t,n,o,d){if(t.value===void 0)return new Fa(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},o,d),v=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,x=this._calculate(v,v,v,n);return new Fa(this,{kind:"constant",value:x},n)}if(t.expression.kind==="camera"){const _=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Fa(this,{kind:"constant",value:_},n)}return new Fa(this,t.expression,n)}evaluate(t,n,o,d,_,v){if(t.kind==="source"){const x=t.evaluate(n,o,d,_,v);return this._calculate(x,x,x,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},o,d),t.evaluate({zoom:Math.floor(n.zoom)},o,d),t.evaluate({zoom:Math.floor(n.zoom)+1},o,d),n):t.value}_calculate(t,n,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class ku{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},o,d);return this._calculate(_,_,_,n)}return this._calculate(t.expression.evaluate(new Li(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Li(Math.floor(n.zoom),n)),t.expression.evaluate(new Li(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,o,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class Br{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,d){return!!t.expression.evaluate(n,null,{},o,d)}interpolate(){return!1}}class hn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const o=t[n];o.specification.overridable&&this.overridableProperties.push(n);const d=this.defaultPropertyValues[n]=new Xs(o,void 0,void 0),_=this.defaultTransitionablePropertyValues[n]=new zc(o,void 0);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=d.possiblyEvaluate({})}}}zt("DataDrivenProperty",qt),zt("DataConstantProperty",Ot),zt("CrossFadedDataDrivenProperty",cl),zt("CrossFadedProperty",ku),zt("ColorRampProperty",Br);const bs="-transition";class wa extends Ft{constructor(t,n,o){if(super(),this.id=t.id,this.type=t.type,this._globalState=o,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=ua(t.filter,o)),n.layout&&(this._unevaluatedLayout=new Ih(n.layout,o)),n.paint)){this._transitionablePaint=new Du(n.paint,o);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ja(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=ua(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const o=this._unevaluatedLayout._values[n];for(const d of o.getGlobalStateRefs())t.add(d)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}getPaintAffectingGlobalStateRefs(){var t;const n=new globalThis.Map;if(this._transitionablePaint)for(const o in this._transitionablePaint._values){const d=this._transitionablePaint._values[o].value;for(const _ of d.getGlobalStateRefs()){const v=(t=n.get(_))!==null&&t!==void 0?t:[];v.push({name:o,value:d.value}),n.set(_,v)}}return n}setLayoutProperty(t,n,o={}){n!=null&&this._validate(Gs,`layers.${this.id}.layout.${t}`,t,n,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(bs)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,o={}){if(n!=null&&this._validate(Ah,`layers.${this.id}.paint.${t}`,t,n,o))return!1;if(t.endsWith(bs))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const d=this._transitionablePaint._values[t],_=d.property.specification["property-type"]==="cross-faded-data-driven",v=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(t,x,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,o){return!1}isHidden(t,n=!1){return!!(this.minzoom&&t<(n?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Qt(t,((n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length)))}_validate(t,n,o,d,_={}){return(!_||_.validate!==!1)&&zu(this,t.call(Fl,{key:n,layerType:this.type,objectKey:o,value:d,styleSpec:De,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Fa&&Oa(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}let Ph;var To={get paint(){return Ph=Ph||new hn({"raster-opacity":new Ot(De.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ot(De.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(De.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(De.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(De.paint_raster["raster-saturation"]),"raster-contrast":new Ot(De.paint_raster["raster-contrast"]),"raster-resampling":new Ot(De.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(De.paint_raster["raster-fade-duration"])})}};class Sa extends wa{constructor(t,n){super(t,To,n)}}const $n={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ta{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Nt(r,t=1){let n=0,o=0;return{members:r.map((d=>{const _=$n[d.type].BYTES_PER_ELEMENT,v=n=Qi(n,Math.max(t,_)),x=d.components||1;return o=Math.max(o,_),n+=_*x,{name:d.name,type:d.type,components:x,offset:v}})),size:Qi(n,Math.max(o,t)),alignment:t}}function Qi(r,t){return Math.ceil(r/t)*t}class En extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.int16[d+0]=n,this.int16[d+1]=o,t}}En.prototype.bytesPerElement=4,zt("StructArrayLayout2i4",En);class ul extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const _=3*t;return this.int16[_+0]=n,this.int16[_+1]=o,this.int16[_+2]=d,t}}ul.prototype.bytesPerElement=6,zt("StructArrayLayout3i6",ul);class Eo extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,o,d)}emplace(t,n,o,d,_){const v=4*t;return this.int16[v+0]=n,this.int16[v+1]=o,this.int16[v+2]=d,this.int16[v+3]=_,t}}Eo.prototype.bytesPerElement=8,zt("StructArrayLayout4i8",Eo);class ta extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,d,_,v)}emplace(t,n,o,d,_,v,x){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=d,this.int16[T+3]=_,this.int16[T+4]=v,this.int16[T+5]=x,t}}ta.prototype.bytesPerElement=12,zt("StructArrayLayout2i4i12",ta);class hl extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,d,_,v)}emplace(t,n,o,d,_,v,x){const T=4*t,I=8*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.uint8[I+4]=d,this.uint8[I+5]=_,this.uint8[I+6]=v,this.uint8[I+7]=x,t}}hl.prototype.bytesPerElement=8,zt("StructArrayLayout2i4ub8",hl);class es extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.float32[d+0]=n,this.float32[d+1]=o,t}}es.prototype.bytesPerElement=8,zt("StructArrayLayout2f8",es);class Ys extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T,I,D){const B=this.length;return this.resize(B+1),this.emplace(B,t,n,o,d,_,v,x,T,I,D)}emplace(t,n,o,d,_,v,x,T,I,D,B){const V=10*t;return this.uint16[V+0]=n,this.uint16[V+1]=o,this.uint16[V+2]=d,this.uint16[V+3]=_,this.uint16[V+4]=v,this.uint16[V+5]=x,this.uint16[V+6]=T,this.uint16[V+7]=I,this.uint16[V+8]=D,this.uint16[V+9]=B,t}}Ys.prototype.bytesPerElement=20,zt("StructArrayLayout10ui20",Ys);class Cc extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T){const I=this.length;return this.resize(I+1),this.emplace(I,t,n,o,d,_,v,x,T)}emplace(t,n,o,d,_,v,x,T,I){const D=8*t;return this.uint16[D+0]=n,this.uint16[D+1]=o,this.uint16[D+2]=d,this.uint16[D+3]=_,this.uint16[D+4]=v,this.uint16[D+5]=x,this.uint16[D+6]=T,this.uint16[D+7]=I,t}}Cc.prototype.bytesPerElement=16,zt("StructArrayLayout8ui16",Cc);class Pn extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T,I,D,B,V){const X=this.length;return this.resize(X+1),this.emplace(X,t,n,o,d,_,v,x,T,I,D,B,V)}emplace(t,n,o,d,_,v,x,T,I,D,B,V,X){const W=12*t;return this.int16[W+0]=n,this.int16[W+1]=o,this.int16[W+2]=d,this.int16[W+3]=_,this.uint16[W+4]=v,this.uint16[W+5]=x,this.uint16[W+6]=T,this.uint16[W+7]=I,this.int16[W+8]=D,this.int16[W+9]=B,this.int16[W+10]=V,this.int16[W+11]=X,t}}Pn.prototype.bytesPerElement=24,zt("StructArrayLayout4i4ui4i24",Pn);class Mo extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const _=3*t;return this.float32[_+0]=n,this.float32[_+1]=o,this.float32[_+2]=d,t}}Mo.prototype.bytesPerElement=12,zt("StructArrayLayout3f12",Mo);class Ws extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}Ws.prototype.bytesPerElement=4,zt("StructArrayLayout1ul4",Ws);class Ru extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T,I){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,o,d,_,v,x,T,I)}emplace(t,n,o,d,_,v,x,T,I,D){const B=10*t,V=5*t;return this.int16[B+0]=n,this.int16[B+1]=o,this.int16[B+2]=d,this.int16[B+3]=_,this.int16[B+4]=v,this.int16[B+5]=x,this.uint32[V+3]=T,this.uint16[B+8]=I,this.uint16[B+9]=D,t}}Ru.prototype.bytesPerElement=20,zt("StructArrayLayout6i1ul2ui20",Ru);class Ic extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,d,_,v)}emplace(t,n,o,d,_,v,x){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=d,this.int16[T+3]=_,this.int16[T+4]=v,this.int16[T+5]=x,t}}Ic.prototype.bytesPerElement=12,zt("StructArrayLayout2i2i2i12",Ic);class dl extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,o,d,_)}emplace(t,n,o,d,_,v){const x=4*t,T=8*t;return this.float32[x+0]=n,this.float32[x+1]=o,this.float32[x+2]=d,this.int16[T+6]=_,this.int16[T+7]=v,t}}dl.prototype.bytesPerElement=16,zt("StructArrayLayout2f1f2i16",dl);class Pc extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,d,_,v)}emplace(t,n,o,d,_,v,x){const T=16*t,I=4*t,D=8*t;return this.uint8[T+0]=n,this.uint8[T+1]=o,this.float32[I+1]=d,this.float32[I+2]=_,this.int16[D+6]=v,this.int16[D+7]=x,t}}Pc.prototype.bytesPerElement=16,zt("StructArrayLayout2ub2f2i16",Pc);class Zl extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const _=3*t;return this.uint16[_+0]=n,this.uint16[_+1]=o,this.uint16[_+2]=d,t}}Zl.prototype.bytesPerElement=6,zt("StructArrayLayout3ui6",Zl);class Vl extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue){const Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue)}emplace(t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue,Ce){const _e=24*t,xe=12*t,Fe=48*t;return this.int16[_e+0]=n,this.int16[_e+1]=o,this.uint16[_e+2]=d,this.uint16[_e+3]=_,this.uint32[xe+2]=v,this.uint32[xe+3]=x,this.uint32[xe+4]=T,this.uint16[_e+10]=I,this.uint16[_e+11]=D,this.uint16[_e+12]=B,this.float32[xe+7]=V,this.float32[xe+8]=X,this.uint8[Fe+36]=W,this.uint8[Fe+37]=J,this.uint8[Fe+38]=ne,this.uint32[xe+10]=ue,this.int16[_e+22]=Ce,t}}Vl.prototype.bytesPerElement=48,zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vl);class Lr extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue,Ce,_e,xe,Fe,We,ut,At,xt,Et,Ut,Mt){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue,Ce,_e,xe,Fe,We,ut,At,xt,Et,Ut,Mt)}emplace(t,n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue,Ce,_e,xe,Fe,We,ut,At,xt,Et,Ut,Mt,Tt){const rt=32*t,Jt=16*t;return this.int16[rt+0]=n,this.int16[rt+1]=o,this.int16[rt+2]=d,this.int16[rt+3]=_,this.int16[rt+4]=v,this.int16[rt+5]=x,this.int16[rt+6]=T,this.int16[rt+7]=I,this.uint16[rt+8]=D,this.uint16[rt+9]=B,this.uint16[rt+10]=V,this.uint16[rt+11]=X,this.uint16[rt+12]=W,this.uint16[rt+13]=J,this.uint16[rt+14]=ne,this.uint16[rt+15]=ue,this.uint16[rt+16]=Ce,this.uint16[rt+17]=_e,this.uint16[rt+18]=xe,this.uint16[rt+19]=Fe,this.uint16[rt+20]=We,this.uint16[rt+21]=ut,this.uint16[rt+22]=At,this.uint32[Jt+12]=xt,this.float32[Jt+13]=Et,this.float32[Jt+14]=Ut,this.uint16[rt+30]=Mt,this.uint16[rt+31]=Tt,t}}Lr.prototype.bytesPerElement=64,zt("StructArrayLayout8i15ui1ul2f2ui64",Lr);class p extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}p.prototype.bytesPerElement=4,zt("StructArrayLayout1f4",p);class e extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const _=3*t;return this.uint16[6*t+0]=n,this.float32[_+1]=o,this.float32[_+2]=d,t}}e.prototype.bytesPerElement=12,zt("StructArrayLayout1ui2f12",e);class a extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const d=this.length;return this.resize(d+1),this.emplace(d,t,n,o)}emplace(t,n,o,d){const _=4*t;return this.uint32[2*t+0]=n,this.uint16[_+2]=o,this.uint16[_+3]=d,t}}a.prototype.bytesPerElement=8,zt("StructArrayLayout1ul2ui8",a);class l extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const d=2*t;return this.uint16[d+0]=n,this.uint16[d+1]=o,t}}l.prototype.bytesPerElement=4,zt("StructArrayLayout2ui4",l);class f extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}f.prototype.bytesPerElement=2,zt("StructArrayLayout1ui2",f);class g extends Vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,o,d)}emplace(t,n,o,d,_){const v=4*t;return this.float32[v+0]=n,this.float32[v+1]=o,this.float32[v+2]=d,this.float32[v+3]=_,t}}g.prototype.bytesPerElement=16,zt("StructArrayLayout4f16",g);class b extends Ta{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new K(this.anchorPointX,this.anchorPointY)}}b.prototype.size=20;class M extends Ru{get(t){return new b(this,t)}}zt("CollisionBoxArray",M);class A extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}A.prototype.size=48;class k extends Vl{get(t){return new A(this,t)}}zt("PlacedSymbolArray",k);class R extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}R.prototype.size=64;class N extends Lr{get(t){return new R(this,t)}}zt("SymbolInstanceArray",N);class j extends p{getoffsetX(t){return this.float32[1*t+0]}}zt("GlyphOffsetArray",j);class Y extends ul{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}zt("SymbolLineVertexArray",Y);class Q extends Ta{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Q.prototype.size=12;class re extends e{get(t){return new Q(this,t)}}zt("TextAnchorOffsetArray",re);class se extends Ta{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}se.prototype.size=8;class le extends a{get(t){return new se(this,t)}}zt("FeatureIndexArray",le);class de extends En{}class ye extends En{}class he extends En{}class ve extends ta{}class Ee extends hl{}class me extends es{}class ze extends Ys{}class Ge extends Cc{}class Oe extends Pn{}class Ne extends Mo{}class $e extends Ws{}class yt extends Ic{}class vt extends Pc{}class nt extends Zl{}class kt extends l{}const oi=Nt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Zi}=oi;class mi{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,o,d){const _=this.segments[this.segments.length-1];return t>mi.MAX_VERTEX_ARRAY_LENGTH&&Yt(`Max vertices per segment is ${mi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${mi.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+t>mi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==d?this.createNewSegment(n,o,d):_}createNewSegment(t,n,o){const d={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(d.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(t,n,o){return this.prepareSegment(0,t,n,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,o,d){return new mi([{vertexOffset:t,primitiveOffset:n,vertexLength:o,primitiveLength:d,vaos:{},sortKey:0}])}}function Ji(r,t){return 256*(r=Pt(Math.floor(r),0,255))+Pt(Math.floor(t),0,255)}mi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zt("SegmentVector",mi);const Mn=Nt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),sn=Nt([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Hn,vn,rr,bn={exports:{}},jn={exports:{}},Or={exports:{}},Ao=(function(){if(rr)return bn.exports;rr=1;var r=(Hn||(Hn=1,jn.exports=function(n,o){var d,_,v,x,T,I,D,B;for(_=n.length-(d=3&n.length),v=o,T=3432918353,I=461845907,B=0;B<_;)D=255&n.charCodeAt(B)|(255&n.charCodeAt(++B))<<8|(255&n.charCodeAt(++B))<<16|(255&n.charCodeAt(++B))<<24,++B,v=27492+(65535&(x=5*(65535&(v=(v^=D=(65535&(D=(D=(65535&D)*T+(((D>>>16)*T&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(D=0,d){case 3:D^=(255&n.charCodeAt(B+2))<<16;case 2:D^=(255&n.charCodeAt(B+1))<<8;case 1:v^=D=(65535&(D=(D=(65535&(D^=255&n.charCodeAt(B)))*T+(((D>>>16)*T&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295}return v^=n.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),jn.exports),t=(vn||(vn=1,Or.exports=function(n,o){for(var d,_=n.length,v=o^_,x=0;_>=4;)d=1540483477*(65535&(d=255&n.charCodeAt(x)|(255&n.charCodeAt(++x))<<8|(255&n.charCodeAt(++x))<<16|(255&n.charCodeAt(++x))<<24))+((1540483477*(d>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),_-=4,++x;switch(_){case 3:v^=(255&n.charCodeAt(x+2))<<16;case 2:v^=(255&n.charCodeAt(x+1))<<8;case 1:v=1540483477*(65535&(v^=255&n.charCodeAt(x)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Or.exports);return bn.exports=r,bn.exports.murmur3=r,bn.exports.murmur2=t,bn.exports})(),xs=$(Ao);class ws{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,o,d){this.ids.push(Ks(t)),this.positions.push(n,o,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Ks(t);let o=0,d=this.ids.length-1;for(;o<d;){const v=o+d>>1;this.ids[v]>=n?d=v:o=v+1}const _=[];for(;this.ids[o]===n;)_.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return _}static serialize(t,n){const o=new Float64Array(t.ids),d=new Uint32Array(t.positions);return fl(o,d,0,o.length-1),n&&n.push(o.buffer,d.buffer),{ids:o,positions:d}}static deserialize(t){const n=new ws;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Ks(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:xs(String(r))}function fl(r,t,n,o){for(;n<o;){const d=r[n+o>>1];let _=n-1,v=o+1;for(;;){do _++;while(r[_]<d);do v--;while(r[v]>d);if(_>=v)break;zo(r,_,v),zo(t,3*_,3*v),zo(t,3*_+1,3*v+1),zo(t,3*_+2,3*v+2)}v-n<o-v?(fl(r,t,n,v),n=v+1):(fl(r,t,v+1,o),o=v)}}function zo(r,t,n){const o=r[t];r[t]=r[n],r[n]=o}zt("FeaturePositionMap",ws);class Vr{constructor(t,n){this.gl=t.gl,this.location=n}}class Gr extends Vr{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ss extends Vr{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Co extends Vr{constructor(t,n){super(t,n),this.current=ni.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Dc=new Float32Array(16);function Un(r){return[Ji(255*r.r,255*r.g),Ji(255*r.b,255*r.a)]}class xn{constructor(t,n,o){this.value=t,this.uniformNames=n.map((d=>`u_${d}`)),this.type=o}setUniform(t,n,o){t.set(o.constantOr(this.value))}getBinding(t,n,o){return this.type==="color"?new Co(t,n):new Gr(t,n)}}class ar{constructor(t,n){this.uniformNames=n.map((o=>`u_${o}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setConstantDashPositions(t,n){this.dashTo=[0,t.y,t.height,t.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(t,n,o,d){let _=null;d==="u_pattern_to"?_=this.patternTo:d==="u_pattern_from"?_=this.patternFrom:d==="u_dasharray_to"?_=this.dashTo:d==="u_dasharray_from"?_=this.dashFrom:d==="u_pixel_ratio_to"?_=this.pixelRatioTo:d==="u_pixel_ratio_from"&&(_=this.pixelRatioFrom),_!==null&&t.set(_)}getBinding(t,n,o){return o.substr(0,9)==="u_pattern"||o.substr(0,12)==="u_dasharray_"?new Ss(t,n):new Gr(t,n)}}class en{constructor(t,n,o,d){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map((_=>({name:`a_${_}`,type:"Float32",components:o==="color"?2:1,offset:0}))),this.paintVertexArray=new d}populatePaintArray(t,n,o){const d=this.paintVertexArray.length,_=this.expression.evaluate(new Li(0,o),n,{},o.canonical,[],o.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(d,t,_)}updatePaintArray(t,n,o,d,_){const v=this.expression.evaluate(new Li(0,_),o,d);this._setPaintValue(t,n,v)}_setPaintValue(t,n,o){if(this.type==="color"){const d=Un(o);for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,d[0],d[1])}else{for(let d=t;d<n;d++)this.paintVertexArray.emplace(d,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ua{constructor(t,n,o,d,_,v){this.expression=t,this.uniformNames=n.map((x=>`u_${x}_t`)),this.type=o,this.useIntegerZoom=d,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map((x=>({name:`a_${x}`,type:"Float32",components:o==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(t,n,o){const d=this.expression.evaluate(new Li(this.zoom,o),n,{},o.canonical,[],o.formattedSection),_=this.expression.evaluate(new Li(this.zoom+1,o),n,{},o.canonical,[],o.formattedSection),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,d,_)}updatePaintArray(t,n,o,d,_){const v=this.expression.evaluate(new Li(this.zoom,_),o,d),x=this.expression.evaluate(new Li(this.zoom+1,_),o,d);this._setPaintValue(t,n,v,x)}_setPaintValue(t,n,o,d){if(this.type==="color"){const _=Un(o),v=Un(d);for(let x=t;x<n;x++)this.paintVertexArray.emplace(x,_[0],_[1],v[0],v[1])}else{for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,o,d);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,d=Pt(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,n,o){return new Gr(t,n)}}class Qs{constructor(t,n,o,d,_,v){this.expression=t,this.type=n,this.useIntegerZoom=o,this.zoom=d,this.layerId=v,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,n,o){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,this.getPositionIds(n),o)}updatePaintArray(t,n,o,d,_){this._setPaintValues(t,n,this.getPositionIds(o),_)}_setPaintValues(t,n,o,d){const _=this.getPositions(d);if(!_||!o)return;const v=_[o.min],x=_[o.mid],T=_[o.max];if(v&&x&&T)for(let I=t;I<n;I++)this.emplace(this.zoomInPaintVertexArray,I,x,v),this.emplace(this.zoomOutPaintVertexArray,I,x,T)}upload(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Gl extends Qs{getPositions(t){return t.imagePositions}getPositionIds(t){return t.patterns&&t.patterns[this.layerId]}getVertexAttributes(){return Mn.members}emplace(t,n,o,d){t.emplace(n,o.tlbr[0],o.tlbr[1],o.tlbr[2],o.tlbr[3],d.tlbr[0],d.tlbr[1],d.tlbr[2],d.tlbr[3],o.pixelRatio,d.pixelRatio)}}class Dh extends Qs{getPositions(t){return t.dashPositions}getPositionIds(t){return t.dashes&&t.dashes[this.layerId]}getVertexAttributes(){return sn.members}emplace(t,n,o,d){t.emplace(n,0,o.y,o.height,o.width,0,d.y,d.height,d.width)}}class Bu{constructor(t,n,o){this.binders={},this._buffers=[];const d=[];for(const _ in t.paint._values){if(!o(_))continue;const v=t.paint.get(_);if(!(v instanceof Fa&&Oa(v.property.specification)))continue;const x=Js(_,t.type),T=v.value,I=v.property.specification.type,D=v.property.useIntegerZoom,B=v.property.specification["property-type"],V=B==="cross-faded"||B==="cross-faded-data-driven";if(T.kind==="constant")this.binders[_]=V?new ar(T.value,x):new xn(T.value,x,I),d.push(`/u_${_}`);else if(T.kind==="source"||V){const X=kc(_,I,"source");this.binders[_]=V?_==="line-dasharray"?new Dh(T,I,D,n,X,t.id):new Gl(T,I,D,n,X,t.id):new en(T,x,I,X),d.push(`/a_${_}`)}else{const X=kc(_,I,"composite");this.binders[_]=new Ua(T,x,I,D,n,X),d.push(`/z_${_}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof en||n instanceof Ua?n.maxValue:0}populatePaintArrays(t,n,o){for(const d in this.binders){const _=this.binders[d];(_ instanceof en||_ instanceof Ua||_ instanceof Qs)&&_.populatePaintArray(t,n,o)}}setConstantPatternPositions(t,n){for(const o in this.binders){const d=this.binders[o];d instanceof ar&&d.setConstantPatternPositions(t,n)}}setConstantDashPositions(t,n){for(const o in this.binders){const d=this.binders[o];d instanceof ar&&d.setConstantDashPositions(t,n)}}updatePaintArrays(t,n,o,d,_){let v=!1;for(const x in t){const T=n.getPositions(x);for(const I of T){const D=o.feature(I.index);for(const B in this.binders){const V=this.binders[B];if((V instanceof en||V instanceof Ua||V instanceof Qs)&&V.expression.isStateDependent===!0){const X=d.paint.get(B);V.expression=X.value,V.updatePaintArray(I.start,I.end,D,t[x],_),v=!0}}}}return v}defines(){const t=[];for(const n in this.binders){const o=this.binders[n];(o instanceof xn||o instanceof ar)&&t.push(...o.uniformNames.map((d=>`#define HAS_UNIFORM_${d}`)))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof en||o instanceof Ua)for(let d=0;d<o.paintVertexAttributes.length;d++)t.push(o.paintVertexAttributes[d].name);else if(o instanceof Qs){const d=o.getVertexAttributes();for(const _ of d)t.push(_.name)}}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof xn||o instanceof ar||o instanceof Ua)for(const d of o.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const o=[];for(const d in this.binders){const _=this.binders[d];if(_ instanceof xn||_ instanceof ar||_ instanceof Ua){for(const v of _.uniformNames)if(n[v]){const x=_.getBinding(t,n[v],v);o.push({name:v,property:d,binding:x})}}}return o}setUniforms(t,n,o,d){for(const{name:_,property:v,binding:x}of n)this.binders[v].setUniform(x,d,o.get(v),_)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(t&&o instanceof Qs){const d=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(o instanceof en||o instanceof Ua)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const n in this.binders){const o=this.binders[n];(o instanceof en||o instanceof Ua||o instanceof Qs)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof en||n instanceof Ua||n instanceof Qs)&&n.destroy()}}}class Io{constructor(t,n,o=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new Bu(d,n,o);this.needsUpload=!1,this._featureMap=new ws,this._bufferOffset=0}populatePaintArrays(t,n,o,d){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,n,d);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,o,d){for(const _ of o)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,n,_,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Js(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function kc(r,t,n){const o={color:{source:es,composite:g},number:{source:p,composite:es}},d=(function(_){return{"line-pattern":{source:ze,composite:ze},"fill-pattern":{source:ze,composite:ze},"fill-extrusion-pattern":{source:ze,composite:ze},"line-dasharray":{source:Ge,composite:Ge}}[_]})(r);return d&&d[n]||o[t][n]}zt("ConstantBinder",xn),zt("CrossFadedConstantBinder",ar),zt("SourceExpressionBinder",en),zt("CrossFadedPatternBinder",Gl),zt("CrossFadedDasharrayBinder",Dh),zt("CompositeExpressionBinder",Ua),zt("ProgramConfiguration",Bu,{omit:["_buffers"]}),zt("ProgramConfigurationSet",Io);const Rc=Math.pow(2,14)-1,Lu=-Rc-1;function ia(r){const t=dt/r.extent,n=r.loadGeometry();for(let o=0;o<n.length;o++){const d=n[o];for(let _=0;_<d.length;_++){const v=d[_],x=Math.round(v.x*t),T=Math.round(v.y*t);v.x=Pt(x,Lu,Rc),v.y=Pt(T,Lu,Rc),(x<v.x||x>v.x+1||T<v.y||T>v.y+1)&&Yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function eo(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?ia(r):[]}}const Bc=-32768;function Xp(r,t,n,o,d){r.emplaceBack(Bc+8*t+o,Bc+8*n+d)}class Ou{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new ye,this.indexArray=new nt,this.segments=new mi,this.programConfigurations=new Io(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,o){const d=this.layers[0],_=[];let v=null,x=!1,T=d.type==="heatmap";if(d.type==="circle"){const D=d;v=D.layout.get("circle-sort-key"),x=!v.isConstant(),T=T||D.paint.get("circle-pitch-alignment")==="map"}const I=T?n.subdivisionGranularity.circle:1;for(const{feature:D,id:B,index:V,sourceLayerIndex:X}of t){const W=this.layers[0]._featureFilter.needGeometry,J=eo(D,W);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),J,o))continue;const ne=x?v.evaluate(J,{},o):void 0,ue={id:B,properties:D.properties,type:D.type,sourceLayerIndex:X,index:V,geometry:W?J.geometry:ia(D),patterns:{},sortKey:ne};_.push(ue)}x&&_.sort(((D,B)=>D.sortKey-B.sortKey));for(const D of _){const{geometry:B,index:V,sourceLayerIndex:X}=D,W=t[V].feature;this.addFeature(D,B,V,o,I),n.featureIndex.insert(W,B,V,X,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,o,d,_=1){let v;switch(_){case 1:v=[0,7];break;case 3:v=[0,2,5,7];break;case 5:v=[0,1,3,4,6,7];break;case 7:v=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const x=v.length;for(const T of n)for(const I of T){const D=I.x,B=I.y;if(D<0||D>=dt||B<0||B>=dt)continue;const V=this.segments.prepareSegment(x*x,this.layoutVertexArray,this.indexArray,t.sortKey),X=V.vertexLength;for(let W=0;W<x;W++)for(let J=0;J<x;J++)Xp(this.layoutVertexArray,D,B,v[J],v[W]);for(let W=0;W<x-1;W++)for(let J=0;J<x-1;J++){const ne=X+W*x+J,ue=X+(W+1)*x+J;this.indexArray.emplaceBack(ne,ue+1,ne+1),this.indexArray.emplaceBack(ne,ue,ue+1)}V.vertexLength+=x*x,V.primitiveLength+=(x-1)*(x-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:{},canonical:d})}}function Cf(r,t){for(let n=0;n<r.length;n++)if(Lc(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(Lc(r,t[n]))return!0;return!!Pf(r,t)}function Fu(r,t,n){return!!Lc(r,t)||!!sr(t,r,n)}function If(r,t){if(r.length===1)return kf(t,r[0]);for(let n=0;n<t.length;n++){const o=t[n];for(let d=0;d<o.length;d++)if(Lc(r,o[d]))return!0}for(let n=0;n<r.length;n++)if(kf(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(Pf(r,t[n]))return!0;return!1}function Yp(r,t,n){if(r.length>1){if(Pf(r,t))return!0;for(let o=0;o<t.length;o++)if(sr(t[o],r,n))return!0}for(let o=0;o<r.length;o++)if(sr(r[o],t,n))return!0;return!1}function Pf(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const o=r[n],d=r[n+1];for(let _=0;_<t.length-1;_++)if(Df(o,d,t[_],t[_+1]))return!0}return!1}function Df(r,t,n,o){return gi(r,n,o)!==gi(t,n,o)&&gi(r,t,n)!==gi(r,t,o)}function sr(r,t,n){const o=n*n;if(t.length===1)return r.distSqr(t[0])<o;for(let d=1;d<t.length;d++)if(qr(r,t[d-1],t[d])<o)return!0;return!1}function qr(r,t,n){const o=t.distSqr(n);if(o===0)return r.distSqr(t);const d=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/o;return r.distSqr(d<0?t:d>1?n:n.sub(t)._mult(d)._add(t))}function kf(r,t){let n,o,d,_=!1;for(let v=0;v<r.length;v++){n=r[v];for(let x=0,T=n.length-1;x<n.length;T=x++)o=n[x],d=n[T],o.y>t.y!=d.y>t.y&&t.x<(d.x-o.x)*(t.y-o.y)/(d.y-o.y)+o.x&&(_=!_)}return _}function Lc(r,t){let n=!1;for(let o=0,d=r.length-1;o<r.length;d=o++){const _=r[o],v=r[d];_.y>t.y!=v.y>t.y&&t.x<(v.x-_.x)*(t.y-_.y)/(v.y-_.y)+_.x&&(n=!n)}return n}function Wp(r,t,n){const o=n[0],d=n[2];if(r.x<o.x&&t.x<o.x||r.x>d.x&&t.x>d.x||r.y<o.y&&t.y<o.y||r.y>d.y&&t.y>d.y)return!1;const _=gi(r,t,n[0]);return _!==gi(r,t,n[1])||_!==gi(r,t,n[2])||_!==gi(r,t,n[3])}function Oc(r,t,n){const o=t.paint.get(r).value;return o.kind==="constant"?o.value:n.programConfigurations.get(t.id).getMaxValue(r)}function ql(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function kh(r,t,n,o,d){if(!t[0]&&!t[1])return r;const _=K.convert(t)._mult(d);n==="viewport"&&_._rotate(-o);const v=[];for(let x=0;x<r.length;x++)v.push(r[x].sub(_));return v}function Id({queryGeometry:r,size:t},n){return Fu(r,n,t)}function Kp({queryGeometry:r,size:t,transform:n,unwrappedTileID:o,getElevation:d},_){return Fu(r,_,t*(n.projectTileCoordinates(_.x,_.y,o,d).signedDistanceFromCamera/n.cameraToCenterDistance))}function lg({queryGeometry:r,size:t,transform:n,unwrappedTileID:o,getElevation:d},_){const v=n.projectTileCoordinates(_.x,_.y,o,d).signedDistanceFromCamera,x=t*(n.cameraToCenterDistance/v);return Fu(r,kd(_,n,o,d),x)}function Pd({queryGeometry:r,size:t,transform:n,unwrappedTileID:o,getElevation:d},_){return Fu(r,kd(_,n,o,d),t)}function Dd({queryGeometry:r,size:t,transform:n,unwrappedTileID:o,getElevation:d,pitchAlignment:_="map",pitchScale:v="map"},x){const T=_==="map"?v==="map"?Id:Kp:v==="map"?lg:Pd,I={queryGeometry:r,size:t,transform:n,unwrappedTileID:o,getElevation:d};for(const D of x)for(const B of D)if(T(I,B))return!0;return!1}function kd(r,t,n,o){const d=t.projectTileCoordinates(r.x,r.y,n,o).point;return new K((.5*d.x+.5)*t.width,(.5*-d.y+.5)*t.height)}let Rf,Bf;zt("CircleBucket",Ou,{omit:["layers"]});var Lf={get paint(){return Bf=Bf||new hn({"circle-radius":new qt(De.paint_circle["circle-radius"]),"circle-color":new qt(De.paint_circle["circle-color"]),"circle-blur":new qt(De.paint_circle["circle-blur"]),"circle-opacity":new qt(De.paint_circle["circle-opacity"]),"circle-translate":new Ot(De.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(De.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(De.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(De.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(De.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(De.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(De.paint_circle["circle-stroke-opacity"])})},get layout(){return Rf=Rf||new hn({"circle-sort-key":new qt(De.layout_circle["circle-sort-key"])})}};class Of extends wa{constructor(t,n){super(t,Lf,n)}createBucket(t){return new Ou(t)}queryRadius(t){const n=t;return Oc("circle-radius",this,n)+Oc("circle-stroke-width",this,n)+ql(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,unwrappedTileID:x,getElevation:T}){const I=kh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,v),D=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),B=this.paint.get("circle-pitch-scale"),V=this.paint.get("circle-pitch-alignment");let X,W;return V==="map"?(X=I,W=D*v):(X=(function(J,ne,ue,Ce){return J.map((_e=>kd(_e,ne,ue,Ce)))})(I,_,x,T),W=D),Dd({queryGeometry:X,size:W,transform:_,unwrappedTileID:x,getElevation:T,pitchAlignment:V,pitchScale:B},d)}}class Rd extends Ou{}let Ff;zt("HeatmapBucket",Rd,{omit:["layers"]});var jf={get paint(){return Ff=Ff||new hn({"heatmap-radius":new qt(De.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(De.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(De.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Br(De.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(De.paint_heatmap["heatmap-opacity"])})}};function ju(r,{width:t,height:n},o,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*n*o)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*n*o}`)}else d=new Uint8Array(t*n*o);return r.width=t,r.height=n,r.data=d,r}function Bd(r,{width:t,height:n},o){if(t===r.width&&n===r.height)return;const d=ju({},{width:t,height:n},o);Ld(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,n)},o),r.width=t,r.height=n,r.data=d.data}function Ld(r,t,n,o,d,_){if(d.width===0||d.height===0)return t;if(d.width>r.width||d.height>r.height||n.x>r.width-d.width||n.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||o.x>t.width-d.width||o.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const v=r.data,x=t.data;if(v===x)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<d.height;T++){const I=((n.y+T)*r.width+n.x)*_,D=((o.y+T)*t.width+o.x)*_;for(let B=0;B<d.width*_;B++)x[D+B]=v[I+B]}return t}class Fc{constructor(t,n){ju(this,t,1,n)}resize(t){Bd(this,t,1)}clone(){return new Fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,d,_){Ld(t,n,o,d,_,1)}}class ha{constructor(t,n){ju(this,t,4,n)}resize(t){Bd(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,d,_){Ld(t,n,o,d,_,4)}setPixel(t,n,o){const d=4*(t*this.width+n);this.data[d+0]=Math.round(255*o.r/o.a),this.data[d+1]=Math.round(255*o.g/o.a),this.data[d+2]=Math.round(255*o.b/o.a),this.data[d+3]=Math.round(255*o.a)}}function Po(r){const t={},n=r.resolution||256,o=r.clips?r.clips.length:1,d=r.image||new ha({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const _=(v,x,T)=>{t[r.evaluationKey]=T;const I=r.expression.evaluate(t);d.setPixel(v/4/n,x/4,I)};if(r.clips)for(let v=0,x=0;v<o;++v,x+=4*n)for(let T=0,I=0;T<n;T++,I+=4){const D=T/(n-1),{start:B,end:V}=r.clips[v];_(x,I,B*(1-D)+V*D)}else for(let v=0,x=0;v<n;v++,x+=4)_(0,x,v/(n-1));return d}zt("AlphaImage",Fc),zt("RGBAImage",ha);const Rh="big-fb";class cg extends wa{createBucket(t){return new Rd(t)}constructor(t,n){super(t,jf,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Po({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Rh)&&this.heatmapFbos.delete(Rh)}queryRadius(t){return Oc("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,unwrappedTileID:x,getElevation:T}){return Dd({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(n,o)*v,transform:_,unwrappedTileID:x,getElevation:T},d)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Uf;var pl={get paint(){return Uf=Uf||new hn({"hillshade-illumination-direction":new Ot(De.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ot(De.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ot(De.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(De.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(De.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(De.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(De.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ot(De.paint_hillshade["hillshade-method"])})}};class Nf extends wa{constructor(t,n){super(t,pl,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,d=this.paint.get("hillshade-shadow-color").values;const _=Math.max(t.length,n.length,o.length,d.length);t=t.concat(Array(_-t.length).fill(t.at(-1))),n=n.concat(Array(_-n.length).fill(n.at(-1))),o=o.concat(Array(_-o.length).fill(o.at(-1))),d=d.concat(Array(_-d.length).fill(d.at(-1)));const v=n.map(mn);return{directionRadians:t.map(mn),altitudeRadians:v,shadowColor:d,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Zf;var Od={get paint(){return Zf=Zf||new hn({"color-relief-opacity":new Ot(De["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Br(De["paint_color-relief"]["color-relief-color"])})}};class jc{constructor(t,n,o,d){this.context=t,this.format=o,this.texture=t.gl.createTexture(),this.update(n,d)}update(t,n,o){const{width:d,height:_}=t,v=!(this.size&&this.size[0]===d&&this.size[1]===_||o),{context:x}=this,{gl:T}=x;if(this.useMipmap=!!(n&&n.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[d,_],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||zi(t)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,t):T.texImage2D(T.TEXTURE_2D,0,this.format,d,_,0,this.format,T.UNSIGNED_BYTE,t.data);else{const{x:I,y:D}=o||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||zi(t)?T.texSubImage2D(T.TEXTURE_2D,0,I,D,T.RGBA,T.UNSIGNED_BYTE,t):T.texSubImage2D(T.TEXTURE_2D,0,I,D,d,_,T.RGBA,T.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),x.pixelStoreUnpackFlipY.setDefault(),x.pixelStoreUnpack.setDefault(),x.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,o){const{context:d}=this,{gl:_}=d;_.bindTexture(_.TEXTURE_2D,this.texture),o!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(o=_.LINEAR),t!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,t),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,o||t),this.filter=t),n!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,n),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Dn{constructor(t,n,o,d=1,_=1,v=1,x=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void Yt(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const T=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=_,this.blueFactor=v,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<T;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(T,I)]=this.data[this._idx(T-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,T)]=this.data[this._idx(I,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<T;I++)for(let D=0;D<T;D++){const B=this.get(I,D);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(t,n){const o=new Uint8Array(this.data.buffer),d=4*this._idx(t,n);return this.unpack(o[d],o[d+1],o[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,o){return t*this.redFactor+n*this.greenFactor+o*this.blueFactor-this.baseShift}pack(t){return Qp(t,this.getUnpackVector())}getPixels(){return new ha({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=n*this.dim,_=n*this.dim+this.dim,v=o*this.dim,x=o*this.dim+this.dim;switch(n){case-1:d=_-1;break;case 1:_=d+1}switch(o){case-1:v=x-1;break;case 1:x=v+1}const T=-n*this.dim,I=-o*this.dim;for(let D=v;D<x;D++)for(let B=d;B<_;B++)this.data[this._idx(B,D)]=t.data[this._idx(B+T,D+I)]}}function Qp(r,t){const n=t[0],o=t[1],d=t[2],_=t[3],v=Math.min(n,o,d),x=Math.round((r+_)/v);return{r:Math.floor(x*v/n)%256,g:Math.floor(x*v/o)%256,b:Math.floor(x*v/d)%256}}zt("DEMData",Dn);class ug extends wa{constructor(t,n){super(t,Od,n)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},o=this._transitionablePaint._values["color-relief-color"].value.expression;if(o instanceof Ur&&o._styleExpression.expression instanceof qi){this.colorRampExpression=o;const v=o._styleExpression.expression;n.elevationStops=v.labels,n.colorStops=[];for(const x of n.elevationStops)n.colorStops.push(v.evaluate({globals:{elevation:x}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[ni.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const d={elevationStops:[],colorStops:[]},_=(n.elevationStops.length-1)/(t-1);for(let v=0;v<n.elevationStops.length-.5;v+=_)d.elevationStops.push(n.elevationStops[Math.round(v)]),d.colorStops.push(n.colorStops[Math.round(v)]);return Yt(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${t}, provided: ${n.elevationStops.length}`),d}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,o){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const d=this._createColorRamp(n),_=new ha({width:d.colorStops.length,height:1}),v=new ha({width:d.colorStops.length,height:1});for(let x=0;x<d.elevationStops.length;x++){const T=Qp(d.elevationStops[x],o);v.setPixel(0,x,new ni(T.r/255,T.g/255,T.b/255,1)),_.setPixel(0,x,d.colorStops[x])}return this.colorRampTextures={elevationTexture:new jc(t,v,t.gl.RGBA),colorTexture:new jc(t,_,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Jp=Nt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bh}=Jp;function to(r,t,n){const o=n.patternDependencies;let d=!1;for(const _ of t){const v=_.paint.get(`${r}-pattern`);v.isConstant()||(d=!0);const x=v.constantOr(null);x&&(d=!0,o[x.to]=!0,o[x.from]=!0)}return d}function Fd(r,t,n,o,d){const{zoom:_}=o,v=d.patternDependencies;for(const x of t){const T=x.paint.get(`${r}-pattern`).value;if(T.kind!=="constant"){let I=T.evaluate({zoom:_-1},n,{},d.availableImages),D=T.evaluate({zoom:_},n,{},d.availableImages),B=T.evaluate({zoom:_+1},n,{},d.availableImages);I=I&&I.name?I.name:I,D=D&&D.name?D.name:D,B=B&&B.name?B.name:B,v[I]=!0,v[D]=!0,v[B]=!0,n.patterns[x.id]={min:I,mid:D,max:B}}}return n}function Vf(r,t,n,o,d){let _;if(d===(function(v,x,T,I){let D=0;for(let B=x,V=T-I;B<T;B+=I)D+=(v[V]-v[B])*(v[B+1]+v[V+1]),V=B;return D})(r,t,n,o)>0)for(let v=t;v<n;v+=o)_=Yf(v/o|0,r[v],r[v+1],_);else for(let v=n-o;v>=t;v-=o)_=Yf(v/o|0,r[v],r[v+1],_);return _&&Uc(_,_.next)&&(Nu(_),_=_.next),_}function io(r,t){if(!r)return r;t||(t=r);let n,o=r;do if(n=!1,o.steiner||!Uc(o,o.next)&&Xn(o.prev,o,o.next)!==0)o=o.next;else{if(Nu(o),o=t=o.prev,o===o.next)break;n=!0}while(n||o!==t);return t}function Na(r,t,n,o,d,_,v){if(!r)return;!v&&_&&(function(T,I,D,B){let V=T;do V.z===0&&(V.z=no(V.x,V.y,I,D,B)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==T);V.prevZ.nextZ=null,V.prevZ=null,(function(X){let W,J=1;do{let ne,ue=X;X=null;let Ce=null;for(W=0;ue;){W++;let _e=ue,xe=0;for(let We=0;We<J&&(xe++,_e=_e.nextZ,_e);We++);let Fe=J;for(;xe>0||Fe>0&&_e;)xe!==0&&(Fe===0||!_e||ue.z<=_e.z)?(ne=ue,ue=ue.nextZ,xe--):(ne=_e,_e=_e.nextZ,Fe--),Ce?Ce.nextZ=ne:X=ne,ne.prevZ=Ce,Ce=ne;ue=_e}Ce.nextZ=null,J*=2}while(W>1)})(V)})(r,o,d,_);let x=r;for(;r.prev!==r.next;){const T=r.prev,I=r.next;if(_?Gf(r,o,d,_):em(r))t.push(T.i,r.i,I.i),Nu(r),r=I.next,x=I.next;else if((r=I)===x){v?v===1?Na(r=tm(io(r),t),t,n,o,d,_,2):v===2&&qf(r,t,n,o,d,_):Na(io(r),t,n,o,d,_,1);break}}}function em(r){const t=r.prev,n=r,o=r.next;if(Xn(t,n,o)>=0)return!1;const d=t.x,_=n.x,v=o.x,x=t.y,T=n.y,I=o.y,D=Math.min(d,_,v),B=Math.min(x,T,I),V=Math.max(d,_,v),X=Math.max(x,T,I);let W=o.next;for(;W!==t;){if(W.x>=D&&W.x<=V&&W.y>=B&&W.y<=X&&Uu(d,x,_,T,v,I,W.x,W.y)&&Xn(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function Gf(r,t,n,o){const d=r.prev,_=r,v=r.next;if(Xn(d,_,v)>=0)return!1;const x=d.x,T=_.x,I=v.x,D=d.y,B=_.y,V=v.y,X=Math.min(x,T,I),W=Math.min(D,B,V),J=Math.max(x,T,I),ne=Math.max(D,B,V),ue=no(X,W,t,n,o),Ce=no(J,ne,t,n,o);let _e=r.prevZ,xe=r.nextZ;for(;_e&&_e.z>=ue&&xe&&xe.z<=Ce;){if(_e.x>=X&&_e.x<=J&&_e.y>=W&&_e.y<=ne&&_e!==d&&_e!==v&&Uu(x,D,T,B,I,V,_e.x,_e.y)&&Xn(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,xe.x>=X&&xe.x<=J&&xe.y>=W&&xe.y<=ne&&xe!==d&&xe!==v&&Uu(x,D,T,B,I,V,xe.x,xe.y)&&Xn(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;_e&&_e.z>=ue;){if(_e.x>=X&&_e.x<=J&&_e.y>=W&&_e.y<=ne&&_e!==d&&_e!==v&&Uu(x,D,T,B,I,V,_e.x,_e.y)&&Xn(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;xe&&xe.z<=Ce;){if(xe.x>=X&&xe.x<=J&&xe.y>=W&&xe.y<=ne&&xe!==d&&xe!==v&&Uu(x,D,T,B,I,V,xe.x,xe.y)&&Xn(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function tm(r,t){let n=r;do{const o=n.prev,d=n.next.next;!Uc(o,d)&&Hf(o,n,n.next,d)&&ts(o,d)&&ts(d,o)&&(t.push(o.i,n.i,d.i),Nu(n),Nu(n.next),n=r=d),n=n.next}while(n!==r);return io(n)}function qf(r,t,n,o,d,_){let v=r;do{let x=v.next.next;for(;x!==v.prev;){if(v.i!==x.i&&$r(v,x)){let T=Xf(v,x);return v=io(v,v.next),T=io(T,T.next),Na(v,t,n,o,d,_,0),void Na(T,t,n,o,d,_,0)}x=x.next}v=v.next}while(v!==r)}function $f(r,t){let n=r.x-t.x;return n===0&&(n=r.y-t.y,n===0)&&(n=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function jd(r,t){const n=(function(d,_){let v=_;const x=d.x,T=d.y;let I,D=-1/0;if(Uc(d,v))return v;do{if(Uc(d,v.next))return v.next;if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){const J=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(J<=x&&J>D&&(D=J,I=v.x<v.next.x?v:v.next,J===x))return I}v=v.next}while(v!==_);if(!I)return null;const B=I,V=I.x,X=I.y;let W=1/0;v=I;do{if(x>=v.x&&v.x>=V&&x!==v.x&&Ud(T<X?x:D,T,V,X,T<X?D:x,T,v.x,v.y)){const J=Math.abs(T-v.y)/(x-v.x);ts(v,d)&&(J<W||J===W&&(v.x>I.x||v.x===I.x&&im(I,v)))&&(I=v,W=J)}v=v.next}while(v!==B);return I})(r,t);if(!n)return t;const o=Xf(n,r);return io(o,o.next),io(n,n.next)}function im(r,t){return Xn(r.prev,r,t.prev)<0&&Xn(t.next,r,r.next)<0}function no(r,t,n,o,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function wr(r){let t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Ud(r,t,n,o,d,_,v,x){return(d-v)*(t-x)>=(r-v)*(_-x)&&(r-v)*(o-x)>=(n-v)*(t-x)&&(n-v)*(_-x)>=(d-v)*(o-x)}function Uu(r,t,n,o,d,_,v,x){return!(r===v&&t===x)&&Ud(r,t,n,o,d,_,v,x)}function $r(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!(function(n,o){let d=n;do{if(d.i!==n.i&&d.next.i!==n.i&&d.i!==o.i&&d.next.i!==o.i&&Hf(d,d.next,n,o))return!0;d=d.next}while(d!==n);return!1})(r,t)&&(ts(r,t)&&ts(t,r)&&(function(n,o){let d=n,_=!1;const v=(n.x+o.x)/2,x=(n.y+o.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&v<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(_=!_),d=d.next;while(d!==n);return _})(r,t)&&(Xn(r.prev,r,t.prev)||Xn(r,t.prev,t))||Uc(r,t)&&Xn(r.prev,r,r.next)>0&&Xn(t.prev,t,t.next)>0)}function Xn(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function Uc(r,t){return r.x===t.x&&r.y===t.y}function Hf(r,t,n,o){const d=na(Xn(r,t,n)),_=na(Xn(r,t,o)),v=na(Xn(n,o,r)),x=na(Xn(n,o,t));return d!==_&&v!==x||!(d!==0||!An(r,n,t))||!(_!==0||!An(r,o,t))||!(v!==0||!An(n,r,o))||!(x!==0||!An(n,t,o))}function An(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function na(r){return r>0?1:r<0?-1:0}function ts(r,t){return Xn(r.prev,r,r.next)<0?Xn(r,t,r.next)>=0&&Xn(r,r.prev,t)>=0:Xn(r,t,r.prev)<0||Xn(r,r.next,t)<0}function Xf(r,t){const n=Wf(r.i,r.x,r.y),o=Wf(t.i,t.x,t.y),d=r.next,_=t.prev;return r.next=t,t.prev=r,n.next=d,d.prev=n,o.next=n,n.prev=o,_.next=o,o.prev=_,o}function Yf(r,t,n,o){const d=Wf(r,t,n);return o?(d.next=o.next,d.prev=o,o.next.prev=d,o.next=d):(d.prev=d,d.next=d),d}function Nu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Wf(r,t,n){return{i:r,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ml{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class ra{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}ra.noSubdivision=new ra({fill:new ml(0,0),line:new ml(0,0),tile:new ml(0,0),stencil:new ml(0,0),circle:1}),zt("SubdivisionGranularityExpression",ml),zt("SubdivisionGranularitySetting",ra);const da=-32768,Zu=32767;class Za{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=dt/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),d=0|Math.round(n),_=this._getKey(o,d);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const v=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,v),this._vertexBuffer.push(o,d),v}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(d,_){const v=[];for(let x=0;x<_.length;x+=3){const T=_[x],I=_[x+1],D=_[x+2],B=d[2*T],V=d[2*T+1];(d[2*I]-B)*(d[2*D+1]-V)-(d[2*I+1]-V)*(d[2*D]-B)>0?(v.push(T),v.push(D),v.push(I)):(v.push(T),v.push(I),v.push(D))}return v})(this._vertexBuffer,t);const n=[],o=t.length;for(let d=0;d<o;d+=3){const _=[t[d+0],t[d+1],t[d+2]],v=[this._vertexBuffer[2*t[d+0]+0],this._vertexBuffer[2*t[d+0]+1],this._vertexBuffer[2*t[d+1]+0],this._vertexBuffer[2*t[d+1]+1],this._vertexBuffer[2*t[d+2]+0],this._vertexBuffer[2*t[d+2]+1]];let x=1/0,T=1/0,I=-1/0,D=-1/0;for(let J=0;J<3;J++){const ne=v[2*J],ue=v[2*J+1];x=Math.min(x,ne),I=Math.max(I,ne),T=Math.min(T,ue),D=Math.max(D,ue)}if(x===I||T===D)continue;const B=Math.floor(x/this._granularityCellSize),V=Math.ceil(I/this._granularityCellSize),X=Math.floor(T/this._granularityCellSize),W=Math.ceil(D/this._granularityCellSize);if(B!==V||X!==W)for(let J=X;J<W;J++){const ne=this._scanlineGenerateVertexRingForCellRow(J,v,_);Nc(this._vertexBuffer,ne,n)}else n.push(..._)}return n}_scanlineGenerateVertexRingForCellRow(t,n,o){const d=t*this._granularityCellSize,_=d+this._granularityCellSize,v=[];for(let x=0;x<3;x++){const T=n[2*x],I=n[2*x+1],D=n[2*(x+1)%6],B=n[(2*(x+1)+1)%6],V=n[2*(x+2)%6],X=n[(2*(x+2)+1)%6],W=D-T,J=B-I,ne=W===0,ue=J===0,Ce=(d-I)/J,_e=(_-I)/J,xe=Math.min(Ce,_e),Fe=Math.max(Ce,_e);if(!ue&&(xe>=1||Fe<=0)||ue&&(I<d||I>_)){B>=d&&B<=_&&v.push(o[(x+1)%3]);continue}!ue&&xe>0&&v.push(this._vertexToIndex(T+W*xe,I+J*xe));const We=T+W*Math.max(xe,0),ut=T+W*Math.min(Fe,1);ne||this._generateIntraEdgeVertices(v,T,I,D,B,We,ut),!ue&&Fe<1&&v.push(this._vertexToIndex(T+W*Fe,I+J*Fe)),(ue||B>=d&&B<=_)&&v.push(o[(x+1)%3]),!ue&&(B<=d||B>=_)&&this._generateInterEdgeVertices(v,T,I,D,B,V,X,ut,d,_)}return v}_generateIntraEdgeVertices(t,n,o,d,_,v,x){const T=d-n,I=_-o,D=I===0,B=D?Math.min(n,d):Math.min(v,x),V=D?Math.max(n,d):Math.max(v,x),X=Math.floor(B/this._granularityCellSize)+1,W=Math.ceil(V/this._granularityCellSize)-1;if(D?n<d:v<x)for(let J=X;J<=W;J++){const ne=J*this._granularityCellSize;t.push(this._vertexToIndex(ne,o+I*(ne-n)/T))}else for(let J=W;J>=X;J--){const ne=J*this._granularityCellSize;t.push(this._vertexToIndex(ne,o+I*(ne-n)/T))}}_generateInterEdgeVertices(t,n,o,d,_,v,x,T,I,D){const B=_-o,V=v-d,X=x-_,W=(I-_)/X,J=(D-_)/X,ne=Math.min(W,J),ue=Math.max(W,J),Ce=d+V*ne;let _e=Math.floor(Math.min(Ce,T)/this._granularityCellSize)+1,xe=Math.ceil(Math.max(Ce,T)/this._granularityCellSize)-1,Fe=T<Ce;const We=X===0;if(We&&(x===I||x===D))return;if(We||ne>=1||ue<=0){const At=o-x,xt=v+(n-v)*Math.min((I-x)/At,(D-x)/At);_e=Math.floor(Math.min(xt,T)/this._granularityCellSize)+1,xe=Math.ceil(Math.max(xt,T)/this._granularityCellSize)-1,Fe=T<xt}const ut=B>0?D:I;if(Fe)for(let At=_e;At<=xe;At++)t.push(this._vertexToIndex(At*this._granularityCellSize,ut));else for(let At=xe;At>=_e;At--)t.push(this._vertexToIndex(At*this._granularityCellSize,ut))}_generateOutline(t){const n=[];for(const o of t){const d=Ea(o,this._granularity,!0),_=this._pointArrayToIndices(d),v=[];for(let x=1;x<_.length;x++)v.push(_[x-1]),v.push(_[x]);n.push(v)}return n}_handlePoles(t){let n=!1,o=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(n||o)&&this._fillPoles(t,n,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const o=t[n+1];o===da&&(t[n+1]=-32767),o===Zu&&(t[n+1]=32766)}}_generatePoleQuad(t,n,o,d,_,v){d>_!=(v===da)?(t.push(n),t.push(o),t.push(this._vertexToIndex(d,v)),t.push(o),t.push(this._vertexToIndex(_,v)),t.push(this._vertexToIndex(d,v))):(t.push(o),t.push(n),t.push(this._vertexToIndex(d,v)),t.push(this._vertexToIndex(_,v)),t.push(o),t.push(this._vertexToIndex(d,v)))}_fillPoles(t,n,o){const d=this._vertexBuffer,_=dt,v=t.length;for(let x=2;x<v;x+=3){const T=t[x-2],I=t[x-1],D=t[x],B=d[2*T],V=d[2*T+1],X=d[2*I],W=d[2*I+1],J=d[2*D],ne=d[2*D+1];n&&(V===0&&W===0&&this._generatePoleQuad(t,T,I,B,X,da),W===0&&ne===0&&this._generatePoleQuad(t,I,D,X,J,da),ne===0&&V===0&&this._generatePoleQuad(t,D,T,J,B,da)),o&&(V===_&&W===_&&this._generatePoleQuad(t,T,I,B,X,Zu),W===_&&ne===_&&this._generatePoleQuad(t,I,D,X,J,Zu),ne===_&&V===_&&this._generatePoleQuad(t,D,T,J,B,Zu))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:d}=(function(x){const T=[],I=[];for(const D of x)if(D.length!==0){D!==x[0]&&T.push(I.length/2);for(let B=0;B<D.length;B++)I.push(D[B].x),I.push(D[B].y)}return{flattened:I,holeIndices:T}})(t);let _;this._initializeVertices(o);try{const x=(function(I,D,B=2){const V=D&&D.length,X=V?D[0]*B:I.length;let W=Vf(I,0,X,B,!0);const J=[];if(!W||W.next===W.prev)return J;let ne,ue,Ce;if(V&&(W=(function(_e,xe,Fe,We){const ut=[];for(let At=0,xt=xe.length;At<xt;At++){const Et=Vf(_e,xe[At]*We,At<xt-1?xe[At+1]*We:_e.length,We,!1);Et===Et.next&&(Et.steiner=!0),ut.push(wr(Et))}ut.sort($f);for(let At=0;At<ut.length;At++)Fe=jd(ut[At],Fe);return Fe})(I,D,W,B)),I.length>80*B){ne=I[0],ue=I[1];let _e=ne,xe=ue;for(let Fe=B;Fe<X;Fe+=B){const We=I[Fe],ut=I[Fe+1];We<ne&&(ne=We),ut<ue&&(ue=ut),We>_e&&(_e=We),ut>xe&&(xe=ut)}Ce=Math.max(_e-ne,xe-ue),Ce=Ce!==0?32767/Ce:0}return Na(W,J,B,ne,ue,Ce,0),J})(o,d),T=this._convertIndices(o,x);_=this._subdivideTrianglesScanline(T)}catch(x){console.error(x)}let v=[];return n&&(v=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:v}}_convertIndices(t,n){const o=[];for(let d=0;d<n.length;d++)o.push(this._vertexToIndex(t[2*n[d]],t[2*n[d]+1]));return o}_pointArrayToIndices(t){const n=[];for(let o=0;o<t.length;o++){const d=t[o];n.push(this._vertexToIndex(d.x,d.y))}return n}}function Kf(r,t,n,o=!0){return new Za(n,t).subdividePolygonInternal(r,o)}function Ea(r,t,n=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const o=r[0],d=r[r.length-1],_=n&&(o.x!==d.x||o.y!==d.y);if(t<2)return _?[...r,r[0]]:[...r];const v=Math.floor(dt/t),x=[];x.push(new K(r[0].x,r[0].y));const T=r.length,I=_?T:T-1;for(let D=0;D<I;D++){const B=r[D],V=D<T-1?r[D+1]:r[0],X=B.x,W=B.y,J=V.x,ne=V.y,ue=X!==J,Ce=W!==ne;if(!ue&&!Ce)continue;const _e=J-X,xe=ne-W,Fe=Math.abs(_e),We=Math.abs(xe);let ut=X,At=W;for(;;){const Et=_e>0?(Math.floor(ut/v)+1)*v:(Math.ceil(ut/v)-1)*v,Ut=xe>0?(Math.floor(At/v)+1)*v:(Math.ceil(At/v)-1)*v,Mt=Math.abs(ut-Et),Tt=Math.abs(At-Ut),rt=Math.abs(ut-J),Jt=Math.abs(At-ne),ti=ue?Mt/Fe:Number.POSITIVE_INFINITY,Zt=Ce?Tt/We:Number.POSITIVE_INFINITY;if((rt<=Mt||!ue)&&(Jt<=Tt||!Ce))break;if(ti<Zt&&ue||!Ce){ut=Et,At+=xe*ti;const Lt=new K(ut,Math.round(At));x[x.length-1].x===Lt.x&&x[x.length-1].y===Lt.y||x.push(Lt)}else{ut+=_e*Zt,At=Ut;const Lt=new K(Math.round(ut),At);x[x.length-1].x===Lt.x&&x[x.length-1].y===Lt.y||x.push(Lt)}}const xt=new K(J,ne);x[x.length-1].x===xt.x&&x[x.length-1].y===xt.y||x.push(xt)}return x}function Nc(r,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,d=r[2*t[0]];for(let T=1;T<t.length;T++){const I=r[2*t[T]];I<d&&(d=I,o=T)}const _=t.length;let v=o,x=(v+1)%_;for(;;){const T=v-1>=0?v-1:_-1,I=(x+1)%_,D=r[2*t[T]],B=r[2*t[I]],V=r[2*t[v]],X=r[2*t[v]+1],W=r[2*t[x]+1];let J=!1;if(D<B)J=!0;else if(D>B)J=!1;else{const ne=W-X,ue=-(r[2*t[x]]-V),Ce=X<W?1:-1;((D-V)*ne+(r[2*t[T]+1]-X)*ue)*Ce>((B-V)*ne+(r[2*t[I]+1]-X)*ue)*Ce&&(J=!0)}if(J){const ne=t[T],ue=t[v],Ce=t[x];ne!==ue&&ne!==Ce&&ue!==Ce&&n.push(Ce,ue,ne),v--,v<0&&(v=_-1)}else{const ne=t[I],ue=t[v],Ce=t[x];ne!==ue&&ne!==Ce&&ue!==Ce&&n.push(Ce,ue,ne),x++,x>=_&&(x=0)}if(T===I)break}}function Do(r,t,n,o,d,_,v,x,T){const I=d.length/2,D=v&&x&&T;if(I<mi.MAX_VERTEX_ARRAY_LENGTH){const B=t.prepareSegment(I,n,o),V=B.vertexLength;for(let J=0;J<_.length;J+=3)o.emplaceBack(V+_[J],V+_[J+1],V+_[J+2]);let X,W;B.vertexLength+=I,B.primitiveLength+=_.length/3,D&&(W=v.prepareSegment(I,n,x),X=W.vertexLength,W.vertexLength+=I);for(let J=0;J<d.length;J+=2)r(d[J],d[J+1]);if(D)for(let J=0;J<T.length;J++){const ne=T[J];for(let ue=1;ue<ne.length;ue+=2)x.emplaceBack(X+ne[ue-1],X+ne[ue]);W.primitiveLength+=ne.length/2}}else(function(B,V,X,W,J,ne){const ue=[];for(let We=0;We<W.length/2;We++)ue.push(-1);const Ce={count:0};let _e=0,xe=B.getOrCreateLatestSegment(V,X),Fe=xe.vertexLength;for(let We=2;We<J.length;We+=3){const ut=J[We-2],At=J[We-1],xt=J[We];let Et=ue[ut]<_e,Ut=ue[At]<_e,Mt=ue[xt]<_e;xe.vertexLength+((Et?1:0)+(Ut?1:0)+(Mt?1:0))>mi.MAX_VERTEX_ARRAY_LENGTH&&(xe=B.createNewSegment(V,X),_e=Ce.count,Et=!0,Ut=!0,Mt=!0,Fe=0);const Tt=Zc(ue,W,ne,Ce,ut,Et,xe),rt=Zc(ue,W,ne,Ce,At,Ut,xe),Jt=Zc(ue,W,ne,Ce,xt,Mt,xe);X.emplaceBack(Fe+Tt-_e,Fe+rt-_e,Fe+Jt-_e),xe.primitiveLength++}})(t,n,o,d,_,r),D&&(function(B,V,X,W,J,ne){const ue=[];for(let We=0;We<W.length/2;We++)ue.push(-1);const Ce={count:0};let _e=0,xe=B.getOrCreateLatestSegment(V,X),Fe=xe.vertexLength;for(let We=0;We<J.length;We++){const ut=J[We];for(let At=1;At<J[We].length;At+=2){const xt=ut[At-1],Et=ut[At];let Ut=ue[xt]<_e,Mt=ue[Et]<_e;xe.vertexLength+((Ut?1:0)+(Mt?1:0))>mi.MAX_VERTEX_ARRAY_LENGTH&&(xe=B.createNewSegment(V,X),_e=Ce.count,Ut=!0,Mt=!0,Fe=0);const Tt=Zc(ue,W,ne,Ce,xt,Ut,xe),rt=Zc(ue,W,ne,Ce,Et,Mt,xe);X.emplaceBack(Fe+Tt-_e,Fe+rt-_e),xe.primitiveLength++}}})(v,n,x,d,T,r),t.forceNewSegmentOnNextPrepare(),v?.forceNewSegmentOnNextPrepare()}function Zc(r,t,n,o,d,_,v){if(_){const x=o.count;return n(t[2*d],t[2*d+1]),r[d]=o.count,o.count++,v.vertexLength++,x}return r[d]}class Lh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new he,this.indexArray=new nt,this.indexArray2=new kt,this.programConfigurations=new Io(t.layers,t.zoom),this.segments=new mi,this.segments2=new mi,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,o){this.hasDependencies=to("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),_=!d.isConstant(),v=[];for(const{feature:x,id:T,index:I,sourceLayerIndex:D}of t){const B=this.layers[0]._featureFilter.needGeometry,V=eo(x,B);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),V,o))continue;const X=_?d.evaluate(V,{},o,n.availableImages):void 0,W={id:T,properties:x.properties,type:x.type,sourceLayerIndex:D,index:I,geometry:B?V.geometry:ia(x),patterns:{},sortKey:X};v.push(W)}_&&v.sort(((x,T)=>x.sortKey-T.sortKey));for(const x of v){const{geometry:T,index:I,sourceLayerIndex:D}=x;if(this.hasDependencies){const B=Fd("fill",this.layers,x,{zoom:this.zoom},n);this.patternFeatures.push(B)}else this.addFeature(x,T,I,o,{},n.subdivisionGranularity);n.featureIndex.insert(t[I].feature,T,I,D,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:o})}addFeatures(t,n,o){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bh),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,o,d,_,v){for(const x of pc(n,500)){const T=Kf(x,d,v.fill.getGranularityForZoomLevel(d.z)),I=this.layoutVertexArray;Do(((D,B)=>{I.emplaceBack(D,B)}),this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,canonical:d})}}let Ts,Qf;zt("FillBucket",Lh,{omit:["layers","patternFeatures"]});var Vu={get paint(){return Qf=Qf||new hn({"fill-antialias":new Ot(De.paint_fill["fill-antialias"]),"fill-opacity":new qt(De.paint_fill["fill-opacity"]),"fill-color":new qt(De.paint_fill["fill-color"]),"fill-outline-color":new qt(De.paint_fill["fill-outline-color"]),"fill-translate":new Ot(De.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(De.paint_fill["fill-translate-anchor"]),"fill-pattern":new cl(De.paint_fill["fill-pattern"])})},get layout(){return Ts=Ts||new hn({"fill-sort-key":new qt(De.layout_fill["fill-sort-key"])})}};class Oh extends wa{constructor(t,n){super(t,Vu,n)}recalculate(t,n){super.recalculate(t,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Lh(t)}queryRadius(){return ql(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:o,pixelsToTileUnits:d}){return If(kh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,d),n)}isTileClipped(){return!0}}const Fh=Nt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Gu=Nt([{name:"a_centroid",components:2,type:"Int16"}],4),{members:nm}=Fh;class Vc{constructor(t,n,o,d,_){this.properties={},this.extent=o,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=d,this._values=_,t.readFields(jh,this,n)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos,o=[];let d,_=1,v=0,x=0,T=0;for(;t.pos<n;){if(v<=0){const I=t.readVarint();_=7&I,v=I>>3}if(v--,_===1||_===2)x+=t.readSVarint(),T+=t.readSVarint(),_===1&&(d&&o.push(d),d=[]),d&&d.push(new K(x,T));else{if(_!==7)throw new Error(`unknown command ${_}`);d&&d.push(d[0].clone())}}return d&&o.push(d),o}bbox(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos;let o=1,d=0,_=0,v=0,x=1/0,T=-1/0,I=1/0,D=-1/0;for(;t.pos<n;){if(d<=0){const B=t.readVarint();o=7&B,d=B>>3}if(d--,o===1||o===2)_+=t.readSVarint(),v+=t.readSVarint(),_<x&&(x=_),_>T&&(T=_),v<I&&(I=v),v>D&&(D=v);else if(o!==7)throw new Error(`unknown command ${o}`)}return[x,I,T,D]}toGeoJSON(t,n,o){const d=this.extent*Math.pow(2,o),_=this.extent*t,v=this.extent*n,x=this.loadGeometry();function T(V){return[360*(V.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((1-2*(V.y+v)/d)*Math.PI))-90]}function I(V){return V.map(T)}let D;if(this.type===1){const V=[];for(const W of x)V.push(W[0]);const X=I(V);D=V.length===1?{type:"Point",coordinates:X[0]}:{type:"MultiPoint",coordinates:X}}else if(this.type===2){const V=x.map(I);D=V.length===1?{type:"LineString",coordinates:V[0]}:{type:"MultiLineString",coordinates:V}}else{if(this.type!==3)throw new Error("unknown feature type");{const V=(function(W){const J=W.length;if(J<=1)return[W];const ne=[];let ue,Ce;for(let _e=0;_e<J;_e++){const xe=rm(W[_e]);xe!==0&&(Ce===void 0&&(Ce=xe<0),Ce===xe<0?(ue&&ne.push(ue),ue=[W[_e]]):ue&&ue.push(W[_e]))}return ue&&ne.push(ue),ne})(x),X=[];for(const W of V)X.push(W.map(I));D=X.length===1?{type:"Polygon",coordinates:X[0]}:{type:"MultiPolygon",coordinates:X}}}const B={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(B.id=this.id),B}}function jh(r,t,n){r===1?t.id=n.readVarint():r===2?(function(o,d){const _=o.readVarint()+o.pos;for(;o.pos<_;){const v=d._keys[o.readVarint()],x=d._values[o.readVarint()];d.properties[v]=x}})(n,t):r===3?t.type=n.readVarint():r===4&&(t._geometry=n.pos)}function rm(r){let t=0;for(let n,o,d=0,_=r.length,v=_-1;d<_;v=d++)n=r[d],o=r[v],t+=(o.x-n.x)*(n.y+o.y);return t}Vc.types=["Unknown","Point","LineString","Polygon"];class Uh{constructor(t,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(am,this,n),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new Vc(this._pbf,n,this.extent,this._keys,this._values)}}function am(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push((function(o){let d=null;const _=o.readVarint()+o.pos;for(;o.pos<_;){const v=o.readVarint()>>3;d=v===1?o.readString():v===2?o.readFloat():v===3?o.readDouble():v===4?o.readVarint64():v===5?o.readVarint():v===6?o.readSVarint():v===7?o.readBoolean():null}if(d==null)throw new Error("unknown feature value");return d})(n))}class sm{constructor(t,n){this.layers=t.readFields(hg,{},n)}}function hg(r,t,n){if(r===3){const o=new Uh(n,n.readVarint()+n.pos);o.length&&(t[o.name]=o)}}const $i=Math.pow(2,13);function tn(r,t,n,o,d,_,v,x){r.emplaceBack(t,n,2*Math.floor(o*$i)+v,d*$i*2,_*$i*2,Math.round(x))}class ki{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new ve,this.centroidVertexArray=new de,this.indexArray=new nt,this.programConfigurations=new Io(t.layers,t.zoom),this.segments=new mi,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,o){this.features=[],this.hasDependencies=to("fill-extrusion",this.layers,n);for(const{feature:d,id:_,index:v,sourceLayerIndex:x}of t){const T=this.layers[0]._featureFilter.needGeometry,I=eo(d,T);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),I,o))continue;const D={id:_,sourceLayerIndex:x,index:v,geometry:T?I.geometry:ia(d),properties:d.properties,type:d.type,patterns:{}};this.hasDependencies?this.features.push(Fd("fill-extrusion",this.layers,D,{zoom:this.zoom},n)):this.addFeature(D,D.geometry,v,o,{},n.subdivisionGranularity),n.featureIndex.insert(d,D.geometry,v,x,this.index,!0)}}addFeatures(t,n,o){for(const d of this.features){const{geometry:_}=d;this.addFeature(d,_,d.index,n,o,t.subdivisionGranularity)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nm),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Gu.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,o,d,_,v){for(const x of pc(n,500)){const T={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(T,d,t,x,v);const D=this.layoutVertexArray.length-I,B=Math.floor(T.x/T.sampleCount),V=Math.floor(T.y/T.sampleCount);for(let X=0;X<D;X++)this.centroidVertexArray.emplaceBack(B,V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,canonical:d})}processPolygon(t,n,o,d,_){if(d.length<1||Va(d[0]))return;for(const B of d)B.length!==0&&ji(t,B);const v={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},x=_.fill.getGranularityForZoomLevel(n.z),T=Vc.types[o.type]==="Polygon";for(const B of d){if(B.length===0||Va(B))continue;const V=Ea(B,x,T);this._generateSideFaces(V,v)}if(!T)return;const I=Kf(d,n,x,!1),D=this.layoutVertexArray;Do(((B,V)=>{tn(D,B,V,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(t,n){let o=0;for(let d=1;d<t.length;d++){const _=t[d],v=t[d-1];if(dn(_,v))continue;n.segment.vertexLength+4>mi.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const x=_.sub(v)._perp()._unit(),T=v.dist(_);o+T>32768&&(o=0),tn(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,0,o),tn(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,1,o),o+=T,tn(this.layoutVertexArray,v.x,v.y,x.x,x.y,0,0,o),tn(this.layoutVertexArray,v.x,v.y,x.x,x.y,0,1,o);const I=n.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function ji(r,t){for(let n=0;n<t.length;n++){const o=t[n];n===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(r.x+=o.x,r.y+=o.y,r.sampleCount++)}}function dn(r,t){return r.x===t.x&&(r.x<0||r.x>dt)||r.y===t.y&&(r.y<0||r.y>dt)}function Va(r){return r.every((t=>t.x<0))||r.every((t=>t.x>dt))||r.every((t=>t.y<0))||r.every((t=>t.y>dt))}let gl;zt("FillExtrusionBucket",ki,{omit:["layers","features"]});var qu={get paint(){return gl=gl||new hn({"fill-extrusion-opacity":new Ot(De["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(De["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(De["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(De["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cl(De["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(De["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(De["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ot(De["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jf extends wa{constructor(t,n){super(t,qu,n)}createBucket(t){return new ki(t)}queryRadius(){return ql(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v,pixelPosMatrix:x}){const T=kh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,v),I=this.paint.get("fill-extrusion-height").evaluate(n,o),D=this.paint.get("fill-extrusion-base").evaluate(n,o),B=(function(X,W){const J=[];for(const ne of X){const ue=[ne.x,ne.y,0,1];vi(ue,ue,W),J.push(new K(ue[0]/ue[3],ue[1]/ue[3]))}return J})(T,x),V=(function(X,W,J,ne){const ue=[],Ce=[],_e=ne[8]*W,xe=ne[9]*W,Fe=ne[10]*W,We=ne[11]*W,ut=ne[8]*J,At=ne[9]*J,xt=ne[10]*J,Et=ne[11]*J;for(const Ut of X){const Mt=[],Tt=[];for(const rt of Ut){const Jt=rt.x,ti=rt.y,Zt=ne[0]*Jt+ne[4]*ti+ne[12],Lt=ne[1]*Jt+ne[5]*ti+ne[13],Mi=ne[2]*Jt+ne[6]*ti+ne[14],kn=ne[3]*Jt+ne[7]*ti+ne[15],Wn=Mi+Fe,On=kn+We,Er=Zt+ut,lr=Lt+At,Kn=Mi+xt,cn=kn+Et,zn=new K((Zt+_e)/On,(Lt+xe)/On);zn.z=Wn/On,Mt.push(zn);const Fr=new K(Er/cn,lr/cn);Fr.z=Kn/cn,Tt.push(Fr)}ue.push(Mt),Ce.push(Tt)}return[ue,Ce]})(d,D,I,x);return(function(X,W,J){let ne=1/0;If(J,W)&&(ne=Yn(J,W[0]));for(let ue=0;ue<W.length;ue++){const Ce=W[ue],_e=X[ue];for(let xe=0;xe<Ce.length-1;xe++){const Fe=Ce[xe],We=[Fe,Ce[xe+1],_e[xe+1],_e[xe],Fe];Cf(J,We)&&(ne=Math.min(ne,Yn(J,We)))}}return ne!==1/0&&ne})(V[0],V[1],B)}}function is(r,t){return r.x*t.x+r.y*t.y}function Yn(r,t){if(r.length===1){let n=0;const o=t[n++];let d;for(;!d||o.equals(d);)if(d=t[n++],!d)return 1/0;for(;n<t.length;n++){const _=t[n],v=r[0],x=d.sub(o),T=_.sub(o),I=v.sub(o),D=is(x,x),B=is(x,T),V=is(T,T),X=is(I,x),W=is(I,T),J=D*V-B*B,ne=(V*X-B*W)/J,ue=(D*W-B*X)/J,Ce=o.z*(1-ne-ue)+d.z*ne+_.z*ue;if(isFinite(Ce))return Ce}return 1/0}{let n=1/0;for(const o of t)n=Math.min(n,o.z);return n}}const $l=Nt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Gc}=$l,ep=Nt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ns}=ep,$u=Math.cos(Math.PI/180*37.5),Hu=Math.pow(2,14)/.5;class fa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new Ee,this.layoutVertexArray2=new me,this.indexArray=new nt,this.programConfigurations=new Io(t.layers,t.zoom),this.segments=new mi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,o){this.hasDependencies=to("line",this.layers,n)||this.hasLineDasharray(this.layers);const d=this.layers[0].layout.get("line-sort-key"),_=!d.isConstant(),v=[];for(const{feature:x,id:T,index:I,sourceLayerIndex:D}of t){const B=this.layers[0]._featureFilter.needGeometry,V=eo(x,B);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),V,o))continue;const X=_?d.evaluate(V,{},o):void 0,W={id:T,properties:x.properties,type:x.type,sourceLayerIndex:D,index:I,geometry:B?V.geometry:ia(x),patterns:{},dashes:{},sortKey:X};v.push(W)}_&&v.sort(((x,T)=>x.sortKey-T.sortKey));for(const x of v){const{geometry:T,index:I,sourceLayerIndex:D}=x;this.hasDependencies?(to("line",this.layers,n)?Fd("line",this.layers,x,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,x,this.zoom,n),this.patternFeatures.push(x)):this.addFeature(x,T,I,o,{},{},n.subdivisionGranularity),n.featureIndex.insert(t[I].feature,T,I,D,this.index)}}update(t,n,o,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:o,dashPositions:d})}addFeatures(t,n,o,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,n,o,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,ns)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,o,d,_,v,x){const T=this.layers[0].layout,I=T.get("line-join").evaluate(t,{}),D=T.get("line-cap"),B=T.get("line-miter-limit"),V=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const X of n)this.addLine(X,t,I,D,B,V,d,x);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{imagePositions:_,dashPositions:v,canonical:d})}addLine(t,n,o,d,_,v,x,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Ea(t,x?T.line.getGranularityForZoomLevel(x.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=Vc.types[n.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let B=0;for(;B<D-1&&t[B].equals(t[B+1]);)B++;if(D<(I?3:2))return;o==="bevel"&&(_=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,X=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let W,J,ne,ue,Ce;this.e1=this.e2=-1,I&&(W=t[D-2],Ce=t[B].sub(W)._unit()._perp());for(let _e=B;_e<D;_e++){if(ne=_e===D-1?I?t[B+1]:void 0:t[_e+1],ne&&t[_e].equals(ne))continue;Ce&&(ue=Ce),W&&(J=W),W=t[_e],Ce=ne?ne.sub(W)._unit()._perp():ue,ue=ue||Ce;let xe=ue.add(Ce);xe.x===0&&xe.y===0||xe._unit();const Fe=ue.x*Ce.x+ue.y*Ce.y,We=xe.x*Ce.x+xe.y*Ce.y,ut=We!==0?1/We:1/0,At=2*Math.sqrt(2-2*We),xt=We<$u&&J&&ne,Et=ue.x*Ce.y-ue.y*Ce.x>0;if(xt&&_e>B){const Tt=W.dist(J);if(Tt>2*V){const rt=W.sub(W.sub(J)._mult(V/Tt)._round());this.updateDistance(J,rt),this.addCurrentVertex(rt,ue,0,0,X),J=rt}}const Ut=J&&ne;let Mt=Ut?o:I?"butt":d;if(Ut&&Mt==="round"&&(ut<v?Mt="miter":ut<=2&&(Mt="fakeround")),Mt==="miter"&&ut>_&&(Mt="bevel"),Mt==="bevel"&&(ut>2&&(Mt="flipbevel"),ut<_&&(Mt="miter")),J&&this.updateDistance(J,W),Mt==="miter")xe._mult(ut),this.addCurrentVertex(W,xe,0,0,X);else if(Mt==="flipbevel"){if(ut>100)xe=Ce.mult(-1);else{const Tt=ut*ue.add(Ce).mag()/ue.sub(Ce).mag();xe._perp()._mult(Tt*(Et?-1:1))}this.addCurrentVertex(W,xe,0,0,X),this.addCurrentVertex(W,xe.mult(-1),0,0,X)}else if(Mt==="bevel"||Mt==="fakeround"){const Tt=-Math.sqrt(ut*ut-1),rt=Et?Tt:0,Jt=Et?0:Tt;if(J&&this.addCurrentVertex(W,ue,rt,Jt,X),Mt==="fakeround"){const ti=Math.round(180*At/Math.PI/20);for(let Zt=1;Zt<ti;Zt++){let Lt=Zt/ti;if(Lt!==.5){const kn=Lt-.5;Lt+=Lt*kn*(Lt-1)*((1.0904+Fe*(Fe*(3.55645-1.43519*Fe)-3.2452))*kn*kn+(.848013+Fe*(.215638*Fe-1.06021)))}const Mi=Ce.sub(ue)._mult(Lt)._add(ue)._unit()._mult(Et?-1:1);this.addHalfVertex(W,Mi.x,Mi.y,!1,Et,0,X)}}ne&&this.addCurrentVertex(W,Ce,-rt,-Jt,X)}else if(Mt==="butt")this.addCurrentVertex(W,xe,0,0,X);else if(Mt==="square"){const Tt=J?1:-1;this.addCurrentVertex(W,xe,Tt,Tt,X)}else Mt==="round"&&(J&&(this.addCurrentVertex(W,ue,0,0,X),this.addCurrentVertex(W,ue,1,1,X,!0)),ne&&(this.addCurrentVertex(W,Ce,-1,-1,X,!0),this.addCurrentVertex(W,Ce,0,0,X)));if(xt&&_e<D-1){const Tt=W.dist(ne);if(Tt>2*V){const rt=W.add(ne.sub(W)._mult(V/Tt)._round());this.updateDistance(W,rt),this.addCurrentVertex(rt,Ce,0,0,X),W=rt}}}}addCurrentVertex(t,n,o,d,_,v=!1){const x=n.y*d-n.x,T=-n.y-n.x*d;this.addHalfVertex(t,n.x+n.y*o,n.y-n.x*o,v,!1,o,_),this.addHalfVertex(t,x,T,v,!0,-d,_),this.distance>Hu/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,o,d,_,v))}addHalfVertex({x:t,y:n},o,d,_,v,x,T){const I=.5*(this.lineClips?this.scaledDistance*(Hu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(n<<1)+(v?1:0),Math.round(63*o)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),T.primitiveLength++),v?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}hasLineDasharray(t){for(const n of t){const o=n.paint.get("line-dasharray");if(o&&!o.isConstant())return!0}return!1}addLineDashDependencies(t,n,o,d){for(const _ of t){const v=_.paint.get("line-dasharray");if(!v||v.value.kind==="constant")continue;const x=_.layout.get("line-cap")==="round",T={dasharray:v.value.evaluate({zoom:o-1},n,{}),round:x},I={dasharray:v.value.evaluate({zoom:o},n,{}),round:x},D={dasharray:v.value.evaluate({zoom:o+1},n,{}),round:x},B=`${T.dasharray.join(",")},${T.round}`,V=`${I.dasharray.join(",")},${I.round}`,X=`${D.dasharray.join(",")},${D.round}`;d.dashDependencies[B]=T,d.dashDependencies[V]=I,d.dashDependencies[X]=D,n.dashes[_.id]={min:B,mid:V,max:X}}}}let Nd,Nh;zt("LineBucket",fa,{omit:["layers","patternFeatures"]});var tp={get paint(){return Nh=Nh||new hn({"line-opacity":new qt(De.paint_line["line-opacity"]),"line-color":new qt(De.paint_line["line-color"]),"line-translate":new Ot(De.paint_line["line-translate"]),"line-translate-anchor":new Ot(De.paint_line["line-translate-anchor"]),"line-width":new qt(De.paint_line["line-width"]),"line-gap-width":new qt(De.paint_line["line-gap-width"]),"line-offset":new qt(De.paint_line["line-offset"]),"line-blur":new qt(De.paint_line["line-blur"]),"line-dasharray":new cl(De.paint_line["line-dasharray"]),"line-pattern":new cl(De.paint_line["line-pattern"]),"line-gradient":new Br(De.paint_line["line-gradient"])})},get layout(){return Nd=Nd||new hn({"line-cap":new Ot(De.layout_line["line-cap"]),"line-join":new qt(De.layout_line["line-join"]),"line-miter-limit":new Ot(De.layout_line["line-miter-limit"]),"line-round-limit":new Ot(De.layout_line["line-round-limit"]),"line-sort-key":new qt(De.layout_line["line-sort-key"])})}};class Zd extends qt{possiblyEvaluate(t,n){return n=new Li(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,o,d){return n=Dt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,o,d)}}let qc;class Hl extends wa{constructor(t,n){super(t,tp,n),this.gradientVersion=0,qc||(qc=new Zd(tp.paint.properties["line-width"].specification),qc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(o){return o._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof Pl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=qc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new fa(t)}queryRadius(t){const n=t,o=Sr(Oc("line-width",this,n),Oc("line-gap-width",this,n)),d=Oc("line-offset",this,n);return o/2+Math.abs(d)+ql(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:d,transform:_,pixelsToTileUnits:v}){const x=kh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,v),T=v/2*Sr(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),I=this.paint.get("line-offset").evaluate(n,o);return I&&(d=(function(D,B){const V=[];for(let X=0;X<D.length;X++){const W=D[X],J=[];for(let ne=0;ne<W.length;ne++){const ue=W[ne-1],Ce=W[ne],_e=W[ne+1],xe=ne===0?new K(0,0):Ce.sub(ue)._unit()._perp(),Fe=ne===W.length-1?new K(0,0):_e.sub(Ce)._unit()._perp(),We=xe._add(Fe)._unit(),ut=We.x*Fe.x+We.y*Fe.y;ut!==0&&We._mult(1/ut),J.push(We._mult(B)._add(Ce))}V.push(J)}return V})(d,I*v)),(function(D,B,V){for(let X=0;X<B.length;X++){const W=B[X];if(D.length>=3){for(let J=0;J<W.length;J++)if(Lc(D,W[J]))return!0}if(Yp(D,W,V))return!0}return!1})(x,d,T)}isTileClipped(){return!0}}function Sr(r,t){return t>0?t+2*r:r}const Xl=Nt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xu=Nt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Nt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _l=Nt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Nt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Vd=Nt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ip=Nt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function om(r,t,n){return r.sections.forEach((o=>{o.text=(function(d,_,v){const x=_.layout.get("text-transform").evaluate(v,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),Ja.applyArabicShaping&&(d=Ja.applyArabicShaping(d)),d})(o.text,t,n)})),r}Nt([{name:"triangle",components:3,type:"Uint16"}]),Nt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Nt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Nt([{type:"Float32",name:"offsetX"}]),Nt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Nt([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const yl={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var or=24;const Ma=4294967296,np=1/Ma,Aa=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Gd{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,n,o=this.length){for(;this.pos<o;){const d=this.readVarint(),_=d>>3,v=this.pos;this.type=7&d,t(_,n,this),this.pos===v&&this.skip(d)}return n}readMessage(t,n){return this.readFields(t,n,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Ma;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Ma;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const n=this.buf;let o,d;return d=n[this.pos++],o=127&d,d<128?o:(d=n[this.pos++],o|=(127&d)<<7,d<128?o:(d=n[this.pos++],o|=(127&d)<<14,d<128?o:(d=n[this.pos++],o|=(127&d)<<21,d<128?o:(d=n[this.pos],o|=(15&d)<<28,(function(_,v,x){const T=x.buf;let I,D;if(D=T[x.pos++],I=(112&D)>>4,D<128||(D=T[x.pos++],I|=(127&D)<<3,D<128)||(D=T[x.pos++],I|=(127&D)<<10,D<128)||(D=T[x.pos++],I|=(127&D)<<17,D<128)||(D=T[x.pos++],I|=(127&D)<<24,D<128)||(D=T[x.pos++],I|=(1&D)<<31,D<128))return $c(_,I,v);throw new Error("Expected varint not more than 10 bytes")})(o,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&Aa?Aa.decode(this.buf.subarray(n,t)):(function(o,d,_){let v="",x=d;for(;x<_;){const T=o[x];let I,D,B,V=null,X=T>239?4:T>223?3:T>191?2:1;if(x+X>_)break;X===1?T<128&&(V=T):X===2?(I=o[x+1],(192&I)==128&&(V=(31&T)<<6|63&I,V<=127&&(V=null))):X===3?(I=o[x+1],D=o[x+2],(192&I)==128&&(192&D)==128&&(V=(15&T)<<12|(63&I)<<6|63&D,(V<=2047||V>=55296&&V<=57343)&&(V=null))):X===4&&(I=o[x+1],D=o[x+2],B=o[x+3],(192&I)==128&&(192&D)==128&&(192&B)==128&&(V=(15&T)<<18|(63&I)<<12|(63&D)<<6|63&B,(V<=65535||V>=1114112)&&(V=null))),V===null?(V=65533,X=1):V>65535&&(V-=65536,v+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),v+=String.fromCharCode(V),x+=X}return v})(this.buf,n,t)}readBytes(){const t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n}readPackedVarint(t=[],n){const o=this.readPackedEnd();for(;this.pos<o;)t.push(this.readVarint(n));return t}readPackedSVarint(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const n=7&t;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(t,n){this.writeVarint(t<<3|n)}realloc(t){let n=this.length||16;for(;n<this.pos+t;)n*=2;if(n!==this.length){const o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*np),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*np),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(n,o){let d,_;if(n>=0?(d=n%4294967296|0,_=n/4294967296|0):(d=~(-n%4294967296),_=~(-n/4294967296),4294967295^d?d=d+1|0:(d=0,_=_+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(v,x,T){T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,v>>>=7,T.buf[T.pos++]=127&v|128,T.buf[T.pos]=127&(v>>>=7)})(d,0,o),(function(v,x){const T=(7&v)<<4;x.buf[x.pos++]|=T|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))})(_,o)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const n=this.pos;this.pos=(function(d,_,v){for(let x,T,I=0;I<_.length;I++){if(x=_.charCodeAt(I),x>55295&&x<57344){if(!T){x>56319||I+1===_.length?(d[v++]=239,d[v++]=191,d[v++]=189):T=x;continue}if(x<56320){d[v++]=239,d[v++]=191,d[v++]=189,T=x;continue}x=T-55296<<10|x-56320|65536,T=null}else T&&(d[v++]=239,d[v++]=191,d[v++]=189,T=null);x<128?d[v++]=x:(x<2048?d[v++]=x>>6|192:(x<65536?d[v++]=x>>12|224:(d[v++]=x>>18|240,d[v++]=x>>12&63|128),d[v++]=x>>6&63|128),d[v++]=63&x|128)}return v})(this.buf,t,this.pos);const o=this.pos-n;o>=128&&lm(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const n=t.length;this.writeVarint(n),this.realloc(n);for(let o=0;o<n;o++)this.buf[this.pos++]=t[o]}writeRawMessage(t,n){this.pos++;const o=this.pos;t(n,this);const d=this.pos-o;d>=128&&lm(o,d,this),this.pos=o-1,this.writeVarint(d),this.pos+=d}writeMessage(t,n,o){this.writeTag(t,2),this.writeRawMessage(n,o)}writePackedVarint(t,n){n.length&&this.writeMessage(t,Yl,n)}writePackedSVarint(t,n){n.length&&this.writeMessage(t,qd,n)}writePackedBoolean(t,n){n.length&&this.writeMessage(t,cm,n)}writePackedFloat(t,n){n.length&&this.writeMessage(t,rp,n)}writePackedDouble(t,n){n.length&&this.writeMessage(t,Yu,n)}writePackedFixed32(t,n){n.length&&this.writeMessage(t,um,n)}writePackedSFixed32(t,n){n.length&&this.writeMessage(t,hm,n)}writePackedFixed64(t,n){n.length&&this.writeMessage(t,dm,n)}writePackedSFixed64(t,n){n.length&&this.writeMessage(t,$d,n)}writeBytesField(t,n){this.writeTag(t,2),this.writeBytes(n)}writeFixed32Field(t,n){this.writeTag(t,5),this.writeFixed32(n)}writeSFixed32Field(t,n){this.writeTag(t,5),this.writeSFixed32(n)}writeFixed64Field(t,n){this.writeTag(t,1),this.writeFixed64(n)}writeSFixed64Field(t,n){this.writeTag(t,1),this.writeSFixed64(n)}writeVarintField(t,n){this.writeTag(t,0),this.writeVarint(n)}writeSVarintField(t,n){this.writeTag(t,0),this.writeSVarint(n)}writeStringField(t,n){this.writeTag(t,2),this.writeString(n)}writeFloatField(t,n){this.writeTag(t,5),this.writeFloat(n)}writeDoubleField(t,n){this.writeTag(t,1),this.writeDouble(n)}writeBooleanField(t,n){this.writeVarintField(t,+n)}}function $c(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function lm(r,t,n){const o=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(o);for(let d=n.pos-1;d>=r;d--)n.buf[d+o]=n.buf[d]}function Yl(r,t){for(let n=0;n<r.length;n++)t.writeVarint(r[n])}function qd(r,t){for(let n=0;n<r.length;n++)t.writeSVarint(r[n])}function rp(r,t){for(let n=0;n<r.length;n++)t.writeFloat(r[n])}function Yu(r,t){for(let n=0;n<r.length;n++)t.writeDouble(r[n])}function cm(r,t){for(let n=0;n<r.length;n++)t.writeBoolean(r[n])}function um(r,t){for(let n=0;n<r.length;n++)t.writeFixed32(r[n])}function hm(r,t){for(let n=0;n<r.length;n++)t.writeSFixed32(r[n])}function dm(r,t){for(let n=0;n<r.length;n++)t.writeFixed64(r[n])}function $d(r,t){for(let n=0;n<r.length;n++)t.writeSFixed64(r[n])}function ap(r,t,n){r===1&&n.readMessage(dg,t)}function dg(r,t,n){if(r===3){const{id:o,bitmap:d,width:_,height:v,left:x,top:T,advance:I}=n.readMessage(fg,{});t.push({id:o,bitmap:new Fc({width:_+6,height:v+6},d),metrics:{width:_,height:v,left:x,top:T,advance:I}})}}function fg(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}function fm(r){let t=0,n=0;for(const v of r)t+=v.w*v.h,n=Math.max(n,v.w);r.sort(((v,x)=>x.h-v.h));const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let d=0,_=0;for(const v of r)for(let x=o.length-1;x>=0;x--){const T=o[x];if(!(v.w>T.w||v.h>T.h)){if(v.x=T.x,v.y=T.y,_=Math.max(_,v.y+v.h),d=Math.max(d,v.x+v.w),v.w===T.w&&v.h===T.h){const I=o.pop();I&&x<o.length&&(o[x]=I)}else v.h===T.h?(T.x+=v.w,T.w-=v.w):v.w===T.w?(T.y+=v.h,T.h-=v.h):(o.push({x:T.x+v.w,y:T.y,w:T.w-v.w,h:v.h}),T.y+=v.h,T.h-=v.h);break}}return{w:d,h:_,fill:t/(d*_)||0}}class Hd{constructor(t,{pixelRatio:n,version:o,stretchX:d,stretchY:_,content:v,textFitWidth:x,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=d,this.stretchY=_,this.content=v,this.version=o,this.textFitWidth=x,this.textFitHeight=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class sp{constructor(t,n){const o={},d={};this.haveRenderCallbacks=[];const _=[];this.addImages(t,o,_),this.addImages(n,d,_);const{w:v,h:x}=fm(_),T=new ha({width:v||1,height:x||1});for(const I in t){const D=t[I],B=o[I].paddedRect;ha.copy(D.data,T,{x:0,y:0},{x:B.x+1,y:B.y+1},D.data)}for(const I in n){const D=n[I],B=d[I].paddedRect,V=B.x+1,X=B.y+1,W=D.data.width,J=D.data.height;ha.copy(D.data,T,{x:0,y:0},{x:V,y:X},D.data),ha.copy(D.data,T,{x:0,y:J-1},{x:V,y:X-1},{width:W,height:1}),ha.copy(D.data,T,{x:0,y:0},{x:V,y:X+J},{width:W,height:1}),ha.copy(D.data,T,{x:W-1,y:0},{x:V-1,y:X},{width:1,height:J}),ha.copy(D.data,T,{x:0,y:0},{x:V+W,y:X},{width:1,height:J})}this.image=T,this.iconPositions=o,this.patternPositions=d}addImages(t,n,o){for(const d in t){const _=t[d],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};o.push(v),n[d]=new Hd(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),n)}patchUpdatedImage(t,n,o){if(!t||!n||t.version===n.version)return;t.version=n.version;const[d,_]=t.tl;o.update(n.data,void 0,{x:d,y:_})}}var rs;zt("ImagePosition",Hd),zt("ImageAtlas",sp),z.as=void 0,(rs=z.as||(z.as={}))[rs.none=0]="none",rs[rs.horizontal=1]="horizontal",rs[rs.vertical=2]="vertical",rs[rs.horizontalOnly=3]="horizontalOnly";class Wl{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,o){const d=new Wl;return d.scale=t||1,d.fontStack=n,d.verticalAlign=o||"bottom",d}static forImage(t,n){const o=new Wl;return o.imageName=t,o.verticalAlign=n||"bottom",o}}class Hc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const o=new Hc;for(let d=0;d<t.sections.length;d++){const _=t.sections[d];_.image?o.addImageSection(_):o.addTextSection(_,n)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let n="";for(let o=0;o<t.length;o++){const d=t.charCodeAt(o+1)||null,_=t.charCodeAt(o-1)||null;n+=d&&Ac(d)&&!yl[t[o+1]]||_&&Ac(_)&&!yl[t[o-1]]||!yl[t[o]]?t[o]:yl[t[o]]}return n})(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&Vh[this.text.charCodeAt(o)];o++)t++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&Vh[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const o=new Hc;return o.text=this.text.substring(t,n),o.sectionIndex=this.sectionIndex.slice(t,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,n)=>Math.max(t,this.sections[n].scale)),0)}getMaxImageSize(t){let n=0,o=0;for(let d=0;d<this.length();d++){const _=this.getSection(d);if(_.imageName){const v=t[_.imageName];if(!v)continue;const x=v.displaySize;n=Math.max(n,x[0]),o=Math.max(o,x[1])}}return{maxImageWidth:n,maxImageHeight:o}}addTextSection(t,n){this.text+=t.text,this.sections.push(Wl.forText(t.scale,t.fontStack||n,t.verticalAlign));const o=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(o)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Yt("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(Wl.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Yt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zh(r,t,n,o,d,_,v,x,T,I,D,B,V,X,W){const J=Hc.fromFeature(r,d);let ne;B===z.as.vertical&&J.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:Ce}=Ja;if(ue&&J.sections.length===1){ne=[];const Fe=ue(J.toString(),qh(J,I,_,t,o,X));for(const We of Fe){const ut=new Hc;ut.text=We,ut.sections=J.sections;for(let At=0;At<We.length;At++)ut.sectionIndex.push(0);ne.push(ut)}}else if(Ce){ne=[];const Fe=Ce(J.text,J.sectionIndex,qh(J,I,_,t,o,X));for(const We of Fe){const ut=new Hc;ut.text=We[0],ut.sectionIndex=We[1],ut.sections=J.sections,ne.push(ut)}}else ne=(function(Fe,We){const ut=[],At=Fe.text;let xt=0;for(const Et of We)ut.push(Fe.substring(xt,Et)),xt=Et;return xt<At.length&&ut.push(Fe.substring(xt,At.length)),ut})(J,qh(J,I,_,t,o,X));const _e=[],xe={positionedLines:_e,text:J.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return(function(Fe,We,ut,At,xt,Et,Ut,Mt,Tt,rt,Jt,ti){let Zt=0,Lt=0,Mi=0,kn=0;const Wn=Mt==="right"?1:Mt==="left"?0:.5,On=or/ti;let Er=0;for(const cn of xt){cn.trim();const zn=cn.getMaxScale(),Fr={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[Er]=Fr;const Mr=Fr.positionedGlyphs;let Ar=0;if(!cn.length()){Lt+=Et,++Er;continue}const as=_m(At,cn,On);for(let Hr=0;Hr<cn.length();Hr++){const cr=cn.getSection(Hr),zr=cn.getSectionIndex(Hr),Qn=cn.getCharCode(Hr),Fn=pg(Tt,Jt,Qn);let pn;if(cr.imageName){if(Fe.iconsInText=!0,cr.scale=cr.scale*On,pn=Xd(cr,Fn,zn,as,At),!pn)continue;Ar=Math.max(Ar,pn.imageOffset)}else if(pn=mg(cr,Qn,Fn,as,We,ut),!pn)continue;const{rect:ma,metrics:Kc,baselineOffset:ss}=pn;Mr.push({glyph:Qn,imageName:cr.imageName,x:Zt,y:Lt+ss+-17,vertical:Fn,scale:cr.scale,fontStack:cr.fontStack,sectionIndex:zr,metrics:Kc,rect:ma}),Fn?(Fe.verticalizable=!0,Zt+=(cr.imageName?Kc.advance:or)*cr.scale+rt):Zt+=Kc.advance*cr.scale+rt}Mr.length!==0&&(Mi=Math.max(Zt-rt,Mi),Wu(Mr,0,Mr.length-1,Wn)),Zt=0,Fr.lineOffset=Math.max(Ar,(zn-1)*or);const mr=Et*zn+Ar;Lt+=mr,kn=Math.max(mr,kn),++Er}const{horizontalAlign:lr,verticalAlign:Kn}=cp(Ut);(function(cn,zn,Fr,Mr,Ar,as,mr,Hr,cr){const zr=(zn-Fr)*Ar;let Qn=0;Qn=as!==mr?-Hr*Mr- -17:-Mr*cr*mr+.5*mr;for(const Fn of cn)for(const pn of Fn.positionedGlyphs)pn.x+=zr,pn.y+=Qn})(Fe.positionedLines,Wn,lr,Kn,Mi,kn,Et,Lt,xt.length),Fe.top+=-Kn*Lt,Fe.bottom=Fe.top+Lt,Fe.left+=-lr*Mi,Fe.right=Fe.left+Mi})(xe,t,n,o,ne,v,x,T,B,I,V,W),!(function(Fe){for(const We of Fe)if(We.positionedGlyphs.length!==0)return!1;return!0})(_e)&&xe}const Vh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mm={40:!0};function op(r,t,n,o,d,_){if(t.imageName){const v=o[t.imageName];return v?v.displaySize[0]*t.scale*or/_+d:0}{const v=n[t.fontStack],x=v&&v[r];return x?x.metrics.advance*t.scale+d:0}}function Gh(r,t,n,o){const d=Math.pow(r-t,2);return o?r<t?d/2:2*d:d+Math.abs(n)*n}function gm(r,t,n){let o=0;return r===10&&(o-=1e4),n&&(o+=150),r!==40&&r!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function lp(r,t,n,o,d,_){let v=null,x=Gh(t,n,d,_);for(const T of o){const I=Gh(t-T.x,n,d,_)+T.badness;I<=x&&(v=T,x=I)}return{index:r,x:t,priorBreak:v,badness:x}}function on(r){return r?on(r.priorBreak).concat(r.index):[]}function qh(r,t,n,o,d,_){if(!r)return[];const v=[],x=(function(B,V,X,W,J,ne){let ue=0;for(let Ce=0;Ce<B.length();Ce++){const _e=B.getSection(Ce);ue+=op(B.getCharCode(Ce),_e,W,J,V,ne)}return ue/Math.max(1,Math.ceil(ue/X))})(r,t,n,o,d,_),T=r.text.indexOf("")>=0;let I=0;for(let B=0;B<r.length();B++){const V=r.getSection(B),X=r.getCharCode(B);if(Vh[X]||(I+=op(X,V,o,d,t,_)),B<r.length()-1){const W=!((D=X)<11904)&&(!!hi["CJK Compatibility Forms"](D)||!!hi["CJK Compatibility"](D)||!!hi["CJK Strokes"](D)||!!hi["CJK Symbols and Punctuation"](D)||!!hi["Enclosed CJK Letters and Months"](D)||!!hi["Halfwidth and Fullwidth Forms"](D)||!!hi["Ideographic Description Characters"](D)||!!hi["Vertical Forms"](D)||al.test(String.fromCodePoint(D)));(pm[X]||W||V.imageName||B!==r.length()-2&&mm[r.getCharCode(B+1)])&&v.push(lp(B+1,I,x,v,gm(X,r.getCharCode(B+1),W&&T),!1))}}var D;return on(lp(r.length(),I,x,v,0,!0))}function cp(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function _m(r,t,n){const o=t.getMaxScale()*or,{maxImageWidth:d,maxImageHeight:_}=t.getMaxImageSize(r),v=Math.max(o,_*n);return{verticalLineContentWidth:Math.max(o,d*n),horizontalLineContentHeight:v}}function ym(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function pg(r,t,n){return!(r===z.as.horizontal||!t&&!sl(n)||t&&(Vh[n]||(o=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function mg(r,t,n,o,d,_){const v=_[r.fontStack],x=(function(I,D,B,V){if(I&&I.rect)return I;const X=D[B.fontStack],W=X&&X[V];return W?{rect:null,metrics:W.metrics}:null})(v&&v[t],d,r,t);if(x===null)return null;let T;if(n)T=o.verticalLineContentWidth-r.scale*or;else{const I=ym(r.verticalAlign);T=(o.horizontalLineContentHeight-r.scale*or)*I}return{rect:x.rect,metrics:x.metrics,baselineOffset:T}}function Xd(r,t,n,o,d){const _=d[r.imageName];if(!_)return null;const v=_.paddedRect,x=_.displaySize,T={width:x[0],height:x[1],left:1,top:-3,advance:t?x[1]:x[0]};let I;if(t)I=o.verticalLineContentWidth-x[1]*r.scale;else{const D=ym(r.verticalAlign);I=(o.horizontalLineContentHeight-x[1]*r.scale)*D}return{rect:v,metrics:T,baselineOffset:I,imageOffset:(t?x[0]:x[1])*r.scale-or*n}}function Wu(r,t,n,o){if(o===0)return;const d=r[n],_=(r[n].x+d.metrics.advance*d.scale)*o;for(let v=t;v<=n;v++)r[v].x-=_}function up(r,t,n){const{horizontalAlign:o,verticalAlign:d}=cp(n),_=t[0]-r.displaySize[0]*o,v=t[1]-r.displaySize[1]*d;return{image:r,top:v,bottom:v+r.displaySize[1],left:_,right:_+r.displaySize[0]}}function $h(r){var t,n;let o=r.left,d=r.top,_=r.right-o,v=r.bottom-d;const x=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",I=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(T==="proportional"){if(x==="stretchOnly"&&_/v<I||x==="proportional"){const D=Math.ceil(v*I);o*=D/_,_=D}}else if(x==="proportional"&&T==="stretchOnly"&&I!==0&&_/v>I){const D=Math.ceil(_/I);d*=D/v,v=D}return{x1:o,y1:d,x2:o+_,y2:d+v}}function Yd(r,t,n,o,d,_){const v=r.image;let x;if(v.content){const ne=v.content,ue=v.pixelRatio||1;x=[ne[0]/ue,ne[1]/ue,v.displaySize[0]-ne[2]/ue,v.displaySize[1]-ne[3]/ue]}const T=t.left*_,I=t.right*_;let D,B,V,X;n==="width"||n==="both"?(X=d[0]+T-o[3],B=d[0]+I+o[1]):(X=d[0]+(T+I-v.displaySize[0])/2,B=X+v.displaySize[0]);const W=t.top*_,J=t.bottom*_;return n==="height"||n==="both"?(D=d[1]+W-o[0],V=d[1]+J+o[2]):(D=d[1]+(W+J-v.displaySize[1])/2,V=D+v.displaySize[1]),{image:v,top:D,right:B,bottom:V,left:X,collisionPadding:x}}const pa=128,aa=32640;function Ku(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Li(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:d}=n;let _=0;for(;_<o.length&&o[_]<=r;)_++;_=Math.max(0,_-1);let v=_;for(;v<o.length&&o[v]<r+1;)v++;v=Math.min(o.length-1,v);const x=o[_],T=o[v];return n.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:T,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:T,minSize:n.evaluate(new Li(x)),maxSize:n.evaluate(new Li(T)),interpolationType:d}}}function hp(r,t,n){let o="never";const d=r.get(t);return d?o=d:r.get(n)&&(o="always"),o}const vm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hh(r,t,n,o,d,_,v,x,T,I,D,B,V){const X=x?Math.min(aa,Math.round(x[0])):0,W=x?Math.min(aa,Math.round(x[1])):0;r.emplaceBack(t,n,Math.round(32*o),Math.round(32*d),_,v,(X<<1)+(T?1:0),W,16*I,16*D,256*B,256*V)}function Wd(r,t,n){r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n)}function bm(r){for(const t of r.sections)if(Ch(t.text))return!0;return!1}class dp{constructor(t){this.layoutVertexArray=new Oe,this.indexArray=new nt,this.programConfigurations=t,this.segments=new mi,this.dynamicLayoutVertexArray=new Ne,this.opacityVertexArray=new $e,this.hasVisibleVertices=!1,this.placedSymbolArray=new k}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,o,d){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Xu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,vm,!0),this.opacityVertexBuffer.itemSize=1),(o||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zt("SymbolBuffers",dp);class Xh{constructor(t,n,o){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new o,this.segments=new mi,this.collisionVertexArray=new vt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,_l.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zt("CollisionBuffers",Xh);class Xc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=Ti(globalThis)?Math.min(t.overscaling,128):t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ku(this.zoom,n["text-size"]),this.iconSizeData=Ku(this.zoom,n["icon-size"]);const o=this.layers[0].layout,d=o.get("symbol-sort-key"),_=o.get("symbol-z-order");this.canOverlap=hp(o,"text-overlap","text-allow-overlap")!=="never"||hp(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map((v=>z.as[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=t.sourceID}createArrays(){this.text=new dp(new Io(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new dp(new Io(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new j,this.lineVertexArray=new Y,this.symbolInstances=new N,this.textAnchorOffsets=new re}calculateGlyphDependencies(t,n,o,d,_){for(let v=0;v<t.length;v++)if(n[t.charCodeAt(v)]=!0,(o||d)&&_){const x=yl[t.charAt(v)];x&&(n[x.charCodeAt(0)]=!0)}}populate(t,n,o){const d=this.layers[0],_=d.layout,v=_.get("text-font"),x=_.get("text-field"),T=_.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof dr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,B=_.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const V=n.iconDependencies,X=n.glyphDependencies,W=n.availableImages,J=new Li(this.zoom);for(const{feature:ne,id:ue,index:Ce,sourceLayerIndex:_e}of t){const xe=d._featureFilter.needGeometry,Fe=eo(ne,xe);if(!d._featureFilter.filter(J,Fe,o))continue;let We,ut;if(xe||(Fe.geometry=ia(ne)),I){const xt=d.getValueAndResolveTokens("text-field",Fe,o,W),Et=dr.factory(xt),Ut=this.hasRTLText=this.hasRTLText||bm(Et);(!Ut||Ja.getRTLTextPluginStatus()==="unavailable"||Ut&&Ja.isParsed())&&(We=om(Et,d,Fe))}if(D){const xt=d.getValueAndResolveTokens("icon-image",Fe,o,W);ut=xt instanceof Dr?xt:Dr.fromString(xt)}if(!We&&!ut)continue;const At=this.sortFeaturesByKey?B.evaluate(Fe,{},o):void 0;if(this.features.push({id:ue,text:We,icon:ut,index:Ce,sourceLayerIndex:_e,geometry:Fe.geometry,properties:ne.properties,type:Vc.types[ne.type],sortKey:At}),ut&&(V[ut.name]=!0),We){const xt=v.evaluate(Fe,{},o).join(","),Et=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(z.as.vertical)>=0;for(const Ut of We.sections)if(Ut.image)V[Ut.image.name]=!0;else{const Mt=Iu(We.toString()),Tt=Ut.fontStack||xt,rt=X[Tt]=X[Tt]||{};this.calculateGlyphDependencies(Ut.text,rt,Et,this.allowVerticalPlacement,Mt)}}}_.get("symbol-placement")==="line"&&(this.features=(function(ne){const ue={},Ce={},_e=[];let xe=0;function Fe(xt){_e.push(ne[xt]),xe++}function We(xt,Et,Ut){const Mt=Ce[xt];return delete Ce[xt],Ce[Et]=Mt,_e[Mt].geometry[0].pop(),_e[Mt].geometry[0]=_e[Mt].geometry[0].concat(Ut[0]),Mt}function ut(xt,Et,Ut){const Mt=ue[Et];return delete ue[Et],ue[xt]=Mt,_e[Mt].geometry[0].shift(),_e[Mt].geometry[0]=Ut[0].concat(_e[Mt].geometry[0]),Mt}function At(xt,Et,Ut){const Mt=Ut?Et[0][Et[0].length-1]:Et[0][0];return`${xt}:${Mt.x}:${Mt.y}`}for(let xt=0;xt<ne.length;xt++){const Et=ne[xt],Ut=Et.geometry,Mt=Et.text?Et.text.toString():null;if(!Mt){Fe(xt);continue}const Tt=At(Mt,Ut),rt=At(Mt,Ut,!0);if(Tt in Ce&&rt in ue&&Ce[Tt]!==ue[rt]){const Jt=ut(Tt,rt,Ut),ti=We(Tt,rt,_e[Jt].geometry);delete ue[Tt],delete Ce[rt],Ce[At(Mt,_e[ti].geometry,!0)]=ti,_e[Jt].geometry=null}else Tt in Ce?We(Tt,rt,Ut):rt in ue?ut(Tt,rt,Ut):(Fe(xt),ue[Tt]=xe-1,Ce[rt]=xe-1)}return _e.filter((xt=>xt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ne,ue)=>ne.sortKey-ue.sortKey))}update(t,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:o}),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:o}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const o=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(n[t.segment+1]),_=t.dist(n[t.segment]);const v={};for(let x=t.segment+1;x<n.length;x++)v[x]={x:n[x].x,y:n[x].y,tileUnitDistanceFromAnchor:d},x<n.length-1&&(d+=n[x+1].dist(n[x]));for(let x=t.segment||0;x>=0;x--)v[x]={x:n[x].x,y:n[x].y,tileUnitDistanceFromAnchor:_},x>0&&(_+=n[x-1].dist(n[x]));for(let x=0;x<n.length;x++){const T=v[x];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,n,o,d,_,v,x,T,I,D,B,V){const X=t.indexArray,W=t.layoutVertexArray,J=t.segments.prepareSegment(4*n.length,W,X,this.canOverlap?v.sortKey:void 0),ne=this.glyphOffsetArray.length,ue=J.vertexLength,Ce=this.allowVerticalPlacement&&x===z.as.vertical?Math.PI/2:0,_e=v.text&&v.text.sections;for(let xe=0;xe<n.length;xe++){const{tl:Fe,tr:We,bl:ut,br:At,tex:xt,pixelOffsetTL:Et,pixelOffsetBR:Ut,minFontScaleX:Mt,minFontScaleY:Tt,glyphOffset:rt,isSDF:Jt,sectionIndex:ti}=n[xe],Zt=J.vertexLength,Lt=rt[1];Hh(W,T.x,T.y,Fe.x,Lt+Fe.y,xt.x,xt.y,o,Jt,Et.x,Et.y,Mt,Tt),Hh(W,T.x,T.y,We.x,Lt+We.y,xt.x+xt.w,xt.y,o,Jt,Ut.x,Et.y,Mt,Tt),Hh(W,T.x,T.y,ut.x,Lt+ut.y,xt.x,xt.y+xt.h,o,Jt,Et.x,Ut.y,Mt,Tt),Hh(W,T.x,T.y,At.x,Lt+At.y,xt.x+xt.w,xt.y+xt.h,o,Jt,Ut.x,Ut.y,Mt,Tt),Wd(t.dynamicLayoutVertexArray,T,Ce),X.emplaceBack(Zt,Zt+2,Zt+1),X.emplaceBack(Zt+1,Zt+2,Zt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rt[0]),xe!==n.length-1&&ti===n[xe+1].sectionIndex||t.programConfigurations.populatePaintArrays(W.length,v,v.index,{imagePositions:{},canonical:V,formattedSection:_e&&_e[ti]})}t.placedSymbolArray.emplaceBack(T.x,T.y,ne,this.glyphOffsetArray.length-ne,ue,I,D,T.segment,o?o[0]:0,o?o[1]:0,d[0],d[1],x,0,!1,0,B)}_addCollisionDebugVertex(t,n,o,d,_,v){return n.emplaceBack(0,0),t.emplaceBack(o.x,o.y,d,_,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(t,n,o,d,_,v,x){const T=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),I=T.vertexLength,D=_.layoutVertexArray,B=_.collisionVertexArray,V=x.anchorX,X=x.anchorY;this._addCollisionDebugVertex(D,B,v,V,X,new K(t,n)),this._addCollisionDebugVertex(D,B,v,V,X,new K(o,n)),this._addCollisionDebugVertex(D,B,v,V,X,new K(o,d)),this._addCollisionDebugVertex(D,B,v,V,X,new K(t,d)),T.vertexLength+=4;const W=_.indexArray;W.emplaceBack(I,I+1),W.emplaceBack(I+1,I+2),W.emplaceBack(I+2,I+3),W.emplaceBack(I+3,I),T.primitiveLength+=4}addDebugCollisionBoxes(t,n,o,d){for(let _=t;_<n;_++){const v=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,d?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xh(yt,Vd.members,kt),this.iconCollisionBox=new Xh(yt,Vd.members,kt);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,o,d,_,v,x,T,I){const D={};for(let B=n;B<o;B++){const V=t.get(B);D.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.textFeatureIndex=V.featureIndex;break}for(let B=d;B<_;B++){const V=t.get(B);D.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.verticalTextFeatureIndex=V.featureIndex;break}for(let B=v;B<x;B++){const V=t.get(B);D.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.iconFeatureIndex=V.featureIndex;break}for(let B=T;B<I;B++){const V=t.get(B);D.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},D.verticalIconFeatureIndex=V.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const o=t.placedSymbolArray.get(n),d=o.vertexStartIndex+4*o.numGlyphs;for(let _=o.vertexStartIndex;_<d;_+=4)t.indexArray.emplaceBack(_,_+2,_+1),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),o=Math.cos(t),d=[],_=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);const T=this.symbolInstances.get(x);d.push(0|Math.round(n*T.anchorX+o*T.anchorY)),_.push(T.featureIndex)}return v.sort(((x,T)=>d[x]-d[T]||_[T]-_[x])),v}addToSortKeyRanges(t,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(((d,_,v)=>{d>=0&&v.indexOf(d)===_&&this.addIndicesForPlacedSymbol(this.text,d)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fp,xm;zt("SymbolBucket",Xc,{omit:["layers","collisionBoxArray","features","compareText"]}),Xc.MAX_GLYPHS=65535,Xc.addDynamicAttributes=Wd;var Yh={get paint(){return xm=xm||new hn({"icon-opacity":new qt(De.paint_symbol["icon-opacity"]),"icon-color":new qt(De.paint_symbol["icon-color"]),"icon-halo-color":new qt(De.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(De.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(De.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(De.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(De.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(De.paint_symbol["text-opacity"]),"text-color":new qt(De.paint_symbol["text-color"],{runtimeType:$a,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new qt(De.paint_symbol["text-halo-color"]),"text-halo-width":new qt(De.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(De.paint_symbol["text-halo-blur"]),"text-translate":new Ot(De.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(De.paint_symbol["text-translate-anchor"])})},get layout(){return fp=fp||new hn({"symbol-placement":new Ot(De.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(De.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(De.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(De.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(De.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ot(De.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ot(De.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ot(De.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(De.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(De.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(De.layout_symbol["icon-size"]),"icon-text-fit":new Ot(De.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ot(De.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(De.layout_symbol["icon-image"]),"icon-rotate":new qt(De.layout_symbol["icon-rotate"]),"icon-padding":new qt(De.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(De.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(De.layout_symbol["icon-offset"]),"icon-anchor":new qt(De.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(De.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(De.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(De.layout_symbol["text-rotation-alignment"]),"text-field":new qt(De.layout_symbol["text-field"]),"text-font":new qt(De.layout_symbol["text-font"]),"text-size":new qt(De.layout_symbol["text-size"]),"text-max-width":new qt(De.layout_symbol["text-max-width"]),"text-line-height":new Ot(De.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(De.layout_symbol["text-letter-spacing"]),"text-justify":new qt(De.layout_symbol["text-justify"]),"text-radial-offset":new qt(De.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(De.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new qt(De.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new qt(De.layout_symbol["text-anchor"]),"text-max-angle":new Ot(De.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(De.layout_symbol["text-writing-mode"]),"text-rotate":new qt(De.layout_symbol["text-rotate"]),"text-padding":new Ot(De.layout_symbol["text-padding"]),"text-keep-upright":new Ot(De.layout_symbol["text-keep-upright"]),"text-transform":new qt(De.layout_symbol["text-transform"]),"text-offset":new qt(De.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(De.layout_symbol["text-allow-overlap"]),"text-overlap":new Ot(De.layout_symbol["text-overlap"]),"text-ignore-placement":new Ot(De.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(De.layout_symbol["text-optional"])})}};class Kd{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Ni,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zt("FormatSectionOverride",Kd,{omit:["defaultValue"]});class Qd extends wa{constructor(t,n){super(t,Yh,n)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const d=[];for(const _ of o)d.indexOf(_)<0&&d.push(_);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,o,d){const _=this.layout.get(t).evaluate(n,{},o,d),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Ol(v.value)||!_?_:(function(x,T){return T.replace(/{([^{}]+)}/g,((I,D)=>x&&D in x?String(x[D]):""))})(n.properties,_)}createBucket(t){return new Xc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Yh.paint.overridableProperties){if(!Qd.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),o=new Kd(n),d=new Tu(o,n.property.specification);let _=null;_=n.value.kind==="constant"||n.value.kind==="source"?new Ur("source",d):new vo("composite",d,n.value.zoomStops),this.paint._values[t]=new Fa(n.property,_,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&Qd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const o=t.get("text-field"),d=Yh.paint.properties[n];let _=!1;const v=x=>{for(const T of x)if(d.overrides&&d.overrides.hasOverride(T))return void(_=!0)};if(o.value.kind==="constant"&&o.value.value instanceof dr)v(o.value.value.sections);else if(o.value.kind==="source"||o.value.kind==="composite"){const x=I=>{_||(I instanceof Xa&&Tn(I.value)===za?v(I.value.sections):I instanceof hu?v(I.sections):I.eachChild(x))},T=o.value;T._styleExpression&&x(T._styleExpression.expression)}return _}}let wm;var Wh={get paint(){return wm=wm||new hn({"background-color":new Ot(De.paint_background["background-color"]),"background-pattern":new ku(De.paint_background["background-pattern"]),"background-opacity":new Ot(De.paint_background["background-opacity"])})}};class gg extends wa{constructor(t,n){super(t,Wh,n)}}class Sm extends wa{constructor(t,n){super(t,{},n),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Oi{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const pp={once:!0},Qu=63710088e-1;class ko{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ko(Rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,o=this.lat*n,d=t.lat*n,_=Math.sin(o)*Math.sin(d)+Math.cos(o)*Math.cos(d)*Math.cos((t.lng-this.lng)*n);return Qu*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof ko)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ko(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ko(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const mp=2*Math.PI*Qu;function Jd(r){return mp*Math.cos(r*Math.PI/180)}function Ju(r){return(180+r)/360}function Kh(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Tm(r,t){return r/Jd(t)}function gp(r){return 360*r-180}function ef(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Em(r,t){return r*Jd(ef(t))}class eh{constructor(t,n,o=0){this.x=+t,this.y=+n,this.z=+o}static fromLngLat(t,n=0){const o=ko.convert(t);return new eh(Ju(o.lng),Kh(o.lat),Tm(n,o.lat))}toLngLat(){return new ko(gp(this.x),ef(this.y))}toAltitude(){return Em(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/mp*(t=ef(this.y),1/Math.cos(t*Math.PI/180));var t}}function _p(r,t,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[r*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class ln{constructor(t,n,o){if(!(function(d,_,v){return!(d<0||d>25||v<0||v>=Math.pow(2,d)||_<0||_>=Math.pow(2,d))})(t,n,o))throw new Error(`x=${n}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=o,this.key=th(0,t,t,n,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,o){const d=(v=this.y,x=this.z,T=_p(256*(_=this.x),256*(v=Math.pow(2,x)-v-1),x),I=_p(256*(_+1),256*(v+1),x),T[0]+","+T[1]+","+I[0]+","+I[1]);var _,v,x,T,I;const D=(function(B,V,X){let W,J="";for(let ne=B;ne>0;ne--)W=1<<ne-1,J+=(V&W?1:0)+(X&W?2:0);return J})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new K((t.x*n-this.x)*dt,(t.y*n-this.y)*dt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tf{constructor(t,n){this.wrap=t,this.canonical=n,this.key=th(t,n.z,n.z,n.x,n.y)}}class fn{constructor(t,n,o,d,_){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=n,this.canonical=new ln(o,+d,+_),this.key=th(n,t,o,d,_)}clone(){return new fn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new fn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fn(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?th(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):th(this.wrap*+n,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-t.canonical.z;return!(n<0)&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new fn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,d=2*this.canonical.y;return[new fn(n,this.wrap,n,o,d),new fn(n,this.wrap,n,o+1,d),new fn(n,this.wrap,n,o,d+1),new fn(n,this.wrap,n,o+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new fn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new fn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new eh(t.x-this.wrap,t.y))}}function th(r,t,n,o,d){(r*=2)<0&&(r=-1*r-1);const _=1<<n;return(_*_*r+_*d+o).toString(36)+n.toString(36)+t.toString(36)}function ih(r,t){return t?r.properties[t]:r.id}zt("CanonicalTileID",ln),zt("OverscaledTileID",fn,{omit:["terrainRttPosMatrix32f"]});class Yc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new Yc;return n.extend(t(new K(this.minX,this.minY))),n.extend(t(new K(this.maxX,this.minY))),n.extend(t(new K(this.minX,this.maxY))),n.extend(t(new K(this.maxX,this.maxY))),n}static fromPoints(t){const n=new Yc;for(const o of t)n.extend(o);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class nf{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const o=t[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class rf{constructor(t,n,o,d,_){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=o,t._y=d,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class Qh{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new _s(dt,16,0),this.grid3D=new _s(dt,16,0),this.featureIndexArray=new le,this.promoteId=n}insert(t,n,o,d,_,v){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,d,_);const T=v?this.grid3D:this.grid;for(let I=0;I<n.length;I++){const D=n[I],B=[1/0,1/0,-1/0,-1/0];for(let V=0;V<D.length;V++){const X=D[V];B[0]=Math.min(B[0],X.x),B[1]=Math.min(B[1],X.y),B[2]=Math.max(B[2],X.x),B[3]=Math.max(B[3],X.y)}B[0]<dt&&B[1]<dt&&B[2]>=0&&B[3]>=0&&T.insert(x,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new sm(new Gd(this.rawTileData)).layers,this.sourceLayerCoder=new nf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,o,d){this.loadVTLayers();const _=t.params,v=dt/t.tileSize/t.scale,x=ua(_.filter,_.globalState),T=t.queryGeometry,I=t.queryPadding*v,D=Yc.fromPoints(T),B=this.grid.query(D.minX-I,D.minY-I,D.maxX+I,D.maxY+I),V=Yc.fromPoints(t.cameraQueryGeometry).expandBy(I),X=this.grid3D.query(V.minX,V.minY,V.maxX,V.maxY,((ne,ue,Ce,_e)=>(function(xe,Fe,We,ut,At){for(const Et of xe)if(Fe<=Et.x&&We<=Et.y&&ut>=Et.x&&At>=Et.y)return!0;const xt=[new K(Fe,We),new K(Fe,At),new K(ut,At),new K(ut,We)];if(xe.length>2){for(const Et of xt)if(Lc(xe,Et))return!0}for(let Et=0;Et<xe.length-1;Et++)if(Wp(xe[Et],xe[Et+1],xt))return!0;return!1})(t.cameraQueryGeometry,ne-I,ue-I,Ce+I,_e+I)));for(const ne of X)B.push(ne);B.sort(Mm);const W={};let J;for(let ne=0;ne<B.length;ne++){const ue=B[ne];if(ue===J)continue;J=ue;const Ce=this.featureIndexArray.get(ue);let _e=null;this.loadMatchingFeature(W,Ce.bucketIndex,Ce.sourceLayerIndex,Ce.featureIndex,x,_.layers,_.availableImages,n,o,d,((xe,Fe,We)=>(_e||(_e=ia(xe)),Fe.queryIntersectsFeature({queryGeometry:T,feature:xe,featureState:We,geometry:_e,zoom:this.z,transform:t.transform,pixelsToTileUnits:v,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return W}loadMatchingFeature(t,n,o,d,_,v,x,T,I,D,B){const V=this.bucketLayerIDs[n];if(v&&!V.some((ne=>v.has(ne))))return;const X=this.sourceLayerCoder.decode(o),W=this.vtLayers[X].feature(d);if(_.needGeometry){const ne=eo(W,!0);if(!_.filter(new Li(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!_.filter(new Li(this.tileID.overscaledZ),W))return;const J=this.getId(W,X);for(let ne=0;ne<V.length;ne++){const ue=V[ne];if(v&&!v.has(ue))continue;const Ce=T[ue];if(!Ce)continue;let _e={};J&&D&&(_e=D.getState(Ce.sourceLayer||"_geojsonTileLayer",J));const xe=Dt({},I[ue]);xe.paint=yp(xe.paint,Ce.paint,W,_e,x),xe.layout=yp(xe.layout,Ce.layout,W,_e,x);const Fe=!B||B(W,Ce,_e);if(!Fe)continue;const We=new rf(W,this.z,this.x,this.y,J);We.layer=xe;let ut=t[ue];ut===void 0&&(ut=t[ue]=[]),ut.push({featureIndex:d,feature:We,intersectionZ:Fe})}}lookupSymbolFeatures(t,n,o,d,_,v,x,T){const I={};this.loadVTLayers();const D=ua(_.filterSpec,_.globalState);for(const B of t)this.loadMatchingFeature(I,o,d,B,D,v,x,T,n);return I}hasLayer(t){for(const n of this.bucketLayerIDs)for(const o of n)if(t===o)return!0;return!1}getId(t,n){var o;let d=t.id;return this.promoteId&&(d=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(d=Number(t.properties.cluster_id))),d}}function yp(r,t,n,o,d){return bi(r,((_,v)=>{const x=t instanceof ja?t.get(v):null;return x&&x.evaluate?x.evaluate(n,o,d):x}))}function Mm(r,t){return t-r}function af(r,t,n,o,d){const _=[];for(let v=0;v<r.length;v++){const x=r[v];let T;for(let I=0;I<x.length-1;I++){let D=x[I],B=x[I+1];D.x<t&&B.x<t||(D.x<t?D=new K(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<t&&(B=new K(t,D.y+(t-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<n&&B.y<n||(D.y<n?D=new K(D.x+(n-D.y)/(B.y-D.y)*(B.x-D.x),n)._round():B.y<n&&(B=new K(D.x+(n-D.y)/(B.y-D.y)*(B.x-D.x),n)._round()),D.x>=o&&B.x>=o||(D.x>=o?D=new K(o,D.y+(o-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=o&&(B=new K(o,D.y+(o-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=d&&B.y>=d||(D.y>=d?D=new K(D.x+(d-D.y)/(B.y-D.y)*(B.x-D.x),d)._round():B.y>=d&&(B=new K(D.x+(d-D.y)/(B.y-D.y)*(B.x-D.x),d)._round()),T&&D.equals(T[T.length-1])||(T=[D],_.push(T)),T.push(B)))))}}return _}zt("FeatureIndex",Qh,{omit:["rawTileData","sourceLayerCoder"]});class Ro extends K{constructor(t,n,o,d){super(t,n),this.angle=o,d!==void 0&&(this.segment=d)}clone(){return new Ro(this.x,this.y,this.angle,this.segment)}}function Am(r,t,n,o,d){if(t.segment===void 0||n===0)return!0;let _=t,v=t.segment+1,x=0;for(;x>-n/2;){if(v--,v<0)return!1;x-=r[v].dist(_),_=r[v]}x+=r[v].dist(r[v+1]),v++;const T=[];let I=0;for(;x<n/2;){const D=r[v],B=r[v+1];if(!B)return!1;let V=r[v-1].angleTo(D)-D.angleTo(B);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:x,angleDelta:V}),I+=V;x-T[0].distance>o;)I-=T.shift().angleDelta;if(I>d)return!1;v++,x+=D.dist(B)}return!0}function vp(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function zm(r,t,n){return r?.6*t*n:0}function bp(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function _g(r,t,n,o,d,_){const v=zm(n,d,_),x=bp(n,o)*_;let T=0;const I=vp(r)/2;for(let D=0;D<r.length-1;D++){const B=r[D],V=r[D+1],X=B.dist(V);if(T+X>I){const W=(I-T)/X,J=ka.number(B.x,V.x,W),ne=ka.number(B.y,V.y,W),ue=new Ro(J,ne,V.angleTo(B),D);return ue._round(),!v||Am(r,ue,x,v,t)?ue:void 0}T+=X}}function yg(r,t,n,o,d,_,v,x,T){const I=zm(o,_,v),D=bp(o,d),B=D*v,V=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return t-B<t/4&&(t=B+t/4),vl(r,V?t/2*x%t:(D/2+2*_)*v*x%t,t,I,n,B,V,!1,T)}function vl(r,t,n,o,d,_,v,x,T){const I=_/2,D=vp(r);let B=0,V=t-n,X=[];for(let W=0;W<r.length-1;W++){const J=r[W],ne=r[W+1],ue=J.dist(ne),Ce=ne.angleTo(J);for(;V+n<B+ue;){V+=n;const _e=(V-B)/ue,xe=ka.number(J.x,ne.x,_e),Fe=ka.number(J.y,ne.y,_e);if(xe>=0&&xe<T&&Fe>=0&&Fe<T&&V-I>=0&&V+I<=D){const We=new Ro(xe,Fe,Ce,W);We._round(),o&&!Am(r,We,_,o,d)||X.push(We)}}B+=ue}return x||X.length||v||(X=vl(r,B/2,n,o,d,_,v,!0,T)),X}function xp(r,t,n,o){const d=[],_=r.image,v=_.pixelRatio,x=_.paddedRect.w-2,T=_.paddedRect.h-2;let I={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const D=_.stretchX||[[0,x]],B=_.stretchY||[[0,T]],V=(rt,Jt)=>rt+Jt[1]-Jt[0],X=D.reduce(V,0),W=B.reduce(V,0),J=x-X,ne=T-W;let ue=0,Ce=X,_e=0,xe=W,Fe=0,We=J,ut=0,At=ne;if(_.content&&o){const rt=_.content,Jt=rt[2]-rt[0],ti=rt[3]-rt[1];(_.textFitWidth||_.textFitHeight)&&(I=$h(r)),ue=Jh(D,0,rt[0]),_e=Jh(B,0,rt[1]),Ce=Jh(D,rt[0],rt[2]),xe=Jh(B,rt[1],rt[3]),Fe=rt[0]-ue,ut=rt[1]-_e,We=Jt-Ce,At=ti-xe}const xt=I.x1,Et=I.y1,Ut=I.x2-xt,Mt=I.y2-Et,Tt=(rt,Jt,ti,Zt)=>{const Lt=of(rt.stretch-ue,Ce,Ut,xt),Mi=lf(rt.fixed-Fe,We,rt.stretch,X),kn=of(Jt.stretch-_e,xe,Mt,Et),Wn=lf(Jt.fixed-ut,At,Jt.stretch,W),On=of(ti.stretch-ue,Ce,Ut,xt),Er=lf(ti.fixed-Fe,We,ti.stretch,X),lr=of(Zt.stretch-_e,xe,Mt,Et),Kn=lf(Zt.fixed-ut,At,Zt.stretch,W),cn=new K(Lt,kn),zn=new K(On,kn),Fr=new K(On,lr),Mr=new K(Lt,lr),Ar=new K(Mi/v,Wn/v),as=new K(Er/v,Kn/v),mr=t*Math.PI/180;if(mr){const zr=Math.sin(mr),Qn=Math.cos(mr),Fn=[Qn,-zr,zr,Qn];cn._matMult(Fn),zn._matMult(Fn),Mr._matMult(Fn),Fr._matMult(Fn)}const Hr=rt.stretch+rt.fixed,cr=Jt.stretch+Jt.fixed;return{tl:cn,tr:zn,bl:Mr,br:Fr,tex:{x:_.paddedRect.x+1+Hr,y:_.paddedRect.y+1+cr,w:ti.stretch+ti.fixed-Hr,h:Zt.stretch+Zt.fixed-cr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ar,pixelOffsetBR:as,minFontScaleX:We/v/Ut,minFontScaleY:At/v/Mt,isSDF:n}};if(o&&(_.stretchX||_.stretchY)){const rt=sf(D,J,X),Jt=sf(B,ne,W);for(let ti=0;ti<rt.length-1;ti++){const Zt=rt[ti],Lt=rt[ti+1];for(let Mi=0;Mi<Jt.length-1;Mi++)d.push(Tt(Zt,Jt[Mi],Lt,Jt[Mi+1]))}}else d.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:T+1}));return d}function Jh(r,t,n){let o=0;for(const d of r)o+=Math.max(t,Math.min(n,d[1]))-Math.max(t,Math.min(n,d[0]));return o}function sf(r,t,n){const o=[{fixed:-1,stretch:0}];for(const[d,_]of r){const v=o[o.length-1];o.push({fixed:d-v.stretch,stretch:v.stretch}),o.push({fixed:d-v.stretch,stretch:v.stretch+(_-d)})}return o.push({fixed:t+1,stretch:n}),o}function of(r,t,n,o){return r/t*n+o}function lf(r,t,n,o){return r-t*n/o}zt("Anchor",Ro);class ed{constructor(t,n,o,d,_,v,x,T,I,D){var B;if(this.boxStartIndex=t.length,I){let V=v.top,X=v.bottom;const W=v.collisionPadding;W&&(V-=W[1],X+=W[3]);let J=X-V;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const V=!((B=v.image)===null||B===void 0)&&B.content&&(v.image.textFitWidth||v.image.textFitHeight)?$h(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};V.y1=V.y1*x-T[0],V.y2=V.y2*x+T[2],V.x1=V.x1*x-T[3],V.x2=V.x2*x+T[1];const X=v.collisionPadding;if(X&&(V.x1-=X[0]*x,V.y1-=X[1]*x,V.x2+=X[2]*x,V.y2+=X[3]*x),D){const W=new K(V.x1,V.y1),J=new K(V.x2,V.y1),ne=new K(V.x1,V.y2),ue=new K(V.x2,V.y2),Ce=D*Math.PI/180;W._rotate(Ce),J._rotate(Ce),ne._rotate(Ce),ue._rotate(Ce),V.x1=Math.min(W.x,J.x,ne.x,ue.x),V.x2=Math.max(W.x,J.x,ne.x,ue.x),V.y1=Math.min(W.y,J.y,ne.y,ue.y),V.y2=Math.max(W.y,J.y,ne.y,ue.y)}t.emplaceBack(n.x,n.y,V.x1,V.y1,V.x2,V.y2,o,d,_)}this.boxEndIndex=t.length}}class wp{constructor(t=[],n=(o,d)=>o<d?-1:o>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:o}=this,d=n[t];for(;t>0;){const _=t-1>>1,v=n[_];if(o(d,v)>=0)break;n[t]=v,t=_}n[t]=d}_down(t){const{data:n,compare:o}=this,d=this.length>>1,_=n[t];for(;t<d;){let v=1+(t<<1);const x=v+1;if(x<this.length&&o(n[x],n[v])<0&&(v=x),o(n[v],_)>=0)break;n[t]=n[v],t=v}n[t]=_}}function Sp(r,t=1,n=!1){const o=Yc.fromPoints(r[0]),d=Math.min(o.width(),o.height());let _=d/2;const v=new wp([],vg),{minX:x,minY:T,maxX:I,maxY:D}=o;if(d===0)return new K(x,T);for(let X=x;X<I;X+=d)for(let W=T;W<D;W+=d)v.push(new sa(X+_,W+_,_,r));let B=(function(X){let W=0,J=0,ne=0;const ue=X[0];for(let Ce=0,_e=ue.length,xe=_e-1;Ce<_e;xe=Ce++){const Fe=ue[Ce],We=ue[xe],ut=Fe.x*We.y-We.x*Fe.y;J+=(Fe.x+We.x)*ut,ne+=(Fe.y+We.y)*ut,W+=3*ut}return new sa(J/W,ne/W,0,X)})(r),V=v.length;for(;v.length;){const X=v.pop();(X.d>B.d||!B.d)&&(B=X,n&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,V)),X.max-B.d<=t||(_=X.h/2,v.push(new sa(X.p.x-_,X.p.y-_,_,r)),v.push(new sa(X.p.x+_,X.p.y-_,_,r)),v.push(new sa(X.p.x-_,X.p.y+_,_,r)),v.push(new sa(X.p.x+_,X.p.y+_,_,r)),V+=4)}return n&&(console.log(`num probes: ${V}`),console.log(`best distance: ${B.d}`)),B.p}function vg(r,t){return t.max-r.max}function sa(r,t,n,o){this.p=new K(r,t),this.h=n,this.d=(function(d,_){let v=!1,x=1/0;for(let T=0;T<_.length;T++){const I=_[T];for(let D=0,B=I.length,V=B-1;D<B;V=D++){const X=I[D],W=I[V];X.y>d.y!=W.y>d.y&&d.x<(W.x-X.x)*(d.y-X.y)/(W.y-X.y)+X.x&&(v=!v),x=Math.min(x,qr(d,X,W))}}return(v?1:-1)*Math.sqrt(x)})(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Tr;z.aI=void 0,(Tr=z.aI||(z.aI={}))[Tr.center=1]="center",Tr[Tr.left=2]="left",Tr[Tr.right=3]="right",Tr[Tr.top=4]="top",Tr[Tr.bottom=5]="bottom",Tr[Tr["top-left"]=6]="top-left",Tr[Tr["top-right"]=7]="top-right",Tr[Tr["bottom-left"]=8]="bottom-left",Tr[Tr["bottom-right"]=9]="bottom-right";const cf=Number.POSITIVE_INFINITY;function Tp(r,t){return t[1]!==cf?(function(n,o,d){let _=0,v=0;switch(o=Math.abs(o),d=Math.abs(d),n){case"top-right":case"top-left":case"top":v=d-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-d}switch(n){case"top-right":case"bottom-right":case"right":_=-o;break;case"top-left":case"bottom-left":case"left":_=o}return[_,v]})(r,t[0],t[1]):(function(n,o){let d=0,_=0;o<0&&(o=0);const v=o/Math.SQRT2;switch(n){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-o;break;case"top":_=o-7}switch(n){case"top-right":case"bottom-right":d=-v;break;case"top-left":case"bottom-left":d=v;break;case"left":d=o;break;case"right":d=-o}return[d,_]})(r,t[0])}function Ep(r,t,n){var o;const d=r.layout,_=(o=d.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},n);if(_){const x=_.values,T=[];for(let I=0;I<x.length;I+=2){const D=T[I]=x[I],B=x[I+1].map((V=>V*or));D.startsWith("top")?B[1]-=7:D.startsWith("bottom")&&(B[1]+=7),T[I+1]=B}return new In(T)}const v=d.get("text-variable-anchor");if(v){let x;x=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},n)*or,cf]:d.get("text-offset").evaluate(t,{},n).map((I=>I*or));const T=[];for(const I of v)T.push(I,Tp(I,x));return new In(T)}return null}function Wc(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Es(r,t,n,o,d,_,v,x,T,I,D,B){let V=_.textMaxSize.evaluate(t,{});V===void 0&&(V=v);const X=r.layers[0].layout,W=X.get("icon-offset").evaluate(t,{},D),J=td(n.horizontal),ne=v/24,ue=r.tilePixelRatio*ne,Ce=r.tilePixelRatio*V/24,_e=r.tilePixelRatio*x,xe=r.tilePixelRatio*X.get("symbol-spacing"),Fe=X.get("text-padding")*r.tilePixelRatio,We=(function(ti,Zt,Lt,Mi=1){const kn=ti.get("icon-padding").evaluate(Zt,{},Lt),Wn=kn&&kn.values;return[Wn[0]*Mi,Wn[1]*Mi,Wn[2]*Mi,Wn[3]*Mi]})(X,t,D,r.tilePixelRatio),ut=X.get("text-max-angle")/180*Math.PI,At=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",xt=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Et=X.get("symbol-placement"),Ut=xe/2,Mt=X.get("icon-text-fit");let Tt;o&&Mt!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(Tt=Yd(o,n.vertical,Mt,X.get("icon-text-fit-padding"),W,ne)),J&&(o=Yd(o,J,Mt,X.get("icon-text-fit-padding"),W,ne)));const rt=D?B.line.getGranularityForZoomLevel(D.z):1,Jt=(ti,Zt)=>{Zt.x<0||Zt.x>=dt||Zt.y<0||Zt.y>=dt||(function(Lt,Mi,kn,Wn,On,Er,lr,Kn,cn,zn,Fr,Mr,Ar,as,mr,Hr,cr,zr,Qn,Fn,pn,ma,Kc,ss,df){const Qc=Lt.addToLineVertexArray(Mi,kn);let Jc,xl,i,s,u=0,m=0,E=0,C=0,Z=-1,te=-1;const Se={};let He=xs("");if(Lt.allowVerticalPlacement&&Wn.vertical){const si=Kn.layout.get("text-rotate").evaluate(pn,{},ss)+90;i=new ed(cn,Mi,zn,Fr,Mr,Wn.vertical,Ar,as,mr,si),lr&&(s=new ed(cn,Mi,zn,Fr,Mr,lr,cr,zr,mr,si))}if(On){const si=Kn.layout.get("icon-rotate").evaluate(pn,{}),wi=Kn.layout.get("icon-text-fit")!=="none",Ga=xp(On,si,Kc,wi),ro=lr?xp(lr,si,Kc,wi):void 0;xl=new ed(cn,Mi,zn,Fr,Mr,On,cr,zr,!1,si),u=4*Ga.length;const ad=Lt.iconSizeData;let Jl=null;ad.kind==="source"?(Jl=[pa*Kn.layout.get("icon-size").evaluate(pn,{})],Jl[0]>aa&&Yt(`${Lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ad.kind==="composite"&&(Jl=[pa*ma.compositeIconSizes[0].evaluate(pn,{},ss),pa*ma.compositeIconSizes[1].evaluate(pn,{},ss)],(Jl[0]>aa||Jl[1]>aa)&&Yt(`${Lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Lt.addSymbols(Lt.icon,Ga,Jl,Fn,Qn,pn,z.as.none,Mi,Qc.lineStartIndex,Qc.lineLength,-1,ss),Z=Lt.icon.placedSymbolArray.length-1,ro&&(m=4*ro.length,Lt.addSymbols(Lt.icon,ro,Jl,Fn,Qn,pn,z.as.vertical,Mi,Qc.lineStartIndex,Qc.lineLength,-1,ss),te=Lt.icon.placedSymbolArray.length-1)}const st=Object.keys(Wn.horizontal);for(const si of st){const wi=Wn.horizontal[si];if(!Jc){He=xs(wi.text);const ro=Kn.layout.get("text-rotate").evaluate(pn,{},ss);Jc=new ed(cn,Mi,zn,Fr,Mr,wi,Ar,as,mr,ro)}const Ga=wi.positionedLines.length===1;if(E+=Mp(Lt,Mi,wi,Er,Kn,mr,pn,Hr,Qc,Wn.vertical?z.as.horizontal:z.as.horizontalOnly,Ga?st:[si],Se,Z,ma,ss),Ga)break}Wn.vertical&&(C+=Mp(Lt,Mi,Wn.vertical,Er,Kn,mr,pn,Hr,Qc,z.as.vertical,["vertical"],Se,te,ma,ss));const ft=Jc?Jc.boxStartIndex:Lt.collisionBoxArray.length,Xe=Jc?Jc.boxEndIndex:Lt.collisionBoxArray.length,Qe=i?i.boxStartIndex:Lt.collisionBoxArray.length,Vt=i?i.boxEndIndex:Lt.collisionBoxArray.length,li=xl?xl.boxStartIndex:Lt.collisionBoxArray.length,wn=xl?xl.boxEndIndex:Lt.collisionBoxArray.length,Be=s?s.boxStartIndex:Lt.collisionBoxArray.length,Pe=s?s.boxEndIndex:Lt.collisionBoxArray.length;let je=-1;const lt=(si,wi)=>si&&si.circleDiameter?Math.max(si.circleDiameter,wi):wi;je=lt(Jc,je),je=lt(i,je),je=lt(xl,je),je=lt(s,je);const ei=je>-1?1:0;ei&&(je*=df/or),Lt.glyphOffsetArray.length>=Xc.MAX_GLYPHS&&Yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pn.sortKey!==void 0&&Lt.addToSortKeyRanges(Lt.symbolInstances.length,pn.sortKey);const Ki=Ep(Kn,pn,ss),[Xt,Ci]=(function(si,wi){const Ga=si.length,ro=wi?.values;if(ro?.length>0)for(let ad=0;ad<ro.length;ad+=2){const Jl=ro[ad+1];si.emplaceBack(z.aI[ro[ad]],Jl[0],Jl[1])}return[Ga,si.length]})(Lt.textAnchorOffsets,Ki);Lt.symbolInstances.emplaceBack(Mi.x,Mi.y,Se.right>=0?Se.right:-1,Se.center>=0?Se.center:-1,Se.left>=0?Se.left:-1,Se.vertical||-1,Z,te,He,ft,Xe,Qe,Vt,li,wn,Be,Pe,zn,E,C,u,m,ei,0,Ar,je,Xt,Ci)})(r,Zt,ti,n,o,d,Tt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,ue,[Fe,Fe,Fe,Fe],At,T,_e,We,xt,W,t,_,I,D,v)};if(Et==="line")for(const ti of af(t.geometry,0,0,dt,dt)){const Zt=Ea(ti,rt),Lt=yg(Zt,xe,ut,n.vertical||J,o,24,Ce,r.overscaling,dt);for(const Mi of Lt)J&&bl(r,J.text,Ut,Mi)||Jt(Zt,Mi)}else if(Et==="line-center"){for(const ti of t.geometry)if(ti.length>1){const Zt=Ea(ti,rt),Lt=_g(Zt,ut,n.vertical||J,o,24,Ce);Lt&&Jt(Zt,Lt)}}else if(t.type==="Polygon")for(const ti of pc(t.geometry,0)){const Zt=Sp(ti,16);Jt(Ea(ti[0],rt,!0),new Ro(Zt.x,Zt.y,0))}else if(t.type==="LineString")for(const ti of t.geometry){const Zt=Ea(ti,rt);Jt(Zt,new Ro(Zt[0].x,Zt[0].y,0))}else if(t.type==="Point")for(const ti of t.geometry)for(const Zt of ti)Jt([Zt],new Ro(Zt.x,Zt.y,0))}function Mp(r,t,n,o,d,_,v,x,T,I,D,B,V,X,W){const J=(function(Ce,_e,xe,Fe,We,ut,At,xt){const Et=Fe.layout.get("text-rotate").evaluate(ut,{})*Math.PI/180,Ut=[];for(const Mt of _e.positionedLines)for(const Tt of Mt.positionedGlyphs){if(!Tt.rect)continue;const rt=Tt.rect||{};let Jt=4,ti=!0,Zt=1,Lt=0;const Mi=(We||xt)&&Tt.vertical,kn=Tt.metrics.advance*Tt.scale/2;if(xt&&_e.verticalizable&&(Lt=Mt.lineOffset/2-(Tt.imageName?-(or-Tt.metrics.width*Tt.scale)/2:(Tt.scale-1)*or)),Tt.imageName){const zr=At[Tt.imageName];ti=zr.sdf,Zt=zr.pixelRatio,Jt=1/Zt}const Wn=We?[Tt.x+kn,Tt.y]:[0,0];let On=We?[0,0]:[Tt.x+kn+xe[0],Tt.y+xe[1]-Lt],Er=[0,0];Mi&&(Er=On,On=[0,0]);const lr=Tt.metrics.isDoubleResolution?2:1,Kn=(Tt.metrics.left-Jt)*Tt.scale-kn+On[0],cn=(-Tt.metrics.top-Jt)*Tt.scale+On[1],zn=Kn+rt.w/lr*Tt.scale/Zt,Fr=cn+rt.h/lr*Tt.scale/Zt,Mr=new K(Kn,cn),Ar=new K(zn,cn),as=new K(Kn,Fr),mr=new K(zn,Fr);if(Mi){const zr=new K(-kn,kn- -17),Qn=-Math.PI/2,Fn=12-kn,pn=new K(22-Fn,-(Tt.imageName?Fn:0)),ma=new K(...Er);Mr._rotateAround(Qn,zr)._add(pn)._add(ma),Ar._rotateAround(Qn,zr)._add(pn)._add(ma),as._rotateAround(Qn,zr)._add(pn)._add(ma),mr._rotateAround(Qn,zr)._add(pn)._add(ma)}if(Et){const zr=Math.sin(Et),Qn=Math.cos(Et),Fn=[Qn,-zr,zr,Qn];Mr._matMult(Fn),Ar._matMult(Fn),as._matMult(Fn),mr._matMult(Fn)}const Hr=new K(0,0),cr=new K(0,0);Ut.push({tl:Mr,tr:Ar,bl:as,br:mr,tex:rt,writingMode:_e.writingMode,glyphOffset:Wn,sectionIndex:Tt.sectionIndex,isSDF:ti,pixelOffsetTL:Hr,pixelOffsetBR:cr,minFontScaleX:0,minFontScaleY:0})}return Ut})(0,n,x,d,_,v,o,r.allowVerticalPlacement),ne=r.textSizeData;let ue=null;ne.kind==="source"?(ue=[pa*d.layout.get("text-size").evaluate(v,{})],ue[0]>aa&&Yt(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ne.kind==="composite"&&(ue=[pa*X.compositeTextSizes[0].evaluate(v,{},W),pa*X.compositeTextSizes[1].evaluate(v,{},W)],(ue[0]>aa||ue[1]>aa)&&Yt(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,J,ue,x,_,v,I,t,T.lineStartIndex,T.lineLength,V,W);for(const Ce of D)B[Ce]=r.text.placedSymbolArray.length-1;return 4*J.length}function td(r){for(const t in r)return r[t];return null}function bl(r,t,n,o){const d=r.compareText;if(t in d){const _=d[t];for(let v=_.length-1;v>=0;v--)if(o.dist(_[v])<n)return!0}else d[t]=[];return d[t].push(o),!1}const Cm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ap{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=o>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const _=Cm[15&o];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new Ap(x,v,_,t)}constructor(t,n=64,o=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const _=Cm.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-x%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${o}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+x+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=n,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Kl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,o,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:x}=this,T=[0,_.length-1,0],I=[];for(;T.length;){const D=T.pop()||0,B=T.pop()||0,V=T.pop()||0;if(B-V<=x){for(let ne=V;ne<=B;ne++){const ue=v[2*ne],Ce=v[2*ne+1];ue>=t&&ue<=o&&Ce>=n&&Ce<=d&&I.push(_[ne])}continue}const X=V+B>>1,W=v[2*X],J=v[2*X+1];W>=t&&W<=o&&J>=n&&J<=d&&I.push(_[X]),(D===0?t<=W:n<=J)&&(T.push(V),T.push(X-1),T.push(1-D)),(D===0?o>=W:d>=J)&&(T.push(X+1),T.push(B),T.push(1-D))}return I}within(t,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:_,nodeSize:v}=this,x=[0,d.length-1,0],T=[],I=o*o;for(;x.length;){const D=x.pop()||0,B=x.pop()||0,V=x.pop()||0;if(B-V<=v){for(let ne=V;ne<=B;ne++)Im(_[2*ne],_[2*ne+1],t,n)<=I&&T.push(d[ne]);continue}const X=V+B>>1,W=_[2*X],J=_[2*X+1];Im(W,J,t,n)<=I&&T.push(d[X]),(D===0?t-o<=W:n-o<=J)&&(x.push(V),x.push(X-1),x.push(1-D)),(D===0?t+o>=W:n+o>=J)&&(x.push(X+1),x.push(B),x.push(1-D))}return T}}function Kl(r,t,n,o,d,_){if(d-o<=n)return;const v=o+d>>1;zp(r,t,v,o,d,_),Kl(r,t,n,o,v-1,1-_),Kl(r,t,n,v+1,d,1-_)}function zp(r,t,n,o,d,_){for(;d>o;){if(d-o>600){const I=d-o+1,D=n-o+1,B=Math.log(I),V=.5*Math.exp(2*B/3),X=.5*Math.sqrt(B*V*(I-V)/I)*(D-I/2<0?-1:1);zp(r,t,n,Math.max(o,Math.floor(n-D*V/I+X)),Math.min(d,Math.floor(n+(I-D)*V/I+X)),_)}const v=t[2*n+_];let x=o,T=d;for(id(r,t,o,n),t[2*d+_]>v&&id(r,t,o,d);x<T;){for(id(r,t,x,T),x++,T--;t[2*x+_]<v;)x++;for(;t[2*T+_]>v;)T--}t[2*o+_]===v?id(r,t,o,T):(T++,id(r,t,T,d)),T<=n&&(o=T+1),n<=T&&(d=T-1)}}function id(r,t,n,o){Cp(r,n,o),Cp(t,2*n,2*o),Cp(t,2*n+1,2*o+1)}function Cp(r,t,n){const o=r[t];r[t]=r[n],r[n]=o}function Im(r,t,n,o){const d=r-n,_=t-o;return d*d+_*_}var Ip;z.cA=void 0,(Ip=z.cA||(z.cA={})).create="create",Ip.load="load",Ip.fullLoad="fullLoad";let uf=null,nd=[];const Pp=1e3/60,hf="loadTime",Ql="fullLoadTime",rd={mark(r){performance.mark(r)},frame(r){const t=r;uf!=null&&nd.push(t-uf),uf=t},clearMetrics(){uf=null,nd=[],performance.clearMeasures(hf),performance.clearMeasures(Ql);for(const r in z.cA)performance.clearMarks(z.cA[r])},getPerformanceMetrics(){performance.measure(hf,z.cA.create,z.cA.load),performance.measure(Ql,z.cA.create,z.cA.fullLoad);const r=performance.getEntriesByName(hf)[0].duration,t=performance.getEntriesByName(Ql)[0].duration,n=nd.length,o=1/(nd.reduce(((_,v)=>_+v),0)/n/1e3),d=nd.filter((_=>_>Pp)).reduce(((_,v)=>_+(v-Pp)/Pp),0);return{loadTime:r,fullLoadTime:t,fps:o,percentDroppedFrames:d/(n+d)*100,totalFrames:n}}};z.$=er,z.A=Le,z.B=Fl,z.C=function([r,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(n),y:r*Math.sin(t)*Math.sin(n),z:r*Math.cos(n)}},z.D=Ot,z.E=Ft,z.F=ka,z.G=Li,z.H=Tc,z.I=Hd,z.J=Ti,z.K=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Oi((()=>this.process())),this.subscription=Ei(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=jt(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise(((n,o)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=t?Ei(t.signal,"abort",(()=>{_?.unsubscribe(),delete this.resolveRejects[d];const T={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)}),pp):null;this.resolveRejects[d]={resolve:T=>{_?.unsubscribe(),n(T)},reject:T=>{_?.unsubscribe(),o(T)}};const v=[],x=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:vs(r.data,v)});this.target.postMessage(x,{transfer:v})}))}receive(r){const t=r.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const o=this.abortControllers[n];return delete this.abortControllers[n],void(o&&o.abort())}if(jt(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return c(this,void 0,void 0,(function*(){if(t.type==="<response>"){const d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(t.error?d.reject(Ul(t.error)):d.resolve(Ul(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Ul(t.data),o=new AbortController;this.abortControllers[r]=o;try{const d=yield this.messageHandlers[t.type](t.sourceMapId,n,o);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}}))}completeTask(r,t,n){const o=[];delete this.abortControllers[r];const d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?vs(t):null,data:vs(n,o)};this.target.postMessage(d,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},z.L=H,z.M=function(){var r=new Le(16);return Le!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},z.N=function(r,t,n){var o,d,_,v,x,T,I,D,B,V,X,W,J=n[0],ne=n[1],ue=n[2];return t===r?(r[12]=t[0]*J+t[4]*ne+t[8]*ue+t[12],r[13]=t[1]*J+t[5]*ne+t[9]*ue+t[13],r[14]=t[2]*J+t[6]*ne+t[10]*ue+t[14],r[15]=t[3]*J+t[7]*ne+t[11]*ue+t[15]):(d=t[1],_=t[2],v=t[3],x=t[4],T=t[5],I=t[6],D=t[7],B=t[8],V=t[9],X=t[10],W=t[11],r[0]=o=t[0],r[1]=d,r[2]=_,r[3]=v,r[4]=x,r[5]=T,r[6]=I,r[7]=D,r[8]=B,r[9]=V,r[10]=X,r[11]=W,r[12]=o*J+x*ne+B*ue+t[12],r[13]=d*J+T*ne+V*ue+t[13],r[14]=_*J+I*ne+X*ue+t[14],r[15]=v*J+D*ne+W*ue+t[15]),r},z.O=function(r,t,n){var o=n[0],d=n[1],_=n[2];return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*d,r[5]=t[5]*d,r[6]=t[6]*d,r[7]=t[7]*d,r[8]=t[8]*_,r[9]=t[9]*_,r[10]=t[10]*_,r[11]=t[11]*_,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},z.P=K,z.Q=function(r,t,n){var o=t[0],d=t[1],_=t[2],v=t[3],x=t[4],T=t[5],I=t[6],D=t[7],B=t[8],V=t[9],X=t[10],W=t[11],J=t[12],ne=t[13],ue=t[14],Ce=t[15],_e=n[0],xe=n[1],Fe=n[2],We=n[3];return r[0]=_e*o+xe*x+Fe*B+We*J,r[1]=_e*d+xe*T+Fe*V+We*ne,r[2]=_e*_+xe*I+Fe*X+We*ue,r[3]=_e*v+xe*D+Fe*W+We*Ce,r[4]=(_e=n[4])*o+(xe=n[5])*x+(Fe=n[6])*B+(We=n[7])*J,r[5]=_e*d+xe*T+Fe*V+We*ne,r[6]=_e*_+xe*I+Fe*X+We*ue,r[7]=_e*v+xe*D+Fe*W+We*Ce,r[8]=(_e=n[8])*o+(xe=n[9])*x+(Fe=n[10])*B+(We=n[11])*J,r[9]=_e*d+xe*T+Fe*V+We*ne,r[10]=_e*_+xe*I+Fe*X+We*ue,r[11]=_e*v+xe*D+Fe*W+We*Ce,r[12]=(_e=n[12])*o+(xe=n[13])*x+(Fe=n[14])*B+(We=n[15])*J,r[13]=_e*d+xe*T+Fe*V+We*ne,r[14]=_e*_+xe*I+Fe*X+We*ue,r[15]=_e*v+xe*D+Fe*W+We*Ce,r},z.R=ha,z.S=function(r,t){const n={};for(let o=0;o<t.length;o++){const d=t[o];d in r&&(n[d]=r[d])}return n},z.T=jc,z.U=ko,z.V=Rt,z.W=Kh,z.X=Ju,z.Y=Ve,z.Z=ot,z._=c,z.a=L,z.a$=function(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r[3]=t[3]*n[3],r},z.a0=fn,z.a1=gp,z.a2=ef,z.a3=dt,z.a4=function(r,t){var n,o,d,_,v;if(!r)return t??{};if(!t)return r;let x=Object.assign({},r);if(t.removeAll&&(x={removeAll:!0}),t.remove){const T=new Set(t.remove);x.add&&(x.add=x.add.filter((D=>!T.has(D.id)))),x.update&&(x.update=x.update.filter((D=>!T.has(D.id))));const I=new Set(((n=r.add)!==null&&n!==void 0?n:[]).map((D=>D.id)));t.remove=t.remove.filter((D=>!I.has(D)))}if(t.remove){const T=new Set(x.remove?x.remove.concat(t.remove):t.remove);x.remove=Array.from(T.values())}if(t.add){const T=x.add?x.add.concat(t.add):t.add,I=new Map(T.map((D=>[D.id,D])));x.add=Array.from(I.values())}if(t.update){const T=new Map((o=x.update)===null||o===void 0?void 0:o.map((I=>[I.id,I])));for(const I of t.update){const D=(d=T.get(I.id))!==null&&d!==void 0?d:{id:I.id};I.newGeometry&&(D.newGeometry=I.newGeometry),I.addOrUpdateProperties&&(D.addOrUpdateProperties=((_=D.addOrUpdateProperties)!==null&&_!==void 0?_:[]).concat(I.addOrUpdateProperties)),I.removeProperties&&(D.removeProperties=((v=D.removeProperties)!==null&&v!==void 0?v:[]).concat(I.removeProperties)),I.removeAllProperties&&(D.removeAllProperties=!0),T.set(I.id,D)}x.update=Array.from(T.values())}return x.remove&&x.add&&(x.remove=x.remove.filter((T=>x.add.findIndex((I=>I.id===T))===-1))),x},z.a5=eh,z.a6=Yc,z.a7=25,z.a8=ln,z.a9=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((n=>{t.onloadstart=()=>{n(t)};for(const o of r){const d=window.document.createElement("source");ke(o)||(t.crossOrigin="Anonymous"),d.src=o,t.appendChild(d)}}))},z.aA=vi,z.aB=function(r,t,n,o){const d=t.y-r.y,_=t.x-r.x,v=o.y-n.y,x=o.x-n.x,T=v*_-x*d;if(T===0)return null;const I=(x*(r.y-n.y)-v*(r.x-n.x))/T;return new K(r.x+I*_,r.y+I*d)},z.aC=af,z.aD=Cf,z.aE=function(r){let t=1/0,n=1/0,o=-1/0,d=-1/0;for(const _ of r)t=Math.min(t,_.x),n=Math.min(n,_.y),o=Math.max(o,_.x),d=Math.max(d,_.y);return[t,n,o,d]},z.aF=or,z.aG=Kt,z.aH=function(r,t,n,o,d=!1){if(!n[0]&&!n[1])return[0,0];const _=d?o==="map"?-r.bearingInRadians:0:o==="viewport"?r.bearingInRadians:0;if(_){const v=Math.sin(_),x=Math.cos(_);n=[n[0]*x-n[1]*v,n[0]*v+n[1]*x]}return[d?n[0]:Kt(t,n[0],r.zoom),d?n[1]:Kt(t,n[1],r.zoom)]},z.aJ=hp,z.aK=Wc,z.aL=cp,z.aM=Ap,z.aN=Nt,z.aO=ra,z.aP=de,z.aQ=mi,z.aR=nt,z.aS=Ui,z.aT=Em,z.aU=tt,z.aV=Ie,z.aW=function(r){var t=new Le(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},z.aX=function(r,t,n){return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],r},z.aY=function(r,t){var n=t[0],o=t[1],d=t[2],_=n*n+o*o+d*d;return _>0&&(_=1/Math.sqrt(_)),r[0]=t[0]*_,r[1]=t[1]*_,r[2]=t[2]*_,r},z.aZ=bt,z.a_=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},z.aa=at,z.ab=function(){return Bt++},z.ac=M,z.ad=Xc,z.ae=ua,z.af=eo,z.ag=rf,z.ah=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,o,d,_)=>{const v=d||_;return t[o]=!v||v.toLowerCase(),""})),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},z.ai=Pt,z.aj=85.051129,z.ak=mn,z.al=function(r){return Math.pow(2,r)},z.am=_t,z.an=Tm,z.ao=function(r){return Math.log(r)/Math.LN2},z.ap=function(r){var t=r[0],n=r[1];return t*t+n*n},z.aq=function(r){if(!r.length)return new Set;const t=Math.max(...r.map((T=>T.canonical.z)));let n=1/0,o=-1/0,d=1/0,_=-1/0;const v=[];for(const T of r){const{x:I,y:D,z:B}=T.canonical,V=Math.pow(2,t-B),X=I*V,W=D*V;v.push({id:T,x:X,y:W}),X<n&&(n=X),X>o&&(o=X),W<d&&(d=W),W>_&&(_=W)}const x=new Set;for(const T of v)T.x!==n&&T.x!==o&&T.y!==d&&T.y!==_||x.add(T.id);return x},z.ar=function(r,t){let n=0,o=0;if(r.kind==="constant")o=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:_,maxZoom:v}=r,x=d?Pt(qi.interpolationFactor(d,t,_,v),0,1):0;r.kind==="camera"?o=ka.number(r.minSize,r.maxSize,x):n=x}return{uSizeT:n,uSize:o}},z.at=function(r,{uSize:t,uSizeT:n},{lowerSize:o,upperSize:d}){return r.kind==="source"?o/pa:r.kind==="composite"?ka.number(o/pa,d/pa,n):t},z.au=function(r,t){var n=t[0],o=t[1],d=t[2],_=t[3],v=t[4],x=t[5],T=t[6],I=t[7],D=t[8],B=t[9],V=t[10],X=t[11],W=t[12],J=t[13],ne=t[14],ue=t[15],Ce=n*x-o*v,_e=n*T-d*v,xe=n*I-_*v,Fe=o*T-d*x,We=o*I-_*x,ut=d*I-_*T,At=D*J-B*W,xt=D*ne-V*W,Et=D*ue-X*W,Ut=B*ne-V*J,Mt=B*ue-X*J,Tt=V*ue-X*ne,rt=Ce*Tt-_e*Mt+xe*Ut+Fe*Et-We*xt+ut*At;return rt?(r[0]=(x*Tt-T*Mt+I*Ut)*(rt=1/rt),r[1]=(d*Mt-o*Tt-_*Ut)*rt,r[2]=(J*ut-ne*We+ue*Fe)*rt,r[3]=(V*We-B*ut-X*Fe)*rt,r[4]=(T*Et-v*Tt-I*xt)*rt,r[5]=(n*Tt-d*Et+_*xt)*rt,r[6]=(ne*xe-W*ut-ue*_e)*rt,r[7]=(D*ut-V*xe+X*_e)*rt,r[8]=(v*Mt-x*Et+I*At)*rt,r[9]=(o*Et-n*Mt-_*At)*rt,r[10]=(W*We-J*xe+ue*Ce)*rt,r[11]=(B*xe-D*We-X*Ce)*rt,r[12]=(x*xt-v*Ut-T*At)*rt,r[13]=(n*Ut-o*xt+d*At)*rt,r[14]=(J*_e-W*Fe-ne*Ce)*rt,r[15]=(D*Fe-B*_e+V*Ce)*rt,r):null},z.av=et,z.aw=function(r){var t=r[0],n=r[1];return Math.sqrt(t*t+n*n)},z.ax=function(r){return r[0]=0,r[1]=0,r},z.ay=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r},z.az=Wd,z.b=zi,z.b$=function(r,t,n){var o=t[0],d=t[1],_=t[2];return r[0]=o*n[0]+d*n[3]+_*n[6],r[1]=o*n[1]+d*n[4]+_*n[7],r[2]=o*n[2]+d*n[5]+_*n[8],r},z.b0=St,z.b1=function(r,t,n){const o=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return o===0?null:(-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2])-n[3])/o},z.b2=Wt,z.b3=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r},z.b4=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},z.b5=tf,z.b6=th,z.b7=function(r,t,n,o,d){var _=1/Math.tan(t/2);if(r[0]=_/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0){var v=1/(o-d);r[10]=(d+o)*v,r[14]=2*d*o*v}else r[10]=-1,r[14]=-2*o;return r},z.b8=function(r){var t=new Le(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},z.b9=function(r,t,n){var o=Math.sin(n),d=Math.cos(n),_=t[0],v=t[1],x=t[2],T=t[3],I=t[4],D=t[5],B=t[6],V=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=_*d+I*o,r[1]=v*d+D*o,r[2]=x*d+B*o,r[3]=T*d+V*o,r[4]=I*d-_*o,r[5]=D*d-v*o,r[6]=B*d-x*o,r[7]=V*d-T*o,r},z.bA=function(r,t,n,o){var d=[],_=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],_[0]=d[0],_[1]=d[1]*Math.cos(o)-d[2]*Math.sin(o),_[2]=d[1]*Math.sin(o)+d[2]*Math.cos(o),r[0]=_[0]+n[0],r[1]=_[1]+n[1],r[2]=_[2]+n[2],r},z.bB=function(r,t,n,o){var d=[],_=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],_[0]=d[2]*Math.sin(o)+d[0]*Math.cos(o),_[1]=d[1],_[2]=d[2]*Math.cos(o)-d[0]*Math.sin(o),r[0]=_[0]+n[0],r[1]=_[1]+n[1],r[2]=_[2]+n[2],r},z.bC=function(r,t,n){var o=Math.sin(n),d=Math.cos(n),_=t[0],v=t[1],x=t[2],T=t[3],I=t[8],D=t[9],B=t[10],V=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=_*d-I*o,r[1]=v*d-D*o,r[2]=x*d-B*o,r[3]=T*d-V*o,r[8]=_*o+I*d,r[9]=v*o+D*d,r[10]=x*o+B*d,r[11]=T*o+V*d,r},z.bD=function(r,t){const n=fe(r,360),o=fe(t,360),d=o-n,_=o>n?d-360:d+360;return Math.abs(d)<Math.abs(_)?d:_},z.bE=function(r){return r[0]=0,r[1]=0,r[2]=0,r},z.bF=function(r,t,n,o){const d=Math.sqrt(r*r+t*t),_=Math.sqrt(n*n+o*o);r/=d,t/=d,n/=_,o/=_;const v=Math.acos(r*n+t*o);return-t*n+r*o>0?v:-v},z.bG=function(r,t){const n=fe(r,2*Math.PI),o=fe(t,2*Math.PI);return Math.min(Math.abs(n-o),Math.abs(n-o+2*Math.PI),Math.abs(n-o-2*Math.PI))},z.bH=function(){const r={},t=De.$version;for(const n in De.$root){const o=De.$root[n];if(o.required){let d=null;d=n==="version"?t:o.type==="array"?[]:{},d!=null&&(r[n]=d)}}return r},z.bI=qs,z.bJ=pe,z.bK=function r(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(!r(t[o],n[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const o in t)if(!r(t[o],n[o]))return!1;return!0}return t===n},z.bL=function(r){r=r.slice();const t=Object.create(null);for(let n=0;n<r.length;n++)t[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=rn(r[n],t[r[n].ref]));return r},z.bM=function(r,t){if(r.type==="custom")return new Sm(r,t);switch(r.type){case"background":return new gg(r,t);case"circle":return new Of(r,t);case"color-relief":return new ug(r,t);case"fill":return new Oh(r,t);case"fill-extrusion":return new Jf(r,t);case"heatmap":return new cg(r,t);case"hillshade":return new Nf(r,t);case"line":return new Hl(r,t);case"raster":return new Sa(r,t);case"symbol":return new Qd(r,t)}},z.bN=r=>r.type==="raster",z.bO=ri,z.bP=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let n=[];try{if(!Gt(r.version,t.version))return[{command:"setStyle",args:[t]}];Gt(r.center,t.center)||n.push({command:"setCenter",args:[t.center]}),Gt(r.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),Gt(r.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Gt(r.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),Gt(r.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),Gt(r.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),Gt(r.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),Gt(r.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),Gt(r.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),Gt(r.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),Gt(r.light,t.light)||n.push({command:"setLight",args:[t.light]}),Gt(r.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),Gt(r.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),Gt(r.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const o={},d=[];(function(v,x,T,I){let D;for(D in x=x||{},v=v||{})Object.prototype.hasOwnProperty.call(v,D)&&(Object.prototype.hasOwnProperty.call(x,D)||gn(D,T,I));for(D in x)Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(v,D)?Gt(v[D],x[D])||(v[D].type==="geojson"&&x[D].type==="geojson"&&Sn(v,x,D)?xi(T,{command:"setGeoJSONSourceData",args:[D,x[D].data]}):_r(D,x,T,I)):Yi(D,x,T))})(r.sources,t.sources,d,o);const _=[];r.layers&&r.layers.forEach((v=>{"source"in v&&o[v.source]?n.push({command:"removeLayer",args:[v.id]}):_.push(v)})),n=n.concat(d),(function(v,x,T){x=x||[];const I=(v=v||[]).map(_n),D=x.map(_n),B=v.reduce(Vn,{}),V=x.reduce(Vn,{}),X=I.slice(),W=Object.create(null);let J,ne,ue,Ce,_e;for(let xe=0,Fe=0;xe<I.length;xe++)J=I[xe],Object.prototype.hasOwnProperty.call(V,J)?Fe++:(xi(T,{command:"removeLayer",args:[J]}),X.splice(X.indexOf(J,Fe),1));for(let xe=0,Fe=0;xe<D.length;xe++)J=D[D.length-1-xe],X[X.length-1-xe]!==J&&(Object.prototype.hasOwnProperty.call(B,J)?(xi(T,{command:"removeLayer",args:[J]}),X.splice(X.lastIndexOf(J,X.length-Fe),1)):Fe++,Ce=X[X.length-xe],xi(T,{command:"addLayer",args:[V[J],Ce]}),X.splice(X.length-xe,0,J),W[J]=!0);for(let xe=0;xe<D.length;xe++)if(J=D[xe],ne=B[J],ue=V[J],!W[J]&&!Gt(ne,ue))if(Gt(ne.source,ue.source)&&Gt(ne["source-layer"],ue["source-layer"])&&Gt(ne.type,ue.type)){for(_e in Zn(ne.layout,ue.layout,T,J,null,"setLayoutProperty"),Zn(ne.paint,ue.paint,T,J,null,"setPaintProperty"),Gt(ne.filter,ue.filter)||xi(T,{command:"setFilter",args:[J,ue.filter]}),Gt(ne.minzoom,ue.minzoom)&&Gt(ne.maxzoom,ue.maxzoom)||xi(T,{command:"setLayerZoomRange",args:[J,ue.minzoom,ue.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Zn(ne[_e],ue[_e],T,J,_e.slice(6),"setPaintProperty"):Gt(ne[_e],ue[_e])||xi(T,{command:"setLayerProperty",args:[J,_e,ue[_e]]}));for(_e in ue)Object.prototype.hasOwnProperty.call(ue,_e)&&!Object.prototype.hasOwnProperty.call(ne,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Zn(ne[_e],ue[_e],T,J,_e.slice(6),"setPaintProperty"):Gt(ne[_e],ue[_e])||xi(T,{command:"setLayerProperty",args:[J,_e,ue[_e]]}))}else xi(T,{command:"removeLayer",args:[J]}),Ce=X[X.lastIndexOf(J)+1],xi(T,{command:"addLayer",args:[ue,Ce]})})(_,t.layers,n)}catch(o){console.warn("Unable to compute style diff:",o),n=[{command:"setStyle",args:[t]}]}return n},z.bQ=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},z.bR=bi,z.bS=Qt,z.bT=class extends Vr{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},z.bU=Co,z.bV=class extends Vr{constructor(r,t){super(r,t),this.current=Dc}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},z.bW=Ss,z.bX=class extends Vr{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},z.bY=class extends Vr{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},z.bZ=Ke,z.b_=function(r,t){var n=Math.sin(t),o=Math.cos(t);return r[0]=o,r[1]=n,r[2]=0,r[3]=-n,r[4]=o,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},z.ba=function(r,t,n){var o=Math.sin(n),d=Math.cos(n),_=t[4],v=t[5],x=t[6],T=t[7],I=t[8],D=t[9],B=t[10],V=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=_*d+I*o,r[5]=v*d+D*o,r[6]=x*d+B*o,r[7]=T*d+V*o,r[8]=I*d-_*o,r[9]=D*d-v*o,r[10]=B*d-x*o,r[11]=V*d-T*o,r},z.bb=function(){const r=new Float32Array(16);return _t(r),r},z.bc=function(){const r=new Float64Array(16);return _t(r),r},z.bd=function(){return new Float64Array(16)},z.be=function(r,t,n){const o=new Float64Array(4);return Ue(o,r,t-90,n),o},z.bf=function(r,t,n,o){var d,_,v,x,T,I=t[0],D=t[1],B=t[2],V=t[3],X=n[0],W=n[1],J=n[2],ne=n[3];return(_=I*X+D*W+B*J+V*ne)<0&&(_=-_,X=-X,W=-W,J=-J,ne=-ne),1-_>Ye?(d=Math.acos(_),v=Math.sin(d),x=Math.sin((1-o)*d)/v,T=Math.sin(o*d)/v):(x=1-o,T=o),r[0]=x*I+T*X,r[1]=x*D+T*W,r[2]=x*B+T*J,r[3]=x*V+T*ne,r},z.bg=function(r){const t=new Float64Array(9);var n,o,d,_,v,x,T,I,D,B,V,X,W,J,ne,ue,Ce,_e;B=(d=(o=r)[0])*(T=d+d),V=(_=o[1])*T,W=(v=o[2])*T,J=v*(I=_+_),ue=(x=o[3])*T,Ce=x*I,_e=x*(D=v+v),(n=t)[0]=1-(X=_*I)-(ne=v*D),n[3]=V-_e,n[6]=W+Ce,n[1]=V+_e,n[4]=1-B-ne,n[7]=J-ue,n[2]=W-Ce,n[5]=J+ue,n[8]=1-B-X;const xe=Ui(-Math.asin(Pt(t[2],-1,1)));let Fe,We;return Math.hypot(t[5],t[8])<.001?(Fe=0,We=-Ui(Math.atan2(t[3],t[4]))):(Fe=Ui(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),We=Ui(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Fe,pitch:xe+90,bearing:We}},z.bh=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},z.bi=ni,z.bj=Gr,z.bk=da,z.bl=Zu,z.bm=ml,z.bn=Re,z.bo=Ze,z.bp=kr,z.bq=function(r,t,n,o,d){return Re(o,d,Pt((r-t)/(n-t),0,1))},z.br=fe,z.bs=function(){return new Float64Array(3)},z.bt=function(r,t,n,o){return r[0]=t[0]+n[0]*o,r[1]=t[1]+n[1]*o,r[2]=t[2]+n[2]*o,r},z.bu=Ue,z.bv=function(r,t,n){var o=n[0],d=n[1],_=n[2],v=n[3],x=t[0],T=t[1],I=t[2],D=d*I-_*T,B=_*x-o*I,V=o*T-d*x;return r[0]=x+v*(D+=D)+d*(V+=V)-_*(B+=B),r[1]=T+v*B+_*D-o*V,r[2]=I+v*V+o*B-d*D,r},z.bw=function(r,t,n){const o=(d=[r[0],r[1],r[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((D=d[8])*(v=d[4])-(x=d[5])*(I=d[7]))+d[1]*(-D*(_=d[3])+x*(T=d[6]))+d[2]*(I*_-v*T);var d,_,v,x,T,I,D;if(o===0)return null;const B=bt([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),V=bt([],[n[0],n[1],n[2]],[r[0],r[1],r[2]]),X=bt([],[r[0],r[1],r[2]],[t[0],t[1],t[2]]),W=tt([],B,-r[3]);return Ie(W,W,tt([],V,-t[3])),Ie(W,W,tt([],X,-n[3])),tt(W,W,1/o),W},z.bx=Qu,z.by=function(){return new Float64Array(4)},z.bz=function(r,t,n,o){var d=[],_=[];return d[0]=t[0]-n[0],d[1]=t[1]-n[1],d[2]=t[2]-n[2],_[0]=d[0]*Math.cos(o)-d[1]*Math.sin(o),_[1]=d[0]*Math.sin(o)+d[1]*Math.cos(o),_[2]=d[2],r[0]=_[0]+n[0],r[1]=_[1]+n[1],r[2]=_[2]+n[2],r},z.c=q,z.c0=function(r,t,n,o,d,_,v){var x=1/(t-n),T=1/(o-d),I=1/(_-v);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*I,r[11]=0,r[12]=(t+n)*x,r[13]=(d+o)*T,r[14]=(v+_)*I,r[15]=1,r},z.c1=class extends Vr{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(4*r.length);for(let n=0;n<r.length;n++)t[4*n]=r[n].r,t[4*n+1]=r[n].g,t[4*n+2]=r[n].b,t[4*n+3]=r[n].a;this.gl.uniform4fv(this.location,t)}}},z.c2=class extends Vr{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(r);this.gl.uniform1fv(this.location,t)}}},z.c3=class extends dl{},z.c4=ip,z.c5=class extends Zl{},z.c6=Rh,z.c7=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},z.c8=Po,z.c9=function(r,t,n){var o=t[0],d=t[1],_=t[2],v=n[3]*o+n[7]*d+n[11]*_+n[15];return r[0]=(n[0]*o+n[4]*d+n[8]*_+n[12])/(v=v||1),r[1]=(n[1]*o+n[5]*d+n[9]*_+n[13])/v,r[2]=(n[2]*o+n[6]*d+n[10]*_+n[14])/v,r},z.cB=function(r){return r.message===U},z.cC=ae,z.cD=function(r,t){L.REGISTERED_PROTOCOLS[r]=t},z.cE=function(r){delete L.REGISTERED_PROTOCOLS[r]},z.cF=function(r,t){const n={};for(let d=0;d<r.length;d++){const _=t&&t[r[d].id]||js(r[d]);t&&(t[r[d].id]=_);let v=n[_];v||(v=n[_]=[]),v.push(r[d])}const o=[];for(const d in n)o.push(n[d]);return o},z.cG=zt,z.cH=nf,z.cI=Qh,z.cJ=sp,z.cK=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=dt/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],n=t.layout,o=t._unevaluatedLayout._values,d={layoutIconSize:o["icon-size"].possiblyEvaluate(new Li(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Li(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Li(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=r.bucket.textSizeData;d.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Li(I),r.canonical),o["text-size"].possiblyEvaluate(new Li(D),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=r.bucket.iconSizeData;d.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Li(I),r.canonical),o["icon-size"].possiblyEvaluate(new Li(D),r.canonical)]}const _=n.get("text-line-height")*or,v=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",x=n.get("text-keep-upright"),T=n.get("text-size");for(const I of r.bucket.features){const D=n.get("text-font").evaluate(I,{},r.canonical).join(","),B=T.evaluate(I,{},r.canonical),V=d.layoutTextSize.evaluate(I,{},r.canonical),X=d.layoutIconSize.evaluate(I,{},r.canonical),W={horizontal:{},vertical:void 0},J=I.text;let ne,ue=[0,0];if(J){const xe=J.toString(),Fe=n.get("text-letter-spacing").evaluate(I,{},r.canonical)*or,We=Pu(xe)?Fe:0,ut=n.get("text-anchor").evaluate(I,{},r.canonical),At=Ep(t,I,r.canonical);if(!At){const Mt=n.get("text-radial-offset").evaluate(I,{},r.canonical);ue=Mt?Tp(ut,[Mt*or,cf]):n.get("text-offset").evaluate(I,{},r.canonical).map((Tt=>Tt*or))}let xt=v?"center":n.get("text-justify").evaluate(I,{},r.canonical);const Et=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(I,{},r.canonical)*or:1/0,Ut=()=>{r.bucket.allowVerticalPlacement&&Iu(xe)&&(W.vertical=Zh(J,r.glyphMap,r.glyphPositions,r.imagePositions,D,Et,_,ut,"left",We,ue,z.as.vertical,!0,V,B))};if(!v&&At){const Mt=new Set;if(xt==="auto")for(let rt=0;rt<At.values.length;rt+=2)Mt.add(Wc(At.values[rt]));else Mt.add(xt);let Tt=!1;for(const rt of Mt)if(!W.horizontal[rt])if(Tt)W.horizontal[rt]=W.horizontal[0];else{const Jt=Zh(J,r.glyphMap,r.glyphPositions,r.imagePositions,D,Et,_,"center",rt,We,ue,z.as.horizontal,!1,V,B);Jt&&(W.horizontal[rt]=Jt,Tt=Jt.positionedLines.length===1)}Ut()}else{xt==="auto"&&(xt=Wc(ut));const Mt=Zh(J,r.glyphMap,r.glyphPositions,r.imagePositions,D,Et,_,ut,xt,We,ue,z.as.horizontal,!1,V,B);Mt&&(W.horizontal[xt]=Mt),Ut(),Iu(xe)&&v&&x&&(W.vertical=Zh(J,r.glyphMap,r.glyphPositions,r.imagePositions,D,Et,_,ut,xt,We,ue,z.as.vertical,!1,V,B))}}let Ce=!1;if(I.icon&&I.icon.name){const xe=r.imageMap[I.icon.name];xe&&(ne=up(r.imagePositions[I.icon.name],n.get("icon-offset").evaluate(I,{},r.canonical),n.get("icon-anchor").evaluate(I,{},r.canonical)),Ce=!!xe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=Ce:r.bucket.sdfIcons!==Ce&&Yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xe.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const _e=td(W.horizontal)||W.vertical;r.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||ne)&&Es(r.bucket,I,W,ne,r.imageMap,d,V,X,ue,Ce,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},z.cL=Lh,z.cM=ki,z.cN=fa,z.cO=sm,z.cP=Gd,z.cQ=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},z.cR=function(r,t,n,o,d){return c(this,void 0,void 0,(function*(){if(ot())try{return yield er(r,t,n,o,d)}catch{}return(function(_,v,x,T,I){const D=_.width,B=_.height;Xi&&tr||(Xi=new OffscreenCanvas(D,B),tr=Xi.getContext("2d",{willReadFrequently:!0})),Xi.width=D,Xi.height=B,tr.drawImage(_,0,0,D,B);const V=tr.getImageData(v,x,T,I);return tr.clearRect(0,0,D,B),V.data})(r,t,n,o,d)}))},z.cS=Dn,z.cT=$,z.cU=Uh,z.cV=Vc,z.cW=yo,z.cX=function(r,t){const n=new Map;if(r!=null)if(r.type==="Feature")n.set(ih(r,t),r);else for(const o of r.features)n.set(ih(o,t),o);return n},z.cY=function(r,t){if(r==null)return!0;if(r.type==="Feature")return ih(r,t)!=null;if(r.type==="FeatureCollection"){const n=new Set;for(const o of r.features){const d=ih(o,t);if(d==null||n.has(d))return!1;n.add(d)}return!0}return!1},z.cZ=function(r,t,n){var o,d,_,v;if(t.removeAll&&r.clear(),t.remove)for(const x of t.remove)r.delete(x);if(t.add)for(const x of t.add){const T=ih(x,n);T!=null&&r.set(T,x)}if(t.update)for(const x of t.update){let T=r.get(x.id);if(T==null)continue;const I=!x.removeAllProperties&&(((o=x.removeProperties)===null||o===void 0?void 0:o.length)>0||((d=x.addOrUpdateProperties)===null||d===void 0?void 0:d.length)>0);if((x.newGeometry||x.removeAllProperties||I)&&(T=Object.assign({},T),r.set(x.id,T),I&&(T.properties=Object.assign({},T.properties))),x.newGeometry&&(T.geometry=x.newGeometry),x.removeAllProperties)T.properties={};else if(((_=x.removeProperties)===null||_===void 0?void 0:_.length)>0)for(const D of x.removeProperties)Object.prototype.hasOwnProperty.call(T.properties,D)&&delete T.properties[D];if(((v=x.addOrUpdateProperties)===null||v===void 0?void 0:v.length)>0)for(const{key:D,value:B}of x.addOrUpdateProperties)T.properties[D]=B}},z.c_=Ja,z.ca=class extends Eo{},z.cb=class extends f{},z.cc=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},z.cd=function(r,t){var n=r[0],o=r[1],d=r[2],_=r[3],v=r[4],x=r[5],T=r[6],I=r[7],D=r[8],B=r[9],V=r[10],X=r[11],W=r[12],J=r[13],ne=r[14],ue=r[15],Ce=t[0],_e=t[1],xe=t[2],Fe=t[3],We=t[4],ut=t[5],At=t[6],xt=t[7],Et=t[8],Ut=t[9],Mt=t[10],Tt=t[11],rt=t[12],Jt=t[13],ti=t[14],Zt=t[15];return Math.abs(n-Ce)<=Ye*Math.max(1,Math.abs(n),Math.abs(Ce))&&Math.abs(o-_e)<=Ye*Math.max(1,Math.abs(o),Math.abs(_e))&&Math.abs(d-xe)<=Ye*Math.max(1,Math.abs(d),Math.abs(xe))&&Math.abs(_-Fe)<=Ye*Math.max(1,Math.abs(_),Math.abs(Fe))&&Math.abs(v-We)<=Ye*Math.max(1,Math.abs(v),Math.abs(We))&&Math.abs(x-ut)<=Ye*Math.max(1,Math.abs(x),Math.abs(ut))&&Math.abs(T-At)<=Ye*Math.max(1,Math.abs(T),Math.abs(At))&&Math.abs(I-xt)<=Ye*Math.max(1,Math.abs(I),Math.abs(xt))&&Math.abs(D-Et)<=Ye*Math.max(1,Math.abs(D),Math.abs(Et))&&Math.abs(B-Ut)<=Ye*Math.max(1,Math.abs(B),Math.abs(Ut))&&Math.abs(V-Mt)<=Ye*Math.max(1,Math.abs(V),Math.abs(Mt))&&Math.abs(X-Tt)<=Ye*Math.max(1,Math.abs(X),Math.abs(Tt))&&Math.abs(W-rt)<=Ye*Math.max(1,Math.abs(W),Math.abs(rt))&&Math.abs(J-Jt)<=Ye*Math.max(1,Math.abs(J),Math.abs(Jt))&&Math.abs(ne-ti)<=Ye*Math.max(1,Math.abs(ne),Math.abs(ti))&&Math.abs(ue-Zt)<=Ye*Math.max(1,Math.abs(ue),Math.abs(Zt))},z.ce=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},z.cf=r=>r.type==="symbol",z.cg=r=>r.type==="circle",z.ch=r=>r.type==="heatmap",z.ci=r=>r.type==="line",z.cj=r=>r.type==="fill",z.ck=r=>r.type==="fill-extrusion",z.cl=r=>r.type==="hillshade",z.cm=r=>r.type==="color-relief",z.cn=r=>r.type==="background",z.co=r=>r.type==="custom",z.cp=mt,z.cq=function(r,t,n){const o=it(t.x-n.x,t.y-n.y),d=it(r.x-n.x,r.y-n.y);var _,v;return Ui(Math.atan2(o[0]*d[1]-o[1]*d[0],(_=o)[0]*(v=d)[0]+_[1]*v[1]))},z.cr=It,z.cs=function(r,t){return O[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},z.ct=function(r,t){return ee[t]&&"touches"in r},z.cu=function(r){return ee[r]||O[r]},z.cv=function(r,t,n){var o=t[0],d=t[1];return r[0]=n[0]*o+n[4]*d+n[12],r[1]=n[1]*o+n[5]*d+n[13],r},z.cw=function(r,t){const{x:n,y:o}=eh.fromLngLat(t);return!(r<0||r>25||o<0||o>=1||n<0||n>=1)},z.cx=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},z.cy=class extends ul{},z.cz=rd,z.d=ke,z.e=Dt,z.f=r=>c(void 0,void 0,void 0,(function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),z.g=F,z.h=r=>new Promise(((t,n)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame((()=>{o.src=Gi}))},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(r)],{type:"image/png"});o.src=r.byteLength?URL.createObjectURL(d):Gi})),z.i=jt,z.j=(r,t)=>we(Dt(r,{type:"json"}),t),z.k=Je,z.l=ct,z.m=we,z.n=(r,t)=>we(Dt(r,{type:"arrayBuffer"}),t),z.o=function(r){return new Gd(r).readFields(ap,[])},z.p=fm,z.q=Fc,z.r=hn,z.s=Ei,z.t=De,z.u=hi,z.v=rl,z.w=Yt,z.x=Du,z.y=Cd,z.z=zu})),P("worker",["./shared"],(function(z){class c{constructor(L,F){this.keyCache={},L&&this.replace(L,F)}replace(L,F){this._layerConfigs={},this._layers={},this.update(L,[],F)}update(L,F,H){for(const pe of L){this._layerConfigs[pe.id]=pe;const we=this._layers[pe.id]=z.bM(pe,H);we._featureFilter=z.ae(we.filter,H),this.keyCache[pe.id]&&delete this.keyCache[pe.id]}for(const pe of F)delete this.keyCache[pe],delete this._layerConfigs[pe],delete this._layers[pe];this.familiesBySource={};const ae=z.cF(Object.values(this._layerConfigs),this.keyCache);for(const pe of ae){const we=pe.map((Ft=>this._layers[Ft.id])),ke=we[0];if(ke.visibility==="none")continue;const Te=ke.source||"";let qe=this.familiesBySource[Te];qe||(qe=this.familiesBySource[Te]={});const ct=ke.sourceLayer||"_geojsonTileLayer";let Je=qe[ct];Je||(Je=qe[ct]=[]),Je.push(we)}}}class K{constructor(L){const F={},H=[];for(const ke in L){const Te=L[ke],qe=F[ke]={};for(const ct in Te){const Je=Te[+ct];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const Ft={x:0,y:0,w:Je.bitmap.width+2,h:Je.bitmap.height+2};H.push(Ft),qe[ct]={rect:Ft,metrics:Je.metrics}}}const{w:ae,h:pe}=z.p(H),we=new z.q({width:ae||1,height:pe||1});for(const ke in L){const Te=L[ke];for(const qe in Te){const ct=Te[+qe];if(!ct||ct.bitmap.width===0||ct.bitmap.height===0)continue;const Je=F[ke][qe].rect;z.q.copy(ct.bitmap,we,{x:0,y:0},{x:Je.x+1,y:Je.y+1},ct.bitmap)}}this.image=we,this.positions=F}}z.cG("GlyphAtlas",K);class ${constructor(L){this.tileID=new z.a0(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId,this.inFlightDependencies=[]}parse(L,F,H,ae,pe){return z._(this,void 0,void 0,(function*(){this.status="parsing",this.data=L,this.collisionBoxArray=new z.ac;const we=new z.cH(Object.keys(L.layers).sort()),ke=new z.cI(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const Te={},qe={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:H,subdivisionGranularity:pe},ct=F.familiesBySource[this.source];for(const at in ct){const Rn=L.layers[at];if(!Rn)continue;Rn.version===1&&z.w(`Vector tile source "${this.source}" layer "${at}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const jr=we.encode(at),ga=[];for(let Ni=0;Ni<Rn.length;Ni++){const gt=Rn.feature(Ni),ai=ke.getId(gt,at);ga.push({feature:gt,id:ai,index:Ni,sourceLayerIndex:jr})}for(const Ni of ct[at]){const gt=Ni[0];gt.source!==this.source&&z.w(`layer.source = ${gt.source} does not equal this.source = ${this.source}`),gt.isHidden(this.zoom,!0)||(oe(Ni,this.zoom,H),(Te[gt.id]=gt.createBucket({index:ke.bucketLayerIDs.length,layers:Ni,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:jr,sourceID:this.source})).populate(ga,qe,this.tileID.canonical),ke.bucketLayerIDs.push(Ni.map((ai=>ai.id))))}}const Je=z.bR(qe.glyphDependencies,(at=>Object.keys(at).map(Number)));this.inFlightDependencies.forEach((at=>at?.abort())),this.inFlightDependencies=[];let Ft=Promise.resolve({});if(Object.keys(Je).length){const at=new AbortController;this.inFlightDependencies.push(at),Ft=ae.sendAsync({type:"GG",data:{stacks:Je,source:this.source,tileID:this.tileID,type:"glyphs"}},at)}const De=Object.keys(qe.iconDependencies);let _i=Promise.resolve({});if(De.length){const at=new AbortController;this.inFlightDependencies.push(at),_i=ae.sendAsync({type:"GI",data:{icons:De,source:this.source,tileID:this.tileID,type:"icons"}},at)}const rn=Object.keys(qe.patternDependencies);let Gt=Promise.resolve({});if(rn.length){const at=new AbortController;this.inFlightDependencies.push(at),Gt=ae.sendAsync({type:"GI",data:{icons:rn,source:this.source,tileID:this.tileID,type:"patterns"}},at)}const xi=qe.dashDependencies;let Yi=Promise.resolve({});if(Object.keys(xi).length){const at=new AbortController;this.inFlightDependencies.push(at),Yi=ae.sendAsync({type:"GDA",data:{dashes:xi}},at)}const[gn,_r,Sn,Zn]=yield Promise.all([Ft,_i,Gt,Yi]),_n=new K(gn),Vn=new z.cJ(_r,Sn);for(const at in Te){const Rn=Te[at];Rn instanceof z.ad?(oe(Rn.layers,this.zoom,H),z.cK({bucket:Rn,glyphMap:gn,glyphPositions:_n.positions,imageMap:_r,imagePositions:Vn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:qe.subdivisionGranularity})):Rn.hasDependencies&&(Rn instanceof z.cL||Rn instanceof z.cM||Rn instanceof z.cN)&&(oe(Rn.layers,this.zoom,H),Rn.addFeatures(qe,this.tileID.canonical,Vn.patternPositions,Zn))}return this.status="done",{buckets:Object.values(Te).filter((at=>!at.isEmpty())),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_n.image,imageAtlas:Vn,dashPositions:Zn,glyphMap:this.returnDependencies?gn:null,iconMap:this.returnDependencies?_r:null,glyphPositions:this.returnDependencies?_n.positions:null}}))}}function oe(q,L,F){const H=new z.G(L);for(const ae of q)ae.recalculate(H,F)}class ce{constructor(L,F,H){this.actor=L,this.layerIndex=F,this.availableImages=H,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(L,F){return z._(this,void 0,void 0,(function*(){const H=yield z.n(L.request,F);try{return{vectorTile:new z.cO(new z.cP(H.data)),rawData:H.data,cacheControl:H.cacheControl,expires:H.expires}}catch(ae){const pe=new Uint8Array(H.data);let we=`Unable to parse the tile at ${L.request.url}, `;throw we+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ae.message}`,new Error(we)}}))}loadTile(L){return z._(this,void 0,void 0,(function*(){const F=L.uid,H=!!(L&&L.request&&L.request.collectResourceTiming)&&new z.cQ(L.request),ae=new $(L);this.loading[F]=ae;const pe=new AbortController;ae.abort=pe;try{const we=yield this.loadVectorTile(L,pe);if(delete this.loading[F],!we)return null;const ke=we.rawData,Te={};we.expires&&(Te.expires=we.expires),we.cacheControl&&(Te.cacheControl=we.cacheControl);const qe={};if(H){const Je=H.finish();Je&&(qe.resourceTiming=JSON.parse(JSON.stringify(Je)))}ae.vectorTile=we.vectorTile;const ct=ae.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity);this.loaded[F]=ae,this.fetching[F]={rawTileData:ke,cacheControl:Te,resourceTiming:qe};try{const Je=yield ct;return z.e({rawTileData:ke.slice(0)},Je,Te,qe)}finally{delete this.fetching[F]}}catch(we){throw delete this.loading[F],ae.status="done",this.loaded[F]=ae,we}}))}reloadTile(L){return z._(this,void 0,void 0,(function*(){const F=L.uid;if(!this.loaded||!this.loaded[F])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const H=this.loaded[F];if(H.showCollisionBoxes=L.showCollisionBoxes,H.status==="parsing"){const ae=yield H.parse(H.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity);let pe;if(this.fetching[F]){const{rawTileData:we,cacheControl:ke,resourceTiming:Te}=this.fetching[F];delete this.fetching[F],pe=z.e({rawTileData:we.slice(0)},ae,ke,Te)}else pe=ae;return pe}if(H.status==="done"&&H.vectorTile)return H.parse(H.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity)}))}abortTile(L){return z._(this,void 0,void 0,(function*(){const F=this.loading,H=L.uid;F&&F[H]&&F[H].abort&&(F[H].abort.abort(),delete F[H])}))}removeTile(L){return z._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[L.uid]&&delete this.loaded[L.uid]}))}}class ge{constructor(){this.loaded={}}loadTile(L){return z._(this,void 0,void 0,(function*(){const{uid:F,encoding:H,rawImageData:ae,redFactor:pe,greenFactor:we,blueFactor:ke,baseShift:Te}=L,qe=ae.width+2,ct=ae.height+2,Je=z.b(ae)?new z.R({width:qe,height:ct},yield z.cR(ae,-1,-1,qe,ct)):ae,Ft=new z.cS(F,Je,H,pe,we,ke,Te);return this.loaded=this.loaded||{},this.loaded[F]=Ft,Ft}))}removeTile(L){const F=this.loaded,H=L.uid;F&&F[H]&&delete F[H]}}var Me,Ae,ie=(function(){if(Ae)return Me;function q(F,H){if(F.length!==0){L(F[0],H);for(var ae=1;ae<F.length;ae++)L(F[ae],!H)}}function L(F,H){for(var ae=0,pe=0,we=0,ke=F.length,Te=ke-1;we<ke;Te=we++){var qe=(F[we][0]-F[Te][0])*(F[Te][1]+F[we][1]),ct=ae+qe;pe+=Math.abs(ae)>=Math.abs(qe)?ae-ct+qe:qe-ct+ae,ae=ct}ae+pe>=0!=!!H&&F.reverse()}return Ae=1,Me=function F(H,ae){var pe,we=H&&H.type;if(we==="FeatureCollection")for(pe=0;pe<H.features.length;pe++)F(H.features[pe],ae);else if(we==="GeometryCollection")for(pe=0;pe<H.geometries.length;pe++)F(H.geometries[pe],ae);else if(we==="Feature")F(H.geometry,ae);else if(we==="Polygon")q(H.coordinates,ae);else if(we==="MultiPolygon")for(pe=0;pe<H.coordinates.length;pe++)q(H.coordinates[pe],ae);return H}})(),Ve=z.cT(ie);class ot extends z.cV{constructor(L,F){super(new z.cP,0,F,[],[]),this.feature=L,this.type=L.type,this.properties=L.tags?L.tags:{},"id"in L&&(typeof L.id=="string"?this.id=parseInt(L.id,10):typeof L.id!="number"||isNaN(L.id)||(this.id=L.id))}loadGeometry(){const L=[],F=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const H of F){const ae=[];for(const pe of H)ae.push(new z.P(pe[0],pe[1]));L.push(ae)}return L}}class Ye extends z.cU{constructor(L,F){super(new z.cP),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=F?F.version:1,this.extent=F?F.extent:4096,this.length=L.length,this.features=L}feature(L){return new ot(this.features[L],this.extent)}}function Le(q,L){L.writeVarintField(15,q.version||1),L.writeStringField(1,q.name||""),L.writeVarintField(5,q.extent||4096);const F={keys:[],values:[],keycache:{},valuecache:{}};for(let pe=0;pe<q.length;pe++)F.feature=q.feature(pe),L.writeMessage(2,Ke,F);const H=F.keys;for(const pe of H)L.writeStringField(3,pe);const ae=F.values;for(const pe of ae)L.writeMessage(4,Ie,pe)}function Ke(q,L){if(!q.feature)return;const F=q.feature;F.id!==void 0&&L.writeVarintField(1,F.id),L.writeMessage(2,_t,q),L.writeVarintField(3,F.type),L.writeMessage(4,be,F)}function _t(q,L){for(const F in q.feature?.properties){let H=q.feature.properties[F],ae=q.keycache[F];if(H===null)continue;ae===void 0&&(q.keys.push(F),ae=q.keys.length-1,q.keycache[F]=ae),L.writeVarint(ae),typeof H!="string"&&typeof H!="boolean"&&typeof H!="number"&&(H=JSON.stringify(H));const pe=typeof H+":"+H;let we=q.valuecache[pe];we===void 0&&(q.values.push(H),we=q.values.length-1,q.valuecache[pe]=we),L.writeVarint(we)}}function ht(q,L){return(L<<3)+(7&q)}function St(q){return q<<1^q>>31}function be(q,L){const F=q.loadGeometry(),H=q.type;let ae=0,pe=0;for(const we of F){let ke=1;H===1&&(ke=we.length),L.writeVarint(ht(1,ke));const Te=H===3?we.length-1:we.length;for(let qe=0;qe<Te;qe++){qe===1&&H!==1&&L.writeVarint(ht(2,Te-1));const ct=we[qe].x-ae,Je=we[qe].y-pe;L.writeVarint(St(ct)),L.writeVarint(St(Je)),ae+=ct,pe+=Je}q.type===3&&L.writeVarint(ht(7,1))}}function Ie(q,L){const F=typeof q;F==="string"?L.writeStringField(1,q):F==="boolean"?L.writeBooleanField(7,q):F==="number"&&(q%1!=0?L.writeDoubleField(3,q):q<0?L.writeSVarintField(6,q):L.writeVarintField(5,q))}const tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},bt=Math.fround||(wt=new Float32Array(1),q=>(wt[0]=+q,wt[0]));var wt;class Wt{constructor(L){this.options=Object.assign(Object.create(tt),L),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(L){const{log:F,minZoom:H,maxZoom:ae}=this.options;F&&console.time("total time");const pe=`prepare ${L.length} points`;F&&console.time(pe),this.points=L;const we=[];for(let Te=0;Te<L.length;Te++){const qe=L[Te];if(!qe.geometry)continue;const[ct,Je]=qe.geometry.coordinates,Ft=bt(Ue(ct)),De=bt(et(Je));we.push(Ft,De,1/0,Te,-1,1),this.options.reduce&&we.push(0)}let ke=this.trees[ae+1]=this._createTree(we);F&&console.timeEnd(pe);for(let Te=ae;Te>=H;Te--){const qe=+Date.now();ke=this.trees[Te]=this._createTree(this._cluster(ke,Te)),F&&console.log("z%d: %d clusters in %dms",Te,ke.numItems,+Date.now()-qe)}return F&&console.timeEnd("total time"),this}getClusters(L,F){let H=((L[0]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,L[1]));let pe=L[2]===180?180:((L[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)H=-180,pe=180;else if(H>pe){const Je=this.getClusters([H,ae,180,we],F),Ft=this.getClusters([-180,ae,pe,we],F);return Je.concat(Ft)}const ke=this.trees[this._limitZoom(F)],Te=ke.range(Ue(H),et(we),Ue(pe),et(ae)),qe=ke.data,ct=[];for(const Je of Te){const Ft=this.stride*Je;ct.push(qe[Ft+5]>1?vi(qe,Ft,this.clusterProps):this.points[qe[Ft+3]])}return ct}getChildren(L){const F=this._getOriginId(L),H=this._getOriginZoom(L),ae="No cluster with the specified id.",pe=this.trees[H];if(!pe)throw new Error(ae);const we=pe.data;if(F*this.stride>=we.length)throw new Error(ae);const ke=this.options.radius/(this.options.extent*Math.pow(2,H-1)),Te=pe.within(we[F*this.stride],we[F*this.stride+1],ke),qe=[];for(const ct of Te){const Je=ct*this.stride;we[Je+4]===L&&qe.push(we[Je+5]>1?vi(we,Je,this.clusterProps):this.points[we[Je+3]])}if(qe.length===0)throw new Error(ae);return qe}getLeaves(L,F,H){const ae=[];return this._appendLeaves(ae,L,F=F||10,H=H||0,0),ae}getTile(L,F,H){const ae=this.trees[this._limitZoom(L)],pe=Math.pow(2,L),{extent:we,radius:ke}=this.options,Te=ke/we,qe=(H-Te)/pe,ct=(H+1+Te)/pe,Je={features:[]};return this._addTileFeatures(ae.range((F-Te)/pe,qe,(F+1+Te)/pe,ct),ae.data,F,H,pe,Je),F===0&&this._addTileFeatures(ae.range(1-Te/pe,qe,1,ct),ae.data,pe,H,pe,Je),F===pe-1&&this._addTileFeatures(ae.range(0,qe,Te/pe,ct),ae.data,-1,H,pe,Je),Je.features.length?Je:null}getClusterExpansionZoom(L){let F=this._getOriginZoom(L)-1;for(;F<=this.options.maxZoom;){const H=this.getChildren(L);if(F++,H.length!==1)break;L=H[0].properties.cluster_id}return F}_appendLeaves(L,F,H,ae,pe){const we=this.getChildren(F);for(const ke of we){const Te=ke.properties;if(Te&&Te.cluster?pe+Te.point_count<=ae?pe+=Te.point_count:pe=this._appendLeaves(L,Te.cluster_id,H,ae,pe):pe<ae?pe++:L.push(ke),L.length===H)break}return pe}_createTree(L){const F=new z.aM(L.length/this.stride|0,this.options.nodeSize,Float32Array);for(let H=0;H<L.length;H+=this.stride)F.add(L[H],L[H+1]);return F.finish(),F.data=L,F}_addTileFeatures(L,F,H,ae,pe,we){for(const ke of L){const Te=ke*this.stride,qe=F[Te+5]>1;let ct,Je,Ft;if(qe)ct=Si(F,Te,this.clusterProps),Je=F[Te],Ft=F[Te+1];else{const rn=this.points[F[Te+3]];ct=rn.properties;const[Gt,xi]=rn.geometry.coordinates;Je=Ue(Gt),Ft=et(xi)}const De={type:1,geometry:[[Math.round(this.options.extent*(Je*pe-H)),Math.round(this.options.extent*(Ft*pe-ae))]],tags:ct};let _i;_i=qe||this.options.generateId?F[Te+3]:this.points[F[Te+3]].id,_i!==void 0&&(De.id=_i),we.features.push(De)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(Math.floor(+L),this.options.maxZoom+1))}_cluster(L,F){const{radius:H,extent:ae,reduce:pe,minPoints:we}=this.options,ke=H/(ae*Math.pow(2,F)),Te=L.data,qe=[],ct=this.stride;for(let Je=0;Je<Te.length;Je+=ct){if(Te[Je+2]<=F)continue;Te[Je+2]=F;const Ft=Te[Je],De=Te[Je+1],_i=L.within(Te[Je],Te[Je+1],ke),rn=Te[Je+5];let Gt=rn;for(const xi of _i){const Yi=xi*ct;Te[Yi+2]>F&&(Gt+=Te[Yi+5])}if(Gt>rn&&Gt>=we){let xi,Yi=Ft*rn,gn=De*rn,_r=-1;const Sn=(Je/ct<<5)+(F+1)+this.points.length;for(const Zn of _i){const _n=Zn*ct;if(Te[_n+2]<=F)continue;Te[_n+2]=F;const Vn=Te[_n+5];Yi+=Te[_n]*Vn,gn+=Te[_n+1]*Vn,Te[_n+4]=Sn,pe&&(xi||(xi=this._map(Te,Je,!0),_r=this.clusterProps.length,this.clusterProps.push(xi)),pe(xi,this._map(Te,_n)))}Te[Je+4]=Sn,qe.push(Yi/Gt,gn/Gt,1/0,Sn,-1,Gt),pe&&qe.push(_r)}else{for(let xi=0;xi<ct;xi++)qe.push(Te[Je+xi]);if(Gt>1)for(const xi of _i){const Yi=xi*ct;if(!(Te[Yi+2]<=F)){Te[Yi+2]=F;for(let gn=0;gn<ct;gn++)qe.push(Te[Yi+gn])}}}}return qe}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,F,H){if(L[F+5]>1){const we=this.clusterProps[L[F+6]];return H?Object.assign({},we):we}const ae=this.points[L[F+3]].properties,pe=this.options.map(ae);return H&&pe===ae?Object.assign({},pe):pe}}function vi(q,L,F){return{type:"Feature",id:q[L+3],properties:Si(q,L,F),geometry:{type:"Point",coordinates:[(H=q[L],360*(H-.5)),it(q[L+1])]}};var H}function Si(q,L,F){const H=q[L+5],ae=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H,pe=q[L+6],we=pe===-1?{}:Object.assign({},F[pe]);return Object.assign(we,{cluster:!0,cluster_id:q[L+3],point_count:H,point_count_abbreviated:ae})}function Ue(q){return q/360+.5}function et(q){const L=Math.sin(q*Math.PI/180),F=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return F<0?0:F>1?1:F}function it(q){const L=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function dt(q,L,F,H){let ae=H;const pe=L+(F-L>>1);let we,ke=F-L;const Te=q[L],qe=q[L+1],ct=q[F],Je=q[F+1];for(let Ft=L+3;Ft<F;Ft+=3){const De=Kt(q[Ft],q[Ft+1],Te,qe,ct,Je);if(De>ae)we=Ft,ae=De;else if(De===ae){const _i=Math.abs(Ft-pe);_i<ke&&(we=Ft,ke=_i)}}ae>H&&(we-L>3&&dt(q,L,we,H),q[we+2]=ae,F-we>3&&dt(q,we,F,H))}function Kt(q,L,F,H,ae,pe){let we=ae-F,ke=pe-H;if(we!==0||ke!==0){const Te=((q-F)*we+(L-H)*ke)/(we*we+ke*ke);Te>1?(F=ae,H=pe):Te>0&&(F+=we*Te,H+=ke*Te)}return we=q-F,ke=L-H,we*we+ke*ke}function fe(q,L,F,H){const ae={id:q??null,type:L,geometry:F,tags:H,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(L==="Point"||L==="MultiPoint"||L==="LineString")Re(ae,F);else if(L==="Polygon")Re(ae,F[0]);else if(L==="MultiLineString")for(const pe of F)Re(ae,pe);else if(L==="MultiPolygon")for(const pe of F)Re(ae,pe[0]);return ae}function Re(q,L){for(let F=0;F<L.length;F+=3)q.minX=Math.min(q.minX,L[F]),q.minY=Math.min(q.minY,L[F+1]),q.maxX=Math.max(q.maxX,L[F]),q.maxY=Math.max(q.maxY,L[F+1])}function Ze(q,L,F,H){if(!L.geometry)return;const ae=L.geometry.coordinates;if(ae&&ae.length===0)return;const pe=L.geometry.type,we=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2);let ke=[],Te=L.id;if(F.promoteId?Te=L.properties[F.promoteId]:F.generateId&&(Te=H||0),pe==="Point")mt(ae,ke);else if(pe==="MultiPoint")for(const qe of ae)mt(qe,ke);else if(pe==="LineString")It(ae,ke,we,!1);else if(pe==="MultiLineString"){if(F.lineMetrics){for(const qe of ae)ke=[],It(qe,ke,we,!1),q.push(fe(Te,"LineString",ke,L.properties));return}Pt(ae,ke,we,!1)}else if(pe==="Polygon")Pt(ae,ke,we,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(const qe of L.geometry.geometries)Ze(q,{id:Te,geometry:qe,properties:L.properties},F,H);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const qe of ae){const ct=[];Pt(qe,ct,we,!0),ke.push(ct)}}q.push(fe(Te,pe,ke,L.properties))}function mt(q,L){L.push(Rt(q[0]),Dt(q[1]),0)}function It(q,L,F,H){let ae,pe,we=0;for(let Te=0;Te<q.length;Te++){const qe=Rt(q[Te][0]),ct=Dt(q[Te][1]);L.push(qe,ct,0),Te>0&&(we+=H?(ae*ct-qe*pe)/2:Math.sqrt(Math.pow(qe-ae,2)+Math.pow(ct-pe,2))),ae=qe,pe=ct}const ke=L.length-3;L[2]=1,dt(L,0,ke,F),L[ke+2]=1,L.size=Math.abs(we),L.start=0,L.end=L.size}function Pt(q,L,F,H){for(let ae=0;ae<q.length;ae++){const pe=[];It(q[ae],pe,F,H),L.push(pe)}}function Rt(q){return q/360+.5}function Dt(q){const L=Math.sin(q*Math.PI/180),F=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return F<0?0:F>1?1:F}function Bt(q,L,F,H,ae,pe,we,ke){if(H/=L,pe>=(F/=L)&&we<H)return q;if(we<F||pe>=H)return null;const Te=[];for(const qe of q){const ct=qe.geometry;let Je=qe.type;const Ft=ae===0?qe.minX:qe.minY,De=ae===0?qe.maxX:qe.maxY;if(Ft>=F&&De<H){Te.push(qe);continue}if(De<F||Ft>=H)continue;let _i=[];if(Je==="Point"||Je==="MultiPoint")bi(ct,_i,F,H,ae);else if(Je==="LineString")Qt(ct,_i,F,H,ae,!1,ke.lineMetrics);else if(Je==="MultiLineString")Pi(ct,_i,F,H,ae,!1);else if(Je==="Polygon")Pi(ct,_i,F,H,ae,!0);else if(Je==="MultiPolygon")for(const rn of ct){const Gt=[];Pi(rn,Gt,F,H,ae,!0),Gt.length&&_i.push(Gt)}if(_i.length){if(ke.lineMetrics&&Je==="LineString"){for(const rn of _i)Te.push(fe(qe.id,Je,rn,qe.tags));continue}Je!=="LineString"&&Je!=="MultiLineString"||(_i.length===1?(Je="LineString",_i=_i[0]):Je="MultiLineString"),Je!=="Point"&&Je!=="MultiPoint"||(Je=_i.length===3?"Point":"MultiPoint"),Te.push(fe(qe.id,Je,_i,qe.tags))}}return Te.length?Te:null}function bi(q,L,F,H,ae){for(let pe=0;pe<q.length;pe+=3){const we=q[pe+ae];we>=F&&we<=H&&Yt(L,q[pe],q[pe+1],q[pe+2])}}function Qt(q,L,F,H,ae,pe,we){let ke=ri(q);const Te=ae===0?gi:jt;let qe,ct,Je=q.start;for(let Gt=0;Gt<q.length-3;Gt+=3){const xi=q[Gt],Yi=q[Gt+1],gn=q[Gt+2],_r=q[Gt+3],Sn=q[Gt+4],Zn=ae===0?xi:Yi,_n=ae===0?_r:Sn;let Vn=!1;we&&(qe=Math.sqrt(Math.pow(xi-_r,2)+Math.pow(Yi-Sn,2))),Zn<F?_n>F&&(ct=Te(ke,xi,Yi,_r,Sn,F),we&&(ke.start=Je+qe*ct)):Zn>H?_n<H&&(ct=Te(ke,xi,Yi,_r,Sn,H),we&&(ke.start=Je+qe*ct)):Yt(ke,xi,Yi,gn),_n<F&&Zn>=F&&(ct=Te(ke,xi,Yi,_r,Sn,F),Vn=!0),_n>H&&Zn<=H&&(ct=Te(ke,xi,Yi,_r,Sn,H),Vn=!0),!pe&&Vn&&(we&&(ke.end=Je+qe*ct),L.push(ke),ke=ri(q)),we&&(Je+=qe)}let Ft=q.length-3;const De=q[Ft],_i=q[Ft+1],rn=ae===0?De:_i;rn>=F&&rn<=H&&Yt(ke,De,_i,q[Ft+2]),Ft=ke.length-3,pe&&Ft>=3&&(ke[Ft]!==ke[0]||ke[Ft+1]!==ke[1])&&Yt(ke,ke[0],ke[1],ke[2]),ke.length&&L.push(ke)}function ri(q){const L=[];return L.size=q.size,L.start=q.start,L.end=q.end,L}function Pi(q,L,F,H,ae,pe){for(const we of q)Qt(we,L,F,H,ae,pe,!1)}function Yt(q,L,F,H){q.push(L,F,H)}function gi(q,L,F,H,ae,pe){const we=(pe-L)/(H-L);return Yt(q,pe,F+(ae-F)*we,1),we}function jt(q,L,F,H,ae,pe){const we=(pe-F)/(ae-F);return Yt(q,L+(H-L)*we,pe,1),we}function nn(q,L){const F=[];for(let H=0;H<q.length;H++){const ae=q[H],pe=ae.type;let we;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")we=Ti(ae.geometry,L);else if(pe==="MultiLineString"||pe==="Polygon"){we=[];for(const ke of ae.geometry)we.push(Ti(ke,L))}else if(pe==="MultiPolygon"){we=[];for(const ke of ae.geometry){const Te=[];for(const qe of ke)Te.push(Ti(qe,L));we.push(Te)}}F.push(fe(ae.id,pe,we,ae.tags))}return F}function Ti(q,L){const F=[];F.size=q.size,q.start!==void 0&&(F.start=q.start,F.end=q.end);for(let H=0;H<q.length;H+=3)F.push(q[H]+L,q[H+1],q[H+2]);return F}function zi(q,L){if(q.transformed)return q;const F=1<<q.z,H=q.x,ae=q.y;for(const pe of q.features){const we=pe.geometry,ke=pe.type;if(pe.geometry=[],ke===1)for(let Te=0;Te<we.length;Te+=2)pe.geometry.push(Gi(we[Te],we[Te+1],L,F,H,ae));else for(let Te=0;Te<we.length;Te++){const qe=[];for(let ct=0;ct<we[Te].length;ct+=2)qe.push(Gi(we[Te][ct],we[Te][ct+1],L,F,H,ae));pe.geometry.push(qe)}}return q.transformed=!0,q}function Gi(q,L,F,H,ae,pe){return[Math.round(F*(q*H-ae)),Math.round(F*(L*H-pe))]}function er(q,L,F,H,ae){const pe=L===ae.maxZoom?0:ae.tolerance/((1<<L)*ae.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:q.length,source:null,x:F,y:H,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of q)Xi(we,ke,pe,ae);return we}function Xi(q,L,F,H){const ae=L.geometry,pe=L.type,we=[];if(q.minX=Math.min(q.minX,L.minX),q.minY=Math.min(q.minY,L.minY),q.maxX=Math.max(q.maxX,L.maxX),q.maxY=Math.max(q.maxY,L.maxY),pe==="Point"||pe==="MultiPoint")for(let ke=0;ke<ae.length;ke+=3)we.push(ae[ke],ae[ke+1]),q.numPoints++,q.numSimplified++;else if(pe==="LineString")tr(we,ae,q,F,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(let ke=0;ke<ae.length;ke++)tr(we,ae[ke],q,F,pe==="Polygon",ke===0);else if(pe==="MultiPolygon")for(let ke=0;ke<ae.length;ke++){const Te=ae[ke];for(let qe=0;qe<Te.length;qe++)tr(we,Te[qe],q,F,!0,qe===0)}if(we.length){let ke=L.tags||null;if(pe==="LineString"&&H.lineMetrics){ke={};for(const qe in L.tags)ke[qe]=L.tags[qe];ke.mapbox_clip_start=ae.start/ae.size,ke.mapbox_clip_end=ae.end/ae.size}const Te={geometry:we,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:ke};L.id!==null&&(Te.id=L.id),q.features.push(Te)}}function tr(q,L,F,H,ae,pe){const we=H*H;if(H>0&&L.size<(ae?we:H))return void(F.numPoints+=L.length/3);const ke=[];for(let Te=0;Te<L.length;Te+=3)(H===0||L[Te+2]>we)&&(F.numSimplified++,ke.push(L[Te],L[Te+1])),F.numPoints++;ae&&(function(Te,qe){let ct=0;for(let Je=0,Ft=Te.length,De=Ft-2;Je<Ft;De=Je,Je+=2)ct+=(Te[Je]-Te[De])*(Te[Je+1]+Te[De+1]);if(ct>0===qe)for(let Je=0,Ft=Te.length;Je<Ft/2;Je+=2){const De=Te[Je],_i=Te[Je+1];Te[Je]=Te[Ft-2-Je],Te[Je+1]=Te[Ft-1-Je],Te[Ft-2-Je]=De,Te[Ft-1-Je]=_i}})(ke,pe),q.push(ke)}const Ei={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class mn{constructor(L,F){const H=(F=this.options=(function(pe,we){for(const ke in we)pe[ke]=we[ke];return pe})(Object.create(Ei),F)).debug;if(H&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");let ae=(function(pe,we){const ke=[];if(pe.type==="FeatureCollection")for(let Te=0;Te<pe.features.length;Te++)Ze(ke,pe.features[Te],we,Te);else Ze(ke,pe.type==="Feature"?pe:{geometry:pe},we);return ke})(L,F);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=(function(pe,we){const ke=we.buffer/we.extent;let Te=pe;const qe=Bt(pe,1,-1-ke,ke,0,-1,2,we),ct=Bt(pe,1,1-ke,2+ke,0,-1,2,we);return(qe||ct)&&(Te=Bt(pe,1,-ke,1+ke,0,-1,2,we)||[],qe&&(Te=nn(qe,1).concat(Te)),ct&&(Te=Te.concat(nn(ct,-1)))),Te})(ae,F),ae.length&&this.splitTile(ae,0,0,0),H&&(ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(L,F,H,ae,pe,we,ke){const Te=[L,F,H,ae],qe=this.options,ct=qe.debug;for(;Te.length;){ae=Te.pop(),H=Te.pop(),F=Te.pop(),L=Te.pop();const Je=1<<F,Ft=Ui(F,H,ae);let De=this.tiles[Ft];if(!De&&(ct>1&&console.time("creation"),De=this.tiles[Ft]=er(L,F,H,ae,qe),this.tileCoords.push({z:F,x:H,y:ae}),ct)){ct>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,H,ae,De.numFeatures,De.numPoints,De.numSimplified),console.timeEnd("creation"));const Vn=`z${F}`;this.stats[Vn]=(this.stats[Vn]||0)+1,this.total++}if(De.source=L,pe==null){if(F===qe.indexMaxZoom||De.numPoints<=qe.indexMaxPoints)continue}else{if(F===qe.maxZoom||F===pe)continue;if(pe!=null){const Vn=pe-F;if(H!==we>>Vn||ae!==ke>>Vn)continue}}if(De.source=null,L.length===0)continue;ct>1&&console.time("clipping");const _i=.5*qe.buffer/qe.extent,rn=.5-_i,Gt=.5+_i,xi=1+_i;let Yi=null,gn=null,_r=null,Sn=null,Zn=Bt(L,Je,H-_i,H+Gt,0,De.minX,De.maxX,qe),_n=Bt(L,Je,H+rn,H+xi,0,De.minX,De.maxX,qe);L=null,Zn&&(Yi=Bt(Zn,Je,ae-_i,ae+Gt,1,De.minY,De.maxY,qe),gn=Bt(Zn,Je,ae+rn,ae+xi,1,De.minY,De.maxY,qe),Zn=null),_n&&(_r=Bt(_n,Je,ae-_i,ae+Gt,1,De.minY,De.maxY,qe),Sn=Bt(_n,Je,ae+rn,ae+xi,1,De.minY,De.maxY,qe),_n=null),ct>1&&console.timeEnd("clipping"),Te.push(Yi||[],F+1,2*H,2*ae),Te.push(gn||[],F+1,2*H,2*ae+1),Te.push(_r||[],F+1,2*H+1,2*ae),Te.push(Sn||[],F+1,2*H+1,2*ae+1)}}getTile(L,F,H){L=+L,F=+F,H=+H;const ae=this.options,{extent:pe,debug:we}=ae;if(L<0||L>24)return null;const ke=1<<L,Te=Ui(L,F=F+ke&ke-1,H);if(this.tiles[Te])return zi(this.tiles[Te],pe);we>1&&console.log("drilling down to z%d-%d-%d",L,F,H);let qe,ct=L,Je=F,Ft=H;for(;!qe&&ct>0;)ct--,Je>>=1,Ft>>=1,qe=this.tiles[Ui(ct,Je,Ft)];return qe&&qe.source?(we>1&&(console.log("found parent tile z%d-%d-%d",ct,Je,Ft),console.time("drilling down")),this.splitTile(qe.source,ct,Je,Ft,L,F,H),we>1&&console.timeEnd("drilling down"),this.tiles[Te]?zi(this.tiles[Te],pe):null):null}}function Ui(q,L,F){return 32*((1<<q)*F+L)+q}class ee extends ce{constructor(L,F,H,ae=O){super(L,F,H),this._dataUpdateable=new Map,this._createGeoJSONIndex=ae}loadVectorTile(L,F){return z._(this,void 0,void 0,(function*(){const H=L.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ae=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!ae)return null;const pe=new Ye(ae.features,{version:2,extent:z.a3});let we=(function(ke){const Te=new z.cP;return(function(qe,ct){for(const Je in qe.layers)ct.writeMessage(3,Le,qe.layers[Je])})(ke,Te),Te.finish()})(pe);return we.byteOffset===0&&we.byteLength===we.buffer.byteLength||(we=new Uint8Array(we)),{vectorTile:pe,rawData:we.buffer}}))}loadData(L){return z._(this,void 0,void 0,(function*(){var F;(F=this._pendingRequest)===null||F===void 0||F.abort();const H=!!(L&&L.request&&L.request.collectResourceTiming)&&new z.cQ(L.request);this._pendingRequest=new AbortController;try{(!this._pendingData||L.request||L.data||L.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(L,this._pendingRequest));const ae=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(ae,L),this.loaded={};const pe={data:ae};if(H){const we=H.finish();we&&(pe.resourceTiming={},pe.resourceTiming[L.source]=JSON.parse(JSON.stringify(we)))}return pe}catch(ae){if(delete this._pendingRequest,z.cB(ae))return{abandoned:!0};throw ae}}))}getData(){return z._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(L){const F=this.loaded;return F&&F[L.uid]?super.reloadTile(L):this.loadTile(L)}loadAndProcessGeoJSON(L,F){return z._(this,void 0,void 0,(function*(){let H=yield this.loadGeoJSON(L,F);if(delete this._pendingRequest,typeof H!="object")throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(Ve(H,!0),L.filter){const ae=z.cW(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ae.result==="error")throw new Error(ae.value.map((we=>`${we.key}: ${we.message}`)).join(", "));H={type:"FeatureCollection",features:H.features.filter((we=>ae.value.evaluate({zoom:0},we)))}}return H}))}loadGeoJSON(L,F){return z._(this,void 0,void 0,(function*(){const{promoteId:H}=L;if(L.request){const ae=yield z.j(L.request,F);return this._dataUpdateable=z.cY(ae.data,H)?z.cX(ae.data,H):void 0,ae.data}if(typeof L.data=="string")try{const ae=JSON.parse(L.data);return this._dataUpdateable=z.cY(ae,H)?z.cX(ae,H):void 0,ae}catch{throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`)}if(!L.dataDiff)throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${L.source}`);return z.cZ(this._dataUpdateable,L.dataDiff,H),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(L){return z._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(L){return this._geoJSONIndex.getClusterExpansionZoom(L.clusterId)}getClusterChildren(L){return this._geoJSONIndex.getChildren(L.clusterId)}getClusterLeaves(L){return this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset)}}function O(q,L){return L.cluster?new Wt((function({superclusterOptions:F,clusterProperties:H}){if(!H||!F)return F;const ae={},pe={},we={accumulated:null,zoom:0},ke={properties:null},Te=Object.keys(H);for(const qe of Te){const[ct,Je]=H[qe],Ft=z.cW(Je),De=z.cW(typeof ct=="string"?[ct,["accumulated"],["get",qe]]:ct);ae[qe]=Ft.value,pe[qe]=De.value}return F.map=qe=>{ke.properties=qe;const ct={};for(const Je of Te)ct[Je]=ae[Je].evaluate(we,ke);return ct},F.reduce=(qe,ct)=>{ke.properties=ct;for(const Je of Te)we.accumulated=qe[Je],qe[Je]=pe[Je].evaluate(we,ke)},F})(L)).load(q.features):(function(F,H){return new mn(F,H)})(q,L.geojsonVtOptions)}class U{constructor(L){this.self=L,this.actor=new z.K(L),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(F,H)=>{if(this.externalWorkerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.externalWorkerSourceTypes[F]=H},this.self.addProtocol=z.cD,this.self.removeProtocol=z.cE,this.self.registerRTLTextPlugin=F=>{z.c_.setMethods(F)},this.actor.registerMessageHandler("LDT",((F,H)=>this._getDEMWorkerSource(F,H.source).loadTile(H))),this.actor.registerMessageHandler("RDT",((F,H)=>z._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(F,H.source).removeTile(H)})))),this.actor.registerMessageHandler("GCEZ",((F,H)=>z._(this,void 0,void 0,(function*(){return this._getWorkerSource(F,H.type,H.source).getClusterExpansionZoom(H)})))),this.actor.registerMessageHandler("GCC",((F,H)=>z._(this,void 0,void 0,(function*(){return this._getWorkerSource(F,H.type,H.source).getClusterChildren(H)})))),this.actor.registerMessageHandler("GCL",((F,H)=>z._(this,void 0,void 0,(function*(){return this._getWorkerSource(F,H.type,H.source).getClusterLeaves(H)})))),this.actor.registerMessageHandler("LD",((F,H)=>this._getWorkerSource(F,H.type,H.source).loadData(H))),this.actor.registerMessageHandler("GD",((F,H)=>this._getWorkerSource(F,H.type,H.source).getData())),this.actor.registerMessageHandler("LT",((F,H)=>this._getWorkerSource(F,H.type,H.source).loadTile(H))),this.actor.registerMessageHandler("RT",((F,H)=>this._getWorkerSource(F,H.type,H.source).reloadTile(H))),this.actor.registerMessageHandler("AT",((F,H)=>this._getWorkerSource(F,H.type,H.source).abortTile(H))),this.actor.registerMessageHandler("RMT",((F,H)=>this._getWorkerSource(F,H.type,H.source).removeTile(H))),this.actor.registerMessageHandler("RS",((F,H)=>z._(this,void 0,void 0,(function*(){if(!this.workerSources[F]||!this.workerSources[F][H.type]||!this.workerSources[F][H.type][H.source])return;const ae=this.workerSources[F][H.type][H.source];delete this.workerSources[F][H.type][H.source],ae.removeSource!==void 0&&ae.removeSource(H)})))),this.actor.registerMessageHandler("RM",(F=>z._(this,void 0,void 0,(function*(){delete this.layerIndexes[F],delete this.availableImages[F],delete this.workerSources[F],delete this.demWorkerSources[F],this.globalStates.delete(F)})))),this.actor.registerMessageHandler("SR",((F,H)=>z._(this,void 0,void 0,(function*(){this.referrer=H})))),this.actor.registerMessageHandler("SRPS",((F,H)=>this._syncRTLPluginState(F,H))),this.actor.registerMessageHandler("IS",((F,H)=>z._(this,void 0,void 0,(function*(){this.self.importScripts(H)})))),this.actor.registerMessageHandler("SI",((F,H)=>this._setImages(F,H))),this.actor.registerMessageHandler("UL",((F,H)=>z._(this,void 0,void 0,(function*(){this._getLayerIndex(F).update(H.layers,H.removedIds,this._getGlobalState(F))})))),this.actor.registerMessageHandler("UGS",((F,H)=>z._(this,void 0,void 0,(function*(){const ae=this._getGlobalState(F);for(const pe in H)ae[pe]=H[pe]})))),this.actor.registerMessageHandler("SL",((F,H)=>z._(this,void 0,void 0,(function*(){this._getLayerIndex(F).replace(H,this._getGlobalState(F))}))))}_getGlobalState(L){let F=this.globalStates.get(L);return F||(F={},this.globalStates.set(L,F)),F}_setImages(L,F){return z._(this,void 0,void 0,(function*(){this.availableImages[L]=F;for(const H in this.workerSources[L]){const ae=this.workerSources[L][H];for(const pe in ae)ae[pe].availableImages=F}}))}_syncRTLPluginState(L,F){return z._(this,void 0,void 0,(function*(){return yield z.c_.syncState(F,this.self.importScripts)}))}_getAvailableImages(L){let F=this.availableImages[L];return F||(F=[]),F}_getLayerIndex(L){let F=this.layerIndexes[L];return F||(F=this.layerIndexes[L]=new c),F}_getWorkerSource(L,F,H){if(this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][F]||(this.workerSources[L][F]={}),!this.workerSources[L][F][H]){const ae={sendAsync:(pe,we)=>(pe.targetMapId=L,this.actor.sendAsync(pe,we))};switch(F){case"vector":this.workerSources[L][F][H]=new ce(ae,this._getLayerIndex(L),this._getAvailableImages(L));break;case"geojson":this.workerSources[L][F][H]=new ee(ae,this._getLayerIndex(L),this._getAvailableImages(L));break;default:this.workerSources[L][F][H]=new this.externalWorkerSourceTypes[F](ae,this._getLayerIndex(L),this._getAvailableImages(L))}}return this.workerSources[L][F][H]}_getDEMWorkerSource(L,F){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][F]||(this.demWorkerSources[L][F]=new ge),this.demWorkerSources[L][F]}}return z.i(self)&&(self.worker=new U(self)),U})),P("index",["exports","./shared"],(function(z,c){var K="5.11.0";function $(){var p=new c.A(4);return c.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}let oe,ce;const ge={frame(p,e,a){const l=requestAnimationFrame((g=>{f(),e(g)})),{unsubscribe:f}=c.s(p.signal,"abort",(()=>{f(),cancelAnimationFrame(l),a(c.c())}),!1)},frameAsync(p){return new Promise(((e,a)=>{this.frame(p,e,a)}))},getImageData(p,e=0){return this.getImageCanvasContext(p).getImageData(-e,-e,p.width+2*e,p.height+2*e)},getImageCanvasContext(p){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=p.width,e.height=p.height,a.drawImage(p,0,0,p.width,p.height),a},resolveURL:p=>(oe||(oe=document.createElement("a")),oe.href=p,oe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ce==null&&(ce=matchMedia("(prefers-reduced-motion: reduce)")),ce.matches)}},Me=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(p){this._frozenAt=p}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function Ae(){return Me.getCurrentTime()}class ie{static testProp(e){if(!ie.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in ie.docStyle)return e[a];return e[0]}static create(e,a,l){const f=window.document.createElement(e);return a!==void 0&&(f.className=a),l&&l.appendChild(f),f}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){ie.docStyle&&ie.selectProp&&(ie.userSelect=ie.docStyle[ie.selectProp],ie.docStyle[ie.selectProp]="none")}static enableDrag(){ie.docStyle&&ie.selectProp&&(ie.docStyle[ie.selectProp]=ie.userSelect)}static setTransform(e,a){e.style[ie.transformProp]=a}static addEventListener(e,a,l,f={}){e.addEventListener(a,l,"passive"in f?f:f.capture)}static removeEventListener(e,a,l,f={}){e.removeEventListener(a,l,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ie.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ie.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ie.suppressClickInternal,!0)}),0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,l){const f=a.boundingClientRect;return new c.P((l.clientX-f.left)/a.x-e.clientLeft,(l.clientY-f.top)/a.y-e.clientTop)}static mousePos(e,a){const l=ie.getScale(e);return ie.getPoint(e,l,a)}static touchPos(e,a){const l=[],f=ie.getScale(e);for(let g=0;g<a.length;g++)l.push(ie.getPoint(e,f,a[g]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const f of l)f.remove();return ie.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const l of a)ie.removeAttributes(l),ie.clean(l)}static removeAttributes(e){for(const{name:a,value:l}of e.attributes)ie.isPossiblyDangerous(a,l)&&e.removeAttribute(a)}}ie.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ie.selectProp=ie.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ie.transformProp=ie.testProp(["transform","WebkitTransform"]);const Ve={supported:!1,testSupport:function(p){!Le&&Ye&&(Ke?_t(p):ot=p)}};let ot,Ye,Le=!1,Ke=!1;function _t(p){const e=p.createTexture();p.bindTexture(p.TEXTURE_2D,e);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,Ye),p.isContextLost())return;Ve.supported=!0}catch{}p.deleteTexture(e),Le=!0}var ht;typeof document<"u"&&(Ye=document.createElement("img"),Ye.onload=()=>{ot&&_t(ot),ot=null,Ke=!0},Ye.onerror=()=>{Le=!0,ot=null},Ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(p){let e,a,l,f;p.resetRequestQueue=()=>{e=[],a=0,l=0,f={}},p.addThrottleControl=A=>{const k=l++;return f[k]=A,k},p.removeThrottleControl=A=>{delete f[A],b()},p.getImage=(A,k,R=!0)=>new Promise(((N,j)=>{Ve.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),c.e(A,{type:"image"}),e.push({abortController:k,requestParameters:A,supportImageRefresh:R,state:"queued",onError:Y=>{j(Y)},onSuccess:Y=>{N(Y)}}),b()}));const g=A=>c._(this,void 0,void 0,(function*(){A.state="running";const{requestParameters:k,supportImageRefresh:R,onError:N,onSuccess:j,abortController:Y}=A,Q=R===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce(((le,de)=>le&&de==="accept"),!0));a++;const re=Q?M(k,Y):c.m(k,Y);try{const le=yield re;delete A.abortController,A.state="completed",le.data instanceof HTMLImageElement||c.b(le.data)?j(le):le.data&&j({data:yield(se=le.data,typeof createImageBitmap=="function"?c.f(se):c.h(se)),cacheControl:le.cacheControl,expires:le.expires})}catch(le){delete A.abortController,N(le)}finally{a--,b()}var se})),b=()=>{const A=(()=>{for(const k of Object.keys(f))if(f[k]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<A&&e.length>0;k++){const R=e.shift();R.abortController.signal.aborted?k--:g(R)}},M=(A,k)=>new Promise(((R,N)=>{const j=new Image,Y=A.url,Q=A.credentials;Q&&Q==="include"?j.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.d(Y))&&(j.crossOrigin="anonymous"),k.signal.addEventListener("abort",(()=>{j.src="",N(c.c())})),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,R({data:j})},j.onerror=()=>{j.onerror=j.onload=null,k.signal.aborted||N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=Y}))})(ht||(ht={})),ht.resetRequestQueue();class St{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function be(p){const e=[];if(typeof p=="string")e.push({id:"default",url:p});else if(p&&p.length>0){const a=[];for(const{id:l,url:f}of p){const g=`${l}${f}`;a.indexOf(g)===-1&&(a.push(g),e.push({id:l,url:f}))}}return e}function Ie(p,e,a){try{const l=new URL(p);return l.pathname+=`${e}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${p}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function tt(p){const{userImage:e}=p;return!!(e&&e.render&&e.render())&&(p.data.replace(new Uint8Array(e.data.buffer)),!0)}class bt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let l=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,a){if(!e)return!0;let l=0;for(const f of e){if(f[0]<l||f[1]<f[0]||a<f[1])return!1;l=f[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const l=a.spriteData,f=l&&l.width||a.data.width,g=l&&l.height||a.data.height;return!(e[0]<0||f<e[0]||e[1]<0||g<e[1]||e[2]<0||f<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,l=!0){const f=this.getImage(e);if(l&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((a,l)=>{let f=!0;if(!this.isLoaded())for(const g of e)this.images[g]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})}))}_getImagesForIds(e){const a={};for(const l of e){let f=this.getImage(l);f||(this.fire(new c.l("styleimagemissing",{id:l})),f=this.getImage(l)),f?a[l]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],l=this.getImage(e);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const f={w:l.data.width+2,h:l.data.height+2,x:0,y:0},g=new c.I(f,l);this.patterns[e]={bin:f,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const g in this.patterns)e.push(this.patterns[g].bin);const{w:a,h:l}=c.p(e),f=this.atlasImage;f.resize({width:a||1,height:l||1});for(const g in this.patterns){const{bin:b}=this.patterns[g],M=b.x+1,A=b.y+1,k=this.getImage(g).data,R=k.width,N=k.height;c.R.copy(k,f,{x:0,y:0},{x:M,y:A},{width:R,height:N}),c.R.copy(k,f,{x:0,y:N-1},{x:M,y:A-1},{width:R,height:1}),c.R.copy(k,f,{x:0,y:0},{x:M,y:A+N},{width:R,height:1}),c.R.copy(k,f,{x:R-1,y:0},{x:M-1,y:A},{width:1,height:N}),c.R.copy(k,f,{x:0,y:0},{x:M+R,y:A},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||c.w(`Image with ID: "${a}" was not found`),tt(l)&&this.updateImage(a,l)}}}const wt=1e20;function Wt(p,e,a,l,f,g,b,M,A){for(let k=e;k<e+l;k++)vi(p,a*g+k,g,f,b,M,A);for(let k=a;k<a+f;k++)vi(p,k*g+e,1,l,b,M,A)}function vi(p,e,a,l,f,g,b){g[0]=0,b[0]=-wt,b[1]=wt,f[0]=p[e];for(let M=1,A=0,k=0;M<l;M++){f[M]=p[e+M*a];const R=M*M;do{const N=g[A];k=(f[M]-f[N]+R-N*N)/(M-N)/2}while(k<=b[A]&&--A>-1);A++,g[A]=M,b[A]=k,b[A+1]=wt}for(let M=0,A=0;M<l;M++){for(;b[A+1]<M;)A++;const k=g[A],R=M-k;p[e+M*a]=f[k]+R*R}}const Si=c.v.layout_symbol["text-font"].default.join(",");class Ue{constructor(e,a,l){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,(function*(){const a=[];for(const g in e)for(const b of e[g])a.push(this._getAndCacheGlyphsPromise(g,b));const l=yield Promise.all(a),f={};for(const{stack:g,id:b,glyph:M}of l)f[g]||(f[g]={}),f[g][b]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return f}))}_getAndCacheGlyphsPromise(e,a){return c._(this,void 0,void 0,(function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=l.glyphs[a];return f!==void 0?{stack:e,id:a,glyph:f}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(f=l.glyphs[a]=this._drawGlyph(l,e,a),{stack:e,id:a,glyph:f}):yield this._downloadAndCacheRangePromise(e,a)}))}_downloadAndCacheRangePromise(e,a){return c._(this,void 0,void 0,(function*(){const l=Math.floor(a/256);if(256*l>65535)throw new Error("glyphs > 65535 not supported");const f=this.entries[e];if(f.ranges[l])return{stack:e,id:a,glyph:null};if(!f.requests[l]){const g=Ue.loadGlyphRange(e,l,this.url,this.requestManager);f.requests[l]=g}try{const g=yield f.requests[l];for(const b in g)f.glyphs[+b]=g[+b];return f.ranges[l]=!0,{stack:e,id:a,glyph:g[a]||null}}catch(g){const b=f.glyphs[a]=this._drawGlyph(f,e,a);return this._warnOnMissingGlyphRange(b,l,a,g),{stack:e,id:a,glyph:b}}}))}_warnOnMissingGlyphRange(e,a,l,f){const g=256*a,b=g+255,M=l.toString(16).padStart(4,"0").toUpperCase();c.w(`Unable to load glyph range ${a}, ${g}-${b}. Rendering codepoint U+${M} locally instead. ${f}`)}_charUsesLocalIdeographFontFamily(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_drawGlyph(e,a,l){const f=a===Si&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(l),g=f?"ideographTinySDF":"tinySDF";e[g]||(e[g]=this._createTinySDF(f?this.localIdeographFontFamily:a));const b=e[g].draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(e){const a=e?e.split(","):[];a.push("sans-serif");const l=a.map((f=>/[-\w]+/.test(f)?f:`'${CSS.escape(f)}'`)).join(",");return new Ue.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(e){return/italic/i.test(e)?"italic":/oblique/i.test(e)?"oblique":"normal"}_fontWeight(e){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let l;for(const[f,g]of Object.entries(a))new RegExp(`\\b${f}\\b`,"i").test(e)&&(l=`${g}`);return l}}Ue.loadGlyphRange=function(p,e,a,l){return c._(this,void 0,void 0,(function*(){const f=256*e,g=f+255,b=l.transformRequest(a.replace("{fontstack}",p).replace("{range}",`${f}-${g}`),"Glyphs"),M=yield c.n(b,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${g}`);const A={};for(const k of c.o(M.data))A[k.id]=k;return A}))},Ue.TinySDF=class{constructor({fontSize:p=24,buffer:e=3,radius:a=8,cutoff:l=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:b="normal",lang:M=null}={}){this.buffer=e,this.cutoff=l,this.radius=a,this.lang=M;const A=this.size=p+4*e,k=this._createCanvas(A),R=this.ctx=k.getContext("2d",{willReadFrequently:!0});R.font=`${b} ${g} ${p}px ${f}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(p){const e=document.createElement("canvas");return e.width=e.height=p,e}draw(p){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(p),b=Math.ceil(a),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),A=Math.min(this.size-this.buffer,b+Math.ceil(l)),k=M+2*this.buffer,R=A+2*this.buffer,N=Math.max(k*R,0),j=new Uint8ClampedArray(N),Y={data:j,width:k,height:R,glyphWidth:M,glyphHeight:A,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(M===0||A===0)return Y;const{ctx:Q,buffer:re,gridInner:se,gridOuter:le}=this;this.lang&&(Q.lang=this.lang),Q.clearRect(re,re,M,A),Q.fillText(p,re,re+b);const de=Q.getImageData(re,re,M,A);le.fill(wt,0,N),se.fill(0,0,N);for(let ye=0;ye<A;ye++)for(let he=0;he<M;he++){const ve=de.data[4*(ye*M+he)+3]/255;if(ve===0)continue;const Ee=(ye+re)*k+he+re;if(ve===1)le[Ee]=0,se[Ee]=wt;else{const me=.5-ve;le[Ee]=me>0?me*me:0,se[Ee]=me<0?me*me:0}}Wt(le,0,0,k,R,k,this.f,this.v,this.z),Wt(se,re,re,M,A,k,this.f,this.v,this.z);for(let ye=0;ye<N;ye++){const he=Math.sqrt(le[ye])-Math.sqrt(se[ye]);j[ye]=Math.round(255-255*(he/this.radius+this.cutoff))}return Y}};class et{constructor(){this.specification=c.t.light.position}possiblyEvaluate(e,a){return c.C(e.expression.evaluate(a))}interpolate(e,a,l){return{x:c.F.number(e.x,a.x,l),y:c.F.number(e.y,a.y,l),z:c.F.number(e.z,a.z,l)}}}let it;class dt extends c.E{constructor(e){super(),it=it||new c.r({anchor:new c.D(c.t.light.anchor),position:new et,color:new c.D(c.t.light.color),intensity:new c.D(c.t.light.intensity)}),this._transitionable=new c.x(it,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(c.y,e,a))for(const l in e){const f=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),f):this._transitionable.setValue(l,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l){return(!l||l.validate!==!1)&&c.z(this,e.call(c.B,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.t}))}}const Kt=new c.r({"sky-color":new c.D(c.t.sky["sky-color"]),"horizon-color":new c.D(c.t.sky["horizon-color"]),"fog-color":new c.D(c.t.sky["fog-color"]),"fog-ground-blend":new c.D(c.t.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.t.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.t.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.t.sky["atmosphere-blend"])});class fe extends c.E{constructor(e){super(),this._transitionable=new c.x(Kt,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.G(0))}setSky(e,a={}){if(!this._validate(c.H,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const f=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),f):this._transitionable.setValue(l,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l={}){return l?.validate!==!1&&c.z(this,e.call(c.B,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.t})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Re{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const l=e.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,a)),this.dashEntry[l]}getDashRanges(e,a,l){const f=[];let g=e.length%2==1?-e[e.length-1]*l:0,b=e[0]*l,M=!0;f.push({left:g,right:b,isDash:M,zeroLength:e[0]===0});let A=e[0];for(let k=1;k<e.length;k++){M=!M;const R=e[k];g=A*l,A+=R,b=A*l,f.push({left:g,right:b,isDash:M,zeroLength:R===0})}return f}addRoundDash(e,a,l){const f=a/2;for(let g=-l;g<=l;g++){const b=this.width*(this.nextRow+l+g);let M=0,A=e[M];for(let k=0;k<this.width;k++){k/A.right>1&&(A=e[++M]);const R=Math.abs(k-A.left),N=Math.abs(k-A.right),j=Math.min(R,N);let Y;const Q=g/l*(f+1);if(A.isDash){const re=f-Math.abs(Q);Y=Math.sqrt(j*j+re*re)}else Y=f-Math.sqrt(j*j+Q*Q);this.data[b+k]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(e){for(let M=e.length-1;M>=0;--M){const A=e[M],k=e[M+1];A.zeroLength?e.splice(M,1):k&&k.isDash===A.isDash&&(k.left=A.left,e.splice(M,1))}const a=e[0],l=e[e.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const f=this.width*this.nextRow;let g=0,b=e[g];for(let M=0;M<this.width;M++){M/b.right>1&&(b=e[++g]);const A=Math.abs(M-b.left),k=Math.abs(M-b.right),R=Math.min(A,k);this.data[f+M]=Math.max(0,Math.min(255,(b.isDash?R:-R)+128))}}addDash(e,a){const l=a?7:0,f=2*l+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let M=0;M<e.length;M++)g+=e[M];if(g!==0){const M=this.width/g,A=this.getDashRanges(e,this.width,M);a?this.addRoundDash(A,M,l):this.addRegularDash(A)}const b={y:this.nextRow+l,height:2*l,width:g};return this.nextRow+=f,this.dirty=!0,b}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Ze="maplibre_preloaded_worker_pool";class mt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<mt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ze]}numActive(){return Object.keys(this.active).length}}const It=Math.floor(ge.hardwareConcurrency/2);let Pt,Rt;function Dt(){return Pt||(Pt=new mt),Pt}mt.workerCount=c.J(globalThis)?Math.max(Math.min(It,3),1):1;class Bt{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let f=0;f<l.length;f++){const g=new c.K(l[f],a);g.name=`Worker ${f}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const l=[];for(const f of this.actors)l.push(f.sendAsync({type:e,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const l of this.actors)l.registerMessageHandler(e,a)}}function bi(){return Rt||(Rt=new Bt(Dt(),c.L),Rt.registerMessageHandler("GR",((p,e,a)=>c.m(e,a)))),Rt}function Qt(p,e){const a=c.M();return c.N(a,a,[1,1,0]),c.O(a,a,[.5*p.width,.5*p.height,1]),p.calculatePosMatrix?c.Q(a,a,p.calculatePosMatrix(e.toUnwrapped())):a}function ri(p,e,a,l,f,g,b){var M;const A=(function(j,Y,Q){if(j)for(const re of j){const se=Y[re];if(se&&se.source===Q&&se.type==="fill-extrusion")return!0}else for(const re in Y){const se=Y[re];if(se.source===Q&&se.type==="fill-extrusion")return!0}return!1})((M=f?.layers)!==null&&M!==void 0?M:null,e,p.id),k=g.maxPitchScaleFactor(),R=p.tilesIn(l,k,A);R.sort(Pi);const N=[];for(const j of R)N.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(e,a,p.getState(),j.queryGeometry,j.cameraQueryGeometry,j.scale,f,g,k,Qt(g,j.tileID),b?(Y,Q)=>b(j.tileID,Y,Q):void 0)});return(function(j,Y){for(const Q in j)for(const re of j[Q])Yt(re,Y);return j})((function(j){const Y={},Q={};for(const re of j){const se=re.queryResults,le=re.wrappedTileID,de=Q[le]=Q[le]||{};for(const ye in se){const he=se[ye],ve=de[ye]=de[ye]||{},Ee=Y[ye]=Y[ye]||[];for(const me of he)ve[me.featureIndex]||(ve[me.featureIndex]=!0,Ee.push(me))}}return Y})(N),p)}function Pi(p,e){const a=p.tileID,l=e.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function Yt(p,e){const a=p.feature,l=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function gi(p,e,a){return c._(this,void 0,void 0,(function*(){let l=p;if(p.url?l=(yield c.j(e.transformRequest(p.url,"Source"),a)).data:yield ge.frameAsync(a),!l)return null;const f=c.S(c.e(l,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(f.vectorLayerIds=l.vector_layers.map((g=>g.id))),f}))}class jt{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.U?new c.U(e.lng,e.lat):c.U.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.U?new c.U(e.lng,e.lat):c.U.convert(e),this}extend(e){const a=this._sw,l=this._ne;let f,g;if(e instanceof c.U)f=e,g=e;else{if(!(e instanceof jt))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(jt.convert(e)):this.extend(c.U.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.U.convert(e)):this;if(f=e._sw,g=e._ne,!f||!g)return this}return a||l?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),l.lng=Math.max(g.lng,l.lng),l.lat=Math.max(g.lat,l.lat)):(this._sw=new c.U(f.lng,f.lat),this._ne=new c.U(g.lng,g.lat)),this}getCenter(){return new c.U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.U(this.getWest(),this.getNorth())}getSouthEast(){return new c.U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:l}=c.U.convert(e);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f}intersects(e){if((e=jt.convert(e)).getNorth()<this.getSouth()||e.getSouth()>this.getNorth())return!1;const a=c.V(this.getWest(),-180,180),l=c.V(this.getEast(),-180,180),f=c.V(e.getWest(),-180,180),g=c.V(e.getEast(),-180,180),b=a>l,M=f>g;return!(!b||!M)||(b?g>=a||f<=l:M?l>=f||a<=g:!(f>l||g<a))}static convert(e){return e instanceof jt?e:e&&new jt(e)}static fromLngLat(e,a=0){const l=360*a/40075017,f=l/Math.cos(Math.PI/180*e.lat);return new jt(new c.U(e.lng-f,e.lat-l),new c.U(e.lng+f,e.lat+l))}adjustAntiMeridian(){const e=new c.U(this._sw.lng,this._sw.lat),a=new c.U(this._ne.lng,this._ne.lat);return new jt(e,e.lng>a.lng?new c.U(a.lng+360,a.lat):a)}}class nn{constructor(e,a,l){this.bounds=jt.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),l=Math.floor(c.X(this.bounds.getWest())*a),f=Math.floor(c.W(this.bounds.getNorth())*a),g=Math.ceil(c.X(this.bounds.getEast())*a),b=Math.ceil(c.W(this.bounds.getSouth())*a);return e.x>=l&&e.x<g&&e.y>=f&&e.y<b}}class Ti extends c.E{constructor(e,a,l,f){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.S(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield gi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new nn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((g,b)=>{e.reloadPromise={resolve:g,reject:b}}))}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const g=yield e.actor.sendAsync({type:f,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class zi extends c.E{constructor(e,a,l,f){super(),this.id=e,this.dispatcher=l,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.S(a,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield gi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new nn(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield ht.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const f=this.map.painter.context,g=f.gl,b=l.data;e.texture=this.map.painter.getTileTexture(b.width),e.texture?e.texture.update(b,{useMipmap:!0}):(e.texture=new c.T(f,b,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class Gi extends zi{constructor(e,a,l,f){super(e,a,l,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield ht.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const g=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const b=c.b(g)&&c.Y()?g:yield this.readImageNow(g),M={type:this.type,uid:e.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const A=yield e.actor.sendAsync({type:"LDT",data:M});e.dem=A,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}}))}readImageNow(e){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.Z()){const a=e.width+2,l=e.height+2;try{return new c.R({width:a,height:l},yield c.$(e,-1,-1,a,l))}catch{}}return ge.getImageData(e,1)}))}_getNeighboringTiles(e){const a=e.canonical,l=Math.pow(2,a.z),f=(a.x-1+l)%l,g=a.x===0?e.wrap-1:e.wrap,b=(a.x+1+l)%l,M=a.x+1===l?e.wrap+1:e.wrap,A={};return A[new c.a0(e.overscaledZ,g,a.z,f,a.y).key]={backfilled:!1},A[new c.a0(e.overscaledZ,M,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(A[new c.a0(e.overscaledZ,g,a.z,f,a.y-1).key]={backfilled:!1},A[new c.a0(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},A[new c.a0(e.overscaledZ,M,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<l&&(A[new c.a0(e.overscaledZ,g,a.z,f,a.y+1).key]={backfilled:!1},A[new c.a0(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},A[new c.a0(e.overscaledZ,M,a.z,b,a.y+1).key]={backfilled:!1}),A}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}function er(p){return p.type==="GeometryCollection"?p.geometries.map((e=>e.coordinates)).flat(1/0):p.coordinates.flat(1/0)}function Xi(p){const e=new jt;let a;switch(p.type){case"FeatureCollection":a=p.features.map((l=>er(l.geometry))).flat(1/0);break;case"Feature":a=er(p.geometry);break;default:a=er(p)}if(a.length==0)return e;for(let l=0;l<a.length-1;l+=2)e.extend([a[l],a[l+1]]);return e}class tr extends c.E{constructor(e,a,l,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(f),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:c.a3,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.a3,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(e){return e*(c.a3/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a4(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,(function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getBounds(){return c._(this,void 0,void 0,(function*(){return Xi(yield this.getData())}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:l}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void c.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:e,diff:a}=this._pendingWorkerUpdate,l=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(l.request=this.map._requestManager.transformRequest(ge.resolveURL(e),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=f.data;let g=null;f.resourceTiming&&f.resourceTiming[this.id]&&(g=f.resourceTiming[this.id].slice(0));const b={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(b,{resourceTiming:g}),this.fire(new c.l("data",Object.assign(Object.assign({},b),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},b),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(a)})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(f))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_getShouldReloadTileOptions(e){if(!e||e.removeAll)return;const{add:a=[],update:l=[],remove:f=[]}=e||{},g=new Set([...l.map((b=>b.id)),...f]);return{nextBounds:[...l.map((b=>b.newGeometry)),...a.map((b=>b.geometry))].map((b=>Xi(b))),prevIds:g}}shouldReloadTile(e,{nextBounds:a,prevIds:l}){const f=e.latestFeatureIndex.loadVTLayers();for(let A=0;A<e.latestFeatureIndex.featureIndexArray.length;A++){const k=e.latestFeatureIndex.featureIndexArray.get(A),R=f._geojsonTileLayer.feature(k.featureIndex);if(l.has(R.id))return!0}const{buffer:g,extent:b}=this.workerOptions.geojsonVtOptions,M=(function({x:A,y:k,z:R},N=0){const j=c.a1((A-N)/Math.pow(2,R)),Y=c.a2((k+1+N)/Math.pow(2,R)),Q=c.a1((A+1+N)/Math.pow(2,R)),re=c.a2((k-N)/Math.pow(2,R));return new jt([j,Y],[Q,re])})(e.tileID.canonical,g/b);for(const A of a)if(M.intersects(A))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,a==="RT")}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Ei extends c.E{constructor(e,a,l,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(e){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield ht.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(c.a5.fromLngLat);var l;return this.tileID=(function(f){const g=c.a6.fromPoints(f),b=g.width(),M=g.height(),A=Math.max(b,M),k=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),R=Math.pow(2,k);return new c.a8(k,Math.floor((g.minX+g.maxX)/2*R),Math.floor((g.minY+g.maxY)/2*R))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((f=>this.tileID.getTilePoint(f)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new c.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:l,maxX:f,maxY:g}=c.a6.fromPoints(e),b={};for(let M=0;M<=c.a7;M++){const A=Math.pow(2,M),k=Math.floor(a*A),R=Math.floor(l*A),N=Math.floor(f*A),j=Math.floor(g*A);b[M]={minTileX:k,minTileY:R,maxTileX:N,maxTileY:j}}return b}}class mn extends Ei{constructor(e,a,l,f){super(e,a,l,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a9(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new c.k(new c.aa(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ui extends Ei{constructor(e,a,l,f){super(e,a,l,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((g=>!Array.isArray(g)||g.length!==2||g.some((b=>typeof b!="number"))))||this.fire(new c.k(new c.aa(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.aa(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.k(new c.aa(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.aa(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.aa(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(a,this.canvas,l.RGBA,{premultiply:!0});let f=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ee={},O=p=>{switch(p){case"geojson":return tr;case"image":return Ei;case"raster":return zi;case"raster-dem":return Gi;case"vector":return Ti;case"video":return mn;case"canvas":return Ui}return ee[p]},U="RTLPluginLoaded";class q extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=bi()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ge.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(U))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let L=null;function F(){return L||(L=new q),L}var H,ae;(function(p){p[p.Base=0]="Base",p[p.Parent=1]="Parent"})(H||(H={})),(function(p){p[p.Departing=0]="Departing",p[p.Incoming=1]="Incoming"})(ae||(ae={}));class pe{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=e,this.uid=c.ab(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(e){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(e||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:e,fadingDirection:a,fadingParentID:l,fadeEndTime:f}){this.resetFadeLogic(),this.fadingRole=e,this.fadingDirection=a,this.fadingParentID=l,this.fadeEndTime=f}setSelfFadeLogic(e){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=e}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=Ae(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(f,g){const b={};if(!g)return b;for(const M of f){const A=M.layerIds.map((k=>g.getLayer(k))).filter(Boolean);if(A.length!==0){M.layers=A,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map((k=>A.filter((R=>R.id===k))[0])));for(const k of A)b[k.id]=M}}return b})(e.buckets,a?.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const g=this.buckets[f];if(g instanceof c.ad){if(this.hasSymbolBuckets=!0,!l)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const g=this.buckets[f];if(g instanceof c.ad&&g.hasRTLText){this.hasRTLText=!0,F().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new c.ac}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const f=this.buckets[l];f.uploadPending()&&f.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,l,f,g,b,M,A,k,R,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:g,scale:b,tileSize:this.tileSize,pixelPosMatrix:R,transform:A,params:M,queryPadding:this.queryPadding*k,getElevation:N},e,a,l):{}}querySourceFeatures(e,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const f=l.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",b=f._geojsonTileLayer||f[g];if(!b)return;const M=c.ae(a?.filter,a?.globalState),{z:A,x:k,y:R}=this.tileID.canonical,N={z:A,x:k,y:R};for(let j=0;j<b.length;j++){const Y=b.feature(j);if(M.needGeometry){const se=c.af(Y,!0);if(!M.filter(new c.G(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!M.filter(new c.G(this.tileID.overscaledZ),Y))continue;const Q=l.getId(Y,g),re=new c.ag(Y,A,k,R,Q);re.tile=N,e.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const l=c.ah(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let f=!1;if(this.expirationTime>l)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const g=this.expirationTime-a;g?this.expirationTime=l+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const g=this.buckets[f],b=g.layers[0].sourceLayer||"_geojsonTileLayer",M=l[b],A=e[b];if(!M||!A||Object.keys(A).length===0)continue;g.update(A,M,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const k=a&&a.style&&a.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(g)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ae()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(e){this.symbolFadeHoldUntil=Ae()+e}setDependencies(e,a){const l={};for(const f of a)l[f]=!0;this.dependencies[e]=l}hasDependency(e,a){for(const l of e){const f=this.dependencies[l];if(f){for(const g of a)if(f[g])return!0}}return!1}}class we{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,l){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const g={value:a,timeout:void 0};if(l!==void 0&&(g.timeout=setTimeout((()=>{this.remove(e,g)}),l)),this.data[f].push(g),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const l=e.wrapped().key,f=a===void 0?0:this.data[l].indexOf(a),g=this.data[l][f];return this.data[l].splice(f,1),g.timeout&&clearTimeout(g.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(g.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const l in this.data)for(const f of this.data[l])e(f.value)||a.push(f);for(const l of a)this.remove(l.value.tileID,l)}}class ke{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,l){const f=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},c.e(this.stateChanges[e][f],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==f&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const g in this.state[e][f])l[g]||(this.deletedStates[e][f][g]=null)}else for(const g in l)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][g]===null&&delete this.deletedStates[e][f][g]}removeFeatureState(e,a,l){if(this.deletedStates[e]===null)return;const f=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&a!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][l]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(l in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][l]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,a){const l=String(a),f=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][a];if(g===null)return{};for(const b in g)delete f[b]}return f}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const l={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const g={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),c.e(this.state[f][b],this.stateChanges[f][b]),g[b]=this.state[f][b];l[f]=g}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const g={};if(this.deletedStates[f]===null)for(const b in this.state[f])g[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const M of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][M];g[b]=this.state[f][b]}l[f]=l[f]||{},c.e(l[f],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const f in e)e[f].setFeatureState(l,a)}}const Te=89.25;function qe(p,e){const a=c.ai(e.lat,-c.aj,c.aj);return new c.P(c.X(e.lng)*p,c.W(a)*p)}function ct(p,e){return new c.a5(e.x/p,e.y/p).toLngLat()}function Je(p){return p.cameraToCenterDistance*Math.min(.85*Math.tan(c.ak(90-p.pitch)),Math.tan(c.ak(Te-p.pitch)))}function Ft(p,e){const a=p.canonical,l=e/c.al(a.z),f=a.x+Math.pow(2,a.z)*p.wrap,g=c.am(new Float64Array(16));return c.N(g,g,[f*l,a.y*l,0]),c.O(g,g,[l/c.a3,l/c.a3,1]),g}function De(p,e,a,l,f){const g=c.a5.fromLngLat(p,e),b=f*c.an(1,p.lat),M=b*Math.cos(c.ak(a)),A=Math.sqrt(b*b-M*M),k=A*Math.sin(c.ak(-l)),R=A*Math.cos(c.ak(-l));return new c.a5(g.x+k,g.y+R,g.z+M)}function _i(p,e,a){const l=e.intersectsFrustum(p);if(!a||l===0)return l;const f=e.intersectsPlane(a);return f===0?0:l===2&&f===2?2:1}function rn(p,e,a){let l=0;const f=(a-e)/10;for(let g=0;g<10;g++)l+=f*Math.pow(Math.cos(e+(g+.5)/10*(a-e)),p);return l}function Gt(p,e){return function(a,l,f,g,b){const M=2*((p-1)/c.ao(Math.cos(c.ak(Te-b))/Math.cos(c.ak(Te)))-1),A=Math.acos(f/g),k=2*rn(M-1,0,c.ak(b/2)),R=Math.min(c.ak(Te),A+c.ak(b/2)),N=rn(M-1,Math.min(R,A-c.ak(b/2)),R),j=Math.atan(l/f),Y=Math.hypot(l,f);let Q=a;return Q+=c.ao(g/Y/Math.max(.5,Math.cos(c.ak(b/2)))),Q+=M*c.ao(Math.cos(j))/2,Q-=c.ao(Math.max(1,N/k/e))/2,Q}}const xi=Gt(9.314,3);function Yi(p,e){const a=(e.roundZoom?Math.round:Math.floor)(p.zoom+c.ao(p.tileSize/e.tileSize));return Math.max(0,a)}function gn(p,e){const a=p.getCameraFrustum(),l=p.getClippingPlane(),f=p.screenPointToMercatorCoordinate(p.getCameraPoint()),g=c.a5.fromLngLat(p.center,p.elevation);f.z=g.z+Math.cos(p.pitchInRadians)*p.cameraToCenterDistance/p.worldSize;const b=p.getCoveringTilesDetailsProvider(),M=b.allowVariableZoom(p,e),A=Yi(p,e),k=e.minzoom||0,R=e.maxzoom!==void 0?e.maxzoom:p.maxZoom,N=Math.min(Math.max(0,A),R),j=Math.pow(2,N),Y=[j*f.x,j*f.y,0],Q=[j*g.x,j*g.y,0],re=Math.hypot(g.x-f.x,g.y-f.y),se=Math.abs(g.z-f.z),le=Math.hypot(re,se),de=ve=>({zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),ye=[],he=[];if(p.renderWorldCopies&&b.allowWorldCopies())for(let ve=1;ve<=3;ve++)ye.push(de(-ve)),ye.push(de(ve));for(ye.push(de(0));ye.length>0;){const ve=ye.pop(),Ee=ve.x,me=ve.y;let ze=ve.fullyVisible;const Ge={x:Ee,y:me,z:ve.zoom},Oe=b.getTileBoundingVolume(Ge,ve.wrap,p.elevation,e);if(!ze){const vt=_i(a,Oe,l);if(vt===0)continue;ze=vt===2}const Ne=b.distanceToTile2d(f.x,f.y,Ge,Oe);let $e=A;M&&($e=(e.calculateTileZoom||xi)(p.zoom+c.ao(p.tileSize/e.tileSize),Ne,se,le,p.fov)),$e=(e.roundZoom?Math.round:Math.floor)($e),$e=Math.max(0,$e);const yt=Math.min($e,R);if(ve.wrap=b.getWrap(g,Ge,ve.wrap),ve.zoom>=yt){if(ve.zoom<k)continue;const vt=N-ve.zoom,nt=Y[0]-.5-(Ee<<vt),kt=Y[1]-.5-(me<<vt),oi=e.reparseOverscaled?Math.max(ve.zoom,$e):ve.zoom;he.push({tileID:new c.a0(ve.zoom===R?oi:ve.zoom,ve.wrap,ve.zoom,Ee,me),distanceSq:c.ap([Q[0]-.5-Ee,Q[1]-.5-me]),tileDistanceToCamera:Math.sqrt(nt*nt+kt*kt)})}else for(let vt=0;vt<4;vt++)ye.push({zoom:ve.zoom+1,x:(Ee<<1)+vt%2,y:(me<<1)+(vt>>1),wrap:ve.wrap,fullyVisible:ze})}return he.sort(((ve,Ee)=>ve.distanceSq-Ee.distanceSq)).map((ve=>ve.tileID))}const _r=c.a6.fromPoints([new c.P(0,0),new c.P(c.a3,c.a3)]);class Sn extends c.E{constructor(e,a,l){super(),this.id=e,this.dispatcher=l,this.on("data",(f=>this._dataHandler(f))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((f,g,b,M)=>{const A=new(O(g.type))(f,g,b,M);if(A.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${A.id}`);return A})(e,a,l,this),this._tiles={},this._cache=new we(0,(f=>this._unloadTile(f))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new ke,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,l){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,l)}catch(f){e.state="errored",f.status!==404?this._source.fire(new c.k(f,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const l=this._tiles[a];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Zn).map((e=>e.key))}getRenderableIds(e){const a=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&a.push(this._tiles[l]);return e?a.sort(((l,f)=>{const g=l.tileID,b=f.tileID,M=new c.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),A=new c.P(b.canonical.x,b.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-b.overscaledZ||A.y-M.y||A.x-M.x})).map((l=>l.tileID.key)):a.map((l=>l.tileID)).sort(Zn).map((l=>l.key))}hasRenderableParent(e){const a=e.overscaledZ-1;if(a>=this._source.minzoom){const l=this.getLoadedTile(e.scaledTo(a));if(l)return this._isIdRenderable(l.tileID.key)}return!1}_isIdRenderable(e,a=!1){var l;return(l=this._tiles[e])===null||l===void 0?void 0:l.isRenderable(a)}reload(e,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)a&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[l],a)||(e?this._reloadTile(l,"expired"):this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading"))}}_reloadTile(e,a){return c._(this,void 0,void 0,(function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,e,a))}))}_tileLoaded(e,a,l){e.timeAdded=Ae(),e.selfFading&&(e.fadeEndTime=e.timeAdded+this._rasterFadeDuration),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let f=0;f<a.length;f++){const g=a[f];if(e.neighboringTiles&&e.neighboringTiles[g]){const b=this.getTileByID(g);l(e,b),l(b,e)}}function l(f,g){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let b=g.tileID.canonical.x-f.tileID.canonical.x;const M=g.tileID.canonical.y-f.tileID.canonical.y,A=Math.pow(2,f.tileID.canonical.z),k=g.tileID.key;b===0&&M===0||Math.abs(M)>1||(Math.abs(b)>1&&(Math.abs(b+A)===1?b+=A:Math.abs(b-A)===1&&(b-=A)),g.dem&&f.dem&&(f.dem.backfillBorder(g.dem,b,M),f.neighboringTiles&&f.neighboringTiles[k]&&(f.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a){const l=Object.values(e),f=this._getLoadedDescendents(l),g={};for(const b of l){const M=f[b.key];if(!M?.length){g[b.key]=b;continue}const A=b.overscaledZ+Sn.maxUnderzooming,k=M.filter((j=>j.tileID.overscaledZ<=A));if(!k.length){g[b.key]=b;continue}const R=Math.min(...k.map((j=>j.tileID.overscaledZ))),N=k.filter((j=>j.tileID.overscaledZ===R)).map((j=>j.tileID));for(const j of N)a[j.key]=j;this._areDescendentsComplete(N,R,b.overscaledZ)||(g[b.key]=b)}return g}_getLoadedDescendents(e){var a;const l={};for(const f in this._tiles){const g=this._tiles[f];if(g.hasData())for(const b of e)g.tileID.isChildOf(b)&&(l[a=b.key]||(l[a]=[])).push(g)}return l}_areDescendentsComplete(e,a,l){return e.length===1&&e[0].isOverscaled()?e[0].overscaledZ===a:Math.pow(4,a-l)===e.length}getLoadedTile(e){const a=this._tiles[e.key];return a?.hasData()?a:null}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const l={};for(const f in this._tiles){const g=this._tiles[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),l[g.tileID.key]=g}this._tiles=l,this._resetTileReloadTimers()}}update(e,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((A=>new c.a0(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y))):(l=gn(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((A=>this._source.hasTile(A))))):l=[],this.usedForTerrain&&(l=this._addTerrainIdealTiles(l));const f=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,f&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const g=Yi(e,this._source),b=this._updateRetainedTiles(l,g),M=_n(this._source.type);M&&this._rasterFadeDuration>0&&!a&&this._updateFadingTiles(l,b),M?this._cleanUpRasterTiles(b):this._cleanUpVectorTiles(b)}_cleanUpRasterTiles(e){for(const a in this._tiles)e[a]||this._removeTile(a)}_cleanUpVectorTiles(e){for(const a in this._tiles){const l=this._tiles[a];e[a]?l.clearSymbolFadeHold():l.hasSymbolBuckets?l.holdingForSymbolFade()?l.symbolFadeFinished()&&this._removeTile(a):l.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(e){const a=[];for(const l of e)if(l.canonical.z>this._source.minzoom){const f=l.scaledTo(l.canonical.z-1);a.push(f);const g=l.scaledTo(Math.max(this._source.minzoom,Math.min(l.canonical.z,5)));a.push(g)}return e.concat(a)}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForSymbolFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var l;const f={},g={},b=Math.max(a-Sn.maxOverzooming,this._source.minzoom);let M={};for(const A of e){const k=this._addTile(A);f[A.key]=A,k.hasData()||(M[A.key]=A)}M=this._retainLoadedChildren(M,f);for(const A in M){const k=M[A];let R=this._tiles[A],N=R?.wasRequested();for(let j=k.overscaledZ-1;j>=b;--j){const Y=k.scaledTo(j);if(g[Y.key])break;if(g[Y.key]=!0,R=this.getTile(Y),!R&&N&&(R=this._addTile(Y)),R){const Q=R.hasData();if((Q||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||N)&&(f[Y.key]=Y),N=R.wasRequested(),Q)break}}}return f}_updateFadingTiles(e,a){const l=Ae(),f=c.aq(e);for(const g of e){const b=this._tiles[g.key];b.fadingDirection!==ae.Departing&&b.fadeOpacity!==0||b.resetFadeLogic(),this._updateFadingAncestor(b,a,l)||this._updateFadingDescendents(b,a,l)||this._updateFadingEdge(b,f,l)||b.resetFadeLogic()}}_updateFadingAncestor(e,a,l){if(!e.hasData())return!1;const{tileID:f,fadingRole:g,fadingDirection:b,fadingParentID:M}=e;if(g===H.Base&&b===ae.Incoming&&M)return a[M.key]=M,!0;const A=Math.max(f.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let k=f.overscaledZ-1;k>=A;k--){const R=f.scaledTo(k),N=this.getLoadedTile(R);if(N)return e.setCrossFadeLogic({fadingRole:H.Base,fadingDirection:ae.Incoming,fadingParentID:N.tileID,fadeEndTime:l+this._rasterFadeDuration}),N.setCrossFadeLogic({fadingRole:H.Parent,fadingDirection:ae.Departing,fadeEndTime:l+this._rasterFadeDuration}),a[R.key]=R,!0}return!1}_updateFadingDescendents(e,a,l){if(!e.hasData())return!1;const f=e.tileID.children(this._source.maxzoom);let g=this._updateFadingChildren(e,f,a,l);if(g)return!0;for(const b of f){const M=b.children(this._source.maxzoom);this._updateFadingChildren(e,M,a,l)&&(g=!0)}return g}_updateFadingChildren(e,a,l,f){if(a[0].overscaledZ>=this._source.maxzoom)return!1;let g=!1;for(const b of a){const M=this.getLoadedTile(b);if(!M)continue;const{fadingRole:A,fadingDirection:k,fadingParentID:R}=M;A===H.Base&&k===ae.Departing&&R||(M.setCrossFadeLogic({fadingRole:H.Base,fadingDirection:ae.Departing,fadingParentID:e.tileID,fadeEndTime:f+this._rasterFadeDuration}),e.setCrossFadeLogic({fadingRole:H.Parent,fadingDirection:ae.Incoming,fadeEndTime:f+this._rasterFadeDuration})),l[b.key]=b,g=!0}return g}_updateFadingEdge(e,a,l){const f=e.tileID;return!!e.selfFading||!e.hasData()&&!!a.has(f)&&(e.setSelfFadeLogic(l+this._rasterFadeDuration),!0)}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(a.resetFadeLogic(),this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null));const l=a;return a||(a=new pe(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,l||this._source.fire(new c.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){this._clearTileReloadTimer(e);const l=a.getExpiryTimeout();l&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),l))}_clearTileReloadTimer(e){const a=this._timers[e];a&&(clearTimeout(a),delete this._timers[e])}_resetTileReloadTimers(){for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some((l=>l.equals(this._tiles[a].tileID.canonical)))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._clearTileReloadTimer(e),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){e.dataType==="source"&&(e.sourceDataType!=="metadata"?e.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(e.sourceDataChanged,e.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,l){const f=[],g=this.transform;if(!g)return f;const b=g.getCoveringTilesDetailsProvider().allowWorldCopies(),M=l?g.getCameraQueryGeometry(e):e,A=Y=>g.screenPointToMercatorCoordinate(Y,this.terrain),k=this.transformBbox(e,A,!b),R=this.transformBbox(M,A,!b),N=this.getIds(),j=c.a6.fromPoints(R);for(let Y=0;Y<N.length;Y++){const Q=this._tiles[N[Y]];if(Q.holdingForSymbolFade())continue;const re=b?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],se=Math.pow(2,g.zoom-Q.tileID.overscaledZ),le=a*Q.queryPadding*c.a3/Q.tileSize/se;for(const de of re){const ye=j.map((he=>de.getTilePoint(new c.a5(he.x,he.y))));if(ye.expandBy(le),ye.intersects(_r)){const he=k.map((Ee=>de.getTilePoint(Ee))),ve=R.map((Ee=>de.getTilePoint(Ee)));f.push({tile:Q,tileID:b?de:de.unwrapTo(0),queryGeometry:he,cameraQueryGeometry:ve,scale:se})}}}return f}transformBbox(e,a,l){let f=e.map(a);if(l){const g=c.a6.fromPoints(e);g.shrinkBy(.001*Math.min(g.width(),g.height()));const b=g.map(a);c.a6.fromPoints(f).covers(b)||(f=f.map((M=>M.x>.5?new c.a5(M.x-1,M.y,M.z):M)))}return f}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((l=>this._tiles[l].tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(_n(this._source.type)&&this._rasterFadeDuration>0){const e=Ae();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setRasterFadeDuration(e){this._rasterFadeDuration=e}setFeatureState(e,a,l){this._state.updateState(e=e||"_geojsonTileLayer",a,l)}removeFeatureState(e,a,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,l)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,l){const f=this._tiles[e];f&&f.setDependencies(a,l)}reloadTilesForDependencies(e,a){for(const l in this._tiles)this._tiles[l].hasDependency(e,a)&&this._reloadTile(l,"reloading");this._cache.filter((l=>!l.hasDependency(e,a)))}}function Zn(p,e){const a=Math.abs(2*p.wrap)-+(p.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return p.overscaledZ-e.overscaledZ||l-a||e.canonical.y-p.canonical.y||e.canonical.x-p.canonical.x}function _n(p){return p==="raster"||p==="image"||p==="video"}Sn.maxOverzooming=10,Sn.maxUnderzooming=3;class Vn{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ai(e,0,1);let a=1,l=this._distances[a];const f=e*this.paddedLength+this.padding;for(;l<f&&a<this._distances.length;)l=this._distances[++a];const g=a-1,b=this._distances[g],M=l-b,A=M>0?(f-b)/M:0;return this.points[g].mult(1-A).add(this.points[a].mult(A))}}function at(p,e){let a=!0;return p==="always"||p!=="never"&&e!=="never"||(a=!1),a}class Rn{constructor(e,a,l){const f=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(a/l);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,l,f,g){this._forEachCell(a,l,f,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(g)}insertCircle(e,a,l,f){this._forEachCell(a-f,l-f,a+f,l+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(l),this.circles.push(f)}_insertBoxCell(e,a,l,f,g,b){this.boxCells[g].push(b)}_insertCircleCell(e,a,l,f,g,b){this.circleCells[g].push(b)}_query(e,a,l,f,g,b,M){if(l<0||e>this.width||f<0||a>this.height)return[];const A=[];if(e<=0&&a<=0&&this.width<=l&&this.height<=f){if(g)return[{key:null,x1:e,y1:a,x2:l,y2:f}];for(let k=0;k<this.boxKeys.length;k++)A.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const R=this.circles[3*k],N=this.circles[3*k+1],j=this.circles[3*k+2];A.push({key:this.circleKeys[k],x1:R-j,y1:N-j,x2:R+j,y2:N+j})}}else this._forEachCell(e,a,l,f,this._queryCell,A,{hitTest:g,overlapMode:b,seenUids:{box:{},circle:{}}},M);return A}query(e,a,l,f){return this._query(e,a,l,f,!1,null)}hitTest(e,a,l,f,g,b){return this._query(e,a,l,f,!0,g,b).length>0}hitTestCircle(e,a,l,f,g){const b=e-l,M=e+l,A=a-l,k=a+l;if(M<0||b>this.width||k<0||A>this.height)return!1;const R=[];return this._forEachCell(b,A,M,k,this._queryCellCircle,R,{hitTest:!0,overlapMode:f,circle:{x:e,y:a,radius:l},seenUids:{box:{},circle:{}}},g),R.length>0}_queryCell(e,a,l,f,g,b,M,A){const{seenUids:k,hitTest:R,overlapMode:N}=M,j=this.boxCells[g];if(j!==null){const Q=this.bboxes;for(const re of j)if(!k.box[re]){k.box[re]=!0;const se=4*re,le=this.boxKeys[re];if(e<=Q[se+2]&&a<=Q[se+3]&&l>=Q[se+0]&&f>=Q[se+1]&&(!A||A(le))&&(!R||!at(N,le.overlapMode))&&(b.push({key:le,x1:Q[se],y1:Q[se+1],x2:Q[se+2],y2:Q[se+3]}),R))return!0}}const Y=this.circleCells[g];if(Y!==null){const Q=this.circles;for(const re of Y)if(!k.circle[re]){k.circle[re]=!0;const se=3*re,le=this.circleKeys[re];if(this._circleAndRectCollide(Q[se],Q[se+1],Q[se+2],e,a,l,f)&&(!A||A(le))&&(!R||!at(N,le.overlapMode))){const de=Q[se],ye=Q[se+1],he=Q[se+2];if(b.push({key:le,x1:de-he,y1:ye-he,x2:de+he,y2:ye+he}),R)return!0}}}return!1}_queryCellCircle(e,a,l,f,g,b,M,A){const{circle:k,seenUids:R,overlapMode:N}=M,j=this.boxCells[g];if(j!==null){const Q=this.bboxes;for(const re of j)if(!R.box[re]){R.box[re]=!0;const se=4*re,le=this.boxKeys[re];if(this._circleAndRectCollide(k.x,k.y,k.radius,Q[se+0],Q[se+1],Q[se+2],Q[se+3])&&(!A||A(le))&&!at(N,le.overlapMode))return b.push(!0),!0}}const Y=this.circleCells[g];if(Y!==null){const Q=this.circles;for(const re of Y)if(!R.circle[re]){R.circle[re]=!0;const se=3*re,le=this.circleKeys[re];if(this._circlesCollide(Q[se],Q[se+1],Q[se+2],k.x,k.y,k.radius)&&(!A||A(le))&&!at(N,le.overlapMode))return b.push(!0),!0}}}_forEachCell(e,a,l,f,g,b,M,A){const k=this._convertToXCellCoord(e),R=this._convertToYCellCoord(a),N=this._convertToXCellCoord(l),j=this._convertToYCellCoord(f);for(let Y=k;Y<=N;Y++)for(let Q=R;Q<=j;Q++)if(g.call(this,e,a,l,f,this.xCellCount*Q+Y,b,M,A))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,l,f,g,b){const M=f-e,A=g-a,k=l+b;return k*k>M*M+A*A}_circleAndRectCollide(e,a,l,f,g,b,M){const A=(b-f)/2,k=Math.abs(e-(f+A));if(k>A+l)return!1;const R=(M-g)/2,N=Math.abs(a-(g+R));if(N>R+l)return!1;if(k<=A||N<=R)return!0;const j=k-A,Y=N-R;return j*j+Y*Y<=l*l}}function jr(p,e,a){const l=c.M();if(!p){const{vecSouth:N,vecEast:j}=Ni(e),Y=$();Y[0]=j[0],Y[1]=j[1],Y[2]=N[0],Y[3]=N[1],f=Y,(R=(b=(g=Y)[0])*(k=g[3])-(A=g[2])*(M=g[1]))&&(f[0]=k*(R=1/R),f[1]=-M*R,f[2]=-A*R,f[3]=b*R),l[0]=Y[0],l[1]=Y[1],l[4]=Y[2],l[5]=Y[3]}var f,g,b,M,A,k,R;return c.O(l,l,[1/a,1/a,1]),l}function ga(p,e,a,l){if(p){const f=c.M();if(!e){const{vecSouth:g,vecEast:b}=Ni(a);f[0]=b[0],f[1]=b[1],f[4]=g[0],f[5]=g[1]}return c.O(f,f,[l,l,1]),f}return a.pixelsToClipSpaceMatrix}function Ni(p){const e=Math.cos(p.rollInRadians),a=Math.sin(p.rollInRadians),l=Math.cos(p.pitchInRadians),f=Math.cos(p.bearingInRadians),g=Math.sin(p.bearingInRadians),b=c.av();b[0]=-f*l*a-g*e,b[1]=-g*l*a+f*e;const M=c.aw(b);M<1e-9?c.ax(b):c.ay(b,b,1/M);const A=c.av();A[0]=f*l*e-g*a,A[1]=g*l*e+f*a;const k=c.aw(A);return k<1e-9?c.ax(A):c.ay(A,A,1/k),{vecEast:A,vecSouth:b}}function gt(p,e,a,l){let f;l?(f=[p,e,l(p,e),1],c.aA(f,f,a)):(f=[p,e,0,1],jo(f,f,a));const g=f[3];return{point:new c.P(f[0]/g,f[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function ai(p,e){return .5+p/e*.5}function yi(p,e){return p.x>=-e[0]&&p.x<=e[0]&&p.y>=-e[1]&&p.y<=e[1]}function $a(p,e,a,l,f,g,b,M,A,k,R,N,j){const Y=a?p.textSizeData:p.iconSizeData,Q=c.ar(Y,e.transform.zoom),re=[256/e.width*2+1,256/e.height*2+1],se=a?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;se.clear();const le=p.lineVertexArray,de=a?p.text.placedSymbolArray:p.icon.placedSymbolArray,ye=e.transform.width/e.transform.height;let he=!1;for(let ve=0;ve<de.length;ve++){const Ee=de.get(ve);if(Ee.hidden||Ee.writingMode===c.as.vertical&&!he){Ha(Ee.numGlyphs,se);continue}he=!1;const me=new c.P(Ee.anchorX,Ee.anchorY),ze={getElevation:j,pitchedLabelPlaneMatrix:l,lineVertexArray:le,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:me,unwrappedTileID:A,width:k,height:R,translation:N},Ge=os(Ee.anchorX,Ee.anchorY,ze);if(!yi(Ge.point,re)){Ha(Ee.numGlyphs,se);continue}const Oe=ai(e.transform.cameraToCenterDistance,Ge.signedDistanceFromCamera),Ne=c.at(Y,Q,Ee),$e=g?Ne*e.transform.getPitchedTextCorrection(Ee.anchorX,Ee.anchorY,A)/Oe:Ne*Oe,yt=ci({projectionContext:ze,pitchedLabelPlaneMatrixInverse:f,symbol:Ee,fontSize:$e,flip:!1,keepUpright:b,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ye,rotateToLine:M});he=yt.useVertical,(yt.notEnoughRoom||he||yt.needsFlipping&&ci({projectionContext:ze,pitchedLabelPlaneMatrixInverse:f,symbol:Ee,fontSize:$e,flip:!0,keepUpright:b,glyphOffsetArray:p.glyphOffsetArray,dynamicLayoutVertexArray:se,aspectRatio:ye,rotateToLine:M}).notEnoughRoom)&&Ha(Ee.numGlyphs,se)}a?p.text.dynamicLayoutVertexBuffer.updateData(se):p.icon.dynamicLayoutVertexBuffer.updateData(se)}function tc(p,e,a,l,f,g,b,M){const A=g.glyphStartIndex+g.numGlyphs,k=g.lineStartIndex,R=g.lineStartIndex+g.lineLength,N=e.getoffsetX(g.glyphStartIndex),j=e.getoffsetX(A-1),Y=Ir(p*N,a,l,f,g.segment,k,R,M,b);if(!Y)return null;const Q=Ir(p*j,a,l,f,g.segment,k,R,M,b);return Q?M.projectionCache.anyProjectionOccluded?null:{first:Y,last:Q}:null}function As(p,e,a,l){return p===c.as.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*l?{useVertical:!0}:(p===c.as.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function ci(p){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:f,flip:g,keepUpright:b,glyphOffsetArray:M,dynamicLayoutVertexArray:A,aspectRatio:k,rotateToLine:R}=p,N=f/24,j=l.lineOffsetX*N,Y=l.lineOffsetY*N;let Q;if(l.numGlyphs>1){const re=l.glyphStartIndex+l.numGlyphs,se=l.lineStartIndex,le=l.lineStartIndex+l.lineLength,de=tc(N,M,j,Y,g,l,R,e);if(!de)return{notEnoughRoom:!0};const ye=Ca(de.first.point.x,de.first.point.y,e,a),he=Ca(de.last.point.x,de.last.point.y,e,a);if(b&&!g){const ve=As(l.writingMode,ye,he,k);if(ve)return ve}Q=[de.first];for(let ve=l.glyphStartIndex+1;ve<re-1;ve++){const Ee=Ir(N*M.getoffsetX(ve),j,Y,g,l.segment,se,le,e,R);if(!Ee)return{notEnoughRoom:!0};Q.push(Ee)}Q.push(de.last)}else{if(b&&!g){const se=Xr(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,le=l.lineStartIndex+l.segment+1,de=new c.P(e.lineVertexArray.getx(le),e.lineVertexArray.gety(le)),ye=Xr(de.x,de.y,e),he=ye.signedDistanceFromCamera>0?ye.point:Fo(e.tileAnchorPoint,de,se,1,e),ve=Ca(se.x,se.y,e,a),Ee=Ca(he.x,he.y,e,a),me=As(l.writingMode,ve,Ee,k);if(me)return me}const re=Ir(N*M.getoffsetX(l.glyphStartIndex),j,Y,g,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,R);if(!re||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[re]}for(const re of Q)c.az(A,re.point,re.angle);return{}}function Fo(p,e,a,l,f){const g=p.add(p.sub(e)._unit()),b=Xr(g.x,g.y,f).point,M=a.sub(b);return a.add(M._mult(l/M.mag()))}function za(p,e,a){const l=e.projectionCache;if(l.projections[p])return l.projections[p];const f=new c.P(e.lineVertexArray.getx(p),e.lineVertexArray.gety(p)),g=Xr(f.x,f.y,e);if(g.signedDistanceFromCamera>0)return l.projections[p]=g.point,l.anyProjectionOccluded=l.anyProjectionOccluded||g.isOccluded,g.point;const b=p-a.direction;return Fo(a.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Xr(p,e,a){const l=p+a.translation[0],f=e+a.translation[1];let g;return a.pitchWithMap?(g=gt(l,f,a.pitchedLabelPlaneMatrix,a.getElevation),g.isOccluded=!1):(g=a.transform.projectTileCoordinates(l,f,a.unwrappedTileID,a.getElevation),g.point.x=(.5*g.point.x+.5)*a.width,g.point.y=(.5*-g.point.y+.5)*a.height),g}function Ca(p,e,a,l){if(a.pitchWithMap){const f=[p,e,0,1];return c.aA(f,f,l),a.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],a.unwrappedTileID,a.getElevation).point}return{x:p/a.width*2-1,y:1-e/a.height*2}}function os(p,e,a){return a.transform.projectTileCoordinates(p,e,a.unwrappedTileID,a.getElevation)}function Cn(p,e,a){return p._unit()._perp()._mult(e*a)}function ic(p,e,a,l,f,g,b,M,A){if(M.projectionCache.offsets[p])return M.projectionCache.offsets[p];const k=a.add(e);if(p+A.direction<l||p+A.direction>=f)return M.projectionCache.offsets[p]=k,k;const R=za(p+A.direction,M,A),N=Cn(R.sub(a),b,A.direction),j=a.add(N),Y=R.add(N);return M.projectionCache.offsets[p]=c.aB(g,k,j,Y)||k,M.projectionCache.offsets[p]}function Ir(p,e,a,l,f,g,b,M,A){const k=l?p-e:p+e;let R=k>0?1:-1,N=0;l&&(R*=-1,N=Math.PI),R<0&&(N+=Math.PI);let j,Y=R>0?g+f:g+f+1;M.projectionCache.cachedAnchorPoint?j=M.projectionCache.cachedAnchorPoint:(j=Xr(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=j);let Q,re,se=j,le=j,de=0,ye=0;const he=Math.abs(k),ve=[];let Ee;for(;de+ye<=he;){if(Y+=R,Y<g||Y>=b)return null;de+=ye,le=se,re=Q;const Ge={absOffsetX:he,direction:R,distanceFromAnchor:de,previousVertex:le};if(se=za(Y,M,Ge),a===0)ve.push(le),Ee=se.sub(le);else{let Oe;const Ne=se.sub(le);Oe=Ne.mag()===0?Cn(za(Y+R,M,Ge).sub(se),a,R):Cn(Ne,a,R),re||(re=le.add(Oe)),Q=ic(Y,Oe,se,g,b,re,a,M,Ge),ve.push(re),Ee=Q.sub(re)}ye=Ee.mag()}const me=Ee._mult((he-de)/ye)._add(re||le),ze=N+Math.atan2(se.y-le.y,se.x-le.x);return ve.push(me),{point:me,angle:A?ze:0,path:ve}}const Wi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ha(p,e){for(let a=0;a<p;a++){const l=e.length;e.resize(l+4),e.float32.set(Wi,3*l)}}function jo(p,e,a){const l=e[0],f=e[1];return p[0]=a[0]*l+a[4]*f+a[12],p[1]=a[1]*l+a[5]*f+a[13],p[3]=a[3]*l+a[7]*f+a[15],p}const Gn=100;class co{constructor(e,a=new Rn(e.width+200,e.height+200,25),l=new Rn(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Gn,this.screenBottomBoundary=e.height+Gn,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,l,f,g,b,M,A,k,R,N,j){const Y=this.projectAndGetPerspectiveRatio(e.anchorPointX+A[0],e.anchorPointY+A[1],g,R,j),Q=l*Y.perspectiveRatio;let re;if(b||M)re=this._projectCollisionBox(e,Q,f,g,b,M,A,Y,R,N,j);else{const Ee=Y.x+(N?N.x*Q:0),me=Y.y+(N?N.y*Q:0);re={allPointsOccluded:!1,box:[Ee+e.x1*Q,me+e.y1*Q,Ee+e.x2*Q,me+e.y2*Q]}}const[se,le,de,ye]=re.box,he=b?re.allPointsOccluded:Y.isOccluded;let ve=he;return ve||(ve=Y.perspectiveRatio<this.perspectiveRatioCutoff),ve||(ve=!this.isInsideGrid(se,le,de,ye)),ve||a!=="always"&&this.grid.hitTest(se,le,de,ye,a,k)?{box:[se,le,de,ye],placeable:!1,offscreen:!1,occluded:he}:{box:[se,le,de,ye],placeable:!0,offscreen:this.isOffscreen(se,le,de,ye),occluded:he}}placeCollisionCircles(e,a,l,f,g,b,M,A,k,R,N,j,Y,Q){const re=[],se=new c.P(a.anchorX,a.anchorY),le=this.getPerspectiveRatio(se.x,se.y,b,Q),de=(k?g*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,b)/le:g*le)/c.aF,ye={getElevation:Q,pitchedLabelPlaneMatrix:M,lineVertexArray:l,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:se,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:Y},he=tc(de,f,a.lineOffsetX*de,a.lineOffsetY*de,!1,a,!1,ye);let ve=!1,Ee=!1,me=!0;if(he){const ze=.5*N*le+j,Ge=new c.P(-100,-100),Oe=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ne=new Vn,$e=he.first,yt=he.last;let vt=[];for(let oi=$e.path.length-1;oi>=1;oi--)vt.push($e.path[oi]);for(let oi=1;oi<yt.path.length;oi++)vt.push(yt.path[oi]);const nt=2.5*ze;if(k){const oi=this.projectPathToScreenSpace(vt,ye);vt=oi.some((Zi=>Zi.signedDistanceFromCamera<=0))?[]:oi.map((Zi=>Zi.point))}let kt=[];if(vt.length>0){const oi=vt[0].clone(),Zi=vt[0].clone();for(let mi=1;mi<vt.length;mi++)oi.x=Math.min(oi.x,vt[mi].x),oi.y=Math.min(oi.y,vt[mi].y),Zi.x=Math.max(Zi.x,vt[mi].x),Zi.y=Math.max(Zi.y,vt[mi].y);kt=oi.x>=Ge.x&&Zi.x<=Oe.x&&oi.y>=Ge.y&&Zi.y<=Oe.y?[vt]:Zi.x<Ge.x||oi.x>Oe.x||Zi.y<Ge.y||oi.y>Oe.y?[]:c.aC([vt],Ge.x,Ge.y,Oe.x,Oe.y)}for(const oi of kt){Ne.reset(oi,.25*ze);let Zi=0;Zi=Ne.length<=.5*ze?1:Math.ceil(Ne.paddedLength/nt)+1;for(let mi=0;mi<Zi;mi++){const Ji=mi/Math.max(Zi-1,1),Mn=Ne.lerp(Ji),sn=Mn.x+Gn,Hn=Mn.y+Gn;re.push(sn,Hn,ze,0);const vn=sn-ze,rr=Hn-ze,bn=sn+ze,jn=Hn+ze;if(me=me&&this.isOffscreen(vn,rr,bn,jn),Ee=Ee||this.isInsideGrid(vn,rr,bn,jn),e!=="always"&&this.grid.hitTestCircle(sn,Hn,ze,e,R)&&(ve=!0,!A))return{circles:[],offscreen:!1,collisionDetected:ve}}}}return{circles:!A&&ve||!Ee||le<this.perspectiveRatioCutoff?[]:re,offscreen:me,collisionDetected:ve}}projectPathToScreenSpace(e,a){const l=(function(f,g){const b=c.M();return c.au(b,g.pitchedLabelPlaneMatrix),f.map((M=>{const A=gt(M.x,M.y,b,g.getElevation),k=g.transform.projectTileCoordinates(A.point.x,A.point.y,g.unwrappedTileID,g.getElevation);return k.point.x=(.5*k.point.x+.5)*g.width,k.point.y=(.5*-k.point.y+.5)*g.height,k}))})(e,a);return(function(f){let g=0,b=0,M=0,A=0;for(let k=0;k<f.length;k++)f[k].isOccluded?(M=k+1,A=0):(A++,A>b&&(b=A,g=M));return f.slice(g,g+b)})(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new c.a6;for(const N of e){const j=new c.P(N.x+Gn,N.y+Gn);l.extend(j),a.push(j)}const{minX:f,minY:g,maxX:b,maxY:M}=l,A=this.grid.query(f,g,b,M).concat(this.ignoredGrid.query(f,g,b,M)),k={},R={};for(const N of A){const j=N.key;if(k[j.bucketInstanceId]===void 0&&(k[j.bucketInstanceId]={}),k[j.bucketInstanceId][j.featureIndex])continue;const Y=[new c.P(N.x1,N.y1),new c.P(N.x2,N.y1),new c.P(N.x2,N.y2),new c.P(N.x1,N.y2)];c.aD(a,Y)&&(k[j.bucketInstanceId][j.featureIndex]=!0,R[j.bucketInstanceId]===void 0&&(R[j.bucketInstanceId]=[]),R[j.bucketInstanceId].push(j.featureIndex))}return R}insertCollisionBox(e,a,l,f,g,b){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:g,collisionGroupID:b,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,l,f,g,b){const M=l?this.ignoredGrid:this.grid,A={bucketInstanceId:f,featureIndex:g,collisionGroupID:b,overlapMode:a};for(let k=0;k<e.length;k+=4)M.insertCircle(A,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,a,l,f,g){if(g){let b;f?(b=[e,a,f(e,a),1],c.aA(b,b,g)):(b=[e,a,0,1],jo(b,b,g));const M=b[3];return{x:(b[0]/M+1)/2*this.transform.width+Gn,y:(-b[1]/M+1)/2*this.transform.height+Gn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M*.5,isOccluded:!1,signedDistanceFromCamera:M}}{const b=this.transform.projectTileCoordinates(e,a,l,f);return{x:(b.point.x+1)/2*this.transform.width+Gn,y:(1-b.point.y)/2*this.transform.height+Gn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5,isOccluded:b.isOccluded,signedDistanceFromCamera:b.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,l,f){const g=this.transform.projectTileCoordinates(e,a,l,f);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,a,l,f){return l<Gn||e>=this.screenRightBoundary||f<Gn||a>this.screenBottomBoundary}isInsideGrid(e,a,l,f){return l>=0&&e<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=c.am([]);return c.N(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,l,f,g,b,M,A,k,R,N){let j=1,Y=0,Q=0,re=1;const se=e.anchorPointX+M[0],le=e.anchorPointY+M[1];if(b&&!g){const vt=this.projectAndGetPerspectiveRatio(se+1,le,f,k,N),nt=vt.x-A.x,kt=Math.atan((vt.y-A.y)/nt)+(nt<0?Math.PI:0),oi=Math.sin(kt),Zi=Math.cos(kt);j=Zi,Y=oi,Q=-oi,re=Zi}else if(!b&&g){const vt=Ni(this.transform);j=vt.vecEast[0],Y=vt.vecEast[1],Q=vt.vecSouth[0],re=vt.vecSouth[1]}let de=A.x,ye=A.y,he=a;g&&(de=se,ye=le,he=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),he*=this.transform.getPitchedTextCorrection(se,le,f),R||(he*=c.ai(.5+A.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),R&&(de+=j*R.x*he+Q*R.y*he,ye+=Y*R.x*he+re*R.y*he);const ve=e.x1*he,Ee=e.x2*he,me=(ve+Ee)/2,ze=e.y1*he,Ge=e.y2*he,Oe=(ze+Ge)/2,Ne=[{offsetX:ve,offsetY:ze},{offsetX:me,offsetY:ze},{offsetX:Ee,offsetY:ze},{offsetX:Ee,offsetY:Oe},{offsetX:Ee,offsetY:Ge},{offsetX:me,offsetY:Ge},{offsetX:ve,offsetY:Ge},{offsetX:ve,offsetY:Oe}];let $e=[];for(const{offsetX:vt,offsetY:nt}of Ne)$e.push(new c.P(de+j*vt+Q*nt,ye+Y*vt+re*nt));let yt=!1;if(g){const vt=$e.map((nt=>this.projectAndGetPerspectiveRatio(nt.x,nt.y,f,k,N)));yt=vt.some((nt=>!nt.isOccluded)),$e=vt.map((nt=>new c.P(nt.x,nt.y)))}else yt=!0;return{box:c.aE($e),allPointsOccluded:!yt}}}class zs{constructor(e,a,l,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):f&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Cs{constructor(e,a,l,f,g){this.text=new zs(e?e.text:null,a,l,g),this.icon=new zs(e?e.icon:null,a,f,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class El{constructor(e,a,l){this.text=e,this.icon=a,this.skipFade=l}}class ls{constructor(e,a,l,f,g){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=f,this.tileID=g}}class Pr{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[e]}}function nu(p,e,a,l,f){const{horizontalAlign:g,verticalAlign:b}=c.aL(p);return new c.P(-(g-.5)*e+l[0]*f,-(b-.5)*a+l[1]*f)}class Ef{constructor(e,a,l,f,g){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new co(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Pr(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(l,f)=>a.getElevation(e,l,f):null}getBucketParts(e,a,l,f){const g=l.getBucket(a),b=l.latestFeatureIndex;if(!g||!b||a.id!==g.layerIds[0])return;const M=l.collisionBoxArray,A=g.layers[0].layout,k=g.layers[0].paint,R=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),N=l.tileSize/c.a3,j=l.tileID.toUnwrapped(),Y=A.get("text-rotation-alignment")==="map",Q=c.aG(l,1,this.transform.zoom),re=c.aH(this.collisionIndex.transform,l,k.get("text-translate"),k.get("text-translate-anchor")),se=c.aH(this.collisionIndex.transform,l,k.get("icon-translate"),k.get("icon-translate-anchor")),le=jr(Y,this.transform,Q);this.retainedQueryData[g.bucketInstanceId]=new ls(g.bucketInstanceId,b,g.sourceLayerIndex,g.index,l.tileID);const de={bucket:g,layout:A,translationText:re,translationIcon:se,unwrappedTileID:j,pitchedLabelPlaneMatrix:le,scale:R,textPixelRatio:N,holdingForFade:l.holdingForSymbolFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:c.ar(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(f)for(const ye of g.sortKeyRanges){const{sortKey:he,symbolInstanceStart:ve,symbolInstanceEnd:Ee}=ye;e.push({sortKey:he,symbolInstanceStart:ve,symbolInstanceEnd:Ee,parameters:de})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:de})}attemptAnchorPlacement(e,a,l,f,g,b,M,A,k,R,N,j,Y,Q,re,se,le,de,ye,he){const ve=c.aI[e.textAnchor],Ee=[e.textOffset0,e.textOffset1],me=nu(ve,l,f,Ee,g),ze=this.collisionIndex.placeCollisionBox(a,j,A,k,R,M,b,se,N.predicate,ye,me,he);if((!de||this.collisionIndex.placeCollisionBox(de,j,A,k,R,M,b,le,N.predicate,ye,me,he).placeable)&&ze.placeable){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Ee,width:l,height:f,anchor:ve,textBoxScale:g,prevAnchor:Ge},this.markUsedJustification(Q,ve,Y,re),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,re,Y),this.placedOrientations[Y.crossTileID]=re),{shift:me,placedGlyphBoxes:ze}}}placeLayerBucketPart(e,a,l){const{bucket:f,layout:g,translationText:b,translationIcon:M,unwrappedTileID:A,pitchedLabelPlaneMatrix:k,textPixelRatio:R,holdingForFade:N,collisionBoxArray:j,partiallyEvaluatedTextSize:Y,collisionGroup:Q}=e.parameters,re=g.get("text-optional"),se=g.get("icon-optional"),le=c.aJ(g,"text-overlap","text-allow-overlap"),de=le==="always",ye=c.aJ(g,"icon-overlap","icon-allow-overlap"),he=ye==="always",ve=g.get("text-rotation-alignment")==="map",Ee=g.get("text-pitch-alignment")==="map",me=g.get("icon-text-fit")!=="none",ze=g.get("symbol-z-order")==="viewport-y",Ge=de&&(he||!f.hasIconData()||se),Oe=he&&(de||!f.hasTextData()||re);!f.collisionArrays&&j&&f.deserializeCollisionBoxes(j);const Ne=this.retainedQueryData[f.bucketInstanceId].tileID,$e=this._getTerrainElevationFunc(Ne),yt=this.transform.getFastPathSimpleProjectionMatrix(Ne),vt=(nt,kt,oi)=>{var Zi,mi;if(a[nt.crossTileID])return;if(N)return void(this.placements[nt.crossTileID]=new El(!1,!1,!1));let Ji=!1,Mn=!1,sn=!0,Hn=null,vn={box:null,placeable:!1,offscreen:null,occluded:!1},rr={placeable:!1},bn=null,jn=null,Or=null,Ao=0,xs=0,ws=0;kt.textFeatureIndex?Ao=kt.textFeatureIndex:nt.useRuntimeCollisionCircles&&(Ao=nt.featureIndex),kt.verticalTextFeatureIndex&&(xs=kt.verticalTextFeatureIndex);const Ks=kt.textBox;if(Ks){const Gr=Un=>{let xn=c.as.horizontal;if(f.allowVerticalPlacement&&!Un&&this.prevPlacement){const ar=this.prevPlacement.placedOrientations[nt.crossTileID];ar&&(this.placedOrientations[nt.crossTileID]=ar,xn=ar,this.markUsedOrientation(f,xn,nt))}return xn},Ss=(Un,xn)=>{if(f.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&kt.verticalTextBox){for(const ar of f.writingModes)if(ar===c.as.vertical?(vn=xn(),rr=vn):vn=Un(),vn&&vn.placeable)break}else vn=Un()},Co=nt.textAnchorOffsetStartIndex,Dc=nt.textAnchorOffsetEndIndex;if(Dc===Co){const Un=(xn,ar)=>{const en=this.collisionIndex.placeCollisionBox(xn,le,R,Ne,A,Ee,ve,b,Q.predicate,$e,void 0,yt);return en&&en.placeable&&(this.markUsedOrientation(f,ar,nt),this.placedOrientations[nt.crossTileID]=ar),en};Ss((()=>Un(Ks,c.as.horizontal)),(()=>{const xn=kt.verticalTextBox;return f.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&xn?Un(xn,c.as.vertical):{box:null,offscreen:null}})),Gr(vn&&vn.placeable)}else{let Un=c.aI[(mi=(Zi=this.prevPlacement)===null||Zi===void 0?void 0:Zi.variableOffsets[nt.crossTileID])===null||mi===void 0?void 0:mi.anchor];const xn=(en,Ua,Qs)=>{const Gl=en.x2-en.x1,Dh=en.y2-en.y1,Bu=nt.textBoxScale,Io=me&&ye==="never"?Ua:null;let Js=null,kc=le==="never"?1:2,Rc="never";Un&&kc++;for(let Lu=0;Lu<kc;Lu++){for(let ia=Co;ia<Dc;ia++){const eo=f.textAnchorOffsets.get(ia);if(Un&&eo.textAnchor!==Un)continue;const Bc=this.attemptAnchorPlacement(eo,en,Gl,Dh,Bu,ve,Ee,R,Ne,A,Q,Rc,nt,f,Qs,b,M,Io,$e);if(Bc&&(Js=Bc.placedGlyphBoxes,Js&&Js.placeable))return Ji=!0,Hn=Bc.shift,Js}Un?Un=null:Rc=le}return l&&!Js&&(Js={box:this.collisionIndex.placeCollisionBox(Ks,"always",R,Ne,A,Ee,ve,b,Q.predicate,$e,void 0,yt).box,offscreen:!1,placeable:!1,occluded:!1}),Js};Ss((()=>xn(Ks,kt.iconBox,c.as.horizontal)),(()=>{const en=kt.verticalTextBox;return f.allowVerticalPlacement&&(!vn||!vn.placeable)&&nt.numVerticalGlyphVertices>0&&en?xn(en,kt.verticalIconBox,c.as.vertical):{box:null,occluded:!0,offscreen:null}})),vn&&(Ji=vn.placeable,sn=vn.offscreen);const ar=Gr(vn&&vn.placeable);if(!Ji&&this.prevPlacement){const en=this.prevPlacement.variableOffsets[nt.crossTileID];en&&(this.variableOffsets[nt.crossTileID]=en,this.markUsedJustification(f,en.anchor,nt,ar))}}}if(bn=vn,Ji=bn&&bn.placeable,sn=bn&&bn.offscreen,nt.useRuntimeCollisionCircles&&nt.centerJustifiedTextSymbolIndex>=0){const Gr=f.text.placedSymbolArray.get(nt.centerJustifiedTextSymbolIndex),Ss=c.at(f.textSizeData,Y,Gr),Co=g.get("text-padding");jn=this.collisionIndex.placeCollisionCircles(le,Gr,f.lineVertexArray,f.glyphOffsetArray,Ss,A,k,l,Ee,Q.predicate,nt.collisionCircleDiameter,Co,b,$e),jn.circles.length&&jn.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),Ji=de||jn.circles.length>0&&!jn.collisionDetected,sn=sn&&jn.offscreen}if(kt.iconFeatureIndex&&(ws=kt.iconFeatureIndex),kt.iconBox){const Gr=Ss=>this.collisionIndex.placeCollisionBox(Ss,ye,R,Ne,A,Ee,ve,M,Q.predicate,$e,me&&Hn?Hn:void 0,yt);rr&&rr.placeable&&kt.verticalIconBox?(Or=Gr(kt.verticalIconBox),Mn=Or.placeable):(Or=Gr(kt.iconBox),Mn=Or.placeable),sn=sn&&Or.offscreen}const fl=re||nt.numHorizontalGlyphVertices===0&&nt.numVerticalGlyphVertices===0,zo=se||nt.numIconVertices===0;fl||zo?zo?fl||(Mn=Mn&&Ji):Ji=Mn&&Ji:Mn=Ji=Mn&&Ji;const Vr=Mn&&Or.placeable;if(Ji&&bn.placeable&&this.collisionIndex.insertCollisionBox(bn.box,le,g.get("text-ignore-placement"),f.bucketInstanceId,rr&&rr.placeable&&xs?xs:Ao,Q.ID),Vr&&this.collisionIndex.insertCollisionBox(Or.box,ye,g.get("icon-ignore-placement"),f.bucketInstanceId,ws,Q.ID),jn&&Ji&&this.collisionIndex.insertCollisionCircles(jn.circles,le,g.get("text-ignore-placement"),f.bucketInstanceId,Ao,Q.ID),l&&this.storeCollisionData(f.bucketInstanceId,oi,kt,bn,Or,jn),nt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[nt.crossTileID]=new El((Ji||Ge)&&!bn?.occluded,(Mn||Oe)&&!Or?.occluded,sn||f.justReloaded),a[nt.crossTileID]=!0};if(ze){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const nt=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let kt=nt.length-1;kt>=0;--kt){const oi=nt[kt];vt(f.symbolInstances.get(oi),f.collisionArrays[oi],oi)}}else for(let nt=e.symbolInstanceStart;nt<e.symbolInstanceEnd;nt++)vt(f.symbolInstances.get(nt),f.collisionArrays[nt],nt);f.justReloaded=!1}storeCollisionData(e,a,l,f,g,b){if(l.textBox||l.iconBox){let M,A;this.collisionBoxArrays.has(e)?M=this.collisionBoxArrays.get(e):(M=new Map,this.collisionBoxArrays.set(e,M)),M.has(a)?A=M.get(a):(A={text:null,icon:null},M.set(a,A)),l.textBox&&(A.text=f.box),l.iconBox&&(A.icon=g.box)}if(b){let M=this.collisionCircleArrays[e];M===void 0&&(M=this.collisionCircleArrays[e]=[]);for(let A=0;A<b.circles.length;A+=4)M.push(b.circles[A+0]-Gn),M.push(b.circles[A+1]-Gn),M.push(b.circles[A+2]),M.push(b.collisionDetected?1:0)}}markUsedJustification(e,a,l,f){let g;g=f===c.as.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aK(a)];const b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const M of b)M>=0&&(e.text.placedSymbolArray.get(M).crossTileID=g>=0&&M!==g?0:l.crossTileID)}markUsedOrientation(e,a,l){const f=a===c.as.horizontal||a===c.as.horizontalOnly?a:0,g=a===c.as.vertical?a:0,b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const M of b)e.text.placedSymbolArray.get(M).placedOrientation=f;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(e):1,g=a?a.opacities:{},b=a?a.variableOffsets:{},M=a?a.placedOrientations:{};for(const A in this.placements){const k=this.placements[A],R=g[A];R?(this.opacities[A]=new Cs(R,f,k.text,k.icon),l=l||k.text!==R.text.placed||k.icon!==R.icon.placed):(this.opacities[A]=new Cs(null,f,k.text,k.icon,k.skipFade),l=l||k.text||k.icon)}for(const A in g){const k=g[A];if(!this.opacities[A]){const R=new Cs(k,f,!1,!1);R.isHidden()||(this.opacities[A]=R,l=l||k.text.placed||k.icon.placed)}}for(const A in b)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=b[A]);for(const A in M)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=M[A]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const l={};for(const f of a){const g=f.getBucket(e);g&&f.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,f.tileID,l,f.collisionBoxArray)}}updateBucketOpacities(e,a,l,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const g=e.layers[0],b=g.layout,M=new Cs(null,0,!1,!1,!0),A=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),R=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),N=b.get("text-rotation-alignment")==="map",j=b.get("text-pitch-alignment")==="map",Y=b.get("icon-text-fit")!=="none",Q=new Cs(null,0,A&&(k||!e.hasIconData()||b.get("icon-optional")),k&&(A||!e.hasTextData()||b.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const re=(le,de,ye)=>{for(let he=0;he<de/4;he++)le.opacityVertexArray.emplaceBack(ye);le.hasVisibleVertices=le.hasVisibleVertices||ye!==Ml},se=this.collisionBoxArrays.get(e.bucketInstanceId);for(let le=0;le<e.symbolInstances.length;le++){const de=e.symbolInstances.get(le),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:he,crossTileID:ve}=de;let Ee=this.opacities[ve];l[ve]?Ee=M:Ee||(Ee=Q,this.opacities[ve]=Ee),l[ve]=!0;const me=de.numIconVertices>0,ze=this.placedOrientations[de.crossTileID],Ge=ze===c.as.vertical,Oe=ze===c.as.horizontal||ze===c.as.horizontalOnly;if(ye>0||he>0){const $e=Is(Ee.text);re(e.text,ye,Ge?Ml:$e),re(e.text,he,Oe?Ml:$e);const yt=Ee.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach((kt=>{kt>=0&&(e.text.placedSymbolArray.get(kt).hidden=yt||Ge?1:0)})),de.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=yt||Oe?1:0);const vt=this.variableOffsets[de.crossTileID];vt&&this.markUsedJustification(e,vt.anchor,de,ze);const nt=this.placedOrientations[de.crossTileID];nt&&(this.markUsedJustification(e,"left",de,nt),this.markUsedOrientation(e,nt,de))}if(me){const $e=Is(Ee.icon),yt=!(Y&&de.verticalPlacedIconSymbolIndex&&Ge);de.placedIconSymbolIndex>=0&&(re(e.icon,de.numIconVertices,yt?$e:Ml),e.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(re(e.icon,de.numVerticalIconVertices,yt?Ml:$e),e.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}const Ne=se&&se.has(le)?se.get(le):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const $e=e.collisionArrays[le];if($e){let yt=new c.P(0,0);if($e.textBox||$e.verticalTextBox){let vt=!0;if(R){const nt=this.variableOffsets[ve];nt?(yt=nu(nt.anchor,nt.width,nt.height,nt.textOffset,nt.textBoxScale),N&&yt._rotate(j?-this.transform.bearingInRadians:this.transform.bearingInRadians)):vt=!1}if($e.textBox||$e.verticalTextBox){let nt;$e.textBox&&(nt=Ge),$e.verticalTextBox&&(nt=Oe),ru(e.textCollisionBox.collisionVertexArray,Ee.text.placed,!vt||nt,Ne.text,yt.x,yt.y)}}if($e.iconBox||$e.verticalIconBox){const vt=!!(!Oe&&$e.verticalIconBox);let nt;$e.iconBox&&(nt=vt),$e.verticalIconBox&&(nt=!vt),ru(e.iconCollisionBox.collisionVertexArray,Ee.icon.placed,nt,Ne.icon,Y?yt.x:0,Y?yt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function ru(p,e,a,l,f,g){l&&l.length!==0||(l=[0,0,0,0]);const b=l[0]-Gn,M=l[1]-Gn,A=l[2]-Gn,k=l[3]-Gn;p.emplaceBack(e?1:0,a?1:0,f||0,g||0,b,M),p.emplaceBack(e?1:0,a?1:0,f||0,g||0,A,M),p.emplaceBack(e?1:0,a?1:0,f||0,g||0,A,k),p.emplaceBack(e?1:0,a?1:0,f||0,g||0,b,k)}const pd=Math.pow(2,25),nc=Math.pow(2,24),md=Math.pow(2,17),la=Math.pow(2,16),rc=Math.pow(2,9),oh=Math.pow(2,8),ac=Math.pow(2,1);function Is(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const e=p.placed?1:0,a=Math.floor(127*p.opacity);return a*pd+e*nc+a*md+e*la+a*rc+e*oh+a*ac+e}const Ml=0;class Al{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,l,f,g){const b=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(b,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort(((M,A)=>M.sortKey-A.sortKey)));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,g())return!0;return!1}}class Ps{constructor(e,a,l,f,g,b,M,A){this.placement=new Ef(e,a,b,M,A),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,a,l){const f=Ae(),g=()=>!this._forceFullPlacement&&Ae()-f>2;for(;this._currentPlacementIndex>=0;){const b=a[e[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=M)&&(!b.maxzoom||b.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Al(b)),this._inProgressLayer.continuePlacement(l[b.source],this.placement,this._showCollisionBoxes,b,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const zl=512/c.a3/2;class Uo{constructor(e,a,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const f=new Map;for(let g=0;g<a.length;g++){const b=a.get(g),M=b.key,A=f.get(M);A?A.push(b):f.set(M,[b])}for(const[g,b]of f){const M={positions:b.map((A=>({x:Math.floor(A.anchorX*zl),y:Math.floor(A.anchorY*zl)}))),crossTileIDs:b.map((A=>A.crossTileID))};if(M.positions.length>128){const A=new c.aM(M.positions.length,16,Uint16Array);for(const{x:k,y:R}of M.positions)A.add(k,R);A.finish(),delete M.positions,M.index=A}this._symbolsByKey[g]=M}}getScaledCoordinates(e,a){const{x:l,y:f,z:g}=this.tileID.canonical,{x:b,y:M,z:A}=a.canonical,k=zl/Math.pow(2,A-g),R=(M*c.a3+e.anchorY)*k,N=f*c.a3*zl;return{x:Math.floor((b*c.a3+e.anchorX)*k-l*c.a3*zl),y:Math.floor(R-N)}}findMatches(e,a,l){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<e.length;g++){const b=e.get(g);if(b.crossTileID)continue;const M=this._symbolsByKey[b.key];if(!M)continue;const A=this.getScaledCoordinates(b,a);if(M.index){const k=M.index.range(A.x-f,A.y-f,A.x+f,A.y+f).sort();for(const R of k){const N=M.crossTileIDs[R];if(!l[N]){l[N]=!0,b.crossTileID=N;break}}}else if(M.positions)for(let k=0;k<M.positions.length;k++){const R=M.positions[k],N=M.crossTileIDs[k];if(Math.abs(R.x-A.x)<=f&&Math.abs(R.y-A.y)<=f&&!l[N]){l[N]=!0,b.crossTileID=N;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class lh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ch{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const l in this.indexes){const f=this.indexes[l],g={};for(const b in f){const M=f[b];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+a),g[M.tileID.key]=M}this.indexes[l]=g}this.lng=e}addBucket(e,a,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const g in this.indexes){const b=this.indexes[g];if(Number(g)>e.overscaledZ)for(const M in b){const A=b[M];A.tileID.isChildOf(e)&&A.findMatches(a.symbolInstances,e,f)}else{const M=b[e.scaledTo(Number(g)).key];M&&M.findMatches(a.symbolInstances,e,f)}}for(let g=0;g<a.symbolInstances.length;g++){const b=a.symbolInstances.get(g);b.crossTileID||(b.crossTileID=l.generate(),f[b.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Uo(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const l of a.getCrossTileIDsLists())for(const f of l)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let a=!1;for(const l in this.indexes){const f=this.indexes[l];for(const g in f)e[f[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,f[g]),delete f[g],a=!0)}return a}}class Ds{constructor(){this.layerIndexes={},this.crossTileIDs=new lh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,l){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new ch);let g=!1;const b={};f.handleWrapJump(l);for(const M of a){const A=M.getBucket(e);A&&e.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(M.tileID,A,this.crossTileIDs)&&(g=!0),b[A.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(g=!0),g}pruneUnusedLayers(e){const a={};e.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var No="void main() {fragColor=vec4(1.0);}";const ni={prelude:di(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:di("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:di("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:di(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:di(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:di(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:di(No,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:di(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:di(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:di("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:di("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:di(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:di("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:di(No,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:di(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:di(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:di(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:di(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:di(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:di(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:di(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:di(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:di(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:di(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:di(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:di(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:di(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:di(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:di(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:di(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:di(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:di("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:di("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:di("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:di("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:di(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:di("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function di(p,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),f=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=g?g.concat(f):f,M={};return{fragmentSource:p=p.replace(a,((A,k,R,N,j)=>(M[j]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
in ${R} ${N} ${j};
#else
uniform ${R} ${N} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${R} ${N} ${j} = u_${j};
#endif
`))),vertexSource:e=e.replace(a,((A,k,R,N,j)=>{const Y=N==="float"?"vec2":"vec4",Q=j.match(/color/)?"color":Y;return M[j]?k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${R} ${Y} a_${j};
out ${R} ${N} ${j};
#else
uniform ${R} ${N} u_${j};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${R} ${N} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${Q}(a_${j}, u_${j}_t);
#else
    ${R} ${N} ${j} = u_${j};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
in ${R} ${Y} a_${j};
#else
uniform ${R} ${N} u_${j};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${R} ${N} ${j} = a_${j};
#else
    ${R} ${N} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${R} ${N} ${j} = unpack_mix_${Q}(a_${j}, u_${j}_t);
#else
    ${R} ${N} ${j} = u_${j};
#endif
`})),staticAttributes:l,staticUniforms:b}}class uo{constructor(e,a,l){this.vertexBuffer=e,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ia=c.aN([{name:"a_pos",type:"Int16",components:2}]);const dr="#define PROJECTION_MERCATOR",qn="mercator";class yr{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return qn}get shaderDefine(){return dr}get shaderPreludeCode(){return ni.projectionMercator}get vertexShaderPreludeCode(){return ni.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aO.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,l,f,g){if(this._cachedMesh)return this._cachedMesh;const b=new c.aP;b.emplaceBack(0,0),b.emplaceBack(c.a3,0),b.emplaceBack(0,c.a3),b.emplaceBack(c.a3,c.a3);const M=e.createVertexBuffer(b,Ia.members),A=c.aQ.simpleSegment(0,0,4,2),k=new c.aR;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const R=e.createIndexBuffer(k);return this._cachedMesh=new uo(M,R,A),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Bn{constructor(e=0,a=0,l=0,f=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=l,this.right=f}interpolate(e,a,l){return a.top!=null&&e.top!=null&&(this.top=c.F.number(e.top,a.top,l)),a.bottom!=null&&e.bottom!=null&&(this.bottom=c.F.number(e.bottom,a.bottom,l)),a.left!=null&&e.left!=null&&(this.left=c.F.number(e.left,a.left,l)),a.right!=null&&e.right!=null&&(this.right=c.F.number(e.right,a.right,l)),this}getCenter(e,a){const l=c.ai((this.left+e-this.right)/2,0,e),f=c.ai((this.top+a-this.bottom)/2,0,a);return new c.P(l,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Bn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function un(p,e){if(!p.renderWorldCopies||p.lngRange)return;const a=e.lng-p.center.lng;e.lng+=a>180?-360:a<-180?360:0}function Cl(p){return Math.max(0,Math.floor(p))}class In{constructor(e,a){var l;this._callbacks=e,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrain=(l=a?.constrain)!==null&&l!==void 0?l:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.U(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Cl(this._zoom),this._scale=c.al(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Bn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Cl(this._zoom),this._scale=c.al(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Bn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get constrain(){return this._constrain}setConstrain(e){e||(e=this._callbacks.constrain),this._constrain=e,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=c.V(e,-180,180)*Math.PI/180;var l,f,g,b,M,A,k,R,N;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=$(),l=this._rotationMatrix,g=-this._bearingInRadians,b=(f=this._rotationMatrix)[0],M=f[1],A=f[2],k=f[3],R=Math.sin(g),N=Math.cos(g),l[0]=b*N+A*R,l[1]=M*N+k*R,l[2]=b*-R+A*N,l[3]=M*-R+k*N)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=c.ai(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aS(this._fovInRadians)}setFov(e){e=c.ai(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ak(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.constrain(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=c.al(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,l){this._unmodified=!1,this._edgeInsets.interpolate(e,a,l),this.constrainInternal(),this._calcMatrices()}resize(e,a,l=!0){this._width=e,this._height=a,l&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new jt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-c.aj,c.aj])}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:l,minY:f,maxX:g,maxY:b}=c.a6.fromPoints(a).extend(e);return[new c.P(l,f),new c.P(g,f),new c.P(g,b),new c.P(l,b),new c.P(l,f)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:l}=this.constrain(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.am(new Float64Array(16));c.O(e,e,[this._width/2,-this._height/2,1]),c.N(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.am(new Float64Array(16)),c.O(e,e,[1,-1,1]),c.N(e,e,[-1,-1,0]),c.O(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,l,f){const g=l!==void 0?l:this.bearing,b=f=f!==void 0?f:this.pitch,M=c.a5.fromLngLat(e,a),A=-Math.cos(c.ak(b)),k=Math.sin(c.ak(b)),R=k*Math.sin(c.ak(g)),N=-k*Math.cos(c.ak(g));let j=this.elevation;const Y=a-j;let Q;A*Y>=0||Math.abs(A)<.1?(Q=1e4,j=a+Q*A):Q=-Y/A;let re,se,le=c.aT(1,M.y),de=0;do{if(de+=1,de>10)break;se=Q/le,re=new c.a5(M.x+R*se,M.y+N*se),le=1/re.meterInMercatorCoordinateUnits()}while(Math.abs(Q-se*le)>1e-12);return{center:re.toLngLat(),elevation:j,zoom:c.ao(this.height/2/Math.tan(this.fovInRadians/2)/se/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=c.an(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/a,f=c.a5.fromLngLat(this.center,this.elevation),g=De(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const b=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),c.aT(g.z,f.y),this.bearing,this.pitch);this._elevation=b.elevation,this._center=b.center,this.setZoom(b.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.an(1,this.center.lat)*this.worldSize;return De(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/c.a3,1/a/c.a3]}}class Dr{constructor(e,a){this.min=e,this.max=a,this.center=c.aU([],c.aV([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],l=c.aW(this.min),f=c.aW(this.max);for(let g=0;g<a.length;g++)l[g]=a[g]?this.min[g]:this.center[g],f[g]=a[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new Dr(l,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let l=0;l<e.planes.length;l++){const f=this.intersectsPlane(e.planes[l]);if(f===0)return 0;f===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],l=e[3];for(let f=0;f<3;f++)e[f]>0?(a+=e[f]*this.min[f],l+=e[f]*this.max[f]):(l+=e[f]*this.min[f],a+=e[f]*this.max[f]);return a>=0?2:l<0?0:1}}class kr{distanceToTile2d(e,a,l,f){const g=f.distanceX([e,a]),b=f.distanceY([e,a]);return Math.hypot(g,b)}getWrap(e,a,l){return l}getTileBoundingVolume(e,a,l,f){var g,b;let M=0,A=0;if(f?.terrain){const R=new c.a0(e.z,a,e.z,e.x,e.y),N=f.terrain.getMinMaxElevation(R);M=(g=N.minElevation)!==null&&g!==void 0?g:Math.min(0,l),A=(b=N.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}const k=1<<e.z;return new Dr([a+e.x/k,e.y/k,M],[a+(e.x+1)/k,(e.y+1)/k,A])}allowVariableZoom(e,a){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=c.ai(78.5-l/2,0,60);return!!a.terrain||e.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class Pa{constructor(e,a,l){this.points=e,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(e,a=1,l=0,f,g){const b=g?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],M=Math.pow(2,l),A=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((j=>(function(Y,Q,re,se){const le=c.aA([],Y,Q),de=1/le[3]/re*se;return c.a$(le,le,[de,de,1/le[3],de])})(j,e,a,M)));f&&(function(j,Y,Q,re){const se=re?4:0,le=re?0:4;let de=0;const ye=[],he=[];for(let me=0;me<4;me++){const ze=c.aX([],j[me+le],j[me+se]),Ge=c.b0(ze);c.aU(ze,ze,1/Ge),ye.push(Ge),he.push(ze)}for(let me=0;me<4;me++){const ze=c.b1(j[me+se],he[me],Q);de=ze!==null&&ze>=0?Math.max(de,ze):Math.max(de,ye[me])}const ve=(function(me,ze){const Ge=c.aX([],me[ze[0]],me[ze[1]]),Oe=c.aX([],me[ze[2]],me[ze[1]]),Ne=[0,0,0,0];return c.aY(Ne,c.aZ([],Ge,Oe)),Ne[3]=-c.a_(Ne,me[ze[0]]),Ne})(j,Y),Ee=(function(me,ze){const Ge=c.b2(me),Oe=c.b3([],me,1/Ge),Ne=c.aX([],ze,c.aU([],Oe,c.a_(ze,Oe))),$e=c.b2(Ne);if($e>0){const yt=Math.sqrt(1-Oe[3]*Oe[3]),vt=c.aU([],Oe,-Oe[3]),nt=c.aV([],vt,c.aU([],Ne,yt/$e));return c.b4(ze,nt)}return null})(Q,ve);if(Ee!==null){const me=Ee/c.a_(he[0],ve);de=Math.min(de,me)}for(let me=0;me<4;me++){const ze=Math.min(de,ye[me]);j[me+le]=[j[me+se][0]+he[me][0]*ze,j[me+se][1]+he[me][1]*ze,j[me+se][2]+he[me][2]*ze,1]}})(A,b[0],f,g);const k=b.map((j=>{const Y=c.aX([],A[j[0]],A[j[1]]),Q=c.aX([],A[j[2]],A[j[1]]),re=c.aY([],c.aZ([],Y,Q)),se=-c.a_(re,A[j[1]]);return re.concat(se)})),R=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],N=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of A)for(let Y=0;Y<3;Y++)R[Y]=Math.min(R[Y],j[Y]),N[Y]=Math.max(N[Y],j[Y]);return new Pa(A,k,new Dr(R,N))}}class Da{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrain(e){this._helper.setConstrain(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,l)=>{l=c.ai(+l,this.minZoom,this.maxZoom);const f={center:new c.U(a.lng,a.lat),zoom:l};let g=this._helper._lngRange;if(!this._helper._renderWorldCopies&&g===null){const he=179.9999999999;g=[-he,he]}const b=this.tileSize*c.al(f.zoom);let M=0,A=b,k=0,R=b,N=0,j=0;const{x:Y,y:Q}=this.size;if(this._helper._latRange){const he=this._helper._latRange;M=c.W(he[1])*b,A=c.W(he[0])*b,A-M<Q&&(N=Q/(A-M))}g&&(k=c.V(c.X(g[0])*b,0,b),R=c.V(c.X(g[1])*b,0,b),R<k&&(R+=b),R-k<Y&&(j=Y/(R-k)));const{x:re,y:se}=qe(b,a);let le,de;const ye=Math.max(j||0,N||0);if(ye){const he=new c.P(j?(R+k)/2:re,N?(A+M)/2:se);return f.center=ct(b,he).wrap(),f.zoom+=c.ao(ye),f}if(this._helper._latRange){const he=Q/2;se-he<M&&(de=M+he),se+he>A&&(de=A-he)}if(g){const he=(k+R)/2;let ve=re;this._helper._renderWorldCopies&&(ve=c.V(re,he-b/2,he+b/2));const Ee=Y/2;ve-Ee<k&&(le=k+Ee),ve+Ee>R&&(le=R-Ee)}if(le!==void 0||de!==void 0){const he=new c.P(le??re,de??se);f.center=ct(b,he).wrap()}return f},this._helper=new In({calcMatrices:()=>{this._calcMatrices()},constrain:(a,l)=>this.defaultConstrain(a,l)},e),this._coveringTilesDetailsProvider=new kr}clone(){const e=new Da;return e.apply(this),e}apply(e,a,l){this._helper.apply(e,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new c.b5(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),f=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),b=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),M=Math.floor(Math.min(l.x,f.x,g.x,b.x)),A=Math.floor(Math.max(l.x,f.x,g.x,b.x)),k=1;for(let R=M-k;R<=A+k;R++)R!==0&&a.push(new c.b5(R,e))}return a}getCameraFrustum(){return Pa.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,a){const l=c.an(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(a,l),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),b=c.a5.fromLngLat(e),M=new c.a5(b.x-(f.x-g.x),b.y-(f.y-g.y));this.setCenter(M?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(c.a5.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a5.fromLngLat(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const l=a||0,f=[e.x,e.y,0,1],g=[e.x,e.y,1,1];c.aA(f,f,this._pixelMatrixInverse),c.aA(g,g,this._pixelMatrixInverse);const b=f[3],M=g[3],A=f[1]/b,k=g[1]/M,R=f[2]/b,N=g[2]/M,j=R===N?0:(l-R)/(N-R);return new c.a5(c.F.number(f[0]/b,g[0]/M,j)/this.worldSize,c.F.number(A,k,j)/this.worldSize,l)}coordinatePoint(e,a=0,l=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,a,1];return c.aA(f,f,l),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Je(this));return new jt().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-Je(this)}calculatePosMatrix(e,a=!1,l){var f;const g=(f=e.key)!==null&&f!==void 0?f:c.b6(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),b=a?this._alignedPosMatrixCache:this._posMatrixCache;if(b.has(g)){const k=b.get(g);return l?k.f32:k.f64}const M=Ft(e,this.worldSize);c.Q(M,a?this._alignedProjMatrix:this._viewProjMatrix,M);const A={f64:M,f32:new Float32Array(M)};return b.set(g,A),l?A.f32:A.f64}calculateFogMatrix(e){const a=e.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const f=Ft(e,this.worldSize);return c.Q(f,this._fogMatrix,f),l.set(a,new Float32Array(f)),l.get(a)}calculateCenterFromCameraLngLatAlt(e,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,f)}_calculateNearFarZIfNeeded(e,a,l){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-f*this._helper._pixelPerMeter/Math.cos(a),b=f<0?g:e,M=Math.PI/2+this.pitchInRadians,A=c.ak(this.fov)*(Math.abs(Math.cos(c.ak(this.roll)))*this.height+Math.abs(Math.sin(c.ak(this.roll)))*this.width)/this.height*(.5+l.y/this.height),k=Math.sin(A)*b/Math.sin(c.ai(Math.PI-M-A,.01,Math.PI-.01)),R=Je(this),N=Math.atan(R/this._helper.cameraToCenterDistance),j=c.ak(.75),Y=N>j?2*N*(.5+l.y/(2*R)):j,Q=Math.sin(Y)*b/Math.sin(c.ai(Math.PI-M-Y,.01,Math.PI-.01)),re=Math.min(k,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*re+b),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=qe(this.worldSize,this.center),l=a.x,f=a.y;this._helper._pixelPerMeter=c.an(1,this.center.lat)*this.worldSize;const g=c.ak(Math.min(this.pitch,Te)),b=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g));let M;this._calculateNearFarZIfNeeded(b,g,e),M=new Float64Array(16),c.b7(M,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.au(this._invProjMatrix,M),M[8]=2*-e.x/this._helper._width,M[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b8(M),c.O(M,M,[1,-1,1]),c.N(M,M,[0,0,-this._helper.cameraToCenterDistance]),c.b9(M,M,-this.rollInRadians),c.ba(M,M,this.pitchInRadians),c.b9(M,M,-this.bearingInRadians),c.N(M,M,[-l,-f,0]),this._mercatorMatrix=c.O([],M,[this.worldSize,this.worldSize,this.worldSize]),c.O(M,M,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,M),c.N(M,M,[0,0,-this.elevation]),this._viewProjMatrix=M,this._invViewProjMatrix=c.au([],M);const A=[0,0,-1,1];c.aA(A,A,this._invViewProjMatrix),this._cameraPosition=[A[0]/A[3],A[1]/A[3],A[2]/A[3]],this._fogMatrix=new Float64Array(16),c.b7(this._fogMatrix,this.fovInRadians,this.width/this.height,b,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.O(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.N(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b9(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.ba(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b9(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.N(this._fogMatrix,this._fogMatrix,[-l,-f,0]),c.O(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.N(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.Q(new Float64Array(16),this.clipSpaceToPixelsMatrix,M);const k=this._helper._width%2/2,R=this._helper._height%2/2,N=Math.cos(this.bearingInRadians),j=Math.sin(-this.bearingInRadians),Y=l-Math.round(l)+N*k+j*R,Q=f-Math.round(f)+N*R+j*k,re=new Float64Array(M);if(c.N(re,re,[Y>.5?Y-1:Y,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=re,M=c.au(new Float64Array(16),this._pixelMatrix),!M)throw new Error("failed to invert matrix");this._pixelMatrixInverse=M,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aA(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.an(1,this.center.lat)*this.worldSize;return De(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const l=c.a5.fromLngLat(e),f=[l.x*this.worldSize,l.y*this.worldSize,a,1];return c.aA(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:f}=e,g=this._helper.getMercatorTileCoordinates(a),b=a?this.calculatePosMatrix(a,l,!0):null;let M;return M=a&&a.terrainRttPosMatrix32f&&f?a.terrainRttPosMatrix32f:b||c.bb(),{mainMatrix:M,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:M}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,l){return 1}transformLightDirection(e){return c.aW(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,l,f){const g=this.calculatePosMatrix(l);let b;f?(b=[e,a,f(e,a),1],c.aA(b,b,g)):(b=[e,a,0,1],jo(b,b,g));const M=b[3];return{point:new c.P(b[0]/M,b[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const l=c.a5.fromLngLat(e,a),f=l.meterInMercatorCoordinateUnits(),g=c.bc();return c.N(g,g,[l.x,l.y,l.z]),c.b9(g,g,Math.PI),c.ba(g,g,Math.PI/2),c.O(g,g,[-f,f,f]),g}getProjectionDataForCustomLayer(e=!0){const a=new c.a0(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),f=Ft(a,this.worldSize);c.Q(f,this._viewProjMatrix,f),l.tileMercatorCoords=[0,0,1,1];const g=[c.a3,c.a3,this.worldSize/this._helper.pixelsPerMeter],b=c.bd();return c.O(b,f,g),l.fallbackMatrix=b,l.mainMatrix=b,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Tn(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Zo(p){if(p.useSlerp)if(p.k<1){const e=c.be(p.startEulerAngles.roll,p.startEulerAngles.pitch,p.startEulerAngles.bearing),a=c.be(p.endEulerAngles.roll,p.endEulerAngles.pitch,p.endEulerAngles.bearing),l=new Float64Array(4);c.bf(l,e,a,p.k);const f=c.bg(l);p.tr.setRoll(f.roll),p.tr.setPitch(f.pitch),p.tr.setBearing(f.bearing)}else p.tr.setRoll(p.endEulerAngles.roll),p.tr.setPitch(p.endEulerAngles.pitch),p.tr.setBearing(p.endEulerAngles.bearing);else p.tr.setRoll(c.F.number(p.startEulerAngles.roll,p.endEulerAngles.roll,p.k)),p.tr.setPitch(c.F.number(p.startEulerAngles.pitch,p.endEulerAngles.pitch,p.k)),p.tr.setBearing(c.F.number(p.startEulerAngles.bearing,p.endEulerAngles.bearing,p.k))}function Xa(p,e,a,l,f){const g=f.padding,b=qe(f.worldSize,a.getNorthWest()),M=qe(f.worldSize,a.getNorthEast()),A=qe(f.worldSize,a.getSouthEast()),k=qe(f.worldSize,a.getSouthWest()),R=c.ak(-l),N=b.rotate(R),j=M.rotate(R),Y=A.rotate(R),Q=k.rotate(R),re=new c.P(Math.max(N.x,j.x,Q.x,Y.x),Math.max(N.y,j.y,Q.y,Y.y)),se=new c.P(Math.min(N.x,j.x,Q.x,Y.x),Math.min(N.y,j.y,Q.y,Y.y)),le=re.sub(se),de=(f.width-(g.left+g.right+e.left+e.right))/le.x,ye=(f.height-(g.top+g.bottom+e.top+e.bottom))/le.y;if(ye<0||de<0)return void Tn();const he=Math.min(c.ao(f.scale*Math.min(de,ye)),p.maxZoom),ve=c.P.convert(p.offset),Ee=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ak(l)),me=ve.add(Ee).mult(f.scale/c.al(he));return{center:ct(f.worldSize,b.add(A).div(2).sub(me)),zoom:he,bearing:l}}class cs{get useGlobeControls(){return!1}handlePanInertia(e,a){const l=e.mag(),f=Math.abs(Je(a));return{easingOffset:e.mult(Math.min(.75*f/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,l){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,a,l,f,g){return Xa(e,a,l,f,g)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(c.U.convert(a.center))}handleEaseTo(e,a){const l=e.zoom,f=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},b={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},M=a.zoom!==void 0,A=!e.isPaddingEqual(a.padding);let k=!1;const R=M?+a.zoom:e.zoom;let N=e.centerPoint.add(a.offsetAsPoint);const j=e.screenPointToLocation(N),{center:Y,zoom:Q}=e.constrain(c.U.convert(a.center||j),R??l);un(e,Y);const re=qe(e.worldSize,j),se=qe(e.worldSize,Y).sub(re),le=c.al(Q-l);return k=Q!==l,{easeFunc:de=>{if(k&&e.setZoom(c.F.number(l,Q,de)),c.bh(g,b)||Zo({startEulerAngles:g,endEulerAngles:b,tr:e,k:de,useSlerp:g.roll!=b.roll}),A&&(e.interpolatePadding(f,a.padding,de),N=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const ye=c.al(e.zoom-l),he=Q>l?Math.min(2,le):Math.max(.5,le),ve=Math.pow(he,1-de),Ee=ct(e.worldSize,re.add(se.mult(de*ve)).mult(ye));e.setLocationAtPoint(e.renderWorldCopies?Ee.wrap():Ee,N)}},isZooming:k,elevationCenter:Y}}handleFlyTo(e,a){const l=a.zoom!==void 0,f=e.zoom,g=e.constrain(c.U.convert(a.center||a.locationAtOffset),l?+a.zoom:f),b=g.center,M=g.zoom;un(e,b);const A=qe(e.worldSize,a.locationAtOffset),k=qe(e.worldSize,b).sub(A),R=k.mag(),N=c.al(M-f);let j;if(a.minZoom!==void 0){const Y=Math.min(+a.minZoom,f,M),Q=e.constrain(b,Y).zoom;j=c.al(Q-f)}return{easeFunc:(Y,Q,re,se)=>{e.setZoom(Y===1?M:f+c.ao(Q));const le=Y===1?b:ct(e.worldSize,A.add(k.mult(re)).mult(Q));e.setLocationAtPoint(e.renderWorldCopies?le.wrap():le,se)},scaleOfZoom:N,targetCenter:b,scaleOfMinZoom:j,pixelPathLength:R}}}class Ri{constructor(e,a,l){this.blendFunction=e,this.blendColor=a,this.mask=l}}Ri.Replace=[1,0],Ri.disabled=new Ri(Ri.Replace,c.bi.transparent,[!1,!1,!1,!1]),Ri.unblended=new Ri(Ri.Replace,c.bi.transparent,[!0,!0,!0,!0]),Ri.alphaBlended=new Ri([1,771],c.bi.transparent,[!0,!0,!0,!0]);const Rr=2305;class ui{constructor(e,a,l){this.enable=e,this.mode=a,this.frontFace=l}}ui.disabled=new ui(!1,1029,Rr),ui.backCCW=new ui(!0,1029,Rr),ui.frontCCW=new ui(!0,1028,Rr);class fi{constructor(e,a,l){this.func=e,this.mask=a,this.range=l}}fi.ReadOnly=!1,fi.ReadWrite=!0,fi.disabled=new fi(519,fi.ReadOnly,[0,1]);const ho=7680;class Di{constructor(e,a,l,f,g,b){this.test=e,this.ref=a,this.mask=l,this.fail=f,this.depthFail=g,this.pass=b}}Di.disabled=new Di({func:519,mask:0},0,0,ho,ho,ho);const fo=new WeakMap;function ca(p){var e;if(fo.has(p))return fo.get(p);{const a=(e=p.getParameter(p.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return fo.set(p,a),a}}class ks{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const f=new c.aP;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const g=new c.aR;g.emplaceBack(0,1,2),this._fullscreenTriangle=new uo(a.createVertexBuffer(f,Ia.members),a.createIndexBuffer(g),c.aQ.simpleSegment(0,0,f.length,g.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const b=l.createTexture();l.bindTexture(l.TEXTURE_2D,b),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(b),ca(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const l=this._cachedRenderContext.context,f=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.bi.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,f.TRIANGLES,fi.disabled,Di.disabled,Ri.unblended,ui.disabled,((g,b)=>({u_input:g,u_output_expected:b}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ca(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const g=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ca(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ks._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const Rs=c.a3/128;function Il(p,e){const a=p.granularity!==void 0?Math.max(p.granularity,1):1,l=a+(p.generateBorders?2:0),f=a+(p.extendToNorthPole||p.generateBorders?1:0)+(p.extendToSouthPole||p.generateBorders?1:0),g=l+1,b=f+1,M=p.generateBorders?-1:0,A=p.generateBorders||p.extendToNorthPole?-1:0,k=a+(p.generateBorders?1:0),R=a+(p.generateBorders||p.extendToSouthPole?1:0),N=g*b,j=l*f*6,Y=g*b>65536;if(Y&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=Y||e==="32bit",re=new Int16Array(2*N);let se=0;for(let ye=A;ye<=R;ye++)for(let he=M;he<=k;he++){let ve=he/a*c.a3;he===-1&&(ve=-Rs),he===a+1&&(ve=c.a3+Rs);let Ee=ye/a*c.a3;ye===-1&&(Ee=p.extendToNorthPole?c.bk:-Rs),ye===a+1&&(Ee=p.extendToSouthPole?c.bl:c.a3+Rs),re[se++]=ve,re[se++]=Ee}const le=Q?new Uint32Array(j):new Uint16Array(j);let de=0;for(let ye=0;ye<f;ye++)for(let he=0;he<l;he++){const ve=he+1+ye*g,Ee=he+(ye+1)*g,me=he+1+(ye+1)*g;le[de++]=he+ye*g,le[de++]=Ee,le[de++]=ve,le[de++]=ve,le[de++]=Ee,le[de++]=me}return{vertices:re.buffer.slice(0),indices:le.buffer.slice(0),uses32bitIndices:Q}}const sc=new c.aO({fill:new c.bm(128,2),line:new c.bm(512,0),tile:new c.bm(128,32),stencil:new c.bm(128,1),circle:3});class au{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return ni.projectionGlobe}get vertexShaderPreludeCode(){return ni.projectionMercator.vertexSource}get subdivisionGranularity(){return sc}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new ks(e));const a=c.W(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(a,l),g=Ae();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=g);const b=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bn(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bo(b))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,l,f,g){const b=(g==="stencil"?sc.stencil:sc.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:b,generateBorders:l,extendToNorthPole:a.y===0&&f,extendToSouthPole:a.y===(1<<a.z)-1&&f})}_getMesh(e,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const f=(function(g,b){const M=Il(b,"16bit"),A=c.aP.deserialize({arrayBuffer:M.vertices,length:M.vertices.byteLength/2/2}),k=c.aR.deserialize({arrayBuffer:M.indices,length:M.indices.byteLength/2/3});return new uo(g.createVertexBuffer(A,Ia.members),g.createIndexBuffer(k),c.aQ.simpleSegment(0,0,A.length,k.length))})(e,a);return this._tileMeshCache[l]=f,f}recalculate(e){}hasTransition(){const e=Ae();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const su=new c.r({type:new c.D(c.t.projection.type)});class Vo extends c.E{constructor(e){super(),this._transitionable=new c.x(su,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.G(0)),this._mercatorProjection=new yr,this._verticalPerspectiveProjection=new au}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bp){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,l,f,g){return this.currentProjection.getMeshFromTileID(e,a,l,f,g)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Pl(p){const e=oc(p.worldSize,p.center.lat);return 2*Math.PI*e}function po(p,e,a,l,f){const g=1/(1<<f),b=e/c.a3*g+l*g,M=c.br((p/c.a3*g+a*g)*Math.PI*2+Math.PI,2*Math.PI),A=2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI,k=Math.cos(A),R=new Float64Array(3);return R[0]=Math.sin(M)*k,R[1]=Math.sin(A),R[2]=Math.cos(M)*k,R}function vr(p){return(function(e,a){const l=Math.cos(a),f=new Float64Array(3);return f[0]=Math.sin(e)*l,f[1]=Math.sin(a),f[2]=Math.cos(e)*l,f})(p.lng*Math.PI/180,p.lat*Math.PI/180)}function oc(p,e){return p/(2*Math.PI)/Math.cos(e*Math.PI/180)}function gd(p){const e=Math.asin(p[1])/Math.PI*180,a=Math.sqrt(p[0]*p[0]+p[2]*p[2]);if(a>1e-6){const l=p[0]/a,f=Math.acos(p[2]/a),g=(l>0?f:-f)/Math.PI*180;return new c.U(c.V(g,-180,180),e)}return new c.U(0,e)}function lc(p){return Math.cos(p*Math.PI/180)}function qi(p,e){const a=lc(p),l=lc(e);return c.ao(l/a)}function ou(p,e){const a=p.rotate(e.bearingInRadians),l=e.zoom+qi(e.center.lat,0),f=c.bn(1/lc(e.center.lat),1/lc(Math.min(Math.abs(e.center.lat),60)),c.bq(l,7,3,0,1)),g=360/Pl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.U(e.center.lng-a.x*g*f,c.ai(e.center.lat+a.y*g,-c.aj,c.aj))}function ka(p){const e=.5*p,a=Math.sin(e),l=Math.cos(e);return Math.log(a+l)-Math.log(l-a)}function cc(p,e,a,l){const f=p.lat+a*l;if(Math.abs(a)>1){const g=(Math.sign(p.lat+a)!==Math.sign(p.lat)?-Math.abs(p.lat):Math.abs(p.lat))*Math.PI/180,b=Math.abs(p.lat+a)*Math.PI/180,M=ka(g+l*(b-g)),A=ka(g),k=ka(b);return new c.U(p.lng+e*((M-A)/(k-A)),f)}return new c.U(p.lng+e*l,f)}class lu{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,l,f){const g=`${e.z}_${e.x}_${e.y}_${f?.terrain?"t":""}`,b=this._cache.get(g);if(b)return b;const M=this._cachePrevious.get(g);if(M)return this._cache.set(g,M),M;const A=this._boundingVolumeFactory(e,a,l,f);return this._cache.set(g,A),this._hadAnyChanges=!0,A}}class Go{constructor(e,a,l,f){this.min=l,this.max=f,this.points=e,this.planes=a}static fromAabb(e,a){const l=[];for(let f=0;f<8;f++)l.push([1&~f?e[0]:a[0],(f>>1&1)==1?a[1]:e[1],(f>>2&1)==1?a[2]:e[2]]);return new Go(l,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,l){const f=c.bu([],l[0],l[1],l[2]),g=c.bv([],[a[0],0,0],f),b=c.bv([],[0,a[1],0],f),M=c.bv([],[0,0,a[2]],f),A=[...e],k=[...e];for(let N=0;N<8;N++)for(let j=0;j<3;j++){const Y=e[j]+g[j]*(1&~N?-1:1)+b[j]*((N>>1&1)==1?1:-1)+M[j]*((N>>2&1)==1?1:-1);A[j]=Math.min(A[j],Y),k[j]=Math.max(k[j],Y)}const R=[];for(let N=0;N<8;N++){const j=[...e];c.aV(j,j,c.aU([],g,1&~N?-1:1)),c.aV(j,j,c.aU([],b,(N>>1&1)==1?1:-1)),c.aV(j,j,c.aU([],M,(N>>2&1)==1?1:-1)),R.push(j)}return new Go(R,[[...g,-c.a_(g,R[0])],[...b,-c.a_(b,R[0])],[...M,-c.a_(M,R[0])],[-g[0],-g[1],-g[2],-c.a_(g,R[7])],[-b[0],-b[1],-b[2],-c.a_(b,R[7])],[-M[0],-M[1],-M[2],-c.a_(M,R[7])]],A,k)}intersectsFrustum(e){let a=!0;const l=this.points.length,f=this.planes.length,g=e.planes.length,b=e.points.length;for(let M=0;M<g;M++){const A=e.planes[M];let k=0;for(let R=0;R<l;R++){const N=this.points[R];A[0]*N[0]+A[1]*N[1]+A[2]*N[2]+A[3]>=0&&k++}if(k===0)return 0;k<l&&(a=!1)}if(a)return 2;for(let M=0;M<f;M++){const A=this.planes[M];let k=0;for(let R=0;R<b;R++){const N=e.points[R];A[0]*N[0]+A[1]*N[1]+A[2]*N[2]+A[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let l=0;for(let f=0;f<a;f++){const g=this.points[f];e[0]*g[0]+e[1]*g[1]+e[2]*g[2]+e[3]>=0&&l++}return l===a?2:l===0?0:1}}function Bs(p,e,a){const l=p-e;return l<0?-l:Math.max(0,l-a)}function uh(p,e,a,l,f){const g=p-a;let b;return b=g<0?Math.min(-g,1+g-f):g>1?Math.min(Math.max(g-f,0),1-g):0,Math.max(b,Bs(e,l,f))}class _d{constructor(){this._boundingVolumeCache=new lu(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,l,f){const g=1<<l.z,b=1/g,M=l.x/g,A=l.y/g;let k=2;return k=Math.min(k,uh(e,a,M,A,b)),k=Math.min(k,uh(e,a,M+.5,-A-b,b)),k=Math.min(k,uh(e,a,M+.5,2-A-b,b)),k}getWrap(e,a,l){const f=1<<a.z,g=1/f,b=a.x/f,M=Bs(e.x,b,g),A=Bs(e.x,b-1,g),k=Bs(e.x,b+1,g),R=Math.min(M,A,k);return R===k?1:R===A?-1:0}allowVariableZoom(e,a){return Yi(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,l,f){return this._boundingVolumeCache.getTileBoundingVolume(e,a,l,f)}_computeTileBoundingVolume(e,a,l,f){var g,b;let M=0,A=0;if(f?.terrain){const k=new c.a0(e.z,a,e.z,e.x,e.y),R=f.terrain.getMinMaxElevation(k);M=(g=R.minElevation)!==null&&g!==void 0?g:Math.min(0,l),A=(b=R.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}if(M/=c.bx,A/=c.bx,M+=1,A+=1,e.z<=0)return Go.fromAabb([-A,-A,-A],[A,A,A]);if(e.z===1)return Go.fromAabb([e.x===0?-A:0,e.y===0?0:-A,-A],[e.x===0?0:A,e.y===0?A:0,A]);{const k=[po(0,0,e.x,e.y,e.z),po(c.a3,0,e.x,e.y,e.z),po(c.a3,c.a3,e.x,e.y,e.z),po(0,c.a3,e.x,e.y,e.z)],R=[];for(const Ne of k)R.push(c.aU([],Ne,A));if(A!==M)for(const Ne of k)R.push(c.aU([],Ne,M));e.y===0&&R.push([0,1,0]),e.y===(1<<e.z)-1&&R.push([0,-1,0]);const N=[1,1,1],j=[-1,-1,-1];for(const Ne of R)for(let $e=0;$e<3;$e++)N[$e]=Math.min(N[$e],Ne[$e]),j[$e]=Math.max(j[$e],Ne[$e]);const Y=po(c.a3/2,c.a3/2,e.x,e.y,e.z),Q=c.aZ([],[0,1,0],Y);c.aY(Q,Q);const re=c.aZ([],Y,Q);c.aY(re,re);const se=c.aZ([],k[2],k[1]);c.aY(se,se);const le=c.aZ([],k[0],k[3]);c.aY(le,le),R.push(c.aU([],Y,A)),e.y>=(1<<e.z)/2&&R.push(c.aU([],po(c.a3/2,0,e.x,e.y,e.z),A)),e.y<(1<<e.z)/2&&R.push(c.aU([],po(c.a3/2,c.a3,e.x,e.y,e.z),A));const de=yd(Y,R),ye=yd(re,R),he=[-Y[0],-Y[1],-Y[2],de.max],ve=[Y[0],Y[1],Y[2],-de.min],Ee=[-re[0],-re[1],-re[2],ye.max],me=[re[0],re[1],re[2],-ye.min],ze=[...se,0],Ge=[...le,0],Oe=[];return e.y===0?Oe.push(c.bw(Ge,ze,he),c.bw(Ge,ze,ve)):Oe.push(c.bw(Ee,ze,he),c.bw(Ee,ze,ve),c.bw(Ee,Ge,he),c.bw(Ee,Ge,ve)),e.y===(1<<e.z)-1?Oe.push(c.bw(Ge,ze,he),c.bw(Ge,ze,ve)):Oe.push(c.bw(me,ze,he),c.bw(me,ze,ve),c.bw(me,Ge,he),c.bw(me,Ge,ve)),new Go(Oe,[he,ve,Ee,me,ze,Ge],N,j)}}}function yd(p,e){let a=1/0,l=-1/0;for(const f of e){const g=c.a_(p,f);a=Math.min(a,g),l=Math.max(l,g)}return{min:a,max:l}}class cu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrain(e){this._helper.setConstrain(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(e){this._cachedClippingPlane=c.by(),this._projectionMatrix=c.bc(),this._globeViewProjMatrix32f=c.bb(),this._globeViewProjMatrixNoCorrection=c.bc(),this._globeViewProjMatrixNoCorrectionInverted=c.bc(),this._globeProjMatrixInverted=c.bc(),this._cameraPosition=c.bs(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,l)=>{const f=c.ai(a.lat,-c.aj,c.aj),g=c.ai(+l,this.minZoom+qi(0,f),this.maxZoom);return{center:new c.U(a.lng,f),zoom:g}},this._helper=new In({calcMatrices:()=>{this._calcMatrices()},constrain:(a,l)=>this.defaultConstrain(a,l)},e),this._coveringTilesDetailsProvider=new _d}clone(){const e=new cu;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bs();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:l}=e,f=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,l=this.cameraToCenterDistance/e,f=Math.sin(a)*l,g=Math.cos(a)*l+1,b=1/Math.sqrt(f*f+g*g)*1;let M=-f,A=g;const k=Math.sqrt(M*M+A*A);M/=k,A/=k;const R=[0,M,A];c.bz(R,R,[0,0,0],-this.bearingInRadians),c.bA(R,R,[0,0,0],-1*this.center.lat*Math.PI/180),c.bB(R,R,[0,0,0],this.center.lng*Math.PI/180);const N=1/c.b0(R);return c.aU(R,R,N),[...R,-b*N]}isLocationOccluded(e){return!this.isSurfacePointVisible(vr(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,f=Math.cos(l),g=[Math.sin(a)*f,Math.sin(l),Math.cos(a)*f],b=[g[2],0,-g[0]],M=[0,0,0];c.aZ(M,b,g),c.aY(b,b),c.aY(M,M);const A=[0,0,0];return c.aY(A,[b[0]*e[0]+M[0]*e[1]+g[0]*e[2],b[1]*e[0]+M[1]*e[1]+g[1]*e[2],b[2]*e[0]+M[2]*e[1]+g[2]*e[2]]),A}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,l){const f=(function(M,A,k){const R=1/(1<<k.z);return new c.a5(M/c.a3*R+k.x*R,A/c.a3*R+k.y*R)})(e,a,l.canonical),g=(b=f.y,[c.br(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI]);var b;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,a,l,f){const g=l.canonical,b=po(e,a,g.x,g.y,g.z),M=1+(f?f(e,a):0)/c.bx,A=[b[0]*M,b[1]*M,b[2]*M,1];c.aA(A,A,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,R=k[0]*b[0]+k[1]*b[1]+k[2]*b[2]+k[3]<0;return{point:new c.P(A[0]/A[3],A[1]/A[3]),signedDistanceFromCamera:A[3],isOccluded:R}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=oc(this.worldSize,this.center.lat),a=c.bd(),l=c.bd();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b7(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;a[8]=2*-f.x/this._helper._width,a[9]=2*f.y/this._helper._height,this._projectionMatrix=c.b8(a),this._globeProjMatrixInverted=c.bd(),c.au(this._globeProjMatrixInverted,a),c.N(a,a,[0,0,-this.cameraToCenterDistance]),c.b9(a,a,this.rollInRadians),c.ba(a,a,-this.pitchInRadians),c.b9(a,a,this.bearingInRadians),c.N(a,a,[0,0,-e]);const g=c.bs();g[0]=e,g[1]=e,g[2]=e,c.ba(l,a,this.center.lat*Math.PI/180),c.bC(l,l,-this.center.lng*Math.PI/180),c.O(l,l,g),this._globeViewProjMatrixNoCorrection=l,c.ba(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bC(a,a,-this.center.lng*Math.PI/180),c.O(a,a,g),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=c.bd(),c.au(this._globeViewProjMatrixNoCorrectionInverted,l);const b=c.bs();this._cameraPosition=c.bs(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bz(this._cameraPosition,this._cameraPosition,b,-this.rollInRadians),c.bA(this._cameraPosition,this._cameraPosition,b,this.pitchInRadians),c.bz(this._cameraPosition,this._cameraPosition,b,-this.bearingInRadians),c.aV(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bA(this._cameraPosition,this._cameraPosition,b,-this.center.lat*Math.PI/180),c.bB(this._cameraPosition,this._cameraPosition,b,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const M=c.b8(this._globeViewProjMatrixNoCorrectionInverted);c.O(M,M,[1,1,-1]),this._cachedFrustum=Pa.fromInvProjectionMatrix(M,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const a=c.bd();return c.am(a),a}getVisibleUnwrappedCoordinates(e){return[new c.b5(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=vr(e);c.aU(l,l,1+a/c.bx);const f=c.by();return c.aA(f,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,a),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,a)],f=[];for(const N of l)f.push(this.unprojectScreenPoint(N));let g=0,b=0,M=0,A=0;const k=this.center;for(const N of f){const j=c.bD(k.lng,N.lng),Y=c.bD(k.lat,N.lat);j<b&&(b=j),j>g&&(g=j),Y<A&&(A=Y),Y>M&&(M=Y)}const R=[k.lng+b,k.lat+A,k.lng+g,k.lat+M];return this.isSurfacePointOnScreen([0,1,0])&&(R[3]=90,R[0]=-180,R[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(R[1]=-90,R[0]=-180,R[2]=180),new jt(R)}calculateCenterFromCameraLngLatAlt(e,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,f)}setLocationAtPoint(e,a){const l=vr(this.unprojectScreenPoint(a)),f=vr(e),g=c.bs();c.bE(g);const b=c.bs();c.bB(b,l,g,-this.center.lng*Math.PI/180),c.bA(b,b,g,this.center.lat*Math.PI/180);const M=f[0]*f[0]+f[2]*f[2],A=b[0]*b[0];if(M<A)return;const k=Math.sqrt(M-A),R=-k,N=c.bF(f[0],f[2],b[0],k),j=c.bF(f[0],f[2],b[0],R),Y=c.bs();c.bB(Y,f,g,-N);const Q=c.bF(Y[1],Y[2],b[1],b[2]),re=c.bs();c.bB(re,f,g,-j);const se=c.bF(re[1],re[2],b[1],b[2]),le=.5*Math.PI,de=Q>=-le&&Q<=le,ye=se>=-le&&se<=le;let he,ve;if(de&&ye){const Ge=this.center.lng*Math.PI/180,Oe=this.center.lat*Math.PI/180;c.bG(N,Ge)+c.bG(Q,Oe)<c.bG(j,Ge)+c.bG(se,Oe)?(he=N,ve=Q):(he=j,ve=se)}else if(de)he=N,ve=Q;else{if(!ye)return;he=j,ve=se}const Ee=he/Math.PI*180,me=ve/Math.PI*180,ze=this.center.lat;this.setCenter(new c.U(Ee,c.ai(me,-90,90))),this.setZoom(this.zoom+qi(ze,this.center.lat))}locationToScreenPoint(e,a){const l=vr(e);if(a){const f=a.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aU(l,l,1+f/c.bx)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const a=c.by();return c.aA(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new c.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l)return l}return c.a5.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,a){const l=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,f)}getRayDirectionFromPixel(e){const a=c.by();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,c.aA(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=c.bs();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const f=c.bs();return c.aY(f,l),f}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=c.by();return c.aA(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const l=c.a_(e,a),f=c.bs(),g=c.bs();c.aU(g,a,l),c.aX(f,e,g);const b=1-c.a_(f,f);if(b<0)return null;const M=c.a_(e,e)-1,A=-l+(l<0?1:-1)*Math.sqrt(b),k=M/A,R=A;return{tMin:Math.min(k,R),tMax:Math.max(k,R)}}unprojectScreenPoint(e){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(a,l);if(f){const R=c.bs();c.aV(R,a,[l[0]*f.tMin,l[1]*f.tMin,l[2]*f.tMin]);const N=c.bs();return c.aY(N,R),gd(N)}const g=this._cachedClippingPlane,b=g[0]*l[0]+g[1]*l[1]+g[2]*l[2],M=-c.b4(g,a)/b,A=c.bs();if(M>0)c.aV(A,a,[l[0]*M,l[1]*M,l[2]*M]);else{const R=c.bs();c.aV(R,a,[2*l[0],2*l[1],2*l[2]]);const N=c.b4(this._cachedClippingPlane,R);c.aX(A,R,[this._cachedClippingPlane[0]*N,this._cachedClippingPlane[1]*N,this._cachedClippingPlane[2]*N])}const k=(function(R){const N=c.bs();return N[0]=R[0]*-R[3],N[1]=R[1]*-R[3],N[2]=R[2]*-R[3],{center:N,radius:Math.sqrt(1-R[3]*R[3])}})(g);return gd((function(R,N,j){const Y=c.bs();c.aX(Y,j,R);const Q=c.bs();return c.bt(Q,R,Y,N/c.b2(Y)),Q})(k.center,k.radius,A))}getMatrixForModel(e,a){const l=c.U.convert(e),f=1/c.bx,g=c.bc();return c.bC(g,g,l.lng/180*Math.PI),c.ba(g,g,-l.lat/180*Math.PI),c.N(g,g,[0,0,1+a/c.bx]),c.ba(g,g,.5*Math.PI),c.O(g,g,[f,f,f]),g}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new c.a0(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class uu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrain(e){this._helper.setConstrain(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(e){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,l)=>this.currentTransform.defaultConstrain(a,l),this._helper=new In({calcMatrices:()=>{this._calcMatrices()},constrain:(a,l)=>this.defaultConstrain(a,l)},e),this._globeness=1,this._mercatorTransform=new Da,this._verticalPerspectiveTransform=new cu}clone(){const e=new uu;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bn(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bn(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,l){const f=this._mercatorTransform.getPitchedTextCorrection(e,a,l),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,l);return c.bn(f,g,this._globeness)}projectTileCoordinates(e,a,l,f){return this.currentTransform.projectTileCoordinates(e,a,l,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(e,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,f)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Ya{get useGlobeControls(){return!0}handlePanInertia(e,a){const l=ou(e,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const l=e.around,f=a.screenPointToLocation(l);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const g=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const b=a.zoom-g;if(b===0)return;const M=c.bD(a.center.lng,f.lng),A=M/(Math.abs(M/180)+1),k=c.bD(a.center.lat,f.lat),R=a.getRayDirectionFromPixel(l),N=a.cameraPosition,j=-1*c.a_(N,R),Y=c.bs();c.aV(Y,N,[R[0]*j,R[1]*j,R[2]*j]);const Q=c.b0(Y)-1,re=Math.exp(.5*-Math.max(Q-.3,0)),se=oc(a.worldSize,a.center.lat)/Math.min(a.width,a.height),le=c.bq(se,.9,.5,1,.25),de=(1-c.al(-b))*Math.min(re,le),ye=a.center.lat,he=a.zoom,ve=new c.U(a.center.lng+A*de,c.ai(a.center.lat+k*de,-c.aj,c.aj));a.setLocationAtPoint(f,l);const Ee=a.center,me=c.bq(Math.abs(M),45,85,0,1),ze=c.bq(se,.75,.35,0,1),Ge=Math.pow(Math.max(me,ze),.25),Oe=c.bD(Ee.lng,ve.lng),Ne=c.bD(Ee.lat,ve.lat);a.setCenter(new c.U(Ee.lng+Oe*Ge,Ee.lat+Ne*Ge).wrap()),a.setZoom(he+qi(ye,a.center.lat))}handleMapControlsPan(e,a,l){if(!e.panDelta)return;const f=a.center.lat,g=a.zoom;a.setCenter(ou(e.panDelta,a).wrap()),a.setZoom(g+qi(f,a.center.lat))}cameraForBoxAndBearing(e,a,l,f,g){const b=Xa(e,a,l,f,g),M=a.left/g.width*2-1,A=(g.width-a.right)/g.width*2-1,k=a.top/g.height*-2+1,R=(g.height-a.bottom)/g.height*-2+1,N=c.bD(l.getWest(),l.getEast())<0,j=N?l.getEast():l.getWest(),Y=N?l.getWest():l.getEast(),Q=Math.max(l.getNorth(),l.getSouth()),re=Math.min(l.getNorth(),l.getSouth()),se=j+.5*c.bD(j,Y),le=Q+.5*c.bD(Q,re),de=g.clone();de.setCenter(b.center),de.setBearing(b.bearing),de.setPitch(0),de.setRoll(0),de.setZoom(b.zoom);const ye=de.modelViewProjectionMatrix,he=[vr(l.getNorthWest()),vr(l.getNorthEast()),vr(l.getSouthWest()),vr(l.getSouthEast()),vr(new c.U(Y,le)),vr(new c.U(j,le)),vr(new c.U(se,Q)),vr(new c.U(se,re))],ve=vr(b.center);let Ee=Number.POSITIVE_INFINITY;for(const me of he)M<0&&(Ee=Ya.getLesserNonNegativeNonNull(Ee,Ya.solveVectorScale(me,ve,ye,"x",M))),A>0&&(Ee=Ya.getLesserNonNegativeNonNull(Ee,Ya.solveVectorScale(me,ve,ye,"x",A))),k>0&&(Ee=Ya.getLesserNonNegativeNonNull(Ee,Ya.solveVectorScale(me,ve,ye,"y",k))),R<0&&(Ee=Ya.getLesserNonNegativeNonNull(Ee,Ya.solveVectorScale(me,ve,ye,"y",R)));if(Number.isFinite(Ee)&&Ee!==0)return b.zoom=de.zoom+c.ao(Ee),b;Tn()}handleJumpToCenterZoom(e,a){const l=e.center.lat,f=e.constrain(a.center?c.U.convert(a.center):e.center,e.zoom).center;e.setCenter(f.wrap());const g=a.zoom!==void 0?+a.zoom:e.zoom+qi(l,f.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,a){const l=e.zoom,f=e.center,g=e.padding,b={roll:e.roll,pitch:e.pitch,bearing:e.bearing},M={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},A=a.zoom!==void 0,k=!e.isPaddingEqual(a.padding);let R=!1;const N=a.center?c.U.convert(a.center):f,j=e.constrain(N,l).center;un(e,j);const Y=e.clone();Y.setCenter(j),Y.setZoom(A?+a.zoom:l+qi(f.lat,N.lat)),Y.setBearing(a.bearing);const Q=new c.P(c.ai(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ai(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));Y.setLocationAtPoint(j,Q);const re=(a.offset&&a.offsetAsPoint.mag())>0?Y.center:j,se=A?+a.zoom:l+qi(f.lat,re.lat),le=l+qi(f.lat,0),de=se+qi(re.lat,0),ye=c.bD(f.lng,re.lng),he=c.bD(f.lat,re.lat),ve=c.al(de-le);return R=se!==l,{easeFunc:Ee=>{if(c.bh(b,M)||Zo({startEulerAngles:b,endEulerAngles:M,tr:e,k:Ee,useSlerp:b.roll!=M.roll}),k&&e.interpolatePadding(g,a.padding,Ee),a.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const me=de>le?Math.min(2,ve):Math.max(.5,ve),ze=Math.pow(me,1-Ee),Ge=cc(f,ye,he,Ee*ze);e.setCenter(Ge.wrap())}if(R){const me=c.F.number(le,de,Ee)+qi(0,e.center.lat);e.setZoom(me)}},isZooming:R,elevationCenter:re}}handleFlyTo(e,a){const l=a.zoom!==void 0,f=e.center,g=e.zoom,b=e.padding,M=!e.isPaddingEqual(a.padding),A=e.constrain(c.U.convert(a.center||a.locationAtOffset),g).center,k=l?+a.zoom:e.zoom+qi(e.center.lat,A.lat),R=e.clone();R.setCenter(A),R.setZoom(k),R.setBearing(a.bearing);const N=new c.P(c.ai(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ai(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));R.setLocationAtPoint(A,N);const j=R.center;un(e,j);const Y=(function(he,ve,Ee){const me=vr(ve),ze=vr(Ee),Ge=c.a_(me,ze),Oe=Math.acos(Ge),Ne=Pl(he);return Oe/(2*Math.PI)*Ne})(e,f,j),Q=g+qi(f.lat,0),re=k+qi(j.lat,0),se=c.al(re-Q);let le;if(typeof a.minZoom=="number"){const he=+a.minZoom+qi(j.lat,0),ve=Math.min(he,Q,re)+qi(0,j.lat),Ee=e.constrain(j,ve).zoom+qi(j.lat,0);le=c.al(Ee-Q)}const de=c.bD(f.lng,j.lng),ye=c.bD(f.lat,j.lat);return{easeFunc:(he,ve,Ee,me)=>{const ze=cc(f,de,ye,Ee);M&&e.interpolatePadding(b,a.padding,he);const Ge=he===1?j:ze;e.setCenter(Ge.wrap());const Oe=Q+c.ao(ve);e.setZoom(he===1?k:Oe+qi(0,Ge.lat))},scaleOfZoom:se,targetCenter:j,scaleOfMinZoom:le,pixelPathLength:Y}}static solveVectorScale(e,a,l,f,g){const b=f==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],M=[l[3],l[7],l[11],l[15]],A=e[0]*b[0]+e[1]*b[1]+e[2]*b[2],k=e[0]*M[0]+e[1]*M[1]+e[2]*M[2],R=a[0]*b[0]+a[1]*b[1]+a[2]*b[2],N=a[0]*M[0]+a[1]*M[1]+a[2]*M[2];return R+g*k===A+g*N||M[3]*(A-R)+b[3]*(N-k)+A*N==R*k?null:(R+b[3]-g*N-g*M[3])/(R-A-g*N+g*k)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class uc{constructor(e){this._globe=e,this._mercatorCameraHelper=new cs,this._verticalPerspectiveCameraHelper=new Ya}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,l){this.currentHelper.handleMapControlsPan(e,a,l)}cameraForBoxAndBearing(e,a,l,f,g){return this.currentHelper.cameraForBoxAndBearing(e,a,l,f,g)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const Dl=(p,e)=>c.z(p,e&&e.filter((a=>a.identifier!=="source.canvas"))),hu=c.bH();class hc extends c.E{constructor(e,a={}){var l,f;super(),this._rtlPluginLoaded=()=>{for(const b in this.tileManagers){const M=this.tileManagers[b].getSource().type;M!=="vector"&&M!=="geojson"||this.tileManagers[b].reload()}},this.map=e,this.dispatcher=new Bt(Dt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((b,M)=>this.getGlyphs(b,M))),this.dispatcher.registerMessageHandler("GI",((b,M)=>this.getImages(b,M))),this.dispatcher.registerMessageHandler("GDA",((b,M)=>this.getDashes(b,M))),this.imageManager=new bt,this.imageManager.setEventedParent(this);const g=((l=e._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((f=document.documentElement)===null||f===void 0?void 0:f.lang)||void 0;this.glyphManager=new Ue(e._requestManager,a.localIdeographFontFamily,g),this.lineAtlas=new Re(256,512),this.crossTileSymbolIndex=new Ds,this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new c.bI,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bJ()),F().on(U,this._rtlPluginLoaded),this.on("data",(b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const M=this.tileManagers[b.sourceId];if(!M)return;const A=M.getSource();if(A&&A.vectorLayerIds)for(const k in this._layers){const R=this._layers[k];R.source===A.id&&this._validateLayer(R)}}))}setGlobalStateProperty(e,a){var l,f,g;this._checkLoaded();const b=a===null?(g=(f=(l=this.stylesheet.state)===null||l===void 0?void 0:l[e])===null||f===void 0?void 0:f.default)!==null&&g!==void 0?g:null:a;if(c.bK(b,this._globalState[e]))return this;this._globalState[e]=b,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const l in e)!c.bK(this._globalState[l],e[l].default)&&(a.push(l),this._globalState[l]=e[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set,l={};for(const f of e){l[f]=this._globalState[f];for(const g in this._layers){const b=this._layers[g],M=b.getLayoutAffectingGlobalStateRefs(),A=b.getPaintAffectingGlobalStateRefs();if(M.has(f)&&a.add(b.source),A.has(f))for(const{name:k,value:R}of A.get(f))this._updatePaintProperty(b,k,R)}}this.dispatcher.broadcast("UGS",l);for(const f in this.tileManagers)a.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.j(f,this._loadStyleRequest).then((b=>{this._loadStyleRequest=null,this._load(b.data,a,l)})).catch((b=>{this._loadStyleRequest=null,b&&!g.signal.aborted&&this.fire(new c.k(b))}))}loadJSON(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ge.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(hu,{validate:!1})}_load(e,a,l){var f,g;let b=a.transformStyle?a.transformStyle(l,e):e;if(!a.validate||!Dl(this,c.B(b))){b=Object.assign({},b),this._loaded=!0,this.stylesheet=b;for(const M in b.sources)this.addSource(M,b.sources[M],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new fe(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e,a,l;const f=c.bL(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",f),this._order=f.map((g=>g.id)),this._layers={},this._serializedLayers=null;for(const g of f){const b=c.bM(g,this._globalState);if(b.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=b,c.bN(b)&&this.tileManagers[b.source]){const M=(l=(a=g.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&l!==void 0?l:b.paint.get("raster-fade-duration");this.tileManagers[b.source].setRasterFadeDuration(M)}}}_loadSprite(e,a=!1,l=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(g,b,M,A){return c._(this,void 0,void 0,(function*(){const k=be(g),R=M>1?"@2x":"",N={},j={};for(const{id:Y,url:Q}of k){const re=b.transformRequest(Ie(Q,R,".json"),"SpriteJSON");N[Y]=c.j(re,A);const se=b.transformRequest(Ie(Q,R,".png"),"SpriteImage");j[Y]=ht.getImage(se,A)}return yield Promise.all([...Object.values(N),...Object.values(j)]),(function(Y,Q){return c._(this,void 0,void 0,(function*(){const re={};for(const se in Y){re[se]={};const le=ge.getImageCanvasContext((yield Q[se]).data),de=(yield Y[se]).data;for(const ye in de){const{width:he,height:ve,x:Ee,y:me,sdf:ze,pixelRatio:Ge,stretchX:Oe,stretchY:Ne,content:$e,textFitWidth:yt,textFitHeight:vt}=de[ye];re[se][ye]={data:null,pixelRatio:Ge,sdf:ze,stretchX:Oe,stretchY:Ne,content:$e,textFitWidth:yt,textFitHeight:vt,spriteData:{width:he,height:ve,x:Ee,y:me,context:le}}}}return re}))})(N,j)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((g=>{if(this._spriteRequest=null,g)for(const b in g){this._spritesImagesIds[b]=[];const M=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter((A=>!(A in g))):[];for(const A of M)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in g[b]){const k=b==="default"?A:`${b}:${A}`;this._spritesImagesIds[b].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,g[b][A],!1):this.imageManager.addImage(k,g[b][A]),a&&(this._changedImages[k]=!0)}}})).catch((g=>{this._spriteRequest=null,f=g,this.fire(new c.k(f))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(f)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.tileManagers[e.source];if(!a)return;const l=e.sourceLayer;if(!l)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.tileManagers)if(!this.tileManagers[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?c.bO(l):l);const f=[];for(const g of e)if(l[g]){const b=a?c.bO(l[g]):l[g];f.push(b)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const f=this._layers[l];f.type!=="custom"&&(e[l]=f.serialize())}return e}hasTransitions(){var e,a,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const f in this.tileManagers)if(this.tileManagers[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(f.length||g.length)&&this._updateWorkerLayers(f,g);for(const b in this._updatedSources){const M=this._updatedSources[b];if(M==="reload")this._reloadSource(b);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const f in this.tileManagers){const g=this.tileManagers[f];l[f]=g.used,g.used=!1}for(const f of this._order){const g=this._layers[f];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.tileManagers[g.source].used=!0)}for(const f in l){const g=this.tileManagers[f];!!l[f]!=!!g.used&&g.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.tileManagers)this.tileManagers[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var l;this._checkLoaded();const f=this.serialize();if(e=a.transformStyle?a.transformStyle(f,e):e,((l=a.validate)===null||l===void 0||l)&&Dl(this,c.B(e)))return!1;(e=c.bO(e)).layers=c.bL(e.layers);const g=c.bP(f,e),b=this._getOperationsToPerform(g);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const M of b.operations)M();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],l=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,f.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,f.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,f.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,f.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,f.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,f.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,f.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,f.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,f.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,f.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,f.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,f.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,f.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,f.args)));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,f.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(f.command)}return{operations:a,unimplemented:l}}addImage(e,a){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,l={}){if(this._checkLoaded(),this.tileManagers[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.B.source,`sources.${e}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.tileManagers[e]=new Sn(e,a,this.dispatcher);f.style=this,f.setEventedParent(this,(()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e}))),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.tileManagers[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const a=this.tileManagers[e];delete this.tileManagers[e],delete this._updatedSources[e],a.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.tileManagers[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.tileManagers[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(e){return this.tileManagers[e]&&this.tileManagers[e].getSource()}addLayer(e,a,l={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new c.k(new Error(`Layer "${f}" already exists on this map.`)));let g;if(e.type==="custom"){if(Dl(this,c.bQ(e)))return;g=c.bM(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=c.bO(e),e=c.e(e,{source:f})),this._validate(c.B.layer,`layers.${f}`,e,{arrayIndex:-1},l))return;g=c.bM(e,this._globalState),this._validateLayer(g),g.setEventedParent(this,{layer:{id:f}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new c.k(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=g,this._removedLayers[f]&&g.source&&g.type!=="custom"){const M=this._removedLayers[f];delete this._removedLayers[f],M.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.tileManagers[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const l=this._order.indexOf(e);this._order.splice(l,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,l){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===a&&f.maxzoom===l||(a!=null&&(f.minzoom=a),l!=null&&(f.maxzoom=l),this._updateLayer(f)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,l={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!c.bK(f.filter,a))return a==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(c.B.filter,`layers.${f.id}.filter`,a,null,l)||(f.setFilter(c.bO(a)),this._updateLayer(f)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bO(this.getLayer(e).filter)}setLayoutProperty(e,a,l,f={}){this._checkLoaded();const g=this.getLayer(e);g?c.bK(g.getLayoutProperty(a),l)||(g.setLayoutProperty(a,l,f),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const l=this.getLayer(e);if(l)return l.getLayoutProperty(a);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,l,f={}){this._checkLoaded();const g=this.getLayer(e);g?c.bK(g.getPaintProperty(a),l)||this._updatePaintProperty(g,a,l,f):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,l,f={}){e.setPaintProperty(a,l,f)&&this._updateLayer(e),c.bN(e)&&a==="raster-fade-duration"&&this.tileManagers[e.source].setRasterFadeDuration(l),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const l=e.source,f=e.sourceLayer,g=this.tileManagers[l];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const b=g.getSource().type;b==="geojson"&&f?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(f,e.id,a)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const l=e.source,f=this.tileManagers[l];if(f===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const g=f.getSource().type,b=g==="vector"?e.sourceLayer:void 0;g!=="vector"||b?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,e.id,a):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,l=e.sourceLayer,f=this.tileManagers[a];if(f!==void 0)return f.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bR(this.tileManagers,(g=>g.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,f=this.stylesheet;return c.bS({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:a,terrain:l},(g=>g!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.tileManagers[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.tileManagers[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=b=>this._layers[b].type==="fill-extrusion",l={},f=[];for(let b=this._order.length-1;b>=0;b--){const M=this._order[b];if(a(M)){l[M]=b;for(const A of e){const k=A[M];if(k)for(const R of k)f.push(R)}}}f.sort(((b,M)=>M.intersectionZ-b.intersectionZ));const g=[];for(let b=this._order.length-1;b>=0;b--){const M=this._order[b];if(a(M))for(let A=f.length-1;A>=0;A--){const k=f[A].feature;if(l[k.layer.id]<b)break;g.push(k),f.pop()}else for(const A of e){const k=A[M];if(k)for(const R of k)g.push(R.feature)}}return g}queryRenderedFeatures(e,a,l){a&&a.filter&&this._validate(c.B.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of a.layers){const R=this._layers[k];if(!R)return this.fire(new c.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[R.source]=!0}}const g=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers(),M=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,A=Object.assign(Object.assign({},a),{layers:M,globalState:this._globalState});for(const k in this.tileManagers)a.layers&&!f[k]||g.push(ri(this.tileManagers[k],this._layers,b,e,A,l,this.map.terrain?(R,N,j)=>this.map.terrain.getElevation(R,N,j):void 0));return this.placement&&g.push((function(k,R,N,j,Y,Q,re){const se={},le=Q.queryRenderedSymbols(j),de=[];for(const ye of Object.keys(le).map(Number))de.push(re[ye]);de.sort(Pi);for(const ye of de){const he=ye.featureIndex.lookupSymbolFeatures(le[ye.bucketInstanceId],R,ye.bucketIndex,ye.sourceLayerIndex,{filterSpec:Y.filter,globalState:Y.globalState},Y.layers,Y.availableImages,k);for(const ve in he){const Ee=se[ve]=se[ve]||[],me=he[ve];me.sort(((ze,Ge)=>{const Oe=ye.featureSortOrder;if(Oe){const Ne=Oe.indexOf(ze.featureIndex);return Oe.indexOf(Ge.featureIndex)-Ne}return Ge.featureIndex-ze.featureIndex}));for(const ze of me)Ee.push(ze)}}return(function(ye,he,ve){for(const Ee in ye)for(const me of ye[Ee])Yt(me,ve[he[Ee].source]);return ye})(se,k,N)})(this._layers,b,this.tileManagers,e,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,a){a?.filter&&this._validate(c.B.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.tileManagers[e];return l?(function(f,g){const b=f.getRenderableIds().map((k=>f.getTileByID(k))),M=[],A={};for(let k=0;k<b.length;k++){const R=b[k],N=R.tileID.canonical.key;A[N]||(A[N]=!0,R.querySourceFeatures(M,g))}return M})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const l=this.light.getLight();let f=!1;for(const b in e)if(!c.bK(e[b],l[b])){f=!0;break}if(!f)return;const g={now:Ae(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const l=this.getSky();let f=!1;if(!e&&!l)return;if(e&&!l)f=!0;else if(!e&&l)f=!0;else for(const b in e)if(!c.bK(e[b],l[b])){f=!0;break}if(!f)return;const g={now:Ae(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(g)}_setProjectionInternal(e){const a=(function(l,f){const g={constrain:f};if(Array.isArray(l)){const b=new Vo({type:l});return{projection:b,transform:new uu(g),cameraHelper:new uc(b)}}switch(l){case"mercator":return{projection:new yr,transform:new Da(g),cameraHelper:new cs};case"globe":{const b=new Vo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:b,transform:new uu(g),cameraHelper:new uc(b)}}case"vertical-perspective":return{projection:new au,transform:new cu(g),cameraHelper:new Ya};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new yr,transform:new Da(g),cameraHelper:new cs}}})(e,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.tileManagers)this.tileManagers[l].reload()}_validate(e,a,l,f,g={}){return(!g||g.validate!==!1)&&Dl(this,e.call(c.B,c.e({key:a,style:this.serialize(),value:l,styleSpec:c.t},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),F().off(U,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const l=this.tileManagers[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.tileManagers[e].clearTiles()}_reloadSource(e){this.tileManagers[e].resume(),this.tileManagers[e].reload()}_updateSources(e){for(const a in this.tileManagers)this.tileManagers[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.tileManagers)this._reloadSource(e)}_updatePlacement(e,a,l,f,g=!1){let b=!1,M=!1;const A={};for(const k of this._order){const R=this._layers[k];if(R.type!=="symbol")continue;if(!A[R.source]){const j=this.tileManagers[R.source];A[R.source]=j.getRenderableIds(!0).map((Y=>j.getTileByID(Y))).sort(((Y,Q)=>Q.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(Q.tileID)?-1:1)))}const N=this.crossTileSymbolIndex.addLayer(R,A[R.source],e.center.lng);b=b||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ae(),e.zoom))&&(this.pauseablePlacement=new Ps(e,this.map.terrain,this._order,g,a,l,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ae()),M=!0),b&&this.pauseablePlacement.placement.setStale()),M||b)for(const k of this._order){const R=this._layers[k];R.type==="symbol"&&this.placement.updateLayerOpacities(R,A[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ae())}_releaseSymbolFadeTiles(){for(const e in this.tileManagers)this.tileManagers[e].releaseSymbolFadeTiles()}getImages(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(c.B.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,a){return c._(this,void 0,void 0,(function*(){const l={};for(const[f,g]of Object.entries(a.dashes))l[f]=this.lineAtlas.getDash(g.dasharray,g.round);return l}))}addSprite(e,a,l={},f){this._checkLoaded();const g=[{id:e,url:a}],b=[...be(this.stylesheet.sprite),...g];this._validate(c.B.sprite,"sprite",b,null,l)||(this.stylesheet.sprite=b,this._loadSprite(g,!0,f))}removeSprite(e){this._checkLoaded();const a=be(this.stylesheet.sprite);if(a.find((l=>l.id===e))){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===e)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return be(this.stylesheet.sprite)}setSprite(e,a={},l){this._checkLoaded(),e&&this._validate(c.B.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var hh=c.aN([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ra{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,l,f,g,b,M,A,k){this.context=e;let R=this.boundPaintVertexBuffers.length!==f.length;for(let N=0;!R&&N<f.length;N++)this.boundPaintVertexBuffers[N]!==f[N]&&(R=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||R||this.boundIndexBuffer!==g||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,l,f,g,b,M,A,k):(e.bindVertexArray.set(this.vao),M&&M.bind(),g&&g.dynamicDraw&&g.bind(),A&&A.bind(),k&&k.bind())}freshBind(e,a,l,f,g,b,M,A){const k=e.numAttributes,R=this.context,N=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=f,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=A,a.enableAttributes(N,e);for(const j of l)j.enableAttributes(N,e);b&&b.enableAttributes(N,e),M&&M.enableAttributes(N,e),A&&A.enableAttributes(N,e),a.bind(),a.setVertexAttribPointers(N,e,g);for(const j of l)j.bind(),j.setVertexAttribPointers(N,e,g);b&&(b.bind(),b.setVertexAttribPointers(N,e,g)),f&&f.bind(),M&&(M.bind(),M.setVertexAttribPointers(N,e,g)),A&&(A.bind(),A.setVertexAttribPointers(N,e,g)),R.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const dc=(p,e,a,l,f)=>({u_texture:0,u_ele_delta:p,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):c.bi.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):c.bi.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),dh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ls(p){const e=[];for(let a=0;a<p.length;a++){if(p[a]===null)continue;const l=p[a].split(" ");e.push(l.pop())}return e}class kl{constructor(e,a,l,f,g,b,M,A,k=[]){const R=e.gl;this.program=R.createProgram();const N=Ls(a.staticAttributes),j=l?l.getBinderAttributes():[],Y=N.concat(j),Q=ni.prelude.staticUniforms?Ls(ni.prelude.staticUniforms):[],re=M.staticUniforms?Ls(M.staticUniforms):[],se=a.staticUniforms?Ls(a.staticUniforms):[],le=l?l.getBinderUniforms():[],de=Q.concat(re).concat(se).concat(le),ye=[];for(const Oe of de)ye.indexOf(Oe)<0&&ye.push(Oe);const he=l?l.defines():[];ca(R)&&he.unshift("#version 300 es"),g&&he.push("#define OVERDRAW_INSPECTOR;"),b&&he.push("#define TERRAIN3D;"),A&&he.push(A),k&&he.push(...k);let ve=he.concat(ni.prelude.fragmentSource,M.fragmentSource,a.fragmentSource).join(`
`),Ee=he.concat(ni.prelude.vertexSource,M.vertexSource,a.vertexSource).join(`
`);ca(R)||(ve=(function(Oe){return Oe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ve),Ee=(function(Oe){return Oe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Ee));const me=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(me,ve),R.compileShader(me),!R.getShaderParameter(me,R.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${R.getShaderInfoLog(me)}`);R.attachShader(this.program,me);const ze=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);if(R.shaderSource(ze,Ee),R.compileShader(ze),!R.getShaderParameter(ze,R.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${R.getShaderInfoLog(ze)}`);R.attachShader(this.program,ze),this.attributes={};const Ge={};this.numAttributes=Y.length;for(let Oe=0;Oe<this.numAttributes;Oe++)Y[Oe]&&(R.bindAttribLocation(this.program,Oe,Y[Oe]),this.attributes[Y[Oe]]=Oe);if(R.linkProgram(this.program),!R.getProgramParameter(this.program,R.LINK_STATUS))throw new Error(`Program failed to link: ${R.getProgramInfoLog(this.program)}`);R.deleteShader(ze),R.deleteShader(me);for(let Oe=0;Oe<ye.length;Oe++){const Ne=ye[Oe];if(Ne&&!Ge[Ne]){const $e=R.getUniformLocation(this.program,Ne);$e&&(Ge[Ne]=$e)}}this.fixedUniforms=f(e,Ge),this.terrainUniforms=((Oe,Ne)=>({u_depth:new c.bT(Oe,Ne.u_depth),u_terrain:new c.bT(Oe,Ne.u_terrain),u_terrain_dim:new c.bj(Oe,Ne.u_terrain_dim),u_terrain_matrix:new c.bV(Oe,Ne.u_terrain_matrix),u_terrain_unpack:new c.bW(Oe,Ne.u_terrain_unpack),u_terrain_exaggeration:new c.bj(Oe,Ne.u_terrain_exaggeration)}))(e,Ge),this.projectionUniforms=((Oe,Ne)=>({u_projection_matrix:new c.bV(Oe,Ne.u_projection_matrix),u_projection_tile_mercator_coords:new c.bW(Oe,Ne.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bW(Oe,Ne.u_projection_clipping_plane),u_projection_transition:new c.bj(Oe,Ne.u_projection_transition),u_projection_fallback_matrix:new c.bV(Oe,Ne.u_projection_fallback_matrix)}))(e,Ge),this.binderUniforms=l?l.getUniforms(e,Ge):[]}draw(e,a,l,f,g,b,M,A,k,R,N,j,Y,Q,re,se,le,de,ye){const he=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(f),e.setColorMode(g),e.setCullFace(b),A){e.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,A.depthTexture),e.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,A.texture);for(const Ee in this.terrainUniforms)this.terrainUniforms[Ee].set(A[Ee])}if(k)for(const Ee in k)this.projectionUniforms[dh[Ee]].set(k[Ee]);if(M)for(const Ee in this.fixedUniforms)this.fixedUniforms[Ee].set(M[Ee]);se&&se.setUniforms(e,this.binderUniforms,Q,{zoom:re});let ve=0;switch(a){case he.LINES:ve=2;break;case he.TRIANGLES:ve=3;break;case he.LINE_STRIP:ve=1}for(const Ee of Y.get()){const me=Ee.vaos||(Ee.vaos={});(me[R]||(me[R]=new Ra)).bind(e,this,N,se?se.getPaintVertexBuffers():[],j,Ee.vertexOffset,le,de,ye),he.drawElements(a,Ee.primitiveLength*ve,he.UNSIGNED_SHORT,Ee.primitiveOffset*ve*2)}}}function fh(p,e,a){const l=1/c.aG(a,1,e.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,e.transform.tileZoom)/f,b=g*(a.tileID.canonical.x+a.tileID.wrap*f),M=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[b>>16,M>>16],u_pixel_coord_lower:[65535&b,65535&M]}}const Rl=(p,e,a,l)=>{const f=p.style.light,g=f.properties.get("position"),b=[g.x,g.y,g.z],M=c.bZ();f.properties.get("anchor")==="viewport"&&c.b_(M,p.transform.bearingInRadians),c.b$(b,b,M);const A=p.transform.transformLightDirection(b),k=f.properties.get("color");return{u_lightpos:b,u_lightpos_globe:A,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:l}},vd=(p,e,a,l,f,g,b)=>c.e(Rl(p,e,a,l),fh(g,p,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),Ba=(p,e,a,l)=>c.e(fh(e,p,a),{u_fill_translate:l}),Mf=(p,e)=>({u_world:p,u_fill_translate:e}),bd=(p,e,a,l,f)=>c.e(Ba(p,e,a,f),{u_world:l}),Af=(p,e,a,l,f)=>{const g=p.transform;let b,M,A=0;if(a.paint.get("circle-pitch-alignment")==="map"){const k=c.aG(e,1,g.zoom);b=!0,M=[k,k],A=k/(c.a3*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else b=!1,M=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+b,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:M,u_globe_extrude_scale:A,u_translate:l}},ph=p=>({u_pixel_extrude_scale:[1/p.width,1/p.height]}),du=p=>({u_viewport_size:[p.width,p.height]}),qo=(p,e=1)=>({u_color:p,u_overlay:0,u_overlay_scale:e}),$o=(p,e,a,l)=>{const f=c.aG(p,1,e)/(c.a3*Math.pow(2,p.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aG(p,1,e),u_intensity:a,u_globe_extrude_scale:f}},mh=(p,e,a,l)=>{const f=c.M();c.c0(f,0,p.width,p.height,0,0,1);const g=p.context.gl;return{u_matrix:f,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},fc=(p,e,a)=>{const l=a.paint.get("hillshade-accent-color");let f;switch(a.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const g=a.getIlluminationProperties();for(let b=0;b<g.directionRadians.length;b++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(g.directionRadians[b]+=p.transform.bearingInRadians);return{u_image:0,u_latrange:gh(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:g.altitudeRadians,u_azimuths:g.directionRadians,u_accent:l,u_method:f,u_highlights:g.highlightColor,u_shadows:g.shadowColor}},mo=(p,e)=>{const a=e.stride,l=c.M();return c.c0(l,0,c.a3,-c.a3,0,0,1),c.N(l,l,[0,-c.a3,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:p.overscaledZ,u_unpack:e.getUnpackVector()}};function gh(p,e){const a=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.a5(0,l/a).toLngLat().lat,new c.a5(0,(l+1)/a).toLngLat().lat]}const fu=(p,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:p.paint.get("color-relief-opacity")}),us=(p,e,a,l)=>{const f=p.transform;return{u_translation:_h(p,e,a),u_ratio:l/c.aG(e,1,f.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},xd=(p,e,a,l,f)=>c.e(us(p,e,a,l),{u_image:0,u_image_height:f}),pc=(p,e,a,l,f)=>{const g=p.transform,b=pu(e,g);return{u_translation:_h(p,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.aG(e,1,g.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[b,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},wd=(p,e,a,l,f)=>{const g=pu(e,p.transform);return c.e(us(p,e,a,l),{u_tileratio:g,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image:0,u_mix:f.t,u_lineatlas_width:p.lineAtlas.width,u_lineatlas_height:p.lineAtlas.height})},zf=(p,e,a,l,f,g)=>{const b=pu(e,p.transform);return c.e(us(p,e,a,l),{u_image:0,u_image_height:g,u_tileratio:b,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image_dash:1,u_mix:f.t,u_lineatlas_width:p.lineAtlas.width,u_lineatlas_height:p.lineAtlas.height})};function pu(p,e){return 1/c.aG(p,1,e.tileZoom)}function _h(p,e,a){return c.aH(p.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Sd=(p,e,a,l,f)=>{return{u_tl_parent:p,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(b=l.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(g=l.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:yh(l.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var g,b};function yh(p){p*=Math.PI/180;const e=Math.sin(p),a=Math.cos(p);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const Yr=(p,e,a,l,f,g,b,M,A,k,R,N,j)=>{const Y=b.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Y.width/Y.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_label_plane_matrix:M,u_coord_matrix:A,u_is_text:+R,u_pitch_with_map:+l,u_is_along_line:f,u_is_variable_anchor:g,u_texsize:N,u_texture:0,u_translation:k,u_pitched_scale:j}},Os=(p,e,a,l,f,g,b,M,A,k,R,N,j,Y)=>{const Q=b.transform;return c.e(Yr(p,e,a,l,f,g,b,M,A,k,R,N,Y),{u_gamma_scale:l?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},hs=(p,e,a,l,f,g,b,M,A,k,R,N,j)=>c.e(Os(p,e,a,l,f,g,b,M,A,k,!0,R,0,j),{u_texsize_icon:N,u_texture_icon:1}),mu=(p,e)=>({u_opacity:p,u_color:e}),gu=(p,e,a,l,f)=>c.e((function(g,b,M,A){const k=M.imageManager.getPattern(g.from.toString()),R=M.imageManager.getPattern(g.to.toString()),{width:N,height:j}=M.imageManager.getPixelSize(),Y=Math.pow(2,A.tileID.overscaledZ),Q=A.tileSize*Math.pow(2,M.transform.tileZoom)/Y,re=Q*(A.tileID.canonical.x+A.tileID.wrap*Y),se=Q*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:R.tl,u_pattern_br_b:R.br,u_texsize:[N,j],u_mix:b.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:R.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/c.aG(A,1,M.transform.tileZoom),u_pixel_coord_upper:[re>>16,se>>16],u_pixel_coord_lower:[65535&re,65535&se]}})(a,f,e,l),{u_opacity:p}),mc=(p,e)=>{},_u={fillExtrusion:(p,e)=>({u_lightpos:new c.bX(p,e.u_lightpos),u_lightpos_globe:new c.bX(p,e.u_lightpos_globe),u_lightintensity:new c.bj(p,e.u_lightintensity),u_lightcolor:new c.bX(p,e.u_lightcolor),u_vertical_gradient:new c.bj(p,e.u_vertical_gradient),u_opacity:new c.bj(p,e.u_opacity),u_fill_translate:new c.bY(p,e.u_fill_translate)}),fillExtrusionPattern:(p,e)=>({u_lightpos:new c.bX(p,e.u_lightpos),u_lightpos_globe:new c.bX(p,e.u_lightpos_globe),u_lightintensity:new c.bj(p,e.u_lightintensity),u_lightcolor:new c.bX(p,e.u_lightcolor),u_vertical_gradient:new c.bj(p,e.u_vertical_gradient),u_height_factor:new c.bj(p,e.u_height_factor),u_opacity:new c.bj(p,e.u_opacity),u_fill_translate:new c.bY(p,e.u_fill_translate),u_image:new c.bT(p,e.u_image),u_texsize:new c.bY(p,e.u_texsize),u_pixel_coord_upper:new c.bY(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bY(p,e.u_pixel_coord_lower),u_scale:new c.bX(p,e.u_scale),u_fade:new c.bj(p,e.u_fade)}),fill:(p,e)=>({u_fill_translate:new c.bY(p,e.u_fill_translate)}),fillPattern:(p,e)=>({u_image:new c.bT(p,e.u_image),u_texsize:new c.bY(p,e.u_texsize),u_pixel_coord_upper:new c.bY(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bY(p,e.u_pixel_coord_lower),u_scale:new c.bX(p,e.u_scale),u_fade:new c.bj(p,e.u_fade),u_fill_translate:new c.bY(p,e.u_fill_translate)}),fillOutline:(p,e)=>({u_world:new c.bY(p,e.u_world),u_fill_translate:new c.bY(p,e.u_fill_translate)}),fillOutlinePattern:(p,e)=>({u_world:new c.bY(p,e.u_world),u_image:new c.bT(p,e.u_image),u_texsize:new c.bY(p,e.u_texsize),u_pixel_coord_upper:new c.bY(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bY(p,e.u_pixel_coord_lower),u_scale:new c.bX(p,e.u_scale),u_fade:new c.bj(p,e.u_fade),u_fill_translate:new c.bY(p,e.u_fill_translate)}),circle:(p,e)=>({u_camera_to_center_distance:new c.bj(p,e.u_camera_to_center_distance),u_scale_with_map:new c.bT(p,e.u_scale_with_map),u_pitch_with_map:new c.bT(p,e.u_pitch_with_map),u_extrude_scale:new c.bY(p,e.u_extrude_scale),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bj(p,e.u_globe_extrude_scale),u_translate:new c.bY(p,e.u_translate)}),collisionBox:(p,e)=>({u_pixel_extrude_scale:new c.bY(p,e.u_pixel_extrude_scale)}),collisionCircle:(p,e)=>({u_viewport_size:new c.bY(p,e.u_viewport_size)}),debug:(p,e)=>({u_color:new c.bU(p,e.u_color),u_overlay:new c.bT(p,e.u_overlay),u_overlay_scale:new c.bj(p,e.u_overlay_scale)}),depth:mc,clippingMask:mc,heatmap:(p,e)=>({u_extrude_scale:new c.bj(p,e.u_extrude_scale),u_intensity:new c.bj(p,e.u_intensity),u_globe_extrude_scale:new c.bj(p,e.u_globe_extrude_scale)}),heatmapTexture:(p,e)=>({u_matrix:new c.bV(p,e.u_matrix),u_world:new c.bY(p,e.u_world),u_image:new c.bT(p,e.u_image),u_color_ramp:new c.bT(p,e.u_color_ramp),u_opacity:new c.bj(p,e.u_opacity)}),hillshade:(p,e)=>({u_image:new c.bT(p,e.u_image),u_latrange:new c.bY(p,e.u_latrange),u_exaggeration:new c.bj(p,e.u_exaggeration),u_altitudes:new c.c2(p,e.u_altitudes),u_azimuths:new c.c2(p,e.u_azimuths),u_accent:new c.bU(p,e.u_accent),u_method:new c.bT(p,e.u_method),u_shadows:new c.c1(p,e.u_shadows),u_highlights:new c.c1(p,e.u_highlights)}),hillshadePrepare:(p,e)=>({u_matrix:new c.bV(p,e.u_matrix),u_image:new c.bT(p,e.u_image),u_dimension:new c.bY(p,e.u_dimension),u_zoom:new c.bj(p,e.u_zoom),u_unpack:new c.bW(p,e.u_unpack)}),colorRelief:(p,e)=>({u_image:new c.bT(p,e.u_image),u_unpack:new c.bW(p,e.u_unpack),u_dimension:new c.bY(p,e.u_dimension),u_elevation_stops:new c.bT(p,e.u_elevation_stops),u_color_stops:new c.bT(p,e.u_color_stops),u_color_ramp_size:new c.bT(p,e.u_color_ramp_size),u_opacity:new c.bj(p,e.u_opacity)}),line:(p,e)=>({u_translation:new c.bY(p,e.u_translation),u_ratio:new c.bj(p,e.u_ratio),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bY(p,e.u_units_to_pixels)}),lineGradient:(p,e)=>({u_translation:new c.bY(p,e.u_translation),u_ratio:new c.bj(p,e.u_ratio),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bY(p,e.u_units_to_pixels),u_image:new c.bT(p,e.u_image),u_image_height:new c.bj(p,e.u_image_height)}),linePattern:(p,e)=>({u_translation:new c.bY(p,e.u_translation),u_texsize:new c.bY(p,e.u_texsize),u_ratio:new c.bj(p,e.u_ratio),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_image:new c.bT(p,e.u_image),u_units_to_pixels:new c.bY(p,e.u_units_to_pixels),u_scale:new c.bX(p,e.u_scale),u_fade:new c.bj(p,e.u_fade)}),lineSDF:(p,e)=>({u_translation:new c.bY(p,e.u_translation),u_ratio:new c.bj(p,e.u_ratio),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bY(p,e.u_units_to_pixels),u_image:new c.bT(p,e.u_image),u_mix:new c.bj(p,e.u_mix),u_tileratio:new c.bj(p,e.u_tileratio),u_crossfade_from:new c.bj(p,e.u_crossfade_from),u_crossfade_to:new c.bj(p,e.u_crossfade_to),u_lineatlas_width:new c.bj(p,e.u_lineatlas_width),u_lineatlas_height:new c.bj(p,e.u_lineatlas_height)}),lineGradientSDF:(p,e)=>({u_translation:new c.bY(p,e.u_translation),u_ratio:new c.bj(p,e.u_ratio),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_units_to_pixels:new c.bY(p,e.u_units_to_pixels),u_image:new c.bT(p,e.u_image),u_image_height:new c.bj(p,e.u_image_height),u_tileratio:new c.bj(p,e.u_tileratio),u_crossfade_from:new c.bj(p,e.u_crossfade_from),u_crossfade_to:new c.bj(p,e.u_crossfade_to),u_image_dash:new c.bT(p,e.u_image_dash),u_mix:new c.bj(p,e.u_mix),u_lineatlas_width:new c.bj(p,e.u_lineatlas_width),u_lineatlas_height:new c.bj(p,e.u_lineatlas_height)}),raster:(p,e)=>({u_tl_parent:new c.bY(p,e.u_tl_parent),u_scale_parent:new c.bj(p,e.u_scale_parent),u_buffer_scale:new c.bj(p,e.u_buffer_scale),u_fade_t:new c.bj(p,e.u_fade_t),u_opacity:new c.bj(p,e.u_opacity),u_image0:new c.bT(p,e.u_image0),u_image1:new c.bT(p,e.u_image1),u_brightness_low:new c.bj(p,e.u_brightness_low),u_brightness_high:new c.bj(p,e.u_brightness_high),u_saturation_factor:new c.bj(p,e.u_saturation_factor),u_contrast_factor:new c.bj(p,e.u_contrast_factor),u_spin_weights:new c.bX(p,e.u_spin_weights),u_coords_top:new c.bW(p,e.u_coords_top),u_coords_bottom:new c.bW(p,e.u_coords_bottom)}),symbolIcon:(p,e)=>({u_is_size_zoom_constant:new c.bT(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bT(p,e.u_is_size_feature_constant),u_size_t:new c.bj(p,e.u_size_t),u_size:new c.bj(p,e.u_size),u_camera_to_center_distance:new c.bj(p,e.u_camera_to_center_distance),u_pitch:new c.bj(p,e.u_pitch),u_rotate_symbol:new c.bT(p,e.u_rotate_symbol),u_aspect_ratio:new c.bj(p,e.u_aspect_ratio),u_fade_change:new c.bj(p,e.u_fade_change),u_label_plane_matrix:new c.bV(p,e.u_label_plane_matrix),u_coord_matrix:new c.bV(p,e.u_coord_matrix),u_is_text:new c.bT(p,e.u_is_text),u_pitch_with_map:new c.bT(p,e.u_pitch_with_map),u_is_along_line:new c.bT(p,e.u_is_along_line),u_is_variable_anchor:new c.bT(p,e.u_is_variable_anchor),u_texsize:new c.bY(p,e.u_texsize),u_texture:new c.bT(p,e.u_texture),u_translation:new c.bY(p,e.u_translation),u_pitched_scale:new c.bj(p,e.u_pitched_scale)}),symbolSDF:(p,e)=>({u_is_size_zoom_constant:new c.bT(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bT(p,e.u_is_size_feature_constant),u_size_t:new c.bj(p,e.u_size_t),u_size:new c.bj(p,e.u_size),u_camera_to_center_distance:new c.bj(p,e.u_camera_to_center_distance),u_pitch:new c.bj(p,e.u_pitch),u_rotate_symbol:new c.bT(p,e.u_rotate_symbol),u_aspect_ratio:new c.bj(p,e.u_aspect_ratio),u_fade_change:new c.bj(p,e.u_fade_change),u_label_plane_matrix:new c.bV(p,e.u_label_plane_matrix),u_coord_matrix:new c.bV(p,e.u_coord_matrix),u_is_text:new c.bT(p,e.u_is_text),u_pitch_with_map:new c.bT(p,e.u_pitch_with_map),u_is_along_line:new c.bT(p,e.u_is_along_line),u_is_variable_anchor:new c.bT(p,e.u_is_variable_anchor),u_texsize:new c.bY(p,e.u_texsize),u_texture:new c.bT(p,e.u_texture),u_gamma_scale:new c.bj(p,e.u_gamma_scale),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_is_halo:new c.bT(p,e.u_is_halo),u_translation:new c.bY(p,e.u_translation),u_pitched_scale:new c.bj(p,e.u_pitched_scale)}),symbolTextAndIcon:(p,e)=>({u_is_size_zoom_constant:new c.bT(p,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bT(p,e.u_is_size_feature_constant),u_size_t:new c.bj(p,e.u_size_t),u_size:new c.bj(p,e.u_size),u_camera_to_center_distance:new c.bj(p,e.u_camera_to_center_distance),u_pitch:new c.bj(p,e.u_pitch),u_rotate_symbol:new c.bT(p,e.u_rotate_symbol),u_aspect_ratio:new c.bj(p,e.u_aspect_ratio),u_fade_change:new c.bj(p,e.u_fade_change),u_label_plane_matrix:new c.bV(p,e.u_label_plane_matrix),u_coord_matrix:new c.bV(p,e.u_coord_matrix),u_is_text:new c.bT(p,e.u_is_text),u_pitch_with_map:new c.bT(p,e.u_pitch_with_map),u_is_along_line:new c.bT(p,e.u_is_along_line),u_is_variable_anchor:new c.bT(p,e.u_is_variable_anchor),u_texsize:new c.bY(p,e.u_texsize),u_texsize_icon:new c.bY(p,e.u_texsize_icon),u_texture:new c.bT(p,e.u_texture),u_texture_icon:new c.bT(p,e.u_texture_icon),u_gamma_scale:new c.bj(p,e.u_gamma_scale),u_device_pixel_ratio:new c.bj(p,e.u_device_pixel_ratio),u_is_halo:new c.bT(p,e.u_is_halo),u_translation:new c.bY(p,e.u_translation),u_pitched_scale:new c.bj(p,e.u_pitched_scale)}),background:(p,e)=>({u_opacity:new c.bj(p,e.u_opacity),u_color:new c.bU(p,e.u_color)}),backgroundPattern:(p,e)=>({u_opacity:new c.bj(p,e.u_opacity),u_image:new c.bT(p,e.u_image),u_pattern_tl_a:new c.bY(p,e.u_pattern_tl_a),u_pattern_br_a:new c.bY(p,e.u_pattern_br_a),u_pattern_tl_b:new c.bY(p,e.u_pattern_tl_b),u_pattern_br_b:new c.bY(p,e.u_pattern_br_b),u_texsize:new c.bY(p,e.u_texsize),u_mix:new c.bj(p,e.u_mix),u_pattern_size_a:new c.bY(p,e.u_pattern_size_a),u_pattern_size_b:new c.bY(p,e.u_pattern_size_b),u_scale_a:new c.bj(p,e.u_scale_a),u_scale_b:new c.bj(p,e.u_scale_b),u_pixel_coord_upper:new c.bY(p,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bY(p,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bj(p,e.u_tile_units_to_pixels)}),terrain:(p,e)=>({u_texture:new c.bT(p,e.u_texture),u_ele_delta:new c.bj(p,e.u_ele_delta),u_fog_matrix:new c.bV(p,e.u_fog_matrix),u_fog_color:new c.bU(p,e.u_fog_color),u_fog_ground_blend:new c.bj(p,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bj(p,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bU(p,e.u_horizon_color),u_horizon_fog_blend:new c.bj(p,e.u_horizon_fog_blend),u_is_globe_mode:new c.bj(p,e.u_is_globe_mode)}),terrainDepth:(p,e)=>({u_ele_delta:new c.bj(p,e.u_ele_delta)}),terrainCoords:(p,e)=>({u_texture:new c.bT(p,e.u_texture),u_terrain_coords_id:new c.bj(p,e.u_terrain_coords_id),u_ele_delta:new c.bj(p,e.u_ele_delta)}),projectionErrorMeasurement:(p,e)=>({u_input:new c.bj(p,e.u_input),u_output_expected:new c.bj(p,e.u_output_expected)}),atmosphere:(p,e)=>({u_sun_pos:new c.bX(p,e.u_sun_pos),u_atmosphere_blend:new c.bj(p,e.u_atmosphere_blend),u_globe_position:new c.bX(p,e.u_globe_position),u_globe_radius:new c.bj(p,e.u_globe_radius),u_inv_proj_matrix:new c.bV(p,e.u_inv_proj_matrix)}),sky:(p,e)=>({u_sky_color:new c.bU(p,e.u_sky_color),u_horizon_color:new c.bU(p,e.u_horizon_color),u_horizon:new c.bY(p,e.u_horizon),u_horizon_normal:new c.bY(p,e.u_horizon_normal),u_sky_horizon_blend:new c.bj(p,e.u_sky_horizon_blend),u_sky_blend:new c.bj(p,e.u_sky_blend)})};class vh{constructor(e,a,l){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const La={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gc{constructor(e,a,l,f){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=e;const g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let l=0;l<this.attributes.length;l++){const f=a.attributes[this.attributes[l].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,a,l){for(let f=0;f<this.attributes.length;f++){const g=this.attributes[f],b=a.attributes[g.name];b!==void 0&&e.vertexAttribPointer(b,g.components,e[La[g.type]],!1,this.itemSize,g.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Bi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bh extends Bi{getDefault(){return c.bi.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Td extends Bi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Ho extends Bi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Xo extends Bi{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class xh extends Bi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class wh extends Bi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class ds extends Bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class _c extends Bi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class yc extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class yu extends Bi{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Yo extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class vc extends Bi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Bl extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class _a extends Bi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Sh extends Bi{getDefault(){return c.bi.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class vu extends Bi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ya extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class fs extends Bi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Wr extends Bi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Fs extends Bi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Wo extends Bi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Ko extends Bi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class bc extends Bi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class go extends Bi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Oa extends Bi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Th extends Bi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ll extends Bi{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class pi extends Bi{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const l=this.gl;ca(l)?l.bindVertexArray(e):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class bu extends Bi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class va extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class xu extends Bi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Kr extends Bi{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class Ed extends Kr{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class wu extends Kr{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class _o extends Kr{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Su="Framebuffer is not complete";class Tu{constructor(e,a,l,f,g){this.context=e,this.width=a,this.height=l;const b=e.gl,M=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new Ed(e,M),f)this.depthAttachment=g?new _o(e,M):new wu(e,M);else if(g)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error(Su)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Ol{constructor(e){var a,l;if(this.gl=e,this.clearColor=new bh(this),this.clearDepth=new Td(this),this.clearStencil=new Ho(this),this.colorMask=new Xo(this),this.depthMask=new xh(this),this.stencilMask=new wh(this),this.stencilFunc=new ds(this),this.stencilOp=new _c(this),this.stencilTest=new yc(this),this.depthRange=new yu(this),this.depthTest=new Yo(this),this.depthFunc=new vc(this),this.blend=new Bl(this),this.blendFunc=new _a(this),this.blendColor=new Sh(this),this.blendEquation=new vu(this),this.cullFace=new ya(this),this.cullFaceSide=new fs(this),this.frontFace=new Wr(this),this.program=new Fs(this),this.activeTexture=new Wo(this),this.viewport=new Ko(this),this.bindFramebuffer=new bc(this),this.bindRenderbuffer=new go(this),this.bindTexture=new Oa(this),this.bindVertexBuffer=new Th(this),this.bindElementBuffer=new Ll(this),this.bindVertexArray=new pi(this),this.pixelStoreUnpack=new bu(this),this.pixelStoreUnpackPremultiplyAlpha=new va(this),this.pixelStoreUnpackFlipY=new xu(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ca(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:f?.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:f?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new vh(this,e,a)}createVertexBuffer(e,a,l){return new gc(this,e,a,l)}createRenderbuffer(e,a,l){const f=this.gl,g=f.createRenderbuffer();return this.bindRenderbuffer.set(g),f.renderbufferStorage(f.RENDERBUFFER,e,a,l),this.bindRenderbuffer.set(null),g}createFramebuffer(e,a,l,f){return new Tu(this,e,a,l,f)}clear({color:e,depth:a,stencil:l}){const f=this.gl;let g=0;e&&(g|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(g|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),f.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bK(e.blendFunction,Ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ca(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return ca(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let yo;function Ur(p,e,a,l,f){const g=p.context,b=p.transform,M=g.gl,A=p.useProgram("collisionBox"),k=[];let R=0,N=0;for(let le=0;le<l.length;le++){const de=l[le],ye=e.getTile(de).getBucket(a);if(!ye)continue;const he=f?ye.textCollisionBox:ye.iconCollisionBox,ve=ye.collisionCircleArray;ve.length>0&&(k.push({circleArray:ve,circleOffset:N,coord:de}),R+=ve.length/4,N=R),he&&A.draw(g,M.LINES,fi.disabled,Di.disabled,p.colorModeForRenderPass(),ui.disabled,ph(p.transform),p.style.map.terrain&&p.style.map.terrain.getTerrainData(de),b.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,p.transform.zoom,null,null,he.collisionVertexBuffer)}if(!f||!k.length)return;const j=p.useProgram("collisionCircle"),Y=new c.c3;Y.resize(4*R),Y._trim();let Q=0;for(const le of k)for(let de=0;de<le.circleArray.length/4;de++){const ye=4*de,he=le.circleArray[ye+0],ve=le.circleArray[ye+1],Ee=le.circleArray[ye+2],me=le.circleArray[ye+3];Y.emplace(Q++,he,ve,Ee,me,0),Y.emplace(Q++,he,ve,Ee,me,1),Y.emplace(Q++,he,ve,Ee,me,2),Y.emplace(Q++,he,ve,Ee,me,3)}(!yo||yo.length<2*R)&&(yo=(function(le){const de=2*le,ye=new c.c5;ye.resize(de),ye._trim();for(let he=0;he<de;he++){const ve=6*he;ye.uint16[ve+0]=4*he+0,ye.uint16[ve+1]=4*he+1,ye.uint16[ve+2]=4*he+2,ye.uint16[ve+3]=4*he+2,ye.uint16[ve+4]=4*he+3,ye.uint16[ve+5]=4*he+0}return ye})(R));const re=g.createIndexBuffer(yo,!0),se=g.createVertexBuffer(Y,c.c4.members,!0);for(const le of k){const de=du(p.transform);j.draw(g,M.TRIANGLES,fi.disabled,Di.disabled,p.colorModeForRenderPass(),ui.disabled,de,p.style.map.terrain&&p.style.map.terrain.getTerrainData(le.coord),null,a.id,se,re,c.aQ.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,p.transform.zoom,null,null,null)}se.destroy(),re.destroy()}const vo=c.am(new Float32Array(16));function Qo(p,e,a,l,f,g){const{horizontalAlign:b,verticalAlign:M}=c.aL(p);return new c.P((-(b-.5)*e/f+l[0])*g,(-(M-.5)*a/f+l[1])*g)}function Jo(p,e,a,l,f,g){const b=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let M=l.mult(g);a||(M=M.rotate(-f));const A=b.add(M);return gt(A.x,A.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const M=Xr(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(p),A=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return p.add(l.rotate(A))}return p.add(l)}function bo(p,e,a,l,f,g,b,M,A,k,R,N){const j=p.text.placedSymbolArray,Y=p.text.dynamicLayoutVertexArray,Q=p.icon.dynamicLayoutVertexArray,re={};Y.clear();for(let se=0;se<j.length;se++){const le=j.get(se),de=le.hidden||!le.crossTileID||p.allowVerticalPlacement&&!le.placedOrientation?null:l[le.crossTileID];if(de){const ye=new c.P(le.anchorX,le.anchorY),he={getElevation:N,width:f.width,height:f.height,pitchedLabelPlaneMatrix:g,pitchWithMap:a,transform:f,tileAnchorPoint:ye,translation:k,unwrappedTileID:R},ve=a?os(ye.x,ye.y,he):Xr(ye.x,ye.y,he),Ee=ai(f.cameraToCenterDistance,ve.signedDistanceFromCamera);let me=c.at(p.textSizeData,M,le)*Ee/c.aF;a&&(me*=p.tilePixelRatio/b);const{width:ze,height:Ge,anchor:Oe,textOffset:Ne,textBoxScale:$e}=de,yt=Qo(Oe,ze,Ge,Ne,$e,me),vt=f.getPitchedTextCorrection(ye.x+k[0],ye.y+k[1],R),nt=Jo(ve.point,he,e,yt,-f.bearingInRadians,vt),kt=p.allowVerticalPlacement&&le.placedOrientation===c.as.vertical?Math.PI/2:0;for(let oi=0;oi<le.numGlyphs;oi++)c.az(Y,nt,kt);A&&le.associatedIconIndex>=0&&(re[le.associatedIconIndex]={shiftedAnchor:nt,angle:kt})}else Ha(le.numGlyphs,Y)}if(A){Q.clear();const se=p.icon.placedSymbolArray;for(let le=0;le<se.length;le++){const de=se.get(le);if(de.hidden)Ha(de.numGlyphs,Q);else{const ye=re[le];if(ye)for(let he=0;he<de.numGlyphs;he++)c.az(Q,ye.shiftedAnchor,ye.angle);else Ha(de.numGlyphs,Q)}}p.icon.dynamicLayoutVertexBuffer.updateData(Q)}p.text.dynamicLayoutVertexBuffer.updateData(Y)}function Qr(p,e,a){return a.iconsInText&&e?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function br(p,e,a,l,f,g,b,M,A,k,R,N,j){const Y=p.context,Q=Y.gl,re=p.transform,se=M==="map",le=A==="map",de=M!=="viewport"&&a.layout.get("symbol-placement")!=="point",ye=se&&!le&&!de,he=!a.layout.get("symbol-sort-key").isConstant();let ve=!1;const Ee=p.getDepthModeForSublayer(0,fi.ReadOnly),me=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ze=[],Ge=re.getCircleRadiusCorrection();for(const Oe of l){const Ne=e.getTile(Oe),$e=Ne.getBucket(a);if(!$e)continue;const yt=f?$e.text:$e.icon;if(!yt||!yt.segments.get().length||!yt.hasVisibleVertices)continue;const vt=yt.programConfigurations.get(a.id),nt=f||$e.sdfIcons,kt=f?$e.textSizeData:$e.iconSizeData,oi=le||re.pitch!==0,Zi=p.useProgram(Qr(nt,f,$e),vt),mi=c.ar(kt,re.zoom),Ji=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Oe);let Mn,sn,Hn,vn,rr=[0,0],bn=null;if(f)sn=Ne.glyphAtlasTexture,Hn=Q.LINEAR,Mn=Ne.glyphAtlasTexture.size,$e.iconsInText&&(rr=Ne.imageAtlasTexture.size,bn=Ne.imageAtlasTexture,vn=oi||p.options.rotating||p.options.zooming||kt.kind==="composite"||kt.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const Un=a.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;sn=Ne.imageAtlasTexture,Hn=nt||p.options.rotating||p.options.zooming||Un||oi?Q.LINEAR:Q.NEAREST,Mn=Ne.imageAtlasTexture.size}const jn=c.aG(Ne,1,p.transform.zoom),Or=jr(se,p.transform,jn),Ao=c.M();c.au(Ao,Or);const xs=ga(le,se,p.transform,jn),ws=c.aH(re,Ne,g,b),Ks=re.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),fl=me&&$e.hasTextData(),zo=a.layout.get("icon-text-fit")!=="none"&&fl&&$e.hasIconData();if(de){const Un=p.style.map.terrain?(ar,en)=>p.style.map.terrain.getElevation(Oe,ar,en):null,xn=a.layout.get("text-rotation-alignment")==="map";$a($e,p,f,Or,Ao,le,k,xn,Oe.toUnwrapped(),re.width,re.height,ws,Un)}const Vr=f&&me||zo,Gr=de||Vr?vo:le?Or:p.transform.clipSpaceToPixelsMatrix,Ss=nt&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Co;Co=nt?$e.iconsInText?hs(kt.kind,mi,ye,le,de,Vr,p,Gr,xs,ws,Mn,rr,Ge):Os(kt.kind,mi,ye,le,de,Vr,p,Gr,xs,ws,f,Mn,0,Ge):Yr(kt.kind,mi,ye,le,de,Vr,p,Gr,xs,ws,f,Mn,Ge);const Dc={program:Zi,buffers:yt,uniformValues:Co,projectionData:Ks,atlasTexture:sn,atlasTextureIcon:bn,atlasInterpolation:Hn,atlasInterpolationIcon:vn,isSDF:nt,hasHalo:Ss};if(he&&$e.canOverlap){ve=!0;const Un=yt.segments.get();for(const xn of Un)ze.push({segments:new c.aQ([xn]),sortKey:xn.sortKey,state:Dc,terrainData:Ji})}else ze.push({segments:yt.segments,sortKey:0,state:Dc,terrainData:Ji})}ve&&ze.sort(((Oe,Ne)=>Oe.sortKey-Ne.sortKey));for(const Oe of ze){const Ne=Oe.state;if(Y.activeTexture.set(Q.TEXTURE0),Ne.atlasTexture.bind(Ne.atlasInterpolation,Q.CLAMP_TO_EDGE),Ne.atlasTextureIcon&&(Y.activeTexture.set(Q.TEXTURE1),Ne.atlasTextureIcon&&Ne.atlasTextureIcon.bind(Ne.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Ne.isSDF){const $e=Ne.uniformValues;Ne.hasHalo&&($e.u_is_halo=1,Wa(Ne.buffers,Oe.segments,a,p,Ne.program,Ee,R,N,$e,Ne.projectionData,Oe.terrainData)),$e.u_is_halo=0}Wa(Ne.buffers,Oe.segments,a,p,Ne.program,Ee,R,N,Ne.uniformValues,Ne.projectionData,Oe.terrainData)}}function Wa(p,e,a,l,f,g,b,M,A,k,R){const N=l.context;f.draw(N,N.gl.TRIANGLES,g,b,M,ui.backCCW,A,R,k,a.id,p.layoutVertexBuffer,p.indexBuffer,e,a.paint,l.transform.zoom,p.programConfigurations.get(a.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function ps(p,e,a,l,f){const g=p.context,b=g.gl,M=Di.disabled,A=new Ri([b.ONE,b.ONE],c.bi.transparent,[!0,!0,!0,!0]),k=e.getBucket(a);if(!k)return;const R=l.key;let N=a.heatmapFbos.get(R);N||(N=ms(g,e.tileSize,e.tileSize),a.heatmapFbos.set(R,N)),g.bindFramebuffer.set(N.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:c.bi.transparent});const j=k.programConfigurations.get(a.id),Y=p.useProgram("heatmap",j,!f),Q=p.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),re=p.style.map.terrain.getTerrainData(l);Y.draw(g,b.TRIANGLES,fi.disabled,M,A,ui.disabled,$o(e,p.transform.zoom,a.paint.get("heatmap-intensity"),1),re,Q,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,p.transform.zoom,j)}function ua(p,e,a,l,f){const g=p.context,b=g.gl,M=p.transform;g.setColorMode(p.colorModeForRenderPass());const A=Eu(g,e),k=a.key,R=e.heatmapFbos.get(k);if(!R)return;g.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,R.colorAttachment.get()),g.activeTexture.set(b.TEXTURE1),A.bind(b.LINEAR,b.CLAMP_TO_EDGE);const N=M.getProjectionData({overscaledTileID:a,applyTerrainMatrix:f,applyGlobeMatrix:!l});p.useProgram("heatmapTexture").draw(g,b.TRIANGLES,fi.disabled,Di.disabled,p.colorModeForRenderPass(),ui.disabled,mh(p,e,0,1),null,N,e.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments,e.paint,M.zoom),R.destroy(),e.heatmapFbos.delete(k)}function ms(p,e,a){var l,f;const g=p.gl,b=g.createTexture();g.bindTexture(g.TEXTURE_2D,b),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);const M=(l=p.HALF_FLOAT)!==null&&l!==void 0?l:g.UNSIGNED_BYTE,A=(f=p.RGBA16F)!==null&&f!==void 0?f:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,A,e,a,0,g.RGBA,M,null);const k=p.createFramebuffer(e,a,!1,!1);return k.colorAttachment.set(b),k}function Eu(p,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(p,e.colorRamp,p.gl.RGBA)),e.colorRampTexture}function el(p,e,a,l,f,g,b,M){let A=256;if(f.stepInterpolant){const k=e.getSource().maxzoom,R=b.canonical.z===k?Math.ceil(1<<p.transform.maxZoom-b.canonical.z):1;A=c.ai(c.c7(g.maxLineLength/c.a3*1024*R),256,a.maxTextureSize)}return M.gradient=c.c8({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:A,image:M.gradient||void 0,clips:g.lineClipsArray}),M.texture?M.texture.update(M.gradient):M.texture=new c.T(a,M.gradient,l.RGBA),M.version=f.gradientVersion,M.texture}function xc(p,e,a,l,f){p.activeTexture.set(e.TEXTURE0),a.imageAtlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE),l.updatePaintBuffers(f)}function Eh(p,e,a,l,f,g){(f||p.lineAtlas.dirty)&&(e.activeTexture.set(a.TEXTURE0),p.lineAtlas.bind(e)),l.updatePaintBuffers(g)}function xr(p,e,a,l,f,g,b){const M=g.gradients[f.id];let A=M.texture;f.gradientVersion!==M.version&&(A=el(p,e,a,l,f,g,b,M)),a.activeTexture.set(l.TEXTURE0),A.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE)}function an(p,e,a,l,f,g,b,M,A){const k=g.gradients[f.id];let R=k.texture;f.gradientVersion!==k.version&&(R=el(p,e,a,l,f,g,b,k)),a.activeTexture.set(l.TEXTURE0),R.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),p.lineAtlas.bind(a),M.updatePaintBuffers(A)}function Ii(p,e,a,l,f){if(!a||!l||!l.imageAtlas)return;const g=l.imageAtlas.patternPositions;let b=g[a.to.toString()],M=g[a.from.toString()];if(!b&&M&&(b=M),!M&&b&&(M=b),!b||!M){const A=f.getPaintProperty(e);b=g[A],M=g[A]}b&&M&&p.setConstantPatternPositions(b,M)}function js(p,e,a,l,f,g,b,M){const A=p.context.gl,k="fill-pattern",R=a.paint.get(k),N=R&&R.constantOr(1),j=a.getCrossfadeParameters();let Y,Q,re,se,le;const de=p.transform,ye=a.paint.get("fill-translate"),he=a.paint.get("fill-translate-anchor");b?(Q=N&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=A.LINES):(Q=N?"fillPattern":"fill",Y=A.TRIANGLES);const ve=R.constantOr(null);for(const Ee of l){const me=e.getTile(Ee);if(N&&!me.patternsLoaded())continue;const ze=me.getBucket(a);if(!ze)continue;const Ge=ze.programConfigurations.get(a.id),Oe=p.useProgram(Q,Ge),Ne=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ee);N&&(p.context.activeTexture.set(A.TEXTURE0),me.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Ge.updatePaintBuffers(j)),Ii(Ge,k,ve,me,a);const $e=de.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),yt=c.aH(de,me,ye,he);if(b){se=ze.indexBuffer2,le=ze.segments2;const nt=[A.drawingBufferWidth,A.drawingBufferHeight];re=Q==="fillOutlinePattern"&&N?bd(p,j,me,nt,yt):Mf(nt,yt)}else se=ze.indexBuffer,le=ze.segments,re=N?Ba(p,j,me,yt):{u_fill_translate:yt};const vt=p.stencilModeForClipping(Ee);Oe.draw(p.context,Y,f,vt,g,ui.backCCW,re,Ne,$e,a.id,ze.layoutVertexBuffer,se,le,a.paint,p.transform.zoom,Ge)}}function Jr(p,e,a,l,f,g,b,M){const A=p.context,k=A.gl,R="fill-extrusion-pattern",N=a.paint.get(R),j=N.constantOr(1),Y=a.getCrossfadeParameters(),Q=a.paint.get("fill-extrusion-opacity"),re=N.constantOr(null),se=p.transform;for(const le of l){const de=e.getTile(le),ye=de.getBucket(a);if(!ye)continue;const he=p.style.map.terrain&&p.style.map.terrain.getTerrainData(le),ve=ye.programConfigurations.get(a.id),Ee=p.useProgram(j?"fillExtrusionPattern":"fillExtrusion",ve);j&&(p.context.activeTexture.set(k.TEXTURE0),de.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ve.updatePaintBuffers(Y));const me=se.getProjectionData({overscaledTileID:le,applyGlobeMatrix:!M,applyTerrainMatrix:!0});Ii(ve,R,re,de,a);const ze=c.aH(se,de,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ge=a.paint.get("fill-extrusion-vertical-gradient"),Oe=j?vd(p,Ge,Q,ze,le,Y,de):Rl(p,Ge,Q,ze);Ee.draw(A,A.gl.TRIANGLES,f,g,b,ui.backCCW,Oe,he,me,a.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,a.paint,p.transform.zoom,ve,p.style.map.terrain&&ye.centroidVertexBuffer)}}function yn(p,e,a,l,f,g,b,M,A){var k;const R=p.style.projection,N=p.context,j=p.transform,Y=N.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],re=p.useProgram("hillshade",null,!1,Q),se=!p.options.moving;for(const le of l){const de=e.getTile(le),ye=de.fbo;if(!ye)continue;const he=R.getMeshFromTileID(N,le.canonical,M,!0,"raster"),ve=(k=p.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(le);N.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,ye.colorAttachment.get());const Ee=j.getProjectionData({overscaledTileID:le,aligned:se,applyGlobeMatrix:!A,applyTerrainMatrix:!0});re.draw(N,Y.TRIANGLES,g,f[le.overscaledZ],b,ui.backCCW,fc(p,de,a),ve,Ee,a.id,he.vertexBuffer,he.indexBuffer,he.segments)}}function Nr(p,e,a,l,f,g,b,M,A){var k;const R=p.style.projection,N=p.context,j=p.transform,Y=N.gl,Q=p.useProgram("colorRelief"),re=!p.options.moving;let se=!0,le=0;for(const de of l){const ye=e.getTile(de),he=ye.dem;if(se){const Oe=Y.getParameter(Y.MAX_TEXTURE_SIZE),{elevationTexture:Ne,colorTexture:$e}=a.getColorRampTextures(N,Oe,he.getUnpackVector());N.activeTexture.set(Y.TEXTURE1),Ne.bind(Y.NEAREST,Y.CLAMP_TO_EDGE),N.activeTexture.set(Y.TEXTURE4),$e.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),se=!1,le=Ne.size[0]}if(!he||!he.data)continue;const ve=he.stride,Ee=he.getPixels();if(N.activeTexture.set(Y.TEXTURE0),N.pixelStoreUnpackPremultiplyAlpha.set(!1),ye.demTexture=ye.demTexture||p.getTileTexture(ve),ye.demTexture){const Oe=ye.demTexture;Oe.update(Ee,{premultiply:!1}),Oe.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}else ye.demTexture=new c.T(N,Ee,Y.RGBA,{premultiply:!1}),ye.demTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const me=R.getMeshFromTileID(N,de.canonical,M,!0,"raster"),ze=(k=p.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(de),Ge=j.getProjectionData({overscaledTileID:de,aligned:re,applyGlobeMatrix:!A,applyTerrainMatrix:!0});Q.draw(N,Y.TRIANGLES,g,f[de.overscaledZ],b,ui.backCCW,fu(a,ye.dem,le),ze,Ge,a.id,me.vertexBuffer,me.indexBuffer,me.segments)}}const ea=[new c.P(0,0),new c.P(c.a3,0),new c.P(c.a3,c.a3),new c.P(0,c.a3)];function tl(p,e,a,l,f,g,b,M,A=!1,k=!1){const R=l[l.length-1].overscaledZ,N=p.context,j=N.gl,Y=p.useProgram("raster"),Q=p.transform,re=p.style.projection,se=p.colorModeForRenderPass(),le=!p.options.moving,de=a.paint.get("raster-opacity"),ye=a.paint.get("raster-resampling"),he=a.paint.get("raster-fade-duration"),ve=!!p.style.map.terrain;for(const Ee of l){const me=p.getDepthModeForSublayer(Ee.overscaledZ-R,de===1?fi.ReadWrite:fi.ReadOnly,j.LESS),ze=e.getTile(Ee),Ge=ye==="nearest"?j.NEAREST:j.LINEAR;N.activeTexture.set(j.TEXTURE0),ze.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),N.activeTexture.set(j.TEXTURE1);const{parentTile:Oe,parentScaleBy:Ne,parentTopLeft:$e,fadeValues:yt}=Us(ze,e,he,ve);ze.fadeOpacity=yt.tileOpacity,Oe?(Oe.fadeOpacity=yt.parentTileOpacity,Oe.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST)):ze.texture.bind(Ge,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),ze.texture.useMipmap&&N.extTextureFilterAnisotropic&&p.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const vt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ee),nt=Q.getProjectionData({overscaledTileID:Ee,aligned:le,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),kt=Sd($e,Ne,yt.fadeMix,a,M),oi=re.getMeshFromTileID(N,Ee.canonical,g,b,"raster");Y.draw(N,j.TRIANGLES,me,f?f[Ee.overscaledZ]:Di.disabled,se,A?ui.frontCCW:ui.backCCW,kt,vt,nt,a.id,oi.vertexBuffer,oi.indexBuffer,oi.segments)}}function Us(p,e,a,l){const f={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||l)return f;if(p.fadingParentID){const g=e.getLoadedTile(p.fadingParentID);if(!g)return f;const b=Math.pow(2,g.tileID.overscaledZ-p.tileID.overscaledZ),M=[p.tileID.canonical.x*b%1,p.tileID.canonical.y*b%1],A=(function(k,R,N){const j=Ae(),Y=(j-R.timeAdded)/N,Q=k.fadingDirection===ae.Incoming,re=c.ai((j-k.timeAdded)/N,0,1),se=c.ai(1-Y,0,1),le=Q?re:se;return{tileOpacity:le,parentTileOpacity:Q?se:re,fadeMix:{opacity:1,mix:1-le}}})(p,g,a);return{parentTile:g,parentScaleBy:b,parentTopLeft:M,fadeValues:A}}if(p.selfFading){const g=(function(b,M){const A=(Ae()-b.timeAdded)/M,k=c.ai(A,0,1);return{tileOpacity:k,fadeMix:{opacity:k,mix:0}}})(p,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:g}}return f}const xo=new c.bi(1,0,0,1),wo=new c.bi(0,1,0,1),il=new c.bi(0,0,1,1),nl=new c.bi(1,0,1,1),Ns=new c.bi(0,1,1,1);function Ka(p,e,a,l){ba(p,0,e+a/2,p.transform.width,a,l)}function gs(p,e,a,l){ba(p,e-a/2,0,a,p.transform.height,l)}function ba(p,e,a,l,f,g){const b=p.context,M=b.gl;M.enable(M.SCISSOR_TEST),M.scissor(e*p.pixelRatio,a*p.pixelRatio,l*p.pixelRatio,f*p.pixelRatio),b.clear({color:g}),M.disable(M.SCISSOR_TEST)}function Mu(p,e,a){const l=p.context,f=l.gl,g=p.useProgram("debug"),b=fi.disabled,M=Di.disabled,A=p.colorModeForRenderPass(),k="$debug",R=p.style.map.terrain&&p.style.map.terrain.getTerrainData(a);l.activeTexture.set(f.TEXTURE0);const N=e.getTileByID(a.key).latestRawTileData,j=Math.floor((N&&N.byteLength||0)/1024),Y=e.getTile(a).tileSize,Q=512/Math.min(Y,512)*(a.overscaledZ/p.transform.zoom)*.5;let re=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(re+=` => ${a.overscaledZ}`),(function(le,de){le.initDebugOverlayCanvas();const ye=le.debugOverlayCanvas,he=le.context.gl,ve=le.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,ye.width,ye.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(de,5,5),ve.strokeText(de,5,5),le.debugOverlayTexture.update(ye),le.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)})(p,`${re} ${j}kB`);const se=p.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(l,f.TRIANGLES,b,M,Ri.alphaBlended,ui.disabled,qo(c.bi.transparent,Q),null,se,k,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),g.draw(l,f.LINE_STRIP,b,M,A,ui.disabled,qo(c.bi.red),R,se,k,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function wc(p,e,a,l){const{isRenderingGlobe:f}=l,g=p.context,b=g.gl,M=p.transform,A=p.colorModeForRenderPass(),k=p.getDepthModeFor3D(),R=p.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,p.width,p.height]);for(const N of a){const j=e.getTerrainMesh(N.tileID),Y=p.renderToTexture.getTexture(N),Q=e.getTerrainData(N.tileID);g.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,Y.texture);const re=e.getMeshFrameDelta(M.zoom),se=M.calculateFogMatrix(N.tileID.toUnwrapped()),le=dc(re,se,p.style.sky,M.pitch,f),de=M.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});R.draw(g,b.TRIANGLES,k,Di.disabled,A,ui.backCCW,le,Q,de,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}}function xa(p,e){if(!e.mesh){const a=new c.aP;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new c.aR;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new uo(p.createVertexBuffer(a,Ia.members),p.createIndexBuffer(l),c.aQ.simpleSegment(0,0,a.length,l.length))}return e.mesh}class Sc{constructor(e,a){this.context=new Ol(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.am(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Sn.maxUnderzooming+Sn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ds}resize(e,a,l){if(this.width=Math.floor(e*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,a=new c.aP;a.emplaceBack(0,0),a.emplaceBack(c.a3,0),a.emplaceBack(0,c.a3),a.emplaceBack(c.a3,c.a3),this.tileExtentBuffer=e.createVertexBuffer(a,Ia.members),this.tileExtentSegments=c.aQ.simpleSegment(0,0,4,2);const l=new c.aP;l.emplaceBack(0,0),l.emplaceBack(c.a3,0),l.emplaceBack(0,c.a3),l.emplaceBack(c.a3,c.a3),this.debugBuffer=e.createVertexBuffer(l,Ia.members),this.debugSegments=c.aQ.simpleSegment(0,0,4,5);const f=new c.ca;f.emplaceBack(0,0,0,0),f.emplaceBack(c.a3,0,c.a3,0),f.emplaceBack(0,c.a3,0,c.a3),f.emplaceBack(c.a3,c.a3,c.a3,c.a3),this.rasterBoundsBuffer=e.createVertexBuffer(f,hh.members),this.rasterBoundsSegments=c.aQ.simpleSegment(0,0,4,2);const g=new c.aP;g.emplaceBack(0,0),g.emplaceBack(c.a3,0),g.emplaceBack(0,c.a3),g.emplaceBack(c.a3,c.a3),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,Ia.members),this.rasterBoundsSegmentsPosOnly=c.aQ.simpleSegment(0,0,4,5);const b=new c.aP;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(b,Ia.members),this.viewportSegments=c.aQ.simpleSegment(0,0,4,2);const M=new c.cb;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(M);const A=new c.aR;A.emplaceBack(1,0,2),A.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(A);const k=this.context.gl;this.stencilClearMode=new Di({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new uo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.M();c.c0(l,0,this.width,this.height,0,0,1),c.O(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const f={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,fi.disabled,this.stencilClearMode,Ri.disabled,ui.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Ri.disabled),f.setDepthMode(fi.disabled);const g={};for(const b of a)g[b.key]=this.nextStencilID++;this._renderTileMasks(g,a,l,!0),this._renderTileMasks(g,a,l,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,a,l,f){const g=this.context,b=g.gl,M=this.style.projection,A=this.transform,k=this.useProgram("clippingMask");for(const R of a){const N=e[R.key],j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),Y=M.getMeshFromTileID(this.context,R.canonical,f,!0,"stencil"),Q=A.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!l,applyTerrainMatrix:!0});k.draw(g,b.TRIANGLES,fi.disabled,new Di({func:b.ALWAYS,mask:0},N,255,b.KEEP,b.KEEP,b.REPLACE),Ri.disabled,l?ui.disabled:ui.backCCW,null,j,Q,"$clipping",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,l=this.style.projection,f=this.transform,g=this.useProgram("depth"),b=this.getDepthModeFor3D(),M=gn(f,{tileSize:f.tileSize});for(const A of M){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(A),R=l.getMeshFromTileID(this.context,A.canonical,!0,!0,"raster"),N=f.getProjectionData({overscaledTileID:A,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,a.TRIANGLES,b,Di.disabled,Ri.disabled,ui.backCCW,null,k,N,"$clipping",R.vertexBuffer,R.indexBuffer,R.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new Di({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new Di({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,l=e.sort(((b,M)=>M.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,g=l[0].overscaledZ-f+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const b={};for(let M=0;M<g;M++)b[M+f]=new Di({func:a.GEQUAL,mask:255},M+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[b,l]}return[{[f]:Di.disabled},l]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,l=e.sort(((b,M)=>M.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,g=l[0].overscaledZ-f+1;if(this.clearStencil(),g>1){const b={},M={};for(let A=0;A<g;A++)b[A+f]=new Di({func:a.GREATER,mask:255},g+1+A,255,a.KEEP,a.KEEP,a.REPLACE),M[A+f]=new Di({func:a.GREATER,mask:255},1+A,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*g+1,[b,M,l]}return this.nextStencilID=3,[{[f]:new Di({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[f]:new Di({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ri([e.CONSTANT_COLOR,e.ONE],new c.bi(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ri.unblended:Ri.alphaBlended}getDepthModeForSublayer(e,a,l){if(!this.opaquePassEnabledForLayer())return fi.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new fi(l||this.context.gl.LEQUAL,a,[f,f])}getDepthModeFor3D(){return new fi(this.context.gl.LEQUAL,fi.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var l,f;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Ae()),this.imageManager.beginFrame();const g=this.style._order,b=this.style.tileManagers,M={},A={},k={},R={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const j in b){const Y=b[j];Y.used&&Y.prepare(this.context),M[j]=Y.getVisibleCoordinates(!1),A[j]=M[j].slice().reverse(),k[j]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<g.length;j++)if(this.style._layers[g[j]].is3D()){this.opaquePassCutoff=j;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const j of g){const Y=this.style._layers[j];if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const Q=A[Y.source];(Y.type==="custom"||Q.length)&&this.renderLayer(this,b[Y.source],Y,Q,R)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:j=>this.useProgram(j)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.bi.black:c.bi.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(j,Y){const Q=j.context,re=Q.gl,se=((Ee,me,ze)=>{const Ge=Math.cos(me.rollInRadians),Oe=Math.sin(me.rollInRadians),Ne=Je(me),$e=me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ee.properties.get("sky-color"),u_horizon_color:Ee.properties.get("horizon-color"),u_horizon:[(me.width/2-Ne*Oe)*ze,(me.height/2+Ne*Ge)*ze],u_horizon_normal:[-Oe,Ge],u_sky_horizon_blend:Ee.properties.get("sky-horizon-blend")*me.height/2*ze,u_sky_blend:$e}})(Y,j.style.map.transform,j.pixelRatio),le=new fi(re.LEQUAL,fi.ReadWrite,[0,1]),de=Di.disabled,ye=j.colorModeForRenderPass(),he=j.useProgram("sky"),ve=xa(Q,Y);he.draw(Q,re.TRIANGLES,le,de,ye,ui.disabled,se,null,void 0,"sky",ve.vertexBuffer,ve.indexBuffer,ve.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[g[this.currentLayer]],Y=b[j.source],Q=M[j.source];this._renderTileClippingMasks(j,Q,!1),this.renderLayer(this,Y,j,Q,R)}this.renderPass="translucent";let N=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const j=this.style._layers[g[this.currentLayer]],Y=b[j.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(j,R))continue;this.opaquePassEnabledForLayer()||N||(N=!0,R.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(j.type==="symbol"?k:A)[j.source];this._renderTileClippingMasks(j,M[j.source],!!this.renderToTexture),this.renderLayer(this,Y,j,Q,R)}if(R.isRenderingGlobe&&(function(j,Y,Q){const re=j.context,se=re.gl,le=j.useProgram("atmosphere"),de=new fi(se.LEQUAL,fi.ReadOnly,[0,1]),ye=j.transform,he=(function($e,yt){const vt=$e.properties.get("position"),nt=[-vt.x,-vt.y,-vt.z],kt=c.am(new Float64Array(16));return $e.properties.get("anchor")==="map"&&(c.b9(kt,kt,yt.rollInRadians),c.ba(kt,kt,-yt.pitchInRadians),c.b9(kt,kt,yt.bearingInRadians),c.ba(kt,kt,yt.center.lat*Math.PI/180),c.bC(kt,kt,-yt.center.lng*Math.PI/180)),c.c9(nt,nt,kt),nt})(Q,j.transform),ve=ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ee=Y.properties.get("atmosphere-blend")*ve.projectionTransition;if(Ee===0)return;const me=oc(ye.worldSize,ye.center.lat),ze=ye.inverseProjectionMatrix,Ge=new Float64Array(4);Ge[3]=1,c.aA(Ge,Ge,ye.modelViewProjectionMatrix),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1,c.aA(Ge,Ge,ze),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1;const Oe=(($e,yt,vt,nt,kt)=>({u_sun_pos:$e,u_atmosphere_blend:yt,u_globe_position:vt,u_globe_radius:nt,u_inv_proj_matrix:kt}))(he,Ee,[Ge[0],Ge[1],Ge[2]],me,ze),Ne=xa(re,Y);le.draw(re,se.TRIANGLES,de,Di.disabled,Ri.alphaBlended,ui.disabled,Oe,null,null,"atmosphere",Ne.vertexBuffer,Ne.indexBuffer,Ne.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const j=(function(Y,Q){let re=null;const se=Object.values(Y._layers).flatMap((he=>he.source&&!he.isHidden(Q)?[Y.tileManagers[he.source]]:[])),le=se.filter((he=>he.getSource().type==="vector")),de=se.filter((he=>he.getSource().type!=="vector")),ye=he=>{(!re||re.getSource().maxzoom<he.getSource().maxzoom)&&(re=he)};return le.forEach((he=>ye(he))),re||de.forEach((he=>ye(he))),re})(this.style,this.transform.zoom);j&&(function(Y,Q,re){for(let se=0;se<re.length;se++)Mu(Y,Q,re[se])})(this,j,j.getVisibleCoordinates())}this.options.showPadding&&(function(j){const Y=j.transform.padding;Ka(j,j.transform.height-(Y.top||0),3,xo),Ka(j,Y.bottom||0,3,wo),gs(j,Y.left||0,3,il),gs(j,j.transform.width-(Y.right||0),3,nl);const Q=j.transform.centerPoint;(function(re,se,le,de){ba(re,se-1,le-10,2,20,de),ba(re,se-10,le-1,20,2,de)})(j,Q.x,j.transform.height-Q.y,Ns)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!c.cc(a,l):!c.cd(a,l)),f||(f=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(c.ce(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(g,b){const M=g.context,A=M.gl,k=g.transform,R=Ri.unblended,N=new fi(A.LEQUAL,fi.ReadWrite,[0,1]),j=b.tileManager.getRenderableTiles(),Y=g.useProgram("terrainDepth");M.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),M.clear({color:c.bi.transparent,depth:1});for(const Q of j){const re=b.getTerrainMesh(Q.tileID),se=b.getTerrainData(Q.tileID),le=k.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),de={u_ele_delta:b.getMeshFrameDelta(k.zoom)};Y.draw(M,A.TRIANGLES,N,Di.disabled,R,ui.backCCW,de,se,le,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain),(function(g,b){const M=g.context,A=M.gl,k=g.transform,R=Ri.unblended,N=new fi(A.LEQUAL,fi.ReadWrite,[0,1]),j=b.getCoordsTexture(),Y=b.tileManager.getRenderableTiles(),Q=g.useProgram("terrainCoords");M.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),M.clear({color:c.bi.transparent,depth:1}),b.coordsIndex=[];for(const re of Y){const se=b.getTerrainMesh(re.tileID),le=b.getTerrainData(re.tileID);M.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,j.texture);const de={u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(k.zoom)},ye=k.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(M,A.TRIANGLES,N,Di.disabled,R,ui.backCCW,de,le,ye,"terrain",se.vertexBuffer,se.indexBuffer,se.segments),b.coordsIndex.push(re.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain))}renderLayer(e,a,l,f,g){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(f||[]).length)&&(this.id=l.id,c.cf(l)?(function(b,M,A,k,R,N){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:j}=N,Y=Di.disabled,Q=b.colorModeForRenderPass();(A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(re,se,le,de,ye,he,ve,Ee,me){const ze=se.transform,Ge=se.style.map.terrain,Oe=ye==="map",Ne=he==="map";for(const $e of re){const yt=de.getTile($e),vt=yt.getBucket(le);if(!vt||!vt.text||!vt.text.segments.get().length)continue;const nt=c.ar(vt.textSizeData,ze.zoom),kt=c.aG(yt,1,se.transform.zoom),oi=jr(Oe,se.transform,kt),Zi=le.layout.get("icon-text-fit")!=="none"&&vt.hasIconData();if(nt){const mi=Math.pow(2,ze.zoom-yt.tileID.overscaledZ),Ji=Ge?(Mn,sn)=>Ge.getElevation($e,Mn,sn):null;bo(vt,Oe,Ne,me,ze,oi,mi,nt,Zi,c.aH(ze,yt,ve,Ee),$e.toUnwrapped(),Ji)}}})(k,b,A,M,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),R),A.paint.get("icon-opacity").constantOr(1)!==0&&br(b,M,A,k,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),Y,Q,j),A.paint.get("text-opacity").constantOr(1)!==0&&br(b,M,A,k,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),Y,Q,j),M.map.showCollisionBoxes&&(Ur(b,M,A,k,!0),Ur(b,M,A,k,!1))})(e,a,l,f,this.style.placement.variableOffsets,g):c.cg(l)?(function(b,M,A,k,R){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:N}=R,j=A.paint.get("circle-opacity"),Y=A.paint.get("circle-stroke-width"),Q=A.paint.get("circle-stroke-opacity"),re=!A.layout.get("circle-sort-key").isConstant();if(j.constantOr(1)===0&&(Y.constantOr(1)===0||Q.constantOr(1)===0))return;const se=b.context,le=se.gl,de=b.transform,ye=b.getDepthModeForSublayer(0,fi.ReadOnly),he=Di.disabled,ve=b.colorModeForRenderPass(),Ee=[],me=de.getCircleRadiusCorrection();for(let ze=0;ze<k.length;ze++){const Ge=k[ze],Oe=M.getTile(Ge),Ne=Oe.getBucket(A);if(!Ne)continue;const $e=A.paint.get("circle-translate"),yt=A.paint.get("circle-translate-anchor"),vt=c.aH(de,Oe,$e,yt),nt=Ne.programConfigurations.get(A.id),kt=b.useProgram("circle",nt),oi=Ne.layoutVertexBuffer,Zi=Ne.indexBuffer,mi=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ge),Ji={programConfiguration:nt,program:kt,layoutVertexBuffer:oi,indexBuffer:Zi,uniformValues:Af(b,Oe,A,vt,me),terrainData:mi,projectionData:de.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!N,applyTerrainMatrix:!0})};if(re){const Mn=Ne.segments.get();for(const sn of Mn)Ee.push({segments:new c.aQ([sn]),sortKey:sn.sortKey,state:Ji})}else Ee.push({segments:Ne.segments,sortKey:0,state:Ji})}re&&Ee.sort(((ze,Ge)=>ze.sortKey-Ge.sortKey));for(const ze of Ee){const{programConfiguration:Ge,program:Oe,layoutVertexBuffer:Ne,indexBuffer:$e,uniformValues:yt,terrainData:vt,projectionData:nt}=ze.state;Oe.draw(se,le.TRIANGLES,ye,he,ve,ui.backCCW,yt,vt,nt,A.id,Ne,$e,ze.segments,A.paint,b.transform.zoom,Ge)}})(e,a,l,f,g):c.ch(l)?(function(b,M,A,k,R){if(A.paint.get("heatmap-opacity")===0)return;const N=b.context,{isRenderingToTexture:j,isRenderingGlobe:Y}=R;if(b.style.map.terrain){for(const Q of k){const re=M.getTile(Q);M.hasRenderableParent(Q)||(b.renderPass==="offscreen"?ps(b,re,A,Q,Y):b.renderPass==="translucent"&&ua(b,A,Q,j,Y))}N.viewport.set([0,0,b.width,b.height])}else b.renderPass==="offscreen"?(function(Q,re,se,le){const de=Q.context,ye=de.gl,he=Q.transform,ve=Di.disabled,Ee=new Ri([ye.ONE,ye.ONE],c.bi.transparent,[!0,!0,!0,!0]);(function(me,ze,Ge){const Oe=me.gl;me.activeTexture.set(Oe.TEXTURE1),me.viewport.set([0,0,ze.width/4,ze.height/4]);let Ne=Ge.heatmapFbos.get(c.c6);Ne?(Oe.bindTexture(Oe.TEXTURE_2D,Ne.colorAttachment.get()),me.bindFramebuffer.set(Ne.framebuffer)):(Ne=ms(me,ze.width/4,ze.height/4),Ge.heatmapFbos.set(c.c6,Ne))})(de,Q,se),de.clear({color:c.bi.transparent});for(let me=0;me<le.length;me++){const ze=le[me];if(re.hasRenderableParent(ze))continue;const Ge=re.getTile(ze),Oe=Ge.getBucket(se);if(!Oe)continue;const Ne=Oe.programConfigurations.get(se.id),$e=Q.useProgram("heatmap",Ne),yt=he.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),vt=he.getCircleRadiusCorrection();$e.draw(de,ye.TRIANGLES,fi.disabled,ve,Ee,ui.backCCW,$o(Ge,he.zoom,se.paint.get("heatmap-intensity"),vt),null,yt,se.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,se.paint,he.zoom,Ne)}de.viewport.set([0,0,Q.width,Q.height])})(b,M,A,k):b.renderPass==="translucent"&&(function(Q,re){const se=Q.context,le=se.gl;se.setColorMode(Q.colorModeForRenderPass());const de=re.heatmapFbos.get(c.c6);de&&(se.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,de.colorAttachment.get()),se.activeTexture.set(le.TEXTURE1),Eu(se,re).bind(le.LINEAR,le.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(se,le.TRIANGLES,fi.disabled,Di.disabled,Q.colorModeForRenderPass(),ui.disabled,mh(Q,re,0,1),null,null,re.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,re.paint,Q.transform.zoom))})(b,A)})(e,a,l,f,g):c.ci(l)?(function(b,M,A,k,R){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:N}=R,j=A.paint.get("line-opacity"),Y=A.paint.get("line-width");if(j.constantOr(1)===0||Y.constantOr(1)===0)return;const Q=b.getDepthModeForSublayer(0,fi.ReadOnly),re=b.colorModeForRenderPass(),se=A.paint.get("line-dasharray"),le=se.constantOr(1),de=A.paint.get("line-pattern"),ye=de.constantOr(1),he=A.paint.get("line-gradient"),ve=A.getCrossfadeParameters();let Ee;Ee=ye?"linePattern":le&&he?"lineGradientSDF":le?"lineSDF":he?"lineGradient":"line";const me=b.context,ze=me.gl,Ge=b.transform;let Oe=!0;for(const Ne of k){const $e=M.getTile(Ne);if(ye&&!$e.patternsLoaded())continue;const yt=$e.getBucket(A);if(!yt)continue;const vt=yt.programConfigurations.get(A.id),nt=b.context.program.get(),kt=b.useProgram(Ee,vt),oi=Oe||kt.program!==nt,Zi=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ne),mi=de.constantOr(null),Ji=se&&se.constantOr(null);if(mi&&$e.imageAtlas){const rr=$e.imageAtlas,bn=rr.patternPositions[mi.to.toString()],jn=rr.patternPositions[mi.from.toString()];bn&&jn&&vt.setConstantPatternPositions(bn,jn)}else if(Ji){const rr=A.layout.get("line-cap")==="round",bn=b.lineAtlas.getDash(Ji.to,rr),jn=b.lineAtlas.getDash(Ji.from,rr);vt.setConstantDashPositions(bn,jn)}const Mn=Ge.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),sn=Ge.getPixelScale();let Hn;ye?(Hn=pc(b,$e,A,sn,ve),xc(me,ze,$e,vt,ve)):le&&he?(Hn=zf(b,$e,A,sn,ve,yt.lineClipsArray.length),an(b,M,me,ze,A,yt,Ne,vt,ve)):le?(Hn=wd(b,$e,A,sn,ve),Eh(b,me,ze,vt,oi,ve)):he?(Hn=xd(b,$e,A,sn,yt.lineClipsArray.length),xr(b,M,me,ze,A,yt,Ne)):Hn=us(b,$e,A,sn);const vn=b.stencilModeForClipping(Ne);kt.draw(me,ze.TRIANGLES,Q,vn,re,ui.disabled,Hn,Zi,Mn,A.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,A.paint,b.transform.zoom,vt,yt.layoutVertexBuffer2),Oe=!1}})(e,a,l,f,g):c.cj(l)?(function(b,M,A,k,R){const N=A.paint.get("fill-color"),j=A.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const{isRenderingToTexture:Y}=R,Q=b.colorModeForRenderPass(),re=A.paint.get("fill-pattern"),se=b.opaquePassEnabledForLayer()&&!re.constantOr(1)&&N.constantOr(c.bi.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===se){const le=b.getDepthModeForSublayer(1,b.renderPass==="opaque"?fi.ReadWrite:fi.ReadOnly);js(b,M,A,k,le,Q,!1,Y)}if(b.renderPass==="translucent"&&A.paint.get("fill-antialias")){const le=b.getDepthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,fi.ReadOnly);js(b,M,A,k,le,Q,!0,Y)}})(e,a,l,f,g):c.ck(l)?(function(b,M,A,k,R){const N=A.paint.get("fill-extrusion-opacity");if(N===0)return;const{isRenderingToTexture:j}=R;if(b.renderPass==="translucent"){const Y=new fi(b.context.gl.LEQUAL,fi.ReadWrite,b.depthRangeFor3D);if(N!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))Jr(b,M,A,k,Y,Di.disabled,Ri.disabled,j),Jr(b,M,A,k,Y,b.stencilModeFor3D(),b.colorModeForRenderPass(),j);else{const Q=b.colorModeForRenderPass();Jr(b,M,A,k,Y,Di.disabled,Q,j)}}})(e,a,l,f,g):c.cl(l)?(function(b,M,A,k,R){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const{isRenderingToTexture:N}=R,j=b.context,Y=b.style.projection.useSubdivision,Q=b.getDepthModeForSublayer(0,fi.ReadOnly),re=b.colorModeForRenderPass();if(b.renderPass==="offscreen")(function(se,le,de,ye,he,ve,Ee){const me=se.context,ze=me.gl;for(const Ge of de){const Oe=le.getTile(Ge),Ne=Oe.dem;if(!Ne||!Ne.data||!Oe.needsHillshadePrepare)continue;const $e=Ne.dim,yt=Ne.stride,vt=Ne.getPixels();if(me.activeTexture.set(ze.TEXTURE1),me.pixelStoreUnpackPremultiplyAlpha.set(!1),Oe.demTexture=Oe.demTexture||se.getTileTexture(yt),Oe.demTexture){const kt=Oe.demTexture;kt.update(vt,{premultiply:!1}),kt.bind(ze.NEAREST,ze.CLAMP_TO_EDGE)}else Oe.demTexture=new c.T(me,vt,ze.RGBA,{premultiply:!1}),Oe.demTexture.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);me.activeTexture.set(ze.TEXTURE0);let nt=Oe.fbo;if(!nt){const kt=new c.T(me,{width:$e,height:$e,data:null},ze.RGBA);kt.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),nt=Oe.fbo=me.createFramebuffer($e,$e,!0,!1),nt.colorAttachment.set(kt.texture)}me.bindFramebuffer.set(nt.framebuffer),me.viewport.set([0,0,$e,$e]),se.useProgram("hillshadePrepare").draw(me,ze.TRIANGLES,he,ve,Ee,ui.disabled,mo(Oe.tileID,Ne),null,null,ye.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments),Oe.needsHillshadePrepare=!1}})(b,M,k,A,Q,Di.disabled,re),j.viewport.set([0,0,b.width,b.height]);else if(b.renderPass==="translucent")if(Y){const[se,le,de]=b.stencilConfigForOverlapTwoPass(k);yn(b,M,A,de,se,Q,re,!1,N),yn(b,M,A,de,le,Q,re,!0,N)}else{const[se,le]=b.getStencilConfigForOverlapAndUpdateStencilID(k);yn(b,M,A,le,se,Q,re,!1,N)}})(e,a,l,f,g):c.cm(l)?(function(b,M,A,k,R){if(b.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:N}=R,j=b.style.projection.useSubdivision,Y=b.getDepthModeForSublayer(0,fi.ReadOnly),Q=b.colorModeForRenderPass();if(j){const[re,se,le]=b.stencilConfigForOverlapTwoPass(k);Nr(b,M,A,le,re,Y,Q,!1,N),Nr(b,M,A,le,se,Y,Q,!0,N)}else{const[re,se]=b.getStencilConfigForOverlapAndUpdateStencilID(k);Nr(b,M,A,se,re,Y,Q,!1,N)}})(e,a,l,f,g):c.bN(l)?(function(b,M,A,k,R){if(b.renderPass!=="translucent"||A.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:N}=R,j=M.getSource(),Y=b.style.projection.useSubdivision;if(j instanceof Ei)tl(b,M,A,k,null,!1,!1,j.tileCoords,j.flippedWindingOrder,N);else if(Y){const[Q,re,se]=b.stencilConfigForOverlapTwoPass(k);tl(b,M,A,se,Q,!1,!0,ea,!1,N),tl(b,M,A,se,re,!0,!0,ea,!1,N)}else{const[Q,re]=b.getStencilConfigForOverlapAndUpdateStencilID(k);tl(b,M,A,re,Q,!1,!0,ea,!1,N)}})(e,a,l,f,g):c.cn(l)?(function(b,M,A,k,R){const N=A.paint.get("background-color"),j=A.paint.get("background-opacity");if(j===0)return;const{isRenderingToTexture:Y}=R,Q=b.context,re=Q.gl,se=b.style.projection,le=b.transform,de=le.tileSize,ye=A.paint.get("background-pattern");if(b.isPatternMissing(ye))return;const he=!ye&&N.a===1&&j===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==he)return;const ve=Di.disabled,Ee=b.getDepthModeForSublayer(0,he==="opaque"?fi.ReadWrite:fi.ReadOnly),me=b.colorModeForRenderPass(),ze=b.useProgram(ye?"backgroundPattern":"background"),Ge=k||gn(le,{tileSize:de,terrain:b.style.map.terrain});ye&&(Q.activeTexture.set(re.TEXTURE0),b.imageManager.bind(b.context));const Oe=A.getCrossfadeParameters();for(const Ne of Ge){const $e=le.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),yt=ye?gu(j,b,ye,{tileID:Ne,tileSize:de},Oe):mu(j,N),vt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ne),nt=se.getMeshFromTileID(Q,Ne.canonical,!1,!0,"raster");ze.draw(Q,re.TRIANGLES,Ee,ve,me,ui.backCCW,yt,vt,$e,A.id,nt.vertexBuffer,nt.indexBuffer,nt.segments)}})(e,0,l,f,g):c.co(l)&&(function(b,M,A,k){const{isRenderingGlobe:R}=k,N=b.context,j=A.implementation,Y=b.style.projection,Q=b.transform,re=Q.getProjectionDataForCustomLayer(R),se={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:Y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Y.shaderPreludeCode.vertexSource}`,define:Y.shaderDefine},defaultProjectionData:re},le=j.renderingMode?j.renderingMode:"2d";if(b.renderPass==="offscreen"){const de=j.prerender;de&&(b.setCustomLayerDefaults(),N.setColorMode(b.colorModeForRenderPass()),de.call(j,N.gl,se),N.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),N.setColorMode(b.colorModeForRenderPass()),N.setStencilMode(Di.disabled);const de=le==="3d"?b.getDepthModeFor3D():b.getDepthModeForSublayer(0,fi.ReadOnly);N.setDepthMode(de),j.render(N.gl,se),N.setDirty(),b.setBaseState(),N.bindFramebuffer.set(null)}})(e,0,l,g))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!a||!l}useProgram(e,a,l=!1,f=[]){this.cache=this.cache||{};const g=!!this.style.map.terrain,b=this.style.projection,M=l?ni.projectionMercator:b.shaderPreludeCode,A=l?dr:b.shaderDefine,k=e+(a?a.cacheKey:"")+`/${l?qn:b.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[k]||(this.cache[k]=new kl(this.context,ni[e],a,_u[e],this._showOverdrawInspector,g,M,A,f)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function Zs(p,e){let a,l=!1,f=null,g=null;const b=()=>{f=null,l&&(p.apply(g,a),f=setTimeout(b,e),l=!1)};return(...M)=>(l=!0,g=this,a=M,f||b(),f)}class fr{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(l=f)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let f=l;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${l}`);let g=window.location.hash.replace(f,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let b=window.location.href.replace(/(#.+)?$/,g);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=Zs(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,f=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,f),b=Math.round(a.lng*g)/g,M=Math.round(a.lat*g)/g,A=this._map.getBearing(),k=this._map.getPitch();let R="";if(R+=e?`/${b}/${M}/${l}`:`${l}/${M}/${b}`,(A||k)&&(R+="/"+Math.round(10*A)/10),k&&(R+=`/${Math.round(k)}`),this._hashName){const N=this._hashName;let j=!1;const Y=window.location.hash.slice(1).split("&").map((Q=>{const re=Q.split("=")[0];return re===N?(j=!0,`${re}=${R}`):Q})).filter((Q=>Q));return j||Y.push(`${N}=${R}`),`#${Y.join("&")}`}return`#${R}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.U(+e[2],+e[1])}catch{return!1}const a=+e[0],l=+(e[3]||0),f=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Vs={linearity:.3,easing:c.cp(0,0,.3,1)},Mh=c.e({deceleration:2500,maxSpeed:1400},Vs),Md=c.e({deceleration:20,maxSpeed:1400},Vs),Ad=c.e({deceleration:1e3,maxSpeed:360},Vs),zd=c.e({deceleration:1e3,maxSpeed:90},Vs),Ln=c.e({deceleration:1e3,maxSpeed:360},Vs);class Au{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ae(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=Ae();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,a.roll+=g.rollDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const g=pr(a.pan.mag(),l,c.e({},Mh,e||{})),b=a.pan.mult(g.amount/a.pan.mag()),M=this._map.cameraHelper.handlePanInertia(b,this._map.transform);f.center=M.easingCenter,f.offset=M.easingOffset,ir(f,g)}if(a.zoom){const g=pr(a.zoom,l,Md);f.zoom=this._map.transform.zoom+g.amount,ir(f,g)}if(a.bearing){const g=pr(a.bearing,l,Ad);f.bearing=this._map.transform.bearing+c.ai(g.amount,-179,179),ir(f,g)}if(a.pitch){const g=pr(a.pitch,l,zd);f.pitch=this._map.transform.pitch+g.amount,ir(f,g)}if(a.roll){const g=pr(a.roll,l,Ln);f.roll=this._map.transform.roll+c.ai(g.amount,-179,179),ir(f,g)}if(f.zoom||f.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;f.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function ir(p,e){(!p.duration||p.duration<e.duration)&&(p.duration=e.duration,p.easing=e.easing)}function pr(p,e,a){const{maxSpeed:l,linearity:f,deceleration:g}=a,b=c.ai(p*f/(e/1e3),-l,l),M=Math.abs(b)/(g*f);return{easing:a.easing,duration:1e3*M,amount:b*(M/2)}}class Zr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l,f={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const g=ie.mousePos(a.getCanvas(),l),b=a.unproject(g);super(e,c.e({point:g,lngLat:b,originalEvent:l},f)),this._defaultPrevented=!1,this.target=a}}class nr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){const f=e==="touchend"?l.changedTouches:l.touches,g=ie.touchPos(a.getCanvasContainer(),f),b=g.map((A=>a.unproject(A))),M=g.reduce(((A,k,R,N)=>A.add(k.div(N.length))),new c.P(0,0));super(e,{points:g,point:M,lngLats:b,lngLat:a.unproject(M),originalEvent:l}),this._defaultPrevented=!1}}class rl extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Fl{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new rl(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new Zr(e.type,this._map,e))}mouseup(e){this._map.fire(new Zr(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Zr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Zr(e.type,this._map,e))}mouseover(e){this._map.fire(new Zr(e.type,this._map,e))}mouseout(e){this._map.fire(new Zr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new nr(e.type,this._map,e))}touchmove(e){this._map.fire(new nr(e.type,this._map,e))}touchend(e){this._map.fire(new nr(e.type,this._map,e))}touchcancel(e){this._map.fire(new nr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cd{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Zr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Zr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tc{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Ah{constructor(e,a){this._map=e,this._tr=new Tc(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(ie.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=l,this._box||(this._box=ie.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const g=Math.min(f.x,l.x),b=Math.max(f.x,l.x),M=Math.min(f.y,l.y),A=Math.max(f.y,l.y);ie.setTransform(this._box,`translate(${g}px,${M}px)`),this._box.style.width=b-g+"px",this._box.style.height=A-M+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const l=this._startPos,f=a;if(this.reset(),ie.suppressClick(),l.x!==f.x||l.y!==f.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(l,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ie.remove(this._box),this._box=null),ie.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new c.l(e,{originalEvent:a}))}}function Gs(p,e){if(p.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${e.length}`);const a={};for(let l=0;l<p.length;l++)a[p[l].identifier]=e[l];return a}class zu{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=(function(f){const g=new c.P(0,0);for(const b of f)g._add(b);return g.div(f.length)})(a),this.touches=Gs(l,a)))}touchmove(e,a,l){if(this.aborted||!this.centroid)return;const f=Gs(l,a);for(const g in this.touches){const b=f[g];(!b||b.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,a,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class _s{constructor(e){this.singleTap=new zu(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,l){this.singleTap.touchstart(e,a,l)}touchmove(e,a,l){this.singleTap.touchmove(e,a,l)}touchend(e,a,l){const f=this.singleTap.touchend(e,a,l);if(f){const g=e.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(g&&b||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class ys{constructor(e){this._tr=new Tc(e),this._zoomIn=new _s({numTouches:1,numTaps:2}),this._zoomOut=new _s({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,l){this._zoomIn.touchstart(e,a,l),this._zoomOut.touchstart(e,a,l)}touchmove(e,a,l){this._zoomIn.touchmove(e,a,l),this._zoomOut.touchmove(e,a,l)}touchend(e,a,l){const f=this._zoomIn.touchend(e,a,l),g=this._zoomOut.touchend(e,a,l),b=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(f)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zt{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(a)?a[0]:a;return!this._moved&&f.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(l,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ie.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Cu=0,jl=2,Ec={[Cu]:1,[jl]:2};class vs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=ie.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(a,l){const f=Ec[l];return a.buttons===void 0||(a.buttons&f)!==f})(e,this._eventButton)}isValidEndEvent(e){return ie.mouseButton(e)===this._eventButton}}class Ul{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class qs{constructor(e=new vs({checkCorrectEvent:()=>!0}),a=new Ul){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,l){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const hi=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=e=>{e.preventDefault()}};class Iu{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,l){return this._calculateTransform(e,a,l)}touchmove(e,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,l){this._calculateTransform(e,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,l){l.length>0&&(this._active=!0);const f=Gs(l,a),g=new c.P(0,0),b=new c.P(0,0);let M=0;for(const k in f){const R=f[k],N=this._touches[k];N&&(g._add(R),b._add(R.sub(N)),M++,f[k]=R)}if(this._touches=f,this._shouldBePrevented(M)||!b.mag())return;const A=b.div(M);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(M),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,l){if(!this._firstTwoTouches)return;e.preventDefault();const[f,g]=this._firstTwoTouches,b=Qa(l,a,f),M=Qa(l,a,g);if(!b||!M)return;const A=this._aroundCenter?null:b.add(M).div(2);return this._move([b,M],A,e)}touchend(e,a,l){if(!this._firstTwoTouches)return;const[f,g]=this._firstTwoTouches,b=Qa(l,a,f),M=Qa(l,a,g);b&&M||(this._active&&ie.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Qa(p,e,a){for(let l=0;l<p.length;l++)if(p[l].identifier===a)return e[l]}function Nl(p,e){return Math.log(p/e)/Math.LN2}class Mc extends Pu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Nl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Nl(this._distance,l),pinchAround:a}}}function al(p,e){return 180*p.angleWith(e)/Math.PI}class sl extends Pu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,l){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:al(this._vector,f),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,l=al(e,this._startVector);return Math.abs(l)<a}}function Ac(p){return Math.abs(p.y)>Math.abs(p.x)}class So extends Pu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,l){super.touchstart(e,a,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Ac(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,g,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,l){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,g=a.mag()>=2;if(!f&&!g)return;if(!f||!g)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const b=e.y>0==a.y>0;return Ac(e)&&Ac(a)&&b}}const zh={panStep:100,bearingStep:15,pitchStep:10};class $s{constructor(e){this._tr=new Tc(e);const a=zh;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,l=0,f=0,g=0,b=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),b=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(l=0,f=0),{cameraAnimation:M=>{const A=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:Ch,zoom:a?Math.round(A.zoom)+a*(e.shiftKey?2:1):A.zoom,bearing:A.bearing+l*this._bearingStep,pitch:A.pitch+f*this._pitchStep,offset:[-g*this._panStep,-b*this._panStep],center:A.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ch(p){return p*(2-p)}const Ja=4.000244140625,Li=1/450;class Hs{constructor(e,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Tc(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Li}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=Ae(),f=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Ja==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=ie.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.U.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const M=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=M),typeof this._targetZoom=="number"&&(this._targetZoom+=M)}if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>Ja?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&A!==0&&(A=1/A);const k=typeof this._targetZoom!="number"?e.scale:c.al(this._targetZoom);this._targetZoom=e.constrain(e.getCameraLngLat(),c.ao(k*A)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,f=this._easing;let g,b=!1;if(this._type==="wheel"&&l&&f){const M=Ae()-this._lastWheelEventTime,A=Math.min((M+5)/200,1),k=f(A);g=c.F.number(l,a,k),A<1?this._frameId||(this._frameId=!0):b=!0}else g=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!b,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=c.cr;if(this._prevEase){const l=this._prevEase,f=(Ae()-l.start)/l.duration,g=l.easing(f+.01)-l.easing(f),b=.27/Math.sqrt(g*g+1e-4)*.01,M=Math.sqrt(.0729-b*b);a=c.cp(b,M,.25,1)}return this._prevEase={start:Ae(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Xs{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class zc{constructor(e){this._tr=new Tc(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Du{constructor(){this._tap=new _s({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,l){if(!this._swipePoint)if(this._tapTime){const f=a[0],g=e.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;g&&b?l.length>0&&(this._swipePoint=f,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,a,l)}touchmove(e,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const f=a[0],g=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,a,l)}touchend(e,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const f=this._tap.touchend(e,a,l);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ol{constructor(e,a,l){this._el=e,this._mousePan=a,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ll{constructor(e,a,l,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ih{constructor(e,a,l,f){this._el=e,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Fa{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ie.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=l,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ie.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const ja=p=>p.zoom||p.drag||p.roll||p.pitch||p.rotate;class Ot extends c.l{}function qt(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta||p.rollDelta}class cl{constructor(e,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,g)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,M={needsRenderFrame:!1},A={},k={};for(const{handlerName:j,handler:Y,allowed:Q}of this._handlers){if(!Y.isEnabled())continue;let re;if(this._blockedByActive(k,Q,j))Y.reset();else if(Y[g||f.type]){if(c.cs(f,g||f.type)){const se=ie.mousePos(this._map.getCanvas(),f);re=Y[g||f.type](f,se)}else if(c.ct(f,g||f.type)){const se=this._getMapTouches(f.touches),le=ie.touchPos(this._map.getCanvas(),se);re=Y[g||f.type](f,le,se)}else c.cu(g||f.type)||(re=Y[g||f.type](f));this.mergeHandlerResult(M,A,re,j,b),re&&re.needsRenderFrame&&this._triggerRenderFrame()}(re||Y.isActive())&&(k[j]=Y)}const R={};for(const j in this._previousActiveHandlers)k[j]||(R[j]=b);this._previousActiveHandlers=k,(Object.keys(R).length||qt(M))&&(this._changes.push([M,A,R]),this._triggerRenderFrame()),(Object.keys(k).length||qt(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=M;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Au(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,g,b]of this._listeners)ie.addEventListener(f,g,f===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[e,a,l]of this._listeners)ie.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new Fl(a,e));const f=a.boxZoom=new Ah(a,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const g=a.cooperativeGestures=new Fa(a,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();const b=new ys(a),M=new zc(a);a.doubleClickZoom=new Xs(M,b),this._add("tapZoom",b),this._add("clickZoom",M),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const A=new Du;this._add("tapDragZoom",A);const k=a.touchPitch=new So(a);this._add("touchPitch",k),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const R=()=>a.project(a.getCenter()),N=(function({enable:he,clickTolerance:ve,aroundCenter:Ee=!0,minPixelCenterThreshold:me=100,rotateDegreesPerPixelMoved:ze=.8},Ge){const Oe=new vs({checkCorrectEvent:Ne=>ie.mouseButton(Ne)===0&&Ne.ctrlKey||ie.mouseButton(Ne)===2&&!Ne.ctrlKey});return new zt({clickTolerance:ve,move:(Ne,$e)=>{const yt=Ge();if(Ee&&Math.abs(yt.y-Ne.y)>me)return{bearingDelta:c.cq(new c.P(Ne.x,$e.y),$e,yt)};let vt=($e.x-Ne.x)*ze;return Ee&&$e.y<yt.y&&(vt=-vt),{bearingDelta:vt}},moveStateManager:Oe,enable:he,assignEvents:hi})})(e,R),j=(function({enable:he,clickTolerance:ve,pitchDegreesPerPixelMoved:Ee=-.5}){const me=new vs({checkCorrectEvent:ze=>ie.mouseButton(ze)===0&&ze.ctrlKey||ie.mouseButton(ze)===2});return new zt({clickTolerance:ve,move:(ze,Ge)=>({pitchDelta:(Ge.y-ze.y)*Ee}),moveStateManager:me,enable:he,assignEvents:hi})})(e),Y=(function({enable:he,clickTolerance:ve,rollDegreesPerPixelMoved:Ee=.3},me){const ze=new vs({checkCorrectEvent:Ge=>ie.mouseButton(Ge)===2&&Ge.ctrlKey});return new zt({clickTolerance:ve,move:(Ge,Oe)=>{const Ne=me();let $e=(Oe.x-Ge.x)*Ee;return Oe.y<Ne.y&&($e=-$e),{rollDelta:$e}},moveStateManager:ze,enable:he,assignEvents:hi})})(e,R);a.dragRotate=new ll(e,N,j,Y),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",j,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Y,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const Q=(function({enable:he,clickTolerance:ve}){const Ee=new vs({checkCorrectEvent:me=>ie.mouseButton(me)===0&&!me.ctrlKey});return new zt({clickTolerance:ve,move:(me,ze)=>({around:ze,panDelta:ze.sub(me)}),activateOnStart:!0,moveStateManager:Ee,enable:he,assignEvents:hi})})(e),re=new Iu(e,a);a.dragPan=new ol(l,Q,re),this._add("mousePan",Q),this._add("touchPan",re,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const se=new sl,le=new Mc;a.touchZoomRotate=new Ih(l,le,se,A),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate),this._add("blockableMapEvent",new Cd(a));const de=a.scrollZoom=new Hs(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",de,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const ye=a.keyboard=new $s(a);this._add("keyboard",ye),e.interactive&&e.keyboard&&a.keyboard.enable()}_add(e,a,l){this._handlers.push({handlerName:e,handler:a,allowed:l}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,l){for(const f in e)if(f!==l&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const l of e)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(e,a,l,f,g){if(!l)return;c.e(e,l);const b={handlerName:f,originalEvent:l.originalEvent||g};l.zoomDelta!==void 0&&(a.zoom=b),l.panDelta!==void 0&&(a.drag=b),l.rollDelta!==void 0&&(a.roll=b),l.pitchDelta!==void 0&&(a.pitch=b),l.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const e={},a={},l={};for(const[f,g,b]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),c.e(a,g),c.e(l,b);this._updateMapTransform(e,a,l),this._changes=[]}_updateMapTransform(e,a,l){const f=this._map,g=f._getTransformForUpdate(),b=f.terrain;if(!(qt(e)||b&&this._terrainMovement))return this._fireEvents(a,l,!0);f._stop(!0);let{panDelta:M,zoomDelta:A,bearingDelta:k,pitchDelta:R,rollDelta:N,around:j,pinchAround:Y}=e;Y!==void 0&&(j=Y),j=j||f.transform.centerPoint,b&&!g.isPointOnMapSurface(j)&&(j=g.centerPoint);const Q={panDelta:M,zoomDelta:A,rollDelta:N,pitchDelta:R,bearingDelta:k,around:j};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(j)&&(j=g.centerPoint);const re=j.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(M?j.sub(M):j);this._handleMapControls({terrain:b,tr:g,deltasForHelper:Q,preZoomAroundLoc:re,combinedEventsInProgress:a,panDelta:M}),f._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,l,!0)}_handleMapControls({terrain:e,tr:a,deltasForHelper:l,preZoomAroundLoc:f,combinedEventsInProgress:g,panDelta:b}){const M=this._map.cameraHelper;if(M.handleMapControlsRollPitchBearingZoom(l,a),e)return M.useGlobeControls?(this._terrainMovement||!g.drag&&!g.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void M.handleMapControlsPan(l,a,f)):this._terrainMovement||!g.drag&&!g.zoom?void(g.drag&&this._terrainMovement&&b?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(b))):M.handleMapControlsPan(l,a,f)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void M.handleMapControlsPan(l,a,f));M.handleMapControlsPan(l,a,f)}_fireEvents(e,a,l){const f=ja(this._eventsInProgress),g=ja(e),b={};for(const N in e){const{originalEvent:j}=e[N];this._eventsInProgress[N]||(b[`${N}start`]=j),this._eventsInProgress[N]=e[N]}!f&&g&&this._fireEvent("movestart",g.originalEvent);for(const N in b)this._fireEvent(N,b[N]);g&&this._fireEvent("move",g.originalEvent);for(const N in e){const{originalEvent:j}=e[N];this._fireEvent(N,j)}const M={};let A;for(const N in this._eventsInProgress){const{handlerName:j,originalEvent:Y}=this._eventsInProgress[N];this._handlersById[j].isActive()||(delete this._eventsInProgress[N],A=a[j]||Y,M[`${N}end`]=A)}for(const N in M)this._fireEvent(N,M[N]);const k=ja(this._eventsInProgress),R=(f||g)&&!k;if(R&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const N=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&N.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(N)}if(l&&R){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;!N||!N.essential&&ge.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:A})),j(this._map.getBearing())&&this._map.resetNorth()):(j(N.bearing||this._map.getBearing())&&(N.bearing=0),N.freezeElevation=!0,this._map.easeTo(N,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new c.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Ot("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ku extends c.E{constructor(e,a,l){super(),this._renderFrameCallback=()=>{const f=Math.min((Ae()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new c.U(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},a),l)}panTo(e,a,l){return this.easeTo(c.e({center:e},a),l)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,l){return this.easeTo(c.e({zoom:e},a),l)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)).fire(new c.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,l){return this.easeTo(c.e({bearing:e},a),l)}resetNorth(e,a){return this.rotateTo(0,c.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=jt.convert(e).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,a)}_cameraForBoxAndBearing(e,a,l,f){const g={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const k=f.padding;f.padding={top:k,bottom:k,right:k,left:k}}const b=c.e(g,f.padding);f.padding=b;const M=this.transform,A=new jt(e,a);return this.cameraHelper.cameraForBoxAndBearing(f,b,A,l,M)}fitBounds(e,a,l){return this._fitInternal(this.cameraForBounds(e,a),a,l)}fitScreenCoordinates(e,a,l,f,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(a)),l,f),f,g)}_fitInternal(e,a,l){return e?(delete(a=c.e(e,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(e,a){this.stop();const l=this._getTransformForUpdate();let f=!1,g=!1,b=!1;const M=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const A=l.zoom!==M;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(f=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(g=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(b=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)),A&&this.fire(new c.l("zoomstart",a)).fire(new c.l("zoom",a)).fire(new c.l("zoomend",a)),f&&this.fire(new c.l("rotatestart",a)).fire(new c.l("rotate",a)).fire(new c.l("rotateend",a)),g&&this.fire(new c.l("pitchstart",a)).fire(new c.l("pitch",a)).fire(new c.l("pitchend",a)),b&&this.fire(new c.l("rollstart",a)).fire(new c.l("roll",a)).fire(new c.l("rollend",a)),this.fire(new c.l("moveend",a))}calculateCameraOptionsFromTo(e,a,l,f=0){const g=c.a5.fromLngLat(e,a),b=c.a5.fromLngLat(l,f),M=b.x-g.x,A=b.y-g.y,k=b.z-g.z,R=Math.hypot(M,A,k);if(R===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(M,A),j=c.ao(this.transform.cameraToCenterDistance/R/this.transform.tileSize),Y=180*Math.atan2(M,-A)/Math.PI;let Q=180*Math.acos(N/R)/Math.PI;return Q=k<0?90-Q:90+Q,{center:b.toLngLat(),elevation:f,zoom:j,pitch:Q,bearing:Y}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,l,f,g){const b=this.transform.calculateCenterFromCameraLngLatAlt(e,a,l,f);return{center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:l,pitch:f,roll:g}}easeTo(e,a){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.cr},e)).animate===!1||!e.essential&&ge.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),f=this.getBearing(),g=l.pitch,b=l.roll,M="bearing"in e?this._normalizeBearing(e.bearing,f):f,A="pitch"in e?+e.pitch:g,k="roll"in e?this._normalizeBearing(e.roll,b):b,R="padding"in e?e.padding:l.padding,N=c.P.convert(e.offset);let j,Y;e.around&&(j=c.U.convert(e.around),Y=l.locationToScreenPoint(j));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},re=this.cameraHelper.handleEaseTo(l,{bearing:M,pitch:A,roll:k,padding:R,around:j,aroundPoint:Y,offsetAsPoint:N,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==M,this._pitching=this._pitching||A!==g,this._rolling=this._rolling||k!==b,this._padding=!l.isPaddingEqual(R),this._zooming=this._zooming||re.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,Q),this.terrain&&this._prepareElevation(re.elevationCenter),this._ease((se=>{re.easeFunc(se),this.terrain&&!e.freezeElevation&&this._updateElevation(se),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(se=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,se)}),e),this}_prepareEase(e,a,l={}){this._moving=!0,a||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(a-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(c.F.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),l=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(l<f){const g=this.calculateCameraOptionsFromTo(a,f,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push((f=>this._elevateCameraIfInsideTerrain(f))),this.transformCameraUpdate&&a.push((f=>this.transformCameraUpdate(f))),!a.length)return;const l=e.clone();for(const f of a){const g=l.clone(),{center:b,zoom:M,roll:A,pitch:k,bearing:R,elevation:N}=f(g);b&&g.setCenter(b),N!==void 0&&g.setElevation(N),M!==void 0&&g.setZoom(M),A!==void 0&&g.setRoll(A),k!==void 0&&g.setPitch(k),R!==void 0&&g.setBearing(R),l.apply(g)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,f=this._rotating,g=this._pitching,b=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),f&&this.fire(new c.l("rotateend",e)),g&&this.fire(new c.l("pitchend",e)),b&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,a){if(!e.essential&&ge.prefersReducedMotion){const $e=c.S(e,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo($e,a)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.cr},e);const l=this._getTransformForUpdate(),f=l.bearing,g=l.pitch,b=l.roll,M=l.padding,A="bearing"in e?this._normalizeBearing(e.bearing,f):f,k="pitch"in e?+e.pitch:g,R="roll"in e?this._normalizeBearing(e.roll,b):b,N="padding"in e?e.padding:l.padding,j=c.P.convert(e.offset);let Y=l.centerPoint.add(j);const Q=l.screenPointToLocation(Y),re=this.cameraHelper.handleFlyTo(l,{bearing:A,pitch:k,roll:R,padding:N,locationAtOffset:Q,offsetAsPoint:j,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let se=e.curve;const le=Math.max(l.width,l.height),de=le/re.scaleOfZoom,ye=re.pixelPathLength;typeof re.scaleOfMinZoom=="number"&&(se=Math.sqrt(le/re.scaleOfMinZoom/ye*2));const he=se*se;function ve($e){const yt=(de*de-le*le+($e?-1:1)*he*he*ye*ye)/(2*($e?de:le)*he*ye);return Math.log(Math.sqrt(yt*yt+1)-yt)}function Ee($e){return(Math.exp($e)-Math.exp(-$e))/2}function me($e){return(Math.exp($e)+Math.exp(-$e))/2}const ze=ve(!1);let Ge=function($e){return me(ze)/me(ze+se*$e)},Oe=function($e){return le*((me(ze)*(Ee(yt=ze+se*$e)/me(yt))-Ee(ze))/he)/ye;var yt},Ne=(ve(!0)-ze)/se;if(Math.abs(ye)<2e-6||!isFinite(Ne)){if(Math.abs(le-de)<1e-6)return this.easeTo(e,a);const $e=de<le?-1:1;Ne=Math.abs(Math.log(de/le))/se,Oe=()=>0,Ge=yt=>Math.exp($e*se*yt)}return e.duration="duration"in e?+e.duration:1e3*Ne/("screenSpeed"in e?+e.screenSpeed/se:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==A,this._pitching=k!==g,this._rolling=R!==b,this._padding=!l.isPaddingEqual(N),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(re.targetCenter),this._ease(($e=>{const yt=$e*Ne,vt=1/Ge(yt),nt=Oe(yt);this._rotating&&l.setBearing(c.F.number(f,A,$e)),this._pitching&&l.setPitch(c.F.number(g,k,$e)),this._rolling&&l.setRoll(c.F.number(b,R,$e)),this._padding&&(l.interpolatePadding(M,N,$e),Y=l.centerPoint.add(j)),re.easeFunc($e,vt,nt,Y),this.terrain&&!e.freezeElevation&&this._updateElevation($e),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,a,l){l.animate===!1||l.duration===0?(e(1),a()):(this._easeStart=Ae(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=c.V(e,-180,180);const l=Math.abs(e-a);return Math.abs(e-360-a)<l&&(e-=360),Math.abs(e+360-a)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.U.convert(e),this.transform.tileZoom):null}}const Br={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class hn{constructor(e=Br){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ie.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ie.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ie.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const l=this._map._getUIString(`AttributionControl.${a}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((f=>typeof f!="string"?"":f))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.tileManagers;for(const f in a){const g=a[f];if(g.used||g.usedForTerrain){const b=g.getSource();b.attribution&&e.indexOf(b.attribution)<0&&e.push(b.attribution)}}e=e.filter((f=>String(f).trim())),e.sort(((f,g)=>f.length-g.length)),e=e.filter(((f,g)=>{for(let b=g+1;b<e.length;b++)if(e[b].indexOf(f)>=0)return!1;return!0}));const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=ie.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class bs{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ie.create("div","maplibregl-ctrl");const a=ie.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ie.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class wa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const f of l)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ph=c.aN([{name:"a_pos3d",type:"Int16",components:3}]);class To extends c.E{constructor(e){super(),this._lastTilesetChange=Ae(),this.tileManager=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(e,a){this.tileManager.update(e,a),this._renderableTilesKeys=[];const l={};for(const f of gn(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))l[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),c.c0(f.terrainRttPosMatrix32f,0,c.a3,c.a3,0,0,1),this._tiles[f.key]=new pe(f,this.tileSize),this._lastTilesetChange=Ae());for(const f in this._tiles)l[f]||delete this._tiles[f]}freeRtt(e){for(const a in this._tiles){const l=this._tiles[a];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const l of this._renderableTilesKeys){const f=this._tiles[l].tileID,g=e.clone(),b=c.bd();if(f.canonical.equals(e.canonical))c.c0(b,0,c.a3,c.a3,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const M=f.canonical.z-e.canonical.z,A=f.canonical.x-(f.canonical.x>>M<<M),k=f.canonical.y-(f.canonical.y>>M<<M),R=c.a3>>M;c.c0(b,0,R,R,0,0,1),c.N(b,b,[-A*R,-k*R,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const M=e.canonical.z-f.canonical.z,A=e.canonical.x-(e.canonical.x>>M<<M),k=e.canonical.y-(e.canonical.y>>M<<M),R=c.a3>>M;c.c0(b,0,c.a3,c.a3,0,0,1),c.N(b,b,[A*R,k*R,0]),c.O(b,b,[1/2**M,1/2**M,0])}}g.terrainRttPosMatrix32f=new Float32Array(b),a[l]=g}return a}_getTerrainCoordsForTileRanges(e,a){const l={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID;if(!this._isWithinTileRanges(g,a))continue;const b=e.clone(),M=c.bd();if(g.canonical.z===e.canonical.z){const A=e.canonical.x-g.canonical.x,k=e.canonical.y-g.canonical.y;c.c0(M,0,c.a3,c.a3,0,0,1),c.N(M,M,[A*c.a3,k*c.a3,0])}else if(g.canonical.z>e.canonical.z){const A=g.canonical.z-e.canonical.z,k=g.canonical.x-(g.canonical.x>>A<<A),R=g.canonical.y-(g.canonical.y>>A<<A),N=e.canonical.x-(g.canonical.x>>A),j=e.canonical.y-(g.canonical.y>>A),Y=c.a3>>A;c.c0(M,0,Y,Y,0,0,1),c.N(M,M,[-k*Y+N*c.a3,-R*Y+j*c.a3,0])}else{const A=e.canonical.z-g.canonical.z,k=e.canonical.x-(e.canonical.x>>A<<A),R=e.canonical.y-(e.canonical.y>>A<<A),N=(e.canonical.x>>A)-g.canonical.x,j=(e.canonical.y>>A)-g.canonical.y,Y=c.a3<<A;c.c0(M,0,Y,Y,0,0,1),c.N(M,M,[k*c.a3+N*Y,R*c.a3+j*Y,0])}b.terrainRttPosMatrix32f=new Float32Array(M),l[f]=b}return l}getSourceTile(e,a){const l=this.tileManager._source;let f=e.overscaledZ-this.deltaZoom;if(f>l.maxzoom&&(f=l.maxzoom),f<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let g=this.tileManager.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&a)for(;f>=l.minzoom&&(!g||!g.dem);)g=this.tileManager.getTileByID(e.scaledTo(f--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class Sa{constructor(e,a,l){this._meshCache={},this.painter=e,this.tileManager=new To(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,l,f=c.a3){var g;if(!(a>=0&&a<f&&l>=0&&l<f))return 0;const b=this.getTerrainData(e),M=(g=b.tile)===null||g===void 0?void 0:g.dem;if(!M)return 0;const A=c.cv([],[a/f*c.a3,l/f*c.a3],b.u_terrain_matrix),k=[A[0]*M.dim,A[1]*M.dim],R=Math.floor(k[0]),N=Math.floor(k[1]),j=k[0]-R,Y=k[1]-N;return M.get(R,N)*(1-j)*(1-Y)+M.get(R+1,N)*j*(1-Y)+M.get(R,N+1)*(1-j)*Y+M.get(R+1,N+1)*j*Y}getElevationForLngLatZoom(e,a){if(!c.cw(a,e.wrap()))return 0;const{tileID:l,mercatorX:f,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(l,f%c.a3,g%c.a3,c.a3)}getElevation(e,a,l,f=c.a3){return this.getDEMElevation(e,a,l,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(f,g,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.am([])}const a=this.tileManager.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new c.T(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a+a.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const f=this.tileManager.getSource().maxzoom;let g=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?g=e.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=e.canonical.x-(e.canonical.x>>g<<g),M=e.canonical.y-(e.canonical.y>>g<<g),A=c.cx(new Float64Array(16),[1/(c.a3<<g),1/(c.a3<<g),0]);c.N(A,A,[b*c.a3,M*c.a3,0]),this._demMatrixCache[e.key]={matrix:A,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,l=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,b=0;g<this._coordsTextureSize;g++)for(let M=0;M<this._coordsTextureSize;M++,b+=4)a[b+0]=255&M,a[b+1]=255&g,a[b+2]=M>>8<<4|g>>8,a[b+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new c.T(e,l,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,f=l.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(g,M-b-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const A=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),R=this.coordsIndex[255-a[3]],N=R&&this.tileManager.getTileByID(R);if(!N)return null;const j=this._coordsTextureSize,Y=(1<<N.tileID.canonical.z)*j;return new c.a5((N.tileID.canonical.x*j+A)/Y+N.tileID.wrap,(N.tileID.canonical.y*j+k)/Y,this.getElevation(N.tileID,A,k,j))}depthAtPoint(e){const a=new Uint8Array(4),l=this.painter.context,f=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,f=l&&e.canonical.y===0,g=l&&e.canonical.y===(1<<e.canonical.z)-1,b=`m_${f?"n":""}_${g?"s":""}`;if(this._meshCache[b])return this._meshCache[b];const M=this.painter.context,A=new c.cy,k=new c.aR,R=this.meshSize,N=c.a3/R,j=R*R;for(let me=0;me<=R;me++)for(let ze=0;ze<=R;ze++)A.emplaceBack(ze*N,me*N,0);for(let me=0;me<j;me+=R+1)for(let ze=0;ze<R;ze++)k.emplaceBack(ze+me,R+ze+me+1,R+ze+me+2),k.emplaceBack(ze+me,R+ze+me+2,ze+me+1);const Y=A.length,Q=Y+(R+1),re=(R+1)*R,se=f?c.bk:0,le=f?0:1,de=g?c.bl:c.a3,ye=g?0:1;for(let me=0;me<=R;me++)A.emplaceBack(me*N,se,le);for(let me=0;me<=R;me++)A.emplaceBack(me*N,de,ye);for(let me=0;me<R;me++)k.emplaceBack(re+me,Q+me,Q+me+1),k.emplaceBack(re+me,Q+me+1,re+me+1),k.emplaceBack(0+me,Y+me+1,Y+me),k.emplaceBack(0+me,0+me+1,Y+me+1);const he=A.length,ve=he+2*(R+1);for(const me of[0,1])for(let ze=0;ze<=R;ze++)for(const Ge of[0,1])A.emplaceBack(me*c.a3,ze*N,Ge);for(let me=0;me<2*R;me+=2)k.emplaceBack(he+me,he+me+1,he+me+3),k.emplaceBack(he+me,he+me+3,he+me+2),k.emplaceBack(ve+me,ve+me+3,ve+me+1),k.emplaceBack(ve+me,ve+me+2,ve+me+3);const Ee=new uo(M.createVertexBuffer(A,Ph.members),M.createIndexBuffer(k),c.aQ.simpleSegment(0,0,A.length,k.length));return this._meshCache[b]=Ee,Ee}getMeshFrameDelta(e){return 2*Math.PI*c.bx/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var l;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(l=this.getMinMaxElevation(f).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,a){const l=c.a5.fromLngLat(e.wrap()),f=(1<<a)*c.a3,g=l.x*f,b=l.y*f,M=Math.floor(g/c.a3),A=Math.floor(b/c.a3);return{tileID:new c.a0(a,0,a,M,A),mercatorX:g,mercatorY:b}}}class $n{constructor(e,a,l){this._context=e,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:e,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>e.id!==a)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const Ta={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Vi{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new $n(e.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=e._order.filter((l=>!e._layers[l].isHidden(a))),this._coordsAscending={};for(const l in e.tileManagers){this._coordsAscending[l]={};const f=e.tileManagers[l].getVisibleCoordinates(),g=e.tileManagers[l].getSource(),b=g instanceof Ei?g.terrainTileRanges:null;for(const M of f){const A=this.terrain.tileManager.getTerrainCoords(M,b);for(const k in A)this._coordsAscending[l][k]||(this._coordsAscending[l][k]=[]),this._coordsAscending[l][k].push(A[k])}}this._coordsAscendingStr={};for(const l of e._order){const f=e._layers[l],g=f.source;if(Ta[f.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(const b in this._coordsAscending[g])this._coordsAscendingStr[g][b]=this._coordsAscending[g][b].map((M=>M.key)).sort().join()}}for(const l of this._renderableTiles)for(const f in this._coordsAscendingStr){const g=this._coordsAscendingStr[f][l.tileID.key];g&&g!==l.rttCoords[f]&&(l.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),f=e.type,g=this.painter,b=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Ta[f]&&(this._prevType&&Ta[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!b))return!0;if(Ta[this._prevType]||Ta[f]&&b){this._prevType=f;const M=this._stacks.length-1,A=this._stacks[M]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(wc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[M]){const N=this.pool.getObjectForId(k.rtt[M].id);if(N.stamp===k.rtt[M].stamp){this.pool.useObject(N);continue}}const R=this.pool.getOrCreateFreeObject();this.pool.useObject(R),this.pool.stampObject(R),k.rtt[M]={id:R.id,stamp:R.stamp},g.context.bindFramebuffer.set(R.fbo.framebuffer),g.context.clear({color:c.bi.transparent,stencil:0}),g.currentStencilSource=void 0;for(let N=0;N<A.length;N++){const j=g.style._layers[A[N]],Y=j.source?this._coordsAscending[j.source][k.tileID.key]:[k.tileID];g.context.viewport.set([0,0,R.fbo.width,R.fbo.height]),g._renderTileClippingMasks(j,Y,!0),g.renderLayer(g,g.style.tileManagers[j.source],j,Y,l),j.source&&(k.rttCoords[j.source]=this._coordsAscendingStr[j.source][k.tileID.key])}}return wc(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Ta[f]}return!1}}const Nt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Qi=K,En={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Br,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ul={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Eo{constructor(e,a,l=!1){this.mousedown=g=>{this.startMove(g,ie.mousePos(this.element,g)),ie.addEventListener(window,"mousemove",this.mousemove),ie.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,ie.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHandler.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ie.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),ie.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=ie.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const f=new qs;this._rotatePitchHandler=new zt({clickTolerance:3,move:(g,b)=>{const M=a.getBoundingClientRect(),A=new c.P((M.bottom-M.top)/2,(M.right-M.left)/2);return{bearingDelta:c.cq(new c.P(g.x,b.y),b,A),pitchDelta:l?-.5*(b.y-g.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,ie.addEventListener(a,"mousedown",this.mousedown),ie.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),ie.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),ie.disableDrag()}move(e,a){const l=this.map,{bearingDelta:f,pitchDelta:g}=this._rotatePitchHandler.dragMove(e,a)||{};f&&l.setBearing(l.getBearing()+f),g&&l.setPitch(l.getPitch()+g)}off(){const e=this.element;ie.removeEventListener(e,"mousedown",this.mousedown),ie.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend),ie.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ie.enableDrag(),ie.removeEventListener(window,"mousemove",this.mousemove),ie.removeEventListener(window,"mouseup",this.mouseup),ie.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ie.removeEventListener(window,"touchend",this.touchend)}}let ta;function hl(p,e,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return p?.wrap();const f=new c.U(p.lng,p.lat);if(p=new c.U(p.lng,p.lat),e){const g=new c.U(p.lng-360,p.lat),b=new c.U(p.lng+360,p.lat),M=a.locationToScreenPoint(p).distSqr(e);a.locationToScreenPoint(g).distSqr(e)<M?p=g:a.locationToScreenPoint(b).distSqr(e)<M&&(p=b)}for(;Math.abs(p.lng-a.center.lng)>180;){const g=a.locationToScreenPoint(p);if(g.x>=0&&g.y>=0&&g.x<=a.width&&g.y<=a.height)break;p.lng>a.center.lng?p.lng-=360:p.lng+=360}return p.lng!==f.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(p))?p:f}const es={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ys(p,e,a){const l=p.classList;for(const f in es)l.remove(`maplibregl-${a}-anchor-${f}`);l.add(`maplibregl-${a}-anchor-${e}`)}class Cc extends c.E{constructor(e){if(super(),this._onKeyPress=a=>{const l=a.code,f=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=hl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),ie.setTransform(this._element,`${es[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${f}`),ge.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ie.create("div");const a=ie.createNS("http://www.w3.org/2000/svg","svg"),l=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${l}`);const g=ie.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const b=ie.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const M=ie.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const le of A){const de=ie.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",le.rx),de.setAttributeNS(null,"ry",le.ry),M.appendChild(de)}const k=ie.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const R=ie.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(R);const N=ie.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const j=ie.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(j);const Y=ie.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Y.setAttributeNS(null,"fill","#FFFFFF");const Q=ie.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=ie.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const se=ie.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),Q.appendChild(re),Q.appendChild(se),b.appendChild(M),b.appendChild(k),b.appendChild(N),b.appendChild(Y),b.appendChild(Q),a.appendChild(b),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),Ys(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ie.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.U.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,l;const f=(a=this._map)===null||a===void 0?void 0:a.terrain,g=this._map.transform.isLocationOccluded(this._lngLat);if(!f||g){const Y=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const b=this._map,M=b.terrain.depthAtPoint(this._pos),A=b.terrain.getElevationForLngLatZoom(this._lngLat,b.transform.tileZoom);if(b.transform.lngLatToCameraDepth(this._lngLat,A)-M<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/b.transform.pixelsPerMeter,R=Math.sin(b.getPitch()*Math.PI/180)*k,N=b.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),j=b.transform.lngLatToCameraDepth(this._lngLat,A+R)-N>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&j&&this._popup.remove(),this._element.style.opacity=j?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Pn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Mo=0,Ws=!1;const Ru={maxWidth:100,unit:"metric"};function Ic(p,e,a){const l=a&&a.maxWidth||100,f=p._container.clientHeight/2,g=p._container.clientWidth/2,b=p.unproject([g-l/2,f]),M=p.unproject([g+l/2,f]),A=Math.round(p.project(M).x-p.project(b).x),k=Math.min(l,A,p._container.clientWidth),R=b.distanceTo(M);if(a&&a.unit==="imperial"){const N=3.2808*R;N>5280?dl(e,k,N/5280,p._getUIString("ScaleControl.Miles")):dl(e,k,N,p._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?dl(e,k,R/1852,p._getUIString("ScaleControl.NauticalMiles")):R>=1e3?dl(e,k,R/1e3,p._getUIString("ScaleControl.Kilometers")):dl(e,k,R,p._getUIString("ScaleControl.Meters"))}function dl(p,e,a,l){const f=(function(g){const b=Math.pow(10,`${Math.floor(g)}`.length-1);let M=g/b;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:(function(A){const k=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*k)/k})(M),b*M})(a);p.style.width=e*(f/a)+"px",p.innerHTML=`${f}&nbsp;${l}`}const Pc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Zl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vl(p){if(p){if(typeof p=="number"){const e=Math.round(Math.abs(p)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,p),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-p),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(p,0),right:new c.P(-p,0)}}if(p instanceof c.P||Array.isArray(p)){const e=c.P.convert(p);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(p.center||[0,0]),top:c.P.convert(p.top||[0,0]),"top-left":c.P.convert(p["top-left"]||[0,0]),"top-right":c.P.convert(p["top-right"]||[0,0]),bottom:c.P.convert(p.bottom||[0,0]),"bottom-left":c.P.convert(p["bottom-left"]||[0,0]),"bottom-right":c.P.convert(p["bottom-right"]||[0,0]),left:c.P.convert(p.left||[0,0]),right:c.P.convert(p.right||[0,0])}}return Vl(new c.P(0,0))}const Lr=K;z.AJAXError=c.cC,z.Event=c.l,z.Evented=c.E,z.LngLat=c.U,z.MercatorCoordinate=c.a5,z.Point=c.P,z.addProtocol=c.cD,z.config=c.a,z.removeProtocol=c.cE,z.AttributionControl=hn,z.BoxZoomHandler=Ah,z.CanvasSource=Ui,z.CooperativeGesturesHandler=Fa,z.DoubleClickZoomHandler=Xs,z.DragPanHandler=ol,z.DragRotateHandler=ll,z.EdgeInsets=Bn,z.FullscreenControl=class extends c.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ie.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=ie.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ie.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},z.GeoJSONSource=tr,z.GeolocateControl=class extends c.E{constructor(p){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new c.U(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,f=this._map.getBearing(),g=c.e({bearing:f},this.options.fitBoundsOptions),b=jt.fromLngLat(a,l);this._map.fitBounds(b,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new c.U(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ws)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=ie.create("button","maplibregl-ctrl-geolocate",this._container),ie.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ie.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Cc({element:this._dotElement}),this._circleElement=ie.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Cc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},Pn,p)}onAdd(p){return this._map=p,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(e=!1){if(ta!==void 0&&!e)return ta;if(window.navigator.permissions===void 0)return ta=!!window.navigator.geolocation,ta;try{ta=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ta=!!window.navigator.geolocation}return ta}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ie.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Mo=0,Ws=!1}_isOutOfMapMaxBounds(p){const e=this._map.getMaxBounds(),a=p.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const p=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&p))return;const e=this._map.project(p),a=this._map.unproject([e.x+100,e.y]),l=p.distanceTo(a)/100,f=2*this._accuracy/l;this._circleElement.style.width=`${f.toFixed(2)}px`,this._circleElement.style.height=`${f.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Mo--,Ws=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Mo++,Mo>1?(p={maximumAge:6e5,timeout:0},Ws=!0):(p=this.options.positionOptions,Ws=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},z.GlobeControl=class{constructor(){this._toggleProjection=()=>{var p;const e=(p=this._map.getProjection())===null||p===void 0?void 0:p.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var p;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((p=this._map.getProjection())===null||p===void 0?void 0:p.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(p){return this._map=p,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ie.create("button","maplibregl-ctrl-globe",this._container),ie.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},z.Hash=fr,z.ImageSource=Ei,z.KeyboardHandler=$s,z.LngLatBounds=jt,z.LogoControl=bs,z.Map=class extends ku{constructor(p){var e,a;c.cz.mark(c.cA.create);const l=Object.assign(Object.assign(Object.assign({},En),p),{canvasContextAttributes:Object.assign(Object.assign({},En.canvasContextAttributes),p.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new Da,g=new cs;if(l.minZoom!==void 0&&f.setMinZoom(l.minZoom),l.maxZoom!==void 0&&f.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&f.setMinPitch(l.minPitch),l.maxPitch!==void 0&&f.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&f.setRenderWorldCopies(l.renderWorldCopies),l.transformConstrain!==null&&f.setConstrain(l.transformConstrain),super(f,g,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new wa,this._controls=[],this._mapId=c.ab(),this._contextLost=M=>{M.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:M}))},this._contextRestored=M=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:M}))},this._onMapScroll=M=>{if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Nt),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.transformConstrain=l.transformConstrain,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ht.addThrottleControl((()=>this.isMoving())),this._requestManager=new St(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let M=!1;const A=Zs((k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())}),50);this._resizeObserver=new ResizeObserver((k=>{M?A(k):M=!0})),this._resizeObserver.observe(this._container)}this.handlers=new cl(this,l),this._hash=l.hash&&new fr(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const b=typeof l.style=="string"||((a=(e=l.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,b),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new hn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new bs,l.logoPosition),this.on("style.load",(()=>{if(b||this._resizeTransform(),this.transform.unmodified){const M=c.S(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(M)}})),this.on("data",(M=>{this._update(M.dataType==="style"),this.fire(new c.l(`${M.dataType}data`,M))})),this.on("dataloading",(M=>{this.fire(new c.l(`${M.dataType}dataloading`,M))})),this.on("dataabort",(M=>{this.fire(new c.l("sourcedataabort",M))}))}_getMapId(){return this._mapId}setGlobalStateProperty(p,e){return this.style.setGlobalStateProperty(p,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(p,e){if(e===void 0&&(e=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=p.onAdd(this);this._controls.push(p);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(p);return e>-1&&this._controls.splice(e,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}coveringTiles(p){return gn(this.transform,p)}calculateCameraOptionsFromTo(p,e,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,e,a,l)}resize(p,e=!0){const[a,l]=this._containerDimensions(),f=this._getClampedPixelRatio(a,l);if(this._resizeCanvas(a,l,f),this.painter.resize(a,l,f),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const M=this._getClampedPixelRatio(a,l);this._resizeCanvas(a,l,M),this.painter.resize(a,l,M)}this._resizeTransform(e);const g=!this._moving;return g&&(this.stop(),this.fire(new c.l("movestart",p)).fire(new c.l("move",p))),this.fire(new c.l("resize",p)),g&&this.fire(new c.l("moveend",p)),this}_resizeTransform(p=!0){var e;const[a,l]=this._containerDimensions();this.transform.resize(a,l,p),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,l,p)}_getClampedPixelRatio(p,e){const{0:a,1:l}=this._maxCanvasSize,f=this.getPixelRatio(),g=p*f,b=e*f;return Math.min(g>a?a/g:1,b>l?l/b:1)*f}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(jt.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.setMinZoom(p),this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.setMaxZoom(p),this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.setMinPitch(p),this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(p>=this.transform.minPitch)return this.transform.setMaxPitch(p),this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.setRenderWorldCopies(p),this._update()}setTransformConstrain(p){return this.transform.setConstrain(p),this._update()}project(p){return this.transform.locationToScreenPoint(c.U.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.screenPointToLocation(c.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,e,a){if(p==="mouseenter"||p==="mouseover"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:g=>{const b=e.filter((A=>this.getLayer(A))),M=b.length!==0?this.queryRenderedFeatures(g.point,{layers:b}):[];M.length?l||(l=!0,a.call(this,new Zr(p,this,g.originalEvent,{features:M}))):l=!1},mouseout:()=>{l=!1}}}}if(p==="mouseleave"||p==="mouseout"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:b=>{const M=e.filter((A=>this.getLayer(A)));(M.length!==0?this.queryRenderedFeatures(b.point,{layers:M}):[]).length?l=!0:l&&(l=!1,a.call(this,new Zr(p,this,b.originalEvent)))},mouseout:b=>{l&&(l=!1,a.call(this,new Zr(p,this,b.originalEvent)))}}}}{const l=f=>{const g=e.filter((M=>this.getLayer(M))),b=g.length!==0?this.queryRenderedFeatures(f.point,{layers:g}):[];b.length&&(f.features=b,a.call(this,f),delete f.features)};return{layers:e,listener:a,delegates:{[p]:l}}}}_saveDelegatedListener(p,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(e)}_removeDelegatedListener(p,e,a){if(!this._delegatedListeners||!this._delegatedListeners[p])return;const l=this._delegatedListeners[p];for(let f=0;f<l.length;f++){const g=l[f];if(g.listener===a&&g.layers.length===e.length&&g.layers.every((b=>e.includes(b)))){for(const b in g.delegates)this.off(b,g.delegates[b]);return void l.splice(f,1)}}}on(p,e,a){if(a===void 0)return super.on(p,e);const l=typeof e=="string"?[e]:e,f=this._createDelegatedListener(p,l,a);this._saveDelegatedListener(p,f);for(const g in f.delegates)this.on(g,f.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(p,l,a)}}}once(p,e,a){if(a===void 0)return super.once(p,e);const l=typeof e=="string"?[e]:e,f=this._createDelegatedListener(p,l,a);for(const g in f.delegates){const b=f.delegates[g];f.delegates[g]=(...M)=>{this._removeDelegatedListener(p,l,a),b(...M)}}this._saveDelegatedListener(p,f);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(p,e,a){return a===void 0?super.off(p,e):(this._removeDelegatedListener(p,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(p,e){if(!this.style)return[];let a;const l=p instanceof c.P||Array.isArray(p),f=l?p:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:p)||{},f instanceof c.P||typeof f[0]=="number")a=[c.P.convert(f)];else{const g=c.P.convert(f[0]),b=c.P.convert(f[1]);a=[g,new c.P(b.x,g.y),b,new c.P(g.x,b.y),g]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(p,e){return this.style.querySourceFeatures(p,e)}setStyle(p,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(p,e))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const e=this._locale[p];if(e==null)throw new Error(`Missing UI string '${p}'`);return e}_updateStyle(p,e){var a,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(p,e)));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new hc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,e,f):this.style.loadJSON(p,e,f),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new hc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,e){if(typeof p=="string"){const a=this._requestManager.transformRequest(p,"Style");c.j(a,new AbortController).then((l=>{this._updateDiff(l.data,e)})).catch((l=>{l&&this.fire(new c.k(l))}))}else typeof p=="object"&&this._updateDiff(p,e)}_updateDiff(p,e){try{this.style.setState(p,e)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(p,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(p,e){return this._lazyInitEmptyStyle(),this.style.addSource(p,e),this._update(!0)}isSourceLoaded(p){const e=this.style&&this.style.tileManagers[p];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no tile manager with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const e=this.style.tileManagers[p.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===p.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===p.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Sa(this.painter,e,p),this.painter.renderToTexture=new Vi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==p.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:p})),this}getTerrain(){var p,e;return(e=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const p=this.style&&this.style.tileManagers;for(const e in p){const a=p[e]._tiles;for(const l in a){const f=a[l];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}setSourceTileLodParams(p,e,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=Gt(Math.max(1,p),Math.max(1,e))}else for(const l in this.style.tileManagers)this.style.tileManagers[l].getSource().calculateTileZoom=Gt(Math.max(1,p),Math.max(1,e));return this._update(!0),this}refreshTiles(p,e){const a=this.style.tileManagers[p];if(!a)throw new Error(`There is no tile manager with ID "${p}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map((l=>new c.a8(l.z,l.x,l.y))))}addImage(p,e,a={}){const{pixelRatio:l=1,sdf:f=!1,stretchX:g,stretchY:b,content:M,textFitWidth:A,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:N,data:j}=e,Y=e;return this.style.addImage(p,{data:new c.R({width:R,height:N},new Uint8Array(j)),pixelRatio:l,stretchX:g,stretchY:b,content:M,textFitWidth:A,textFitHeight:k,sdf:f,version:0,userImage:Y}),Y.onAdd&&Y.onAdd(this,p),this}}{const{width:R,height:N,data:j}=ge.getImageData(e);this.style.addImage(p,{data:new c.R({width:R,height:N},j),pixelRatio:l,stretchX:g,stretchY:b,content:M,textFitWidth:A,textFitHeight:k,sdf:f,version:0})}}updateImage(p,e){const a=this.style.getImage(p);if(!a)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?ge.getImageData(e):e,{width:f,height:g,data:b}=l;if(f===void 0||g===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||g!==a.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(e instanceof HTMLImageElement||c.b(e));return a.data.replace(b,M),this.style.updateImage(p,a),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return ht.getImage(this._requestManager.transformRequest(p,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,e){return this._lazyInitEmptyStyle(),this.style.addLayer(p,e),this._update(!0)}moveLayer(p,e){return this.style.moveLayer(p,e),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,e,a){return this.style.setLayerZoomRange(p,e,a),this._update(!0)}setFilter(p,e,a={}){return this.style.setFilter(p,e,a),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,e,a,l={}){return this.style.setPaintProperty(p,e,a,l),this._update(!0)}getPaintProperty(p,e){return this.style.getPaintProperty(p,e)}setLayoutProperty(p,e,a,l={}){return this.style.setLayoutProperty(p,e,a,l),this._update(!0)}getLayoutProperty(p,e){return this.style.getLayoutProperty(p,e)}setGlyphs(p,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,e,a,(l=>{l||this._update(!0)})),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,e,(a=>{a||this._update(!0)})),this}setLight(p,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(p,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(p,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(p,e){return this.style.setFeatureState(p,e),this._update()}removeFeatureState(p,e){return this.style.removeFeatureState(p,e),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,e=0;return this._container&&(p=this._container.clientWidth||400,e=this._container.clientHeight||300),[p,e]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const e=this._canvasContainer=ie.create("div","maplibregl-canvas-container",p);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ie.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const f=this._controlContainer=ie.create("div","maplibregl-control-container",p),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((b=>{g[b]=ie.create("div",`maplibregl-ctrl-${b} `,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,e,a){this._canvas.width=Math.floor(a*p),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const p=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{e={requestedAttributes:p},l&&(e.statusMessage=l.statusMessage,e.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,p):this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p),!a){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Sc(a,this.transform),Ve.testSupport(a)}migrateProjection(p,e){super.migrateProjection(p,e),this.painter.transform=p,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){var e,a,l,f,g;const b=this._idleTriggered?this._fadeDuration:0,M=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,j=Ae();this.style.zoomHistory.update(N,j);const Y=new c.G(N,{now:j,fadeDuration:b,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Q=Y.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(A=!0,this._crossFadingFactor=Q),this.style.update(Y)}const k=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==M;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cz.mark(c.cA.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const R=this._sourcesDirty||this._styleDirty||this._placementDirty;return R||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,c.cz.mark(c.cA.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ht.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ie.remove(this._canvasContainer),ie.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cz.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ge.frame(this._frameRequest,(p=>{c.cz.frame(p),this._frameRequest=null;try{this._render(p)}catch(e){if(!c.cB(e)&&!(function(a){return a.message===Su})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Qi}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(p){return this._lazyInitEmptyStyle(),this.style.setProjection(p),this._update(!0)}},z.MapMouseEvent=Zr,z.MapTouchEvent=nr,z.MapWheelEvent=rl,z.Marker=Cc,z.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},ul,p),this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),ie.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),ie.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=ie.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Eo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ie.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,e){const a=ie.create("button",p,this._container);return a.type="button",a.addEventListener("click",e),a}},z.Popup=class extends c.E{constructor(p){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&ie.remove(this._content),this._container&&(ie.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ie.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ie.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=hl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const f=Vl(this.options.offset);if(!l){const b=this._container.offsetWidth,M=this._container.offsetHeight;let A;A=a.y+f.bottom.y<M?["top"]:a.y>this._map.transform.height-M?["bottom"]:[],a.x<b/2?A.push("left"):a.x>this._map.transform.width-b/2&&A.push("right"),l=A.length===0?"bottom":A.join("-")}let g=a.add(f[l]);this.options.subpixelPositioning||(g=g.round()),ie.setTransform(this._container,`${es[l]} translate(${g.x}px,${g.y}px)`),Ys(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Pc),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=c.U.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const e=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=p;l=a.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ie.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){return this._container&&this._container.classList.add(p),this}removeClassName(p){return this._container&&this._container.classList.remove(p),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=ie.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Zl);p&&p.focus()}},z.RasterDEMTileSource=Gi,z.RasterTileSource=zi,z.ScaleControl=class{constructor(p){this._onMove=()=>{Ic(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ic(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ru),p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ie.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},z.ScrollZoomHandler=Hs,z.Style=hc,z.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ie.create("button","maplibregl-ctrl-terrain",this._container),ie.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},z.TwoFingersTouchPitchHandler=So,z.TwoFingersTouchRotateHandler=sl,z.TwoFingersTouchZoomHandler=Mc,z.TwoFingersTouchZoomRotateHandler=Ih,z.VectorTileSource=Ti,z.VideoSource=mn,z.addSourceType=(p,e)=>c._(void 0,void 0,void 0,(function*(){if(O(p))throw new Error(`A source type called "${p}" already exists.`);((a,l)=>{ee[a]=l})(p,e)})),z.clearPrewarmedResources=function(){const p=Pt;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Ze),Pt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},z.createTileMesh=Il,z.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},z.getRTLTextPluginStatus=function(){return F().getRTLTextPluginStatus()},z.getVersion=function(){return Lr},z.getWorkerCount=function(){return mt.workerCount},z.getWorkerUrl=function(){return c.a.WORKER_URL},z.importScriptInWorkers=function(p){return bi().broadcast("IS",p)},z.isTimeFrozen=function(){return Me.isFrozen()},z.now=Ae,z.prewarm=function(){Dt().acquire(Ze)},z.restoreNow=function(){Me.restoreNow()},z.setMaxParallelImageRequests=function(p){c.a.MAX_PARALLEL_IMAGE_REQUESTS=p},z.setNow=function(p){Me.setNow(p)},z.setRTLTextPlugin=function(p,e){return F().setRTLTextPlugin(p,e)},z.setWorkerCount=function(p){mt.workerCount=p},z.setWorkerUrl=function(p){c.a.WORKER_URL=p}}));var G=w;return G}))})(Gm)),Gm.exports}var iT=tT();const Oy=tg(iT),nT="https://demotiles.maplibre.org/style.json",qm="network-routes",rT="network-routes-line",$m="network-stops",aT="network-stops-circle",_f={type:"FeatureCollection",features:[]};function sT(h){return{type:"FeatureCollection",features:h.routes.map(y=>({type:"Feature",id:y.id,properties:{id:y.id,name:y.name},geometry:y.geometry}))}}function oT(h){return{type:"FeatureCollection",features:h.stops.map(y=>({type:"Feature",id:y.id,properties:{id:y.id,name:y.name},geometry:{type:"Point",coordinates:[y.lon,y.lat]}}))}}function lT(h){let y=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(const G of h.routes)for(const[z,c]of G.geometry.coordinates)!Number.isFinite(z)||!Number.isFinite(c)||(y=Math.min(y,z),w=Math.min(w,c),S=Math.max(S,z),P=Math.max(P,c));if(!Number.isFinite(y)||!Number.isFinite(w))for(const G of h.stops){const{lon:z,lat:c}=G;!Number.isFinite(z)||!Number.isFinite(c)||(y=Math.min(y,z),w=Math.min(w,c),S=Math.max(S,z),P=Math.max(P,c))}return!Number.isFinite(y)||!Number.isFinite(w)||!Number.isFinite(S)||!Number.isFinite(P)?null:[[y,w],[S,P]]}function cT(h,y){const w=h.getSource(qm),S=h.getSource($m);if(y&&y.routes.length>0){const P=sT(y);w?.setData(P)}else w?.setData(_f);if(y&&y.stops.length>0){const P=oT(y);S?.setData(P)}else S?.setData(_f);if(y){const P=lT(y);if(P){const[G,z]=P;G[0]===z[0]&&G[1]===z[1]?h.flyTo({center:G,zoom:Math.max(h.getZoom(),12),essential:!0}):h.fitBounds(P,{padding:window.innerWidth<1024?32:56,maxZoom:14,duration:800,essential:!0})}}}function uT(){const h=Hi.useRef(null),y=Hi.useRef(null),w=Hi.useRef(null),[S,P]=Hi.useState(!1),G=wf($=>$.network),z=wf($=>$.status),c=Hi.useMemo(()=>{switch(z){case"reading":return"GTFS";case"error":return"GTFS";default:return"GTFS"}},[z]);Hi.useEffect(()=>{if(!h.current||y.current)return;const $=new Oy.Map({container:h.current,style:nT,center:[139.7671,35.6812],zoom:9,locale:{"NavigationControl.ZoomIn":"","NavigationControl.ZoomOut":"","NavigationControl.Compass":""}});$.addControl(new Oy.NavigationControl({visualizePitch:!0}),"top-right");const oe=()=>{$.addSource(qm,{type:"geojson",data:_f}),$.addLayer({id:rT,type:"line",source:qm,paint:{"line-color":"#2563eb","line-width":["interpolate",["linear"],["zoom"],8,1.2,12,3,16,6],"line-opacity":.85}}),$.addSource($m,{type:"geojson",data:_f}),$.addLayer({id:aT,type:"circle",source:$m,paint:{"circle-radius":["interpolate",["linear"],["zoom"],8,2.5,12,4,16,6],"circle-color":"#0ea5e9","circle-stroke-color":"#ffffff","circle-stroke-width":1,"circle-opacity":.9}}),P(!0)};$.on("load",oe),y.current=$;const ce=new ResizeObserver(()=>{$.resize()});return ce.observe(h.current),w.current=ce,()=>{ce.disconnect(),w.current=null,$.off("load",oe),$.remove(),y.current=null}},[]),Hi.useEffect(()=>{!S||!y.current||cT(y.current,G??null)},[G,S]),Hi.useEffect(()=>()=>{if(y.current){const $=y.current.getSource(qm),oe=y.current.getSource($m);$?.setData(_f),oe?.setData(_f)}},[]);const K=!G||z==="reading"||z==="error";return Ct.jsxs("div",{className:"relative flex-1",children:[Ct.jsx("div",{ref:h,className:"h-full min-h-[280px] w-full overflow-hidden rounded-md bg-muted/40 ring-1 ring-border/50"}),K?Ct.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center p-6",children:Ct.jsx("div",{className:"rounded-md border border-border/70 bg-background/90 px-4 py-3 text-center text-xs text-muted-foreground shadow-sm backdrop-blur",children:c})}):null]})}function hT(){const{status:h,summary:y}=wf(S=>({status:S.status,summary:S.summary})),w=(()=>{switch(h){case"reading":return"";case"ready":return"";case"error":return"";default:return""}})();return Ct.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[Ct.jsx("header",{className:"border-b border-border px-6 py-4",children:Ct.jsxs("div",{className:"flex flex-col gap-1",children:[Ct.jsx("h1",{className:"text-xl font-semibold",children:"MLIT UI Mock"}),Ct.jsx("p",{className:"text-sm text-muted-foreground",children:"GTFSSDT"})]})}),Ct.jsxs("main",{className:"grid h-[calc(100vh-4.5rem)] gap-4 px-6 py-4 lg:grid-cols-[320px_minmax(0,1fr)_360px]",children:[Ct.jsxs("section",{className:"flex flex-col gap-6 overflow-y-auto rounded-lg border border-border bg-card/40 p-4",children:[Ct.jsx(JS,{}),Ct.jsxs("section",{className:"space-y-3",children:[Ct.jsxs("header",{children:[Ct.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"KPI"}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:"1"})]}),Ct.jsx("div",{className:"rounded-lg border border-dashed border-border bg-background/50 p-4 text-sm text-muted-foreground",children:"KPI"})]}),Ct.jsxs("section",{className:"space-y-3",children:[Ct.jsxs("header",{children:[Ct.jsx("h2",{className:"text-sm font-semibold text-foreground",children:""}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:"GTFS10SDT"})]}),Ct.jsx(pf,{className:"w-full",disabled:!0,children:""})]})]}),Ct.jsxs("section",{className:"flex flex-col rounded-lg border border-border bg-card/40 p-4",children:[Ct.jsxs("header",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[Ct.jsxs("div",{children:[Ct.jsx("h2",{className:"text-sm font-semibold text-foreground",children:""}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:y?`${y.routeCount.toLocaleString()} / ${y.stopCount.toLocaleString()} / ${y.shapeCount.toLocaleString()}`:"GTFS"})]}),Ct.jsx("span",{className:"text-xs text-muted-foreground",children:w})]}),Ct.jsx("div",{className:"mt-4 flex min-h-[320px] flex-1",children:Ct.jsx(uT,{})})]}),Ct.jsxs("section",{className:"flex flex-col overflow-hidden rounded-lg border border-border bg-card/40",children:[Ct.jsxs("div",{className:"border-b border-border px-4 py-3",children:[Ct.jsx("h2",{className:"text-sm font-semibold text-foreground",children:""}),Ct.jsx("p",{className:"text-xs text-muted-foreground",children:"10"})]}),Ct.jsx("div",{className:"flex-1 space-y-3 overflow-y-auto px-4 py-3 text-sm text-muted-foreground",children:[1,2,3].map(S=>Ct.jsxs("div",{className:"rounded-md border border-dashed border-muted bg-background/60 p-3",children:[" ",S]},S))})]})]})]})}function dT(){return Ct.jsx(hT,{})}async function fT(){}fT().finally(()=>{J0.createRoot(document.getElementById("root")).render(Ct.jsx(Hi.StrictMode,{children:Ct.jsx(dT,{})}))});

