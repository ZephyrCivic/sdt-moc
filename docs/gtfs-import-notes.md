# GTFS取り込みノート（変更履歴）

最終更新: 2025-11-11

## ZIP内サブフォルダ対応

- 背景: 一部のGTFS配布物は `google_transit/stops.txt` のようにZIP内でサブフォルダに格納されています。この場合、`stops.txt` をZIP直下に想定した実装では必須ファイルを検出できず、読み込みエラーや地図未表示の原因となっていました。
- 対応: `src/entities/gtfs/parser.ts` にファイル名リゾルバを追加し、`stops.txt` などを「末尾一致（**/stops.txt）」で解決するように変更しました。大小文字差も吸収します。
- 影響範囲: UIの操作は変更ありません。GTFS ZIPのフォルダ構成差による読込失敗が解消され、ルート・停留所が安定して地図表示されます。

参考: 実装上の詳細は `buildNameResolver()` と `parseGtfsZip()` を参照してください。

